[{"categories":["Apache Spark"],"content":"Spark 3.0 å¯¹å†…å­˜ç›‘æ§æœ‰é‡è¦æ”¹è¿›ï¼Œåˆ†æå³°å€¼å†…å­˜ä½¿ç”¨æƒ…å†µä¸ºè§£å†³ OOM é”™è¯¯å’Œ Spark ä½œä¸šå†…å­˜å¤§å°è°ƒæ•´æä¾›äº†é‡è¦ä¾æ®ã€‚","date":"2021-11-07","objectID":"/spark3-memory-monitoring/","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"Apache 3.0 æ”¹è¿›äº†è¿è¡Œæ—¶çš„å†…å­˜ç›‘æ§ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·è§£å†³å†…å­˜ä½¿ç”¨é—®é¢˜ï¼Œå¹¶ä¸”ä¼˜åŒ– Spark ä½œä¸šçš„å†…å­˜é…ç½®ã€‚å…·ä½“æƒ…å†µè¯·å‚é˜… SPARK-23429 å’Œ SPARK-27189ã€‚ å†…å­˜é—®é¢˜ å†…å­˜æ˜¯ Spark ä½œä¸šæ€§èƒ½å’Œç¨³å®šæ€§çš„å…³é”®ã€‚å¦‚æœæ²¡æœ‰ä¸º Spark ä½œä¸šåˆ†é…è¶³å¤Ÿçš„å†…å­˜ï¼Œåˆ™æœ‰å¯èƒ½é‡åˆ° OOM é”™è¯¯æˆ–è€…ä½œä¸šæ€§èƒ½å¤§å¹…åº¦é™ä½ã€‚Spark éœ€è¦å†…å­˜æ¥é«˜æ•ˆæ‰§è¡Œ Dataframe/RDD æ“ä½œï¼Œæå‡ç®—æ³•æ€§èƒ½ï¼Œå¦åˆ™ä½œä¸šåœ¨å¤„ç†è¿‡ç¨‹ä¸­å¿…é¡» shuffle åˆ°ç£ç›˜ã€‚æ­¤å¤–ï¼Œå†…å­˜è¿˜å¯ä»¥ç”¨äºç¼“å­˜æ•°æ®ï¼Œå‡å°‘ I/Oã€‚åœ¨å®è·µè¿‡ç¨‹ä¸­ï¼Œæ€ä¹ˆçŸ¥é“ä¸€ä¸ªä½œä¸šéœ€è¦å¤šå°‘å†…å­˜ï¼Ÿ åŸºæœ¬æ–¹æ³• ä¸º Spark ä½œä¸šè°ƒæ•´å†…å­˜å¤§å°çš„ä¸€ä¸ªåŸºæœ¬æ–¹æ³•å°±æ˜¯é€šè¿‡ spark.executor.memory é…ç½®å†…å­˜èµ„æºã€‚åœ¨ local æ¨¡å¼ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ spark.driver.memory è¿›è¡Œé…ç½®ã€‚é€šè¿‡åå¤è¯•éªŒï¼Œç”¨æˆ·å¯ä»¥ç¡®è®¤æ‰€éœ€å†…å­˜çš„å¤§æ¦‚æ•°å€¼ã€‚è¿™ç§æ–¹æ³•ä¸æ˜¯æœ€ä½³æ–¹æ¡ˆï¼Œç¼ºç‚¹åœ¨äºç¹çï¼Œä¸”ä¸å¯é ã€‚ æ”¹è¿›æ–¹æ³• ç”¨æˆ·å¯ä»¥æ ¹æ®ç›‘æ§æ•°æ®æ¥äº†è§£ Spark åº”ç”¨ç¨‹åºä½¿ç”¨äº†å¤šå°‘å†…å­˜ã€å“ªäº›ä½œä¸šè¯·æ±‚æ›´å¤šå†…å­˜ä»¥åŠä½¿ç”¨å“ªäº›å†…å­˜åŒºåŸŸã€‚è¿™ç§æ–¹æ³•æœ‰åŠ©äºæ·±å…¥è§£å†³ OOM é—®é¢˜ï¼Œä¹Ÿæœ‰åŠ©äºæ›´åŠ ç²¾ç¡®åœ°ä¸º Spark åº”ç”¨ç¨‹åºåˆ†é…å†…å­˜ã€‚ ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:0:0","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"Spark å¦‚ä½•ä½¿ç”¨å†…å­˜ï¼Ÿ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:1:0","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"executor å†…å­˜é…ç½®spark.executor.memory æ˜¯é…ç½® executor å†…å­˜çš„ä¸»è¦å‚æ•°ï¼Œé€šè¿‡å¢åŠ å†…å­˜å¼€é”€ä»¥è¦†ç›–é¢å¤–å†…å­˜ä½¿ç”¨ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿã€å†—ä½™è®¡ç®—å’Œæ–‡ä»¶ç¼“å­˜ï¼Œè®¡ç®—å…¬å¼ä¸º $memory-overhead-factor \\times spark.executor.memory$ ã€‚memory-overhead-factor é»˜è®¤å€¼ä¸º 0.1ï¼Œå½“ Spark è¿è¡Œåœ¨ Kubernetes ä¸Šæ—¶ï¼Œå¯ä»¥é€šè¿‡ spark.kubernetes.memoryOverheadFactor é…ç½®ã€‚åœ¨ä½¿ç”¨ PySpark æ—¶ï¼Œé¢å¤–å†…å­˜å¯ä»¥é€šè¿‡ spark.executor.pyspark.memory é…ç½®ã€‚å †å¤–å†…å­˜å¯ä»¥ç”¨ spark.memory.offHeap.size=\u003csize\u003e å’Œ spark.memory.offHeap.enable=true é…ç½®ï¼Œè¿™æ ·çš„é…ç½®å¯¹ YARN æœ‰æ•ˆã€‚K8s çš„é…ç½®æ–¹å¼å‚é˜… SPARK-32661ã€‚ è¿˜æœ‰ driver å†…å­˜åˆ†é…å‚æ•°ï¼šspark.driver.memory ã€spark.driver.memoryOverheadã€‚ Spark Executor Memory ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:1:1","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"spark ç»Ÿä¸€å†…å­˜æ± Spark ä»»åŠ¡ä½¿ç”¨çš„å†…å­˜ç”± Spark å†…å­˜ç®¡ç†ç³»ç»Ÿç»Ÿä¸€ç®¡ç†ï¼Œä» executor çš„ JVM å †ä¸­åˆ†é…ã€‚Unified memory é»˜è®¤å ç”¨ 60% JVM å †å¤§å°ã€‚ç³»ç»Ÿå¯ä»¥é€šè¿‡ spark.memory.fraction é…ç½®ã€‚å‰©ä½™ 40% çš„å†…å­˜ç”¨äºç”¨æˆ·æ•°æ®ç»“æ„ã€Spark å†…éƒ¨å…ƒæ•°æ®ã€é˜²æ­¢ OOM é”™è¯¯ã€‚ Spark é€šè¿‡ç»Ÿä¸€å†…å­˜æ± ç®¡ç†æ‰§è¡Œã€å­˜å‚¨å†…å­˜è¯·æ±‚ã€‚æ‰§è¡Œå’Œå­˜å‚¨å¯ä»¥ç›¸äº’å ç”¨å¯¹æ–¹å‰©ä½™å†…å­˜èµ„æºã€‚æ‰§è¡Œ/å­˜å‚¨çš„å†…å­˜èµ„æºå¤§å°å¯ä»¥é€šè¿‡ spark.memory.storageFractionï¼ˆé»˜è®¤ä¸º 0.5ï¼‰è°ƒæ•´ï¼Œè¿™å°±æ„å‘³ç€æ‰§è¡Œå†…å­˜èµ„æºå æ¯”é»˜è®¤ä¸º $spark.memory.fraction \\times spark.memory.storageFraction=0.6\\times0.5=0.3$ã€‚ç»Ÿä¸€å†…å­˜æ± ä¹Ÿå¯ä»¥ç”±å †å¤–å†…å­˜é…ç½®ï¼Œç›¸å…³é…ç½®å‚æ•°ä¸º spark.memory.offHeapã€spark.memory.offHeap.enabledã€‚ ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:1:2","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"Spark 3.0 çš„å†…å­˜ç›‘æ§Spark 3.0 æœ‰ä¸¤ä¸ªå…³äºå†…å­˜ç›‘æ§çš„ä¸»è¦æ”¹è¿›ç‚¹ï¼š SPARK-23429ï¼šå°† executor å†…å­˜æŒ‡æ ‡æ·»åŠ åˆ°å¿ƒè·³å¹¶ç”¨ REST API æš´éœ² SPARK-27189ï¼šå°† executor æŒ‡æ ‡å’Œå†…å­˜ä½¿ç”¨æ£€æµ‹æ·»åŠ åˆ°æŒ‡æ ‡ç³»ç»Ÿ ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:2:0","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"ä½¿ç”¨ REST API è·å–å†…å­˜ä½¿ç”¨æƒ…å†µå’Œå³°å€¼This is a tip REST APIï¼šhttps://spark.apache.org/docs/latest/monitoring.html#rest-api WebUI URL + /api/v1/applications/\u003capplication_id\u003e/executors executor å†…å­˜æŒ‡æ ‡å¦‚ä¸‹æ‰€ç¤ºï¼š \"peakMemoryMetrics\" : { \"JVMHeapMemory\" : 29487812552, \"JVMOffHeapMemory\" : 149957200, \"OnHeapExecutionMemory\" : 12458956272, \"OffHeapExecutionMemory\" : 0, \"OnHeapStorageMemory\" : 83578970, \"OffHeapStorageMemory\" : 0, \"OnHeapUnifiedMemory\" : 12540212490, \"OffHeapUnifiedMemory\" : 0, \"DirectPoolMemory\" : 66809076, \"MappedPoolMemory\" : 0, \"ProcessTreeJVMVMemory\" : 38084534272, \"ProcessTreeJVMRSSMemory\" : 36998328320, \"ProcessTreePythonVMemory\" : 0, \"ProcessTreePythonRSSMemory\" : 0, \"ProcessTreeOtherVMemory\" : 0, \"ProcessTreeOtherRSSMemory\" : 0, \"MinorGCCount\" : 561, \"MinorGCTime\" : 49918, \"MajorGCCount\" : 0, \"MajorGCTime\" : 0 }, ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:2:1","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"Spark ä½œä¸šæ€§èƒ½æ•°æ®å¤§ç›˜Spark æŒ‡æ ‡ç³»ç»Ÿä¸º Spark æ•°æ®å¤§ç›˜æä¾›æ•°æ®æºã€‚Grafana å¯¹æ•°æ®æºè¿›è¡Œå¯è§†åŒ–ï¼Œä¼˜ç‚¹å¦‚ä¸‹ï¼š å¯ä»¥å®æ—¶æŸ¥çœ‹æŒ‡æ ‡å€¼çš„å˜åŒ–ï¼Œå¹¶å°†å®ƒä»¬ä¸å·¥ä½œè´Ÿè½½çš„å…¶ä»–å…³é”®æŒ‡æ ‡è¿›è¡Œæ¯”è¾ƒï¼› å¯ä»¥èšåˆæŒ‡æ ‡è¿›è¡Œæ£€æŸ¥æˆ–è€…æ·±å…¥ executor çº§åˆ«çš„æŒ‡æ ‡ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·äº†è§£æ˜¯å¦å­˜åœ¨å¼‚å¸¸å€¼ï¼› ä¾‹å¦‚ï¼Œå¯ä»¥ç ”ç©¶æŒ‡æ ‡éšæ—¶é—´çš„æ¼”å˜ï¼Œäº†è§£å·¥ä½œè´Ÿè½½çš„å“ªä¸€éƒ¨åˆ†åœ¨ç»™å®šæŒ‡æ ‡ä¸­äº§ç”Ÿäº†æŸäº›å³°å€¼ã€‚ Spark Performance Dashboard ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:2:2","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"å®éªŒ ä½¿ç”¨ Spark 3.0 on YARN/Kubernetes Spark æ€§èƒ½æ•°æ®å¤§ç›˜ï¼šé…ç½®ã€å®‰è£…æ–¹å¼è¯·å‚é˜… https://github.com/cerndb/spark-dashboard æäº¤ä½œä¸šï¼šTPCDS benchmark bin/spark-shell --master yarn --num-executors 16 --executor-cores 8 \\ --driver-memory 4g --executor-memory 32g \\ --jars /home/luca/spark-sql-perf/target/scala-2.12/spark-sql-perf_2.12-0.5.1-SNAPSHOT.jar \\ --conf spark.eventLog.enabled=false \\ --conf spark.sql.shuffle.partitions=512 \\ --conf spark.sql.autoBroadcastJoinThreshold=100000000 \\ --conf spark.executor.processTreeMetrics.enabled=true import com.databricks.spark.sql.perf.tpcds.TPCDSTables val tables = new TPCDSTables(spark.sqlContext, \"/home/luca/tpcds-kit/tools\",\"1500\") tables.createTemporaryTables(\"/project/spark/TPCDS/tpcds_1500_parquet_1.10.1\", \"parquet\") val tpcds = new com.databricks.spark.sql.perf.tpcds.TPCDS(spark.sqlContext) val experiment = tpcds.runExperiment(tpcds.tpcds2_4Queries) ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:3:0","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"æ€»ç»“æ­£ç¡®è°ƒæ•´ Spark ä½œä¸šå†…å­˜é…ç½®å¤§å°å¾ˆé‡è¦ï¼Œæé«˜äº†å¤šç§Ÿæˆ·ç¯å¢ƒä¸­æ€§èƒ½ã€ç¨³å®šæ€§å’Œèµ„æºåˆ©ç”¨ç‡ã€‚Spark 3.0 å¯¹å†…å­˜ç›‘æ§æœ‰é‡è¦æ”¹è¿›ï¼Œåˆ†æå³°å€¼å†…å­˜ä½¿ç”¨æƒ…å†µä¸ºè§£å†³ OOM é”™è¯¯å’Œ Spark ä½œä¸šå†…å­˜å¤§å°è°ƒæ•´æä¾›äº†é‡è¦ä¾æ®ã€‚ ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:4:0","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"å‚è€ƒèµ„æ–™Talksï¼š Metrics-Driven Tuning of Apache Spark at Scale, Spark Summit 2018. Performance Troubleshooting Using Apache Spark Metrics, Spark Summit 2019 Tuning Apache Spark for Large-Scale Workloads, Spark summit 2017 Deep Dive: Apache Spark Memory Management, Spark Summit 2016. Understanding Memory Management In Spark For Fun And Profit, Spark Summit 2016. Spark æ–‡æ¡£å’Œåšå®¢ï¼š Monitoring guide: REST API, Executor Task Metrics. Executor Metrics, Spark Metrics System Tuning guide: Memory Management Overview Apache Spark and off-heap memory A Performance Dashboard for Apache Spark JIRAsï¼š SPARK-23206 SPARK-23429 SPARK-27189 Spark Codeï¼š Spark Memory Manager Unified memory ","date":"2021-11-07","objectID":"/spark3-memory-monitoring/:5:0","tags":["Spark","Performance","Troubleshooting","Tools"],"title":"Apache Spark3 å†…å­˜ç›‘æ§","uri":"/spark3-memory-monitoring/"},{"categories":["Apache Spark"],"content":"æœ¬æ–‡æ€»ç»“äº† Spark è®¡ç®—æ¡†æ¶çš„åŸºç¡€æ¶æ„ï¼Œä»‹ç»äº† Spark on K8s çš„å¤šç§æ–¹æ¡ˆï¼Œç€é‡ä»‹ç»äº† Spark Operator çš„è®¾è®¡å’Œå®ç°ã€‚","date":"2021-09-21","objectID":"/spark-operator-brief-analysis/","tags":["Spark","Operator","Kubernetes"],"title":"Spark Operator æµ…æ","uri":"/spark-operator-brief-analysis/"},{"categories":["Apache Spark"],"content":" ä¸­ç§‹å¿«ä¹ ğŸŒ•ğŸ¥® ","date":"2021-09-21","objectID":"/spark-operator-brief-analysis/:0:0","tags":["Spark","Operator","Kubernetes"],"title":"Spark Operator æµ…æ","uri":"/spark-operator-brief-analysis/"},{"categories":["Apache Spark"],"content":"Spark è¿è¡Œæ—¶æ¶æ„ç»è¿‡è¿‘å‡ å¹´çš„é«˜é€Ÿå‘å±•ï¼Œåˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶çš„æ¶æ„é€æ¸è¶‹åŒã€‚èµ„æºç®¡ç†æ¨¡å—ä½œä¸ºå…¶ä¸­æœ€é€šç”¨çš„æ¨¡å—é€æ¸ä¸æ¡†æ¶è§£è€¦ï¼Œç‹¬ç«‹æˆé€šç”¨çš„ç»„ä»¶ã€‚ç›®å‰å¤§éƒ¨åˆ†åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶éƒ½æ”¯æŒæ¥å…¥å¤šæ¬¾ä¸åŒçš„èµ„æºç®¡ç†å™¨ã€‚èµ„æºç®¡ç†å™¨è´Ÿè´£é›†ç¾¤èµ„æºçš„ç®¡ç†å’Œè°ƒåº¦ï¼Œä¸ºè®¡ç®—ä»»åŠ¡åˆ†é…èµ„æºå®¹å™¨å¹¶ä¿è¯èµ„æºéš”ç¦»ã€‚Apache Spark ä½œä¸ºé€šç”¨åˆ†å¸ƒå¼è®¡ç®—å¹³å°ï¼Œç›®å‰åŒæ—¶æ”¯æŒå¤šæ¬¾èµ„æºç®¡ç†å™¨ï¼ŒåŒ…æ‹¬ï¼š YARN Mesos Kubernetes Spark Standalone Apache Spark çš„è¿è¡Œæ—¶æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ä¸å„ç±»èµ„æºè°ƒåº¦å™¨çš„äº¤äº’æµç¨‹æ¯”è¾ƒç±»ä¼¼ï¼š Sparkè¿è¡Œæ—¶æ¡†æ¶ï¼ˆClientæ¨¡å¼ï¼‰ å…¶ä¸­ï¼ŒDriver è´Ÿè´£ä½œä¸šé€»è¾‘çš„è°ƒåº¦å’Œä»»åŠ¡çš„ç›‘æ§ï¼Œèµ„æºç®¡ç†å™¨è´Ÿè´£èµ„æºåˆ†é…å’Œç›‘æ§ã€‚Driver æ ¹æ®éƒ¨ç½²æ¨¡å¼çš„ä¸åŒï¼Œå¯åŠ¨å’Œè¿è¡Œçš„ç‰©ç†ä½ç½®æœ‰æ‰€ä¸åŒã€‚å…¶ä¸­ï¼ŒClient æ¨¡å¼ä¸‹ï¼ŒDriver æ¨¡å—è¿è¡Œåœ¨ Spark-Submit è¿›ç¨‹ä¸­ï¼ŒCluster æ¨¡å¼ä¸‹ï¼ŒDriver çš„å¯åŠ¨è¿‡ç¨‹å’ŒExecutor ç±»ä¼¼ï¼Œè¿è¡Œåœ¨èµ„æºè°ƒåº¦å™¨åˆ†é…çš„èµ„æºå®¹å™¨å†…ã€‚ K8s æ˜¯ Spark åœ¨ 2.3 å¼€å§‹æ”¯æŒèµ„æºç®¡ç†å™¨ï¼Œè€Œç›¸å…³è®¨è®ºæ—©åœ¨2016å¹´å°±å·²ç»å¼€å§‹å±•å¼€ã€‚Sparkå¯¹ K8s çš„æ”¯æŒéšç€ç‰ˆæœ¬çš„è¿­ä»£ä¹Ÿé€æ­¥æ·±å…¥ï¼Œåœ¨å‘å¸ƒçš„ 3.0 ä¸­ï¼ŒSpark on K8s æä¾›äº†æ›´å¥½çš„ Kerberos æ”¯æŒå’Œèµ„æºåŠ¨æ€æ”¯æŒçš„ç‰¹æ€§ã€‚ ","date":"2021-09-21","objectID":"/spark-operator-brief-analysis/:1:0","tags":["Spark","Operator","Kubernetes"],"title":"Spark Operator æµ…æ","uri":"/spark-operator-brief-analysis/"},{"categories":["Apache Spark"],"content":"Spark on KubernetesKubernetes æ˜¯ç”± Google å¼€æºçš„ä¸€æ¬¾é¢å‘åº”ç”¨çš„å®¹å™¨é›†ç¾¤éƒ¨ç½²å’Œç®¡ç†ç³»ç»Ÿ,è¿‘å¹´æ¥å‘å±•ååˆ†è¿…çŒ›ï¼Œç›¸å…³ç”Ÿæ€å·²ç»æ—¥è¶‹å®Œå–„ã€‚åœ¨ Spark å®˜æ–¹æ¥å…¥ K8s å‰ï¼Œç¤¾åŒºé€šå¸¸é€šè¿‡åœ¨ K8s é›†ç¾¤ä¸Šéƒ¨ç½²ä¸€ä¸ª Spark Standalone é›†ç¾¤çš„æ–¹å¼æ¥å®ç°åœ¨ K8s é›†ç¾¤ä¸Šè¿è¡Œ Spark ä»»åŠ¡çš„ç›®çš„ã€‚æ–¹æ¡ˆæ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Spark Standalone on K8s è¿™ä¸ªæ¨¡å¼ç®€å•æ˜“ç”¨ï¼Œä½†å­˜åœ¨ç›¸å½“å¤§çš„ç¼ºé™·ï¼š æ— æ³•æŒ‰éœ€æ‰©å±•ï¼ŒSpark Standalone éƒ¨ç½²åé›†ç¾¤è§„æ¨¡å›ºå®šï¼Œæ— æ³•æ ¹æ®ä½œä¸šéœ€æ±‚è‡ªåŠ¨æ‰©å±•é›†ç¾¤ï¼› æ— æ³•åˆ©ç”¨K8såŸç”Ÿèƒ½åŠ›ï¼ŒSpark Standalone å†…å»ºçš„èµ„æºè°ƒåº¦å™¨ä¸æ”¯æŒæ‰©å±•ï¼Œéš¾ä»¥æ¥å…¥K8s è°ƒåº¦ï¼Œæ— æ³•åˆ©ç”¨ K8s æä¾›çš„äº‘åŸç”Ÿç‰¹æ€§ï¼› Spark Standalone é›†ç¾¤åœ¨å¤šç§Ÿæˆ·èµ„æºéš”ç¦»ä¸Šå¤©ç”Ÿå­˜åœ¨çŸ­æ¿ã€‚ Spark on Kubernetes æ–¹æ¡ˆæ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè®¾è®¡ç»†èŠ‚å¯ä»¥å‚è€ƒï¼šSPARK-18278 Spark on K8s åœ¨è¿™ä¸ªæ–¹æ¡ˆä¸­ï¼Œ Spark-Submit é€šè¿‡è°ƒç”¨ K8s API åœ¨ K8s é›†ç¾¤ä¸­å¯åŠ¨ä¸€ä¸ª Spark Driver Podï¼› Driver é€šè¿‡è°ƒç”¨ K8s API å¯åŠ¨ç›¸åº”çš„ Executor Podï¼Œç»„æˆä¸€ä¸ª Spark Application é›†ç¾¤ï¼Œå¹¶æŒ‡æ´¾ä½œä¸šä»»åŠ¡åˆ°è¿™äº› Executor ä¸­æ‰§è¡Œ; ä½œä¸šç»“æŸåï¼ŒExecutor Pod ä¼šè¢«é”€æ¯ï¼Œè€Œ Driver Pod ä¼šæŒä¹…åŒ–ç›¸å…³æ—¥å¿—ï¼Œå¹¶ä¿æŒåœ¨ completed çŠ¶æ€ï¼Œç›´åˆ°ç”¨æˆ·æ‰‹æ¸…ç†æˆ–è¢« K8s é›†ç¾¤çš„åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ã€‚ å½“å‰çš„æ–¹æ¡ˆå·²ç»è§£å†³äº† Spark Standalone on K8s æ–¹æ¡ˆçš„éƒ¨åˆ†ç¼ºé™·ï¼Œç„¶è€Œï¼ŒSpark Application çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†æ–¹å¼å’Œè°ƒåº¦æ–¹å¼ä¸ K8s å†…ç½®çš„å·¥ä½œè´Ÿè½½ï¼ˆå¦‚ Deploymentsã€DaemonSetsã€StatefulSetsç­‰ï¼‰å­˜åœ¨è¾ƒå¤§å·®å¼‚ï¼Œåœ¨ K8s ä¸Šæ‰§è¡Œä½œä¸šä»ç„¶å­˜åœ¨ä¸å°‘é—®é¢˜ï¼š Spark-submit åœ¨ K8s é›†ç¾¤ä¹‹å¤–ï¼Œä½¿ç”¨éå£°æ˜å¼çš„æäº¤æ¥å£ï¼› Spark Application ä¹‹é—´æ²¡æœ‰ååŒè°ƒåº¦ï¼Œåœ¨å°é›†ç¾¤ä¸­å¾ˆå®¹æ˜“å‡ºç°è°ƒåº¦é¥¿æ­»çš„æƒ…å†µï¼› éœ€è¦æ‰‹åŠ¨é…ç½®ç½‘ç»œï¼Œæ¥è®¿é—® WebUIï¼› ä»»åŠ¡ç›‘æ§æ¯”è¾ƒéº»çƒ¦ï¼Œæ²¡æœ‰æ¥å…¥ Prometheus é›†ç¾¤ç›‘æ§ã€‚ å½“ç„¶Spark on Kubernetes æ–¹æ¡ˆç›®å‰è¿˜åœ¨å¿«é€Ÿå¼€å‘ä¸­ï¼Œæ›´å¤šç‰¹æ€§ä¸ä¹…ä¼šå‘å¸ƒå‡ºæ¥ï¼Œç›¸ä¿¡æœªæ¥å’Œ K8s çš„é›†æˆä¼šæ›´åŠ ç´§å¯†å’Œ Nativeï¼Œè¿™äº›ç‰¹æ€§åŒ…æ‹¬ï¼š åŠ¨æ€èµ„æºåˆ†é…å’Œå¤–éƒ¨ Shuffle æœåŠ¡ æœ¬åœ°æ–‡ä»¶ä¾èµ–ç®¡ç†å™¨ Spark Application ç®¡ç†å™¨ ä½œä¸šé˜Ÿåˆ—å’Œèµ„æºç®¡ç†å™¨ ","date":"2021-09-21","objectID":"/spark-operator-brief-analysis/:2:0","tags":["Spark","Operator","Kubernetes"],"title":"Spark Operator æµ…æ","uri":"/spark-operator-brief-analysis/"},{"categories":["Apache Spark"],"content":"Spark Operator æµ…æåœ¨åˆ†æ Spark Operator çš„å®ç°ä¹‹å‰ï¼Œå…ˆç®€å•æ¢³ç†ä¸‹ Kubernetes Operator çš„åŸºæœ¬æ¦‚å¿µã€‚Kubernetes Operator æ˜¯ç”± CoreOS å¼€å‘çš„ Kubernetes æ‰©å±•ç‰¹æ€§ï¼Œç›®æ ‡æ˜¯é€šè¿‡å®šä¹‰ä¸€ç³»åˆ— CRD å’Œå®ç°æ§åˆ¶å™¨ï¼Œå°†ç‰¹å®šé¢†åŸŸçš„åº”ç”¨ç¨‹åºè¿ç»´æŠ€æœ¯å’ŒçŸ¥è¯†ï¼ˆå¦‚éƒ¨ç½²æ–¹æ³•ã€ç›‘æ§ã€æ•…éšœæ¢å¤ç­‰ï¼‰é€šè¿‡ä»£ç çš„æ–¹å¼å›ºåŒ–ä¸‹æ¥ã€‚Spark Operator æ˜¯ Google åŸºäº Operator æ¨¡å¼å¼€å‘çš„ä¸€æ¬¾çš„å·¥å…·(https://github.com/GoogleCloudPlatform/spark-on-k8s-operator)ï¼Œç”¨äºé€šè¿‡å£°æ˜å¼çš„æ–¹å¼å‘ K8s é›†ç¾¤æäº¤ Spark ä½œä¸šã€‚ä½¿ç”¨ Spark Operator ç®¡ç† Spark åº”ç”¨ï¼Œèƒ½æ›´å¥½çš„åˆ©ç”¨ K8s åŸç”Ÿèƒ½åŠ›æ§åˆ¶å’Œç®¡ç† Spark åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬åº”ç”¨çŠ¶æ€ç›‘æ§ã€æ—¥å¿—è·å–ã€åº”ç”¨è¿è¡Œæ§åˆ¶ç­‰ï¼Œå¼¥è¡¥ Spark on K8s æ–¹æ¡ˆåœ¨é›†æˆ K8s ä¸Šä¸å…¶ä»–ç±»å‹çš„è´Ÿè½½ä¹‹é—´å­˜åœ¨çš„å·®è·ã€‚ ä¸‹é¢ç®€å•åˆ†æä¸‹Spark Operatorçš„å®ç°ç»†èŠ‚ã€‚ ","date":"2021-09-21","objectID":"/spark-operator-brief-analysis/:3:0","tags":["Spark","Operator","Kubernetes"],"title":"Spark Operator æµ…æ","uri":"/spark-operator-brief-analysis/"},{"categories":["Apache Spark"],"content":"ç³»ç»Ÿæ¶æ„ Spark Operator æ¶æ„ å¯ä»¥çœ‹å‡ºï¼ŒSpark Operator ç›¸æ¯” Spark on K8sï¼Œæ¶æ„ä¸Šè¦å¤æ‚ä¸€äº›ï¼Œå®é™…ä¸Š Spark Operator é›†æˆäº† Spark on K8s çš„æ–¹æ¡ˆï¼Œæä¾›äº†æ›´å…¨é¢ç®¡æ§ç‰¹æ€§ã€‚é€šè¿‡ Spark Operatorï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨æ›´åŠ ç¬¦åˆ K8s ç†å¿µçš„æ–¹å¼æ¥æ§åˆ¶ Spark åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚Spark Operator åŒ…æ‹¬å¦‚ä¸‹å‡ ä¸ªç»„ä»¶ï¼š SparkApplication æ§åˆ¶å™¨ï¼šè¯¥æ§åˆ¶å™¨ç”¨äºåˆ›å»ºã€æ›´æ–°ã€åˆ é™¤SparkApplicationå¯¹è±¡ï¼ŒåŒæ—¶æ§åˆ¶å™¨è¿˜ä¼šç›‘æ§ç›¸åº”çš„äº‹ä»¶,æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼› Submission Runnerï¼šè´Ÿè´£è°ƒç”¨ spark-submit æäº¤ Spark ä½œä¸šï¼Œä½œä¸šæäº¤çš„æµç¨‹å®Œå…¨å¤ç”¨ Spark on K8s çš„æ¨¡å¼ï¼› Spark Pod Monitorï¼šç›‘æ§ Spark ä½œä¸šç›¸å…³ Pod çš„çŠ¶æ€ï¼Œå¹¶åŒæ­¥åˆ°æ§åˆ¶å™¨ä¸­ï¼› Mutating Admission Webhookï¼šå¯é€‰æ¨¡å—ï¼ŒåŸºäºæ³¨è§£æ¥å®ç° Driver/Executor Pod çš„ä¸€äº›å®šåˆ¶åŒ–éœ€æ±‚ï¼› SparkCtlï¼šç”¨äºå’Œ Spark Operator äº¤äº’çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ Spark Operator é™¤äº†å®ç°åŸºæœ¬çš„ä½œä¸šæäº¤å¤–ï¼Œè¿˜æ”¯æŒå¦‚ä¸‹ç‰¹æ€§ï¼š å£°æ˜å¼çš„ä½œä¸šç®¡ç†ï¼› æ”¯æŒæ›´æ–° SparkApplication å¯¹è±¡åè‡ªåŠ¨é‡æ–°æäº¤ä½œä¸šï¼› æ”¯æŒå¯é…ç½®çš„é‡å¯ç­–ç•¥ï¼› æ”¯æŒå¤±è´¥é‡è¯•ï¼› é›†æˆ Prometheusï¼Œå¯ä»¥æ”¶é›†å’Œè½¬å‘ Spark åº”ç”¨çº§åˆ«çš„åº¦é‡å’Œ Driver/Executor çš„åº¦é‡åˆ° Prometheus ä¸­ã€‚ ","date":"2021-09-21","objectID":"/spark-operator-brief-analysis/:3:1","tags":["Spark","Operator","Kubernetes"],"title":"Spark Operator æµ…æ","uri":"/spark-operator-brief-analysis/"},{"categories":["Apache Spark"],"content":"å·¥ç¨‹ç»“æ„Spark Operator çš„é¡¹ç›®æ˜¯æ ‡å‡†çš„ K8s Operator ç»“æ„ï¼Œå…¶ä¸­æœ€é‡è¦çš„åŒ…æ‹¬ï¼š manifestï¼šå®šä¹‰äº† Spark ç›¸å…³çš„ CRDï¼ŒåŒ…æ‹¬: ScheduledSparkApplicationï¼šè¡¨ç¤ºä¸€ä¸ªå®šæ—¶æ‰§è¡Œçš„ Spark ä½œä¸š SparkApplicationï¼šè¡¨ç¤ºä¸€ä¸ª Spark ä½œä¸š pkgï¼šå…·ä½“çš„ Operator é€»è¾‘å®ç° apiï¼šå®šä¹‰äº† Operator çš„å¤šä¸ªç‰ˆæœ¬çš„ API clientï¼šç”¨äºå¯¹æ¥çš„ client-go SDK controllerï¼šè‡ªå®šä¹‰æ§åˆ¶å™¨çš„å®ç°,åŒ…æ‹¬ï¼š ScheduledSparkApplication æ§åˆ¶å™¨ SparkApplication æ§åˆ¶å™¨ batchscheduler: æ‰¹å¤„ç†è°ƒåº¦å™¨é›†æˆæ¨¡å—, ç›®å‰å·²ç»é›†æˆäº† K8s volcano è°ƒåº¦å™¨ spark-dockerï¼šspark docker é•œåƒ sparkctlï¼šspark operator å‘½ä»¤è¡Œå·¥å…· ","date":"2021-09-21","objectID":"/spark-operator-brief-analysis/:3:2","tags":["Spark","Operator","Kubernetes"],"title":"Spark Operator æµ…æ","uri":"/spark-operator-brief-analysis/"},{"categories":["Apache Spark"],"content":"Spark Application æ§åˆ¶å™¨æ§åˆ¶å™¨çš„ä»£ç ä¸»è¦ä½äºpkg/controller/sparkapplication/controller.goä¸­ã€‚ æäº¤ä½œä¸šæäº¤ä½œä¸šçš„æäº¤ä½œä¸šçš„ä¸»æµç¨‹åœ¨ submitSparkApplication æ–¹æ³•ä¸­ã€‚ // controller.go // submitSparkApplication creates a new submission for the given SparkApplication and submits it using spark-submit. func (c *Controller) submitSparkApplication(app *v1beta2.SparkApplication) *v1beta2.SparkApplication { if app.PrometheusMonitoringEnabled() { ... configPrometheusMonitoring(app, c.kubeClient) } // Use batch scheduler to perform scheduling task before submitting (before build command arguments). if needScheduling, scheduler := c.shouldDoBatchScheduling(app); needScheduling { newApp, err := scheduler.DoBatchSchedulingOnSubmission(app) ... //Spark submit will use the updated app to submit tasks(Spec will not be updated into API server) app = newApp } driverPodName := getDriverPodName(app) submissionID := uuid.New().String() submissionCmdArgs, err := buildSubmissionCommandArgs(app, driverPodName, submissionID) ... // Try submitting the application by running spark-submit. submitted, err := runSparkSubmit(newSubmission(submissionCmdArgs, app)) ... app.Status = v1beta2.SparkApplicationStatus{ SubmissionID: submissionID, AppState: v1beta2.ApplicationState{ State: v1beta2.SubmittedState, }, DriverInfo: v1beta2.DriverInfo{ PodName: driverPodName, }, SubmissionAttempts: app.Status.SubmissionAttempts + 1, ExecutionAttempts: app.Status.ExecutionAttempts + 1, LastSubmissionAttemptTime: metav1.Now(), } c.recordSparkApplicationEvent(app) service, err := createSparkUIService(app, c.kubeClient) ... ingress, err := createSparkUIIngress(app, *service, c.ingressURLFormat, c.kubeClient) return app } æäº¤ä½œä¸šçš„æ ¸å¿ƒé€»è¾‘åœ¨ submission.go è¿™ä¸ªæ¨¡å—ä¸­ï¼š // submission.go func runSparkSubmit(submission *submission) (bool, error) { sparkHome, present := os.LookupEnv(sparkHomeEnvVar) if !present { glog.Error(\"SPARK_HOME is not specified\") } var command = filepath.Join(sparkHome, \"/bin/spark-submit\") cmd := execCommand(command, submission.args...) glog.V(2).Infof(\"spark-submit arguments: %v\", cmd.Args) output, err := cmd.Output() glog.V(3).Infof(\"spark-submit output: %s\", string(output)) if err != nil { var errorMsg string if exitErr, ok := err.(*exec.ExitError); ok { errorMsg = string(exitErr.Stderr) } // The driver pod of the application already exists. if strings.Contains(errorMsg, podAlreadyExistsErrorCode) { glog.Warningf(\"trying to resubmit an already submitted SparkApplication %s/%s\", submission.namespace, submission.name) return false, nil } if errorMsg != \"\" { return false, fmt.Errorf(\"failed to run spark-submit for SparkApplication %s/%s: %s\", submission.namespace, submission.name, errorMsg) } return false, fmt.Errorf(\"failed to run spark-submit for SparkApplication %s/%s: %v\", submission.namespace, submission.name, err) } return true, nil } func buildSubmissionCommandArgs(app *v1beta2.SparkApplication, driverPodName string, submissionID string) ([]string, error) { ... options, err := addDriverConfOptions(app, submissionID) ... options, err = addExecutorConfOptions(app, submissionID) ... } func getMasterURL() (string, error) { kubernetesServiceHost := os.Getenv(kubernetesServiceHostEnvVar) ... kubernetesServicePort := os.Getenv(kubernetesServicePortEnvVar) ... return fmt.Sprintf(\"k8s://https://%s:%s\", kubernetesServiceHost, kubernetesServicePort), nil } å¯ä»¥çœ‹å‡º, å¯ä»¥é…ç½®æ§åˆ¶å™¨å¯ç”¨ Prometheus è¿›è¡Œåº¦é‡æ”¶é›†ï¼› Spark Operator é€šè¿‡æ‹¼è£…ä¸€ä¸ª spark-submit å‘½ä»¤å¹¶æ‰§è¡Œï¼Œå®ç°æäº¤ Spark ä½œä¸šåˆ° K8s é›†ç¾¤ä¸­çš„ç›®çš„ï¼› åœ¨æ¯æ¬¡æäº¤å‰ï¼ŒSpark Operator éƒ½ä¼šç”Ÿæˆä¸€ä¸ª UUID ä½œä¸º Session IDï¼Œå¹¶é€šè¿‡ Spark ç›¸å…³é…ç½®å¯¹ Driver/Executor çš„ Pod è¿›è¡Œæ ‡è®°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ª ID æ¥è·Ÿè¸ªå’Œæ§åˆ¶è¿™ä¸ª Spark ä½œä¸šï¼› Controller é€šè¿‡ç›‘æ§ç›¸å…³ä½œä¸šçš„ Pod çš„çŠ¶æ€æ¥æ›´æ–° SparkApplication çš„çŠ¶æ€ï¼ŒåŒæ—¶é©±åŠ¨ SparkApplication å¯¹è±¡çš„çŠ¶æ€æµè½¬ï¼› æäº¤æˆåŠŸåï¼Œè¿˜ä¼šåšå¦‚ä¸‹å‡ ä»¶äº‹æƒ…: æ›´æ–°ä½œä¸šçš„çŠ¶æ€ï¼› å¯åŠ¨ä¸€ä¸ªServiceï¼Œå¹¶é…ç½®å¥½Ingressï¼Œæ–¹ä¾¿ç”¨æˆ·è®¿é—®Spark WebUIã€‚ çŠ¶æ€æµè½¬æ§åˆ¶åœ¨ Spark Operator ä¸­ï¼ŒController ä½¿ç”¨çŠ¶æ€æœºæ¥ç»´æŠ¤ Spark Application çš„çŠ¶æ€ä¿¡æ¯ï¼ŒçŠ¶æ€æµè½¬å’Œ Action çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š State Machine for SparkApplication ä½œä¸šæäº¤åï¼ŒSpark Application çš„çŠ¶æ€æ›´æ–°éƒ½æ˜¯é€šè¿‡ getAndUpdateAppState() æ–¹æ³•æ¥å®ç°çš„ã€‚ // controller.go func (c *Controller) getAndUpdateAppState(app *v1beta2.SparkApplication) error { i","date":"2021-09-21","objectID":"/spark-operator-brief-analysis/:3:3","tags":["Spark","Operator","Kubernetes"],"title":"Spark Operator æµ…æ","uri":"/spark-operator-brief-analysis/"},{"categories":["Apache Spark"],"content":"Spark on MR3 å…è®¸å¤šä¸ª Spark åº”ç”¨ç¨‹åºå…±äº«è®¡ç®—èµ„æºï¼Œè¾¾åˆ°é™ä½å¼€é”€ä¸æ—¶é—´çš„æ•ˆæœ","date":"2021-09-11","objectID":"/spark-on-mr3/","tags":["Spark","MR3","æ± åŒ–èµ„æº"],"title":"Spark on MR3â€”â€”è¿è¡Œ Apache Spark çš„æ–°æ–¹å¼","uri":"/spark-on-mr3/"},{"categories":["Apache Spark"],"content":"MR3 æ˜¯ä¸€ä¸ªé€šç”¨çš„æ‰§è¡Œå¼•æ“ï¼ŒåŸç”Ÿæ”¯æŒ Hadoop å’Œ Kubernetesã€‚è™½ç„¶ Hive on MR3 æ˜¯ä¸»è¦åº”ç”¨ï¼Œä½† MR3 ä¹Ÿå¯ä»¥è½»æ¾æ‰§è¡Œ MapReduce/Tez ä½œä¸šã€‚ä¾‹å¦‚ï¼ŒHive on MR3 å¯ä»¥ä¸ä¾èµ– MapReduce è¿›è¡Œå‹ç¼©ï¼Œå› ä¸ºæ‰§è¡Œå‹ç¼©çš„ MapReduce ä½œä¸šä¼šè¢«ç›´æ¥å‘é€åˆ° MR3ã€‚ éšç€ MR3 1.3 çš„å‘å¸ƒï¼Œå¼€å‘å›¢é˜Ÿå¼•å…¥äº†å¦ä¸€ä¸ªä¸»è¦åº”ç”¨ â€“ Spark on MR3ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯ä½¿ç”¨ MR3 ä½œä¸ºæ‰§è¡Œåç«¯çš„ Apache Sparkã€‚MR3 ä¸Šçš„ Spark æ˜¯ä½œä¸º Spark çš„é™„åŠ ç»„ä»¶å®ç°çš„ï¼Œå®ƒåˆ©ç”¨ MR3 æ¥å®ç° Spark çš„è°ƒåº¦åç«¯ã€‚å› æ­¤ï¼Œåœ¨ MR3 ä¸Šè¿è¡Œ Spark ä¸éœ€è¦å¯¹ Spark è¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œå¹¶ä¸”ç”¨æˆ·åœ¨ MR3 ä¸Šå®‰è£… Spark æ—¶å¯ä»¥ä½¿ç”¨ Spark Binary Distributionã€‚ åœ¨è¯¦ç»†ä»‹ç» Spark on MR3 ä¹‹å‰ï¼Œåº”è¯¥å›ç­”ä¸€ä¸ªå…³é”®é—®é¢˜â€”â€”ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›¿ä»£çš„ Spark æ‰§è¡Œåç«¯ï¼Ÿ æ¯•ç«Ÿ Spark æ˜¯ä¸€ä¸ªæˆç†Ÿçš„ç³»ç»Ÿï¼Œå·²ç»ä¸º Hadoop å’Œ Kubernetes æä¾›äº†åŸç”Ÿæ”¯æŒï¼Œæ‰€ä»¥ Spark on MR3 ä¼¼ä¹æ²¡æœ‰å¸¦æ¥é¢å¤–çš„ä¼˜åŠ¿ã€‚ç„¶è€Œï¼ŒSpark on MR3 ä¸ä»…ä»…æ˜¯ä¸ºäº†å±•ç¤º MR3 ä½œä¸ºæ‰§è¡Œå¼•æ“çš„èƒ½åŠ›ã€‚ç›¸åï¼Œå®ƒè§£å†³äº† Apache Spark çš„ä¸€ä¸ªé‡è¦æ¶æ„é™åˆ¶ã€‚ ","date":"2021-09-11","objectID":"/spark-on-mr3/:0:0","tags":["Spark","MR3","æ± åŒ–èµ„æº"],"title":"Spark on MR3â€”â€”è¿è¡Œ Apache Spark çš„æ–°æ–¹å¼","uri":"/spark-on-mr3/"},{"categories":["Apache Spark"],"content":"åŠ¨æœºåœ¨ MR3 ä¸Šå¼€å‘ Spark çš„ä¸»è¦åŠ¨æœºæ˜¯å…è®¸å¤šä¸ª Spark åº”ç”¨ç¨‹åºå…±äº«è®¡ç®—èµ„æºï¼Œä¾‹å¦‚ Yarn å®¹å™¨æˆ– Kubernetes Podã€‚ å¯¹äºæ™®é€š Sparkï¼Œä¸åŒçš„ Spark åº”ç”¨ç¨‹åºå¿…é¡»ç»´æŠ¤è‡ªå·±çš„ä¸€ç»„ executorï¼Œå› ä¸º Spark ç¼ºä¹åœ¨ Spark åº”ç”¨ç¨‹åºä¹‹é—´å›æ”¶è®¡ç®—èµ„æºçš„åŠŸèƒ½ã€‚ç›¸åï¼ŒSpark ä¾é èµ„æºç®¡ç†å™¨ï¼ˆä¾‹å¦‚ Yarn å’Œ Kubernetesï¼‰æ¥åˆ†é…è®¡ç®—èµ„æºã€‚è¯·æ³¨æ„ï¼ŒApache Livy ä¸æ˜¯è¿™é‡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒåªå…è®¸å¤šä¸ªç”¨æˆ·é€šè¿‡ REST API å…±äº« Spark åº”ç”¨ç¨‹åºã€‚ å¯¹äº Spark on MR3ï¼ŒMR3 DAGAppMaster çš„å•å®ä¾‹ç®¡ç† Spark åº”ç”¨ç¨‹åºä¹‹é—´å…±äº«çš„æ‰€æœ‰è®¡ç®—èµ„æºã€‚ä¸‹å›¾è¯´æ˜äº†åœ¨ Kubernetes ä¸Šè¿è¡Œçš„ Spark on MR3ï¼Œå…¶ä¸­å››ä¸ª Spark driver å…±äº«ä¸€ä¸ªå…¬å…± DAGAppMaster Podã€‚å½“ Spark driver ç»ˆæ­¢æ—¶ï¼Œå…¶æ‰§è¡Œç¨‹åº Pod ä¸ä¼šç«‹å³é‡Šæ”¾å› Kubernetesã€‚ç›¸åï¼ŒDAGAppMaster å°è¯•é€šè¿‡å°†ç©ºé—² Pod é‡æ–°åˆ†é…ç»™é‚£äº›è¯·æ±‚æ›´å¤šè®¡ç®—èµ„æºçš„ Spark driver æˆ–å°†å®ƒä»¬ä¿ç•™åœ¨å¤‡ç”¨æ± ä¸­ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚ Spark on MR3 K8s Client Mode å› æ­¤ï¼Œå½“å¤šä¸ª Spark åº”ç”¨ç¨‹åºå¹¶å‘è¿è¡Œæ—¶ï¼ŒSpark on MR3 å‡å°‘äº†è·å–å’Œé‡Šæ”¾è®¡ç®—èµ„æºçš„å¼€é”€ã€‚ç”±äº MR3 ä½¿ç”¨ Java è™šæ‹Ÿæœº(JVM)ï¼Œå›æ”¶è®¡ç®—èµ„æºä¹Ÿè½¬åŒ–ä¸ºå‡å°‘ JVM é¢„çƒ­å¼€é”€ã€‚æ­¤å¤–ï¼ŒSpark on MR3 å°†è‡ªèº«ä¸èµ„æºç®¡ç†å™¨çš„è°ƒåº¦ç­–ç•¥åˆ†ç¦»ã€‚ä¾‹å¦‚ï¼Œæ— è®ºèµ„æºç®¡ç†å™¨çš„è°ƒåº¦ç­–ç•¥å¦‚ä½•ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åœ¨ Spark åº”ç”¨ç¨‹åºä¹‹é—´å¼ºåˆ¶æ‰§è¡Œå…¬å¹³è°ƒåº¦ã€‚ Spark on MR3 åœ¨é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ Spark åº”ç”¨ç¨‹åºçš„äº‘ç¯å¢ƒä¸­ç‰¹åˆ«æœ‰ç”¨ã€‚åœ¨äº‘ç¯å¢ƒä¸­ï¼Œé…ç½®è®¡ç®—èµ„æºçš„å¼€é”€è¿œéå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚ä¾‹å¦‚ï¼Œåœ¨ Amazon EKS ä¸Šé¢„ç½®æ–°çš„ Kubernetes èŠ‚ç‚¹å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚é€šè¿‡å…è®¸ DAGAppMaster ä¿ç•™è®¡ç®—èµ„æºçš„å¤‡ç”¨æ± ï¼ŒSpark on MR3 å¯ä»¥æœ‰æ•ˆåœ°æœ€å°åŒ–è®¡ç®—èµ„æºçš„å¼€é”€ã€‚å› ä¸º Spark ä½œä¸šåœ¨æäº¤åç«‹å³æ‰§è¡Œï¼Œå®ƒå¯ä»¥å®ç°äº‘æˆæœ¬çš„é™ä½ä»¥åŠç”¨æˆ·ä½“éªŒçš„æ”¹è¿›ã€‚ ","date":"2021-09-11","objectID":"/spark-on-mr3/:1:0","tags":["Spark","MR3","æ± åŒ–èµ„æº"],"title":"Spark on MR3â€”â€”è¿è¡Œ Apache Spark çš„æ–°æ–¹å¼","uri":"/spark-on-mr3/"},{"categories":["Apache Spark"],"content":"åº”ç”¨Spark on MR3 æ˜¯ä½œä¸º Spark çš„é™„åŠ ç»„ä»¶å®ç°çš„ã€‚Spark-MR3 ä½œä¸ºå¤–éƒ¨é›†ç¾¤ç®¡ç†å™¨ï¼Œæä¾› Spark è°ƒåº¦åç«¯çš„å®ç°ã€‚Spark-MR3 åµŒå…¥åœ¨ Spark driverä¸­ï¼Œå¹¶åœ¨ Spark driver å’Œ MR3 ä¹‹é—´ä¼ è¾“æ¶ˆæ¯ã€‚åœ¨å†…éƒ¨ï¼Œå®ƒæä¾›äº† Spark TaskScheduler å’Œ SchedulerBackend çš„å®ç°ï¼Œå¹¶åˆ›å»ºäº† MR3Client ä»¥ä¾¿ä¸ MR3 è¿›è¡Œé€šä¿¡ã€‚å½“ Spark DAGScheduler æƒ³è¦æ‰§è¡Œæ–°çš„ Spark stage æ—¶ï¼ŒSpark-MR3 å°† stage çš„æ ¼å¼è½¬æ¢ä¸º DAGï¼Œç„¶åå‘é€åˆ° MR3 DAGAppMasterã€‚DAG ç”±è¿è¡Œåœ¨ ContainerWorkers å†…çš„ Spark executor æ‰§è¡Œï¼Œå¹¶å°†ç»“æœå‘é€å› Sparkã€‚ Spark on MR3 Architecture ç”±äº Spark-MR3 å°†æ‰€æœ‰æ¥è‡ª Spark çš„è¯·æ±‚å‘é€åˆ° MR3ï¼Œå› æ­¤ä» Spark çš„è§’åº¦æ¥çœ‹ï¼ŒMR3 æ˜¯ç±»ä¼¼äº Yarn å’Œ Kubernetes çš„èµ„æºç®¡ç†å™¨ã€‚è¿™æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸º Spark ä¸åº•å±‚é›†ç¾¤ç®¡ç†å™¨æ— å…³ï¼Œè€Œ MR3 èƒ½å¤Ÿåœ¨ä¸çœŸæ­£çš„èµ„æºç®¡ç†å™¨é€šä¿¡åæä¾›è®¡ç®—èµ„æºã€‚ç”±äº Spark ä½¿ç”¨ Java ServiceLoader æœºåˆ¶åŠ è½½å¤–éƒ¨é›†ç¾¤ç®¡ç†å™¨ï¼Œå› æ­¤åœ¨ MR3 ä¸Šè¿è¡Œ Spark ä¸éœ€è¦å¯¹ Spark è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚ ","date":"2021-09-11","objectID":"/spark-on-mr3/:2:0","tags":["Spark","MR3","æ± åŒ–èµ„æº"],"title":"Spark on MR3â€”â€”è¿è¡Œ Apache Spark çš„æ–°æ–¹å¼","uri":"/spark-on-mr3/"},{"categories":["Apache Spark"],"content":"å®éªŒç°åœ¨å¼€å‘å›¢é˜Ÿå±•ç¤ºå®éªŒç»“æœæ¥è¯æ˜ Spark on MR3 çš„æ€§èƒ½ã€‚é™¤äº†ä»»åŠ¡è°ƒåº¦å’Œèµ„æºç®¡ç†ï¼ŒSpark on MR3 çš„è¡Œä¸ºæ–¹å¼ä¸æ™®é€š Spark ç›¸åŒã€‚é¦–å…ˆï¼Œå¼€å‘å›¢é˜Ÿå±•ç¤ºäº† Spark on MR3 åœ¨å•ä¸ª Spark åº”ç”¨ç¨‹åºä¸Šä¸æ™®é€š Spark è¡¨ç°ä¸€è‡´ã€‚æ¥ä¸‹æ¥ï¼Œå¼€å‘å›¢é˜Ÿå°†å±•ç¤ºå½“å¤šä¸ª Spark åº”ç”¨ç¨‹åºåŒæ—¶è¿è¡Œæ—¶ï¼ŒSpark on MR3 çš„è¿è¡Œæ—¶é—´å¤§å¹…å‡å°‘ã€‚ åœ¨å®éªŒä¸­ï¼Œå¼€å‘å›¢é˜Ÿä½¿ç”¨ä¸¤ä¸ªè¿è¡Œ HDPï¼ˆHortonworks Data Platformï¼‰3.1.4 çš„é›†ç¾¤ã€‚æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹è¿è¡Œä¸€ä¸ª ContainerWorkerï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ª Spark executorã€‚ Gold é›†ç¾¤ï¼Œç”± 2 ä¸ªä¸»èŠ‚ç‚¹ã€34 ä¸ªå·¥ä½œèŠ‚ç‚¹ï¼ˆæ¯ä¸ªèŠ‚ç‚¹å…·æœ‰ 24 ä¸ªå†…æ ¸å’Œ 96 GB å†…å­˜ï¼‰å’Œååƒå…†ç½‘ç»œç»„æˆã€‚ Grey é›†ç¾¤ï¼Œ1 ä¸ªä¸»èŠ‚ç‚¹ï¼Œ9 ä¸ªå·¥ä½œèŠ‚ç‚¹ï¼ˆæ¯ä¸ªèŠ‚ç‚¹æœ‰ 12 ä¸ªå†…æ ¸å’Œ 48 GB å†…å­˜ï¼‰å’Œä¸€åƒå…†ç½‘ç»œã€‚æ…¢ç½‘ç»œä½¿å¾— Grey é›†ç¾¤é€‚åˆè¯„ä¼°æ™®é€š Spark å’Œ Spark on MR3 ä¸­å»¶è¿Ÿè°ƒåº¦çš„æœ‰æ•ˆæ€§ã€‚ å¼€å‘å›¢é˜Ÿä½¿ç”¨ Spark å¤šç”¨æˆ·åŸºå‡†æµ‹è¯•ä½œä¸ºå·¥ä½œè´Ÿè½½ã€‚Spark åº”ç”¨ç¨‹åºä¸­çš„æ¯ä¸ªçº¿ç¨‹éƒ½æäº¤ç›¸åŒçš„ 8 ä¸ª TPC-DS åŸºå‡†æŸ¥è¯¢åºåˆ—ï¼ˆ#19ã€#42ã€#52ã€#55ã€#63ã€#68ã€#73ã€#98ï¼‰ã€‚å¼€å‘å›¢é˜Ÿä½¿ç”¨çš„æ¯”ä¾‹å› å­ä¸º 100ï¼ˆå¤§çº¦ç›¸å½“äº 100GBï¼‰ï¼Œå®ƒå¯ä»¥ä¿æŒæ¯ä¸ªå·¥ä½œèŠ‚ç‚¹å¤„äºå¿™ç¢ŒçŠ¶æ€ï¼Œä¹Ÿå¯ä»¥æ¸…æ¥šåœ°çªå‡ºå›æ”¶ ContainerWorkers çš„æ•ˆæœã€‚å¼€å‘å›¢é˜Ÿä»¥æ–‡æœ¬æ ¼å¼å­˜å‚¨æ•°æ®é›†è€Œä¸è¿›è¡Œå‹ç¼©ã€‚ ","date":"2021-09-11","objectID":"/spark-on-mr3/:3:0","tags":["Spark","MR3","æ± åŒ–èµ„æº"],"title":"Spark on MR3â€”â€”è¿è¡Œ Apache Spark çš„æ–°æ–¹å¼","uri":"/spark-on-mr3/"},{"categories":["Apache Spark"],"content":"å•ä¸ª Spark åº”ç”¨ç¨‹åºSpark on MR3 æä¾›äº†ä¸¤ç§ä»»åŠ¡è°ƒåº¦ç­–ç•¥â€”â€”FIFO è°ƒåº¦å’Œå…¬å¹³è°ƒåº¦ï¼Œå®ƒä»¬è§„å®šå¦‚ä½•åœ¨åŒä¸€ä¸ª Spark åº”ç”¨ç¨‹åºä¸­åˆ†é… Spark ä½œä¸šã€‚Spark on MR3 ä¹Ÿä»¥ç±»ä¼¼äºæ™®é€š Spark çš„æ–¹å¼å®ç°å»¶è¿Ÿè°ƒåº¦ã€‚å¯¹äºå•ä¸ª Spark åº”ç”¨ç¨‹åºçš„æµ‹è¯•ï¼Œå¼€å‘å›¢é˜Ÿä½¿ç”¨ 1 ç§’å»¶è¿Ÿè¿›è¡Œå»¶è¿Ÿè°ƒåº¦ï¼ˆä¾‹å¦‚ï¼Œè®¾ç½®æ™®é€š Spark çš„å‚æ•° spark.locality.wait ä¸º 1 ç§’ ï¼‰ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†åœ¨ Gold é›†ç¾¤ä¸­ä½¿ç”¨æ™®é€š Spark å’Œ Spark on MR3 è¿è¡Œå•ä¸ª Spark åº”ç”¨ç¨‹åºçš„ç»“æœã€‚Spark driver åˆ›å»ºå…«ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹æäº¤ç›¸åŒçš„å…«ä¸ª TPC-DS æŸ¥è¯¢åºåˆ—ã€‚ï¼ˆå› æ­¤å®ƒæ€»å…±æäº¤äº† $8 \\times 8 = 64$ ä¸ª Spark ä½œä¸šã€‚ï¼‰å¼€å‘å›¢é˜Ÿè§‚å¯Ÿåˆ°ï¼Œåœ¨ FIFO è°ƒåº¦ä¸‹ï¼ŒSpark on MR3 çš„è¿è¡Œé€Ÿåº¦ä¸æ™®é€š Spark ä¸€æ ·å¿«ï¼Œä½†åœ¨å…¬å¹³è°ƒåº¦ä¸‹ï¼Œé€Ÿåº¦ç¨æ…¢ã€‚ Cluster Gold Compare Result Grey é›†ç¾¤æµ‹è¯•ç»“æœå®Œå…¨ä¸åŒã€‚å¼€å‘å›¢é˜Ÿè§‚å¯Ÿåˆ°ï¼ŒSpark on MR3 æ¯”æ™®é€š Spark æ‰§è¡Œ Spark ä½œä¸šçš„å®Œæˆé€Ÿåº¦è¦å¿«å¾—å¤šï¼ŒFIFO è°ƒåº¦ä¸º 3034 s ä¸ 8042 sï¼Œå…¬å¹³è°ƒåº¦ä¸º 3583 s ä¸ 8017 sã€‚ Cluster Grey Compare Result è¿è¡Œæ—¶é—´çš„å·¨å¤§å·®å¼‚æ˜¯ç”±äºä»»åŠ¡è°ƒåº¦çš„ä¸åŒï¼Œç‰¹åˆ«æ˜¯å»¶è¿Ÿè°ƒåº¦åœ¨æ™®é€š Spark å’Œ Spark on MR3 ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†æ²¡æœ‰åŒ¹é…æœºå™¨çš„ Spark ä»»åŠ¡çš„ç™¾åˆ†æ¯”ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¸¦æœ‰ grey1 å’Œ grey2 ä½ç½®æ ‡ç­¾çš„ Spark ä»»åŠ¡ï¼Œå¦‚æœåœ¨ grey3 ä¸Šæ‰§è¡Œï¼Œåˆ™æ²¡æœ‰åŒ¹é…åˆ°æœºå™¨ä¸Šã€‚å¼€å‘å›¢é˜Ÿè§‚å¯Ÿåˆ°ï¼Œæ™®é€š Spark çš„ç™¾åˆ†æ¯”è¦é«˜å¾—å¤šï¼ŒFIFO è°ƒåº¦ä¸º 1.8% ä¸ 22.7%ï¼Œå…¬å¹³è°ƒåº¦ä¸º 7.2% ä¸ 26.8%ã€‚ç»“åˆä½¿ç”¨æ…¢é€Ÿï¼ˆ1 Gbï¼‰ç½‘ç»œï¼Œé«˜ç™¾åˆ†æ¯”ä¼šäº§ç”Ÿè®¸å¤šè½åçš„ä»»åŠ¡ï¼Œä»è€Œæ˜¾ç€å¢åŠ è¿è¡Œæ—¶é—´ã€‚ Cluster Grey No Match Host Compare Result ","date":"2021-09-11","objectID":"/spark-on-mr3/:3:1","tags":["Spark","MR3","æ± åŒ–èµ„æº"],"title":"Spark on MR3â€”â€”è¿è¡Œ Apache Spark çš„æ–°æ–¹å¼","uri":"/spark-on-mr3/"},{"categories":["Apache Spark"],"content":"å¤šä¸ª Spark åº”ç”¨ç¨‹åºç‹¬ç«‹äºä»»åŠ¡è°ƒåº¦ç­–ç•¥ï¼ŒSpark on MR3 æä¾›äº†ä¸¤ä¸ªç­–ç•¥â€”â€”FIFO è°ƒåº¦å’Œå…¬å¹³è°ƒåº¦ï¼ŒæŒ‡å®šå¦‚ä½•åœ¨å¤šä¸ª Spark åº”ç”¨ç¨‹åºä¹‹é—´åˆ†é… ContainerWorkersï¼ˆå³è®¡ç®—èµ„æºï¼‰ã€‚ä¸ºäº†æµ‹è¯•å¤šä¸ªåº”ç”¨ç¨‹åºï¼Œå¼€å‘å›¢é˜Ÿç¦ç”¨å»¶è¿Ÿè°ƒåº¦ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†åœ¨ä½¿ç”¨ Yarn å…¬å¹³è°ƒåº¦çš„ Gold é›†ç¾¤ä¸­ä½¿ç”¨æ™®é€š Spark è¿è¡Œ 12 ä¸ªç›¸åŒçš„ Spark åº”ç”¨ç¨‹åºçš„ç»“æœã€‚ç«–æ¡æ˜¾ç¤ºåœ¨ç›¸åº”å·¥ä½œèŠ‚ç‚¹ä¸Šè¿è¡Œçš„ Spark executor çš„è¿›åº¦ï¼Œå…¶é¢œè‰²è¡¨ç¤ºæ‹¥æœ‰ Spark executor çš„ Spark åº”ç”¨ç¨‹åºã€‚å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œå°½ç®¡ä½¿ç”¨äº†å…¬å¹³è°ƒåº¦ï¼Œä½† Spark åº”ç”¨ç¨‹åºåœ¨ Yarn åˆ†é…çš„è®¡ç®—èµ„æºæ€»é‡æ–¹é¢å­˜åœ¨å¾ˆå¤§å·®å¼‚ã€‚æˆ‘ä»¬è¿˜çœ‹åˆ°ç«–çº¿ä¹‹é—´çš„è®¸å¤šé—´éš™ï¼Œå®ƒä»¬è¡¨ç¤º Spark executor ç»ˆæ­¢åå’Œå¦ä¸€ä¸ª Spark executor å¯åŠ¨ä¹‹å‰çš„ç©ºé—²æ—¶é—´ã€‚ Vanilla Spark in Fair Gold ä¸‹å›¾æ˜¾ç¤ºäº†åœ¨ Gold é›†ç¾¤ä¸­ä½¿ç”¨å…¬å¹³è°ƒåº¦åœ¨ Spark on MR3 è¿è¡Œç›¸åŒçš„ 12 ä¸ª Spark åº”ç”¨ç¨‹åºçš„ç»“æœã€‚ é¡ºä¾¿è¯´ä¸€å¥ï¼Œèµ„æºç®¡ç†å™¨æœ¬èº«çš„è°ƒåº¦ç­–ç•¥å¯¹å®éªŒæ¥è¯´å¹¶ä¸é‡è¦ã€‚å¯ä»¥è§‚å¯Ÿåˆ°ï¼ŒSpark on MR3 é€šè¿‡å›æ”¶ ContainerWorkers å¿«é€Ÿå®ç°äº† Spark executor ä¹‹é—´å·¥ä½œèŠ‚ç‚¹çš„å…¬å¹³åˆ†é…ã€‚ è¯·æ³¨æ„ï¼ŒSpark on MR3 ä¸ä¼šåœ¨å‚ç›´æ¡ä¹‹é—´äº§ç”Ÿé—´éš™ï¼Œå› ä¸ºåœ¨æ•´ä¸ªå®éªŒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šéƒ½ä¼šå›æ”¶ä¸€ä¸ª ContainerWorkerã€‚ åœ¨æˆ‘ä»¬çš„å®éªŒä¸­ï¼Œä¸æ™®é€š Spark ç›¸æ¯”ï¼ŒSpark on MR3 å°†è¿è¡Œæ—¶é—´å‡å°‘äº† 25.6%ï¼ˆä» 907.7s åˆ° 674.6sï¼‰ã€‚ Spark on MR3 in Fair Gold ä¸‹å›¾æ˜¾ç¤ºäº†å½“ Yarn å’Œ Spark on MR3 éƒ½ä½¿ç”¨ FIFO è°ƒåº¦æ—¶ Gold é›†ç¾¤ä¸­çš„ç»“æœã€‚å¼€å‘å›¢é˜Ÿä»¥ 60 ç§’çš„é—´éš”æäº¤æ¯ä¸ª Spark åº”ç”¨ç¨‹åºã€‚æ™®é€š Spark å’Œ Spark on MR3 éƒ½ä¸€æ¬¡è¿è¡Œä¸€ä¸ª Spark åº”ç”¨ç¨‹åºï¼Œå¹¶æŒ‰ç…§æäº¤çš„é¡ºåºå®Œæˆæ‰€æœ‰ Spark åº”ç”¨ç¨‹åºã€‚ è¯·æ³¨æ„ï¼Œä¸€æ—¦ç¬¬ä¸€ä¸ª Spark åº”ç”¨ç¨‹åºç»ˆæ­¢ï¼ŒSpark on MR3 å°±ä¼šæ›´å¿«åœ°å®Œæˆå‰©ä½™çš„ Spark åº”ç”¨ç¨‹åºï¼Œå› ä¸º JVM å·²ç»é¢„çƒ­ã€‚ åœ¨å®éªŒä¸­ï¼Œä¸æ™®é€š Spark ç›¸æ¯”ï¼ŒSpark on MR3 å°†è¿è¡Œæ—¶é—´å‡å°‘äº† 36.3%ï¼ˆä» 797.3s åˆ° 1144.5sï¼‰ã€‚ Vanilla Spark vs. Spark on MR3 in FIFO Gold ","date":"2021-09-11","objectID":"/spark-on-mr3/:3:2","tags":["Spark","MR3","æ± åŒ–èµ„æº"],"title":"Spark on MR3â€”â€”è¿è¡Œ Apache Spark çš„æ–°æ–¹å¼","uri":"/spark-on-mr3/"},{"categories":["Apache Spark"],"content":"æ€»ç»“Spark on MR3 æ˜“äºä½¿ç”¨åœ¨ Hadoop å’Œ Kubernetes ä¸Šï¼Œå› ä¸ºå®ƒä¸ Apache Spark çš„ä¸åŒä¹‹å¤„ä»…åœ¨äºä»»åŠ¡è°ƒåº¦å’Œèµ„æºç®¡ç†ã€‚ é™¤äº†åœ¨ Spark åº”ç”¨ç¨‹åºä¸­å›æ”¶ ContainerWorkers ä¹‹å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥åˆ©ç”¨ MR3 çš„å®¹é”™ã€æ¨æµ‹æ‰§è¡Œå’Œè‡ªåŠ¨ç¼©æ”¾ç­‰ç‰¹æ€§ã€‚ ç›¸å…³é“¾æ¥ åŸæ–‡: https://www.datamonad.com/post/2021-08-18-spark-mr3/ code: https://github.com/mr3project/spark-mr3 ","date":"2021-09-11","objectID":"/spark-on-mr3/:4:0","tags":["Spark","MR3","æ± åŒ–èµ„æº"],"title":"Spark on MR3â€”â€”è¿è¡Œ Apache Spark çš„æ–°æ–¹å¼","uri":"/spark-on-mr3/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"åˆ—å¼å­˜å‚¨å› å…¶è‡ªèº«æ¶æ„è®¾è®¡ä¸æŸ¥è¯¢å¼•æ“ä¼˜åŒ–å¸¦æ¥ OLAP æ€§èƒ½çš„æå‡ï¼Œè¡Œå¼å­˜å‚¨æ— æ³•æ¨¡æ‹Ÿè¿™æ ·çš„è®¾è®¡èŒƒå¼","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"è®ºæ–‡é“¾æ¥ Column-Stores vs. Row-Stores: How Different Are They Really? ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:0:0","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"æ¦‚è¿°è¯¥æ–‡å‘è¡¨åœ¨ 2008 å¹´çš„ SIGMOD ä¼šè®®ä¸Šã€‚ä»è®ºæ–‡æ ‡é¢˜å¯ä»¥çœ‹å‡ºï¼Œè®ºæ–‡ä¸»è¦å†…å®¹ä¸æ˜¯é™ˆè¿°ä¸€ç§æ–°çš„æŠ€æœ¯ã€æ¶æ„ï¼Œè€Œæ˜¯åå‘è®®è®ºã€éªŒè¯ã€‚å…¶ä¸»è¦ç›®çš„åœ¨äºé˜è¿°æ¸…æ¥šåœ¨ OLAP ä¸‹ä¸ºä»€ä¹ˆåˆ—å¼å­˜å‚¨Column-Storeä¼˜äºè¡Œå¼å­˜å‚¨Row-Storeã€‚ åœ¨ OLAP åœºæ™¯ä¸‹ï¼ŒåŸºå‡†æµ‹è¯•çš„ç»“è®ºéƒ½æ˜¯åˆ—å¼å­˜å‚¨æ¯”è¡Œå¼å­˜å‚¨å¿«ä¸€ä¸ªæ•°é‡çº§ã€‚è€Œå¤§å®¶æ™®éç†è§£çš„åŸå› æ˜¯ column-stores are more I/O efficient for read-only queries since they only have to read from disk (or from memory) those attributes accessed by a query. å¯¹äºåªè¯»æŸ¥è¯¢ï¼Œåˆ—å¼å­˜å‚¨çš„ I/O æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºå®ƒä»¬åªéœ€è¦ä»ç£ç›˜ï¼ˆæˆ–å†…å­˜ï¼‰ä¸­è¯»å–æŸ¥è¯¢æ‰€éœ€è¦çš„é‚£äº›å­—æ®µã€‚ ä»è¿™ä¸ªç†è§£å‡ºå‘ï¼Œå¤§å®¶æƒ³åˆ°å³ä½¿æ˜¯è¡Œå¼å­˜å‚¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸€äº›ä¼˜åŒ–æ‰‹æ®µè¾¾åˆ°åˆ—å¼å­˜å‚¨çš„æ€§èƒ½ï¼ŒåŒ…æ‹¬ï¼š å‚ç›´åˆ†è¡¨Vertically Partitioning å…¨åˆ—ç´¢å¼•Indexing Every Column ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:1:0","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"ç®€ä»‹ä½œè€…è®¤ä¸ºå½“å¹´é¢å‘åˆ—çš„ç³»ç»Ÿæ€§èƒ½æµ‹è¯•æ–¹é¢è¿‡äºâ€œä¼ ç»Ÿâ€â€”â€”ä»ç„¶ä»¥é¢å‘è¡Œçš„ç³»ç»Ÿæ•°æ®ç»“æ„çš„è®¾è®¡æ€è·¯æ¥è®¾è®¡æ€§èƒ½æµ‹è¯•æ–¹æ¡ˆã€‚è™½ç„¶çœ‹å‡ºäº†åˆ—å¼å­˜å‚¨çš„æ½œåŠ›ï¼Œä½†æ²¡æœ‰å›ç­”æœ¬è´¨é—®é¢˜ï¼š é—®é¢˜ Are these performance gains due to something fundamental about the way column-oriented DBMSs are internally architected, or would such gains also be possible in a conventional system that used a more column-oriented physical design? åˆ—å¼å­˜å‚¨å¸¦æ¥çš„æ€§èƒ½æå‡æ˜¯ç”±äºå®ƒå†…éƒ¨æ¶æ„çš„åŸºæœ¬åŸç†å¯¼è‡´çš„ï¼Œè¿˜æ˜¯é‡‡ç”¨æ›´åŠ é¢å‘åˆ—å¼ç‰©ç†è®¾è®¡çš„ä¼ ç»Ÿç³»ç»Ÿä¸­ä¹Ÿæœ‰å¯èƒ½å®ç°è¿™äº›æ€§èƒ½æå‡ï¼Ÿ ä¸ºäº†éªŒè¯è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…é‡‡ç”¨äº†å‚ç›´åˆ†è¡¨ã€ç´¢å¼•æŸ¥è¯¢Index-only Plansã€ç‰©åŒ–è§†å›¾Materialized Viewsä¸‰ç§è®¾è®¡èŒƒå¼æ¥å®ç°æ›´åŠ é¢å‘åˆ—å¼ç‰©ç†è®¾è®¡çš„è¡Œå¼ç³»ç»Ÿï¼š å‚ç›´åˆ†è¡¨ï¼Œå°†è¡¨ç»“æ„æ‹†åˆ†ä¸ºäºŒå…ƒç»„çš„å½¢å¼ï¼Œæ¥å®ç°å¯¹äºä¸€ä¸ªæŸ¥è¯¢ï¼Œåªéœ€è¦è®¿é—®ç‰¹å®šåˆ—çš„ç›®æ ‡ï¼› ç´¢å¼•æŸ¥è¯¢ï¼Œä¸ºæ¯ä¸ªè¡¨åˆ›å»ºä¸€ç»„ç´¢å¼•ï¼Œä»¥ç¡®ä¿å¯ä»¥è¦†ç›–æ‰€æœ‰æŸ¥è¯¢ä¸­æ‰€éœ€è¦çš„åˆ—ï¼Œä¿è¯æŸ¥è¯¢è¿‡ç¨‹ä¸­ç›´æ¥ä»ç´¢å¼•ä¸­æå–å­—æ®µçš„å€¼ï¼› ç‰©åŒ–è§†å›¾ï¼Œé’ˆå¯¹æ‰€æœ‰æŸ¥è¯¢åšç‰©åŒ–è§†å›¾ï¼Œä»¥è·å–æœ€ä½³çš„æŸ¥è¯¢æ€§èƒ½ã€‚ ç»è¿‡æ¨¡æ‹Ÿå®éªŒï¼Œä½œè€…å¾—å‡ºç»“è®ºï¼Œå³ä½¿åœ¨é¢å‘è¡Œçš„ç³»ç»Ÿä¸­åº”ç”¨äº†é¢å‘åˆ—çš„æ€è·¯æ¥è®¾è®¡å­˜å‚¨èŒƒå¼ï¼Œåœ¨åˆ†æåœºæ™¯ä¸‹ï¼Œæ€§èƒ½ä»ç„¶æ— æ³•ä¸é¢å‘åˆ—çš„ç³»ç»ŸæŠ—è¡¡ã€‚ åœ¨å¾—åˆ°ä¸Šè¿°ç»“è®ºåï¼Œä½œè€…åˆæŠ›å‡ºä¸‹ä¸€ä¸ªé—®é¢˜ï¼š é—®é¢˜ Which of the many column-database speciï¬c optimizations proposed in the literature are most responsible for the signiï¬cant performance advantage of column-stores over row-stores on warehouse workloads? åœ¨æ•°ä»“åœºæ™¯ä¸‹ï¼Œç©¶ç«Ÿæ˜¯å“ªäº›ä¼˜åŒ–æ‰‹æ®µè®©é¢å‘åˆ—çš„ç³»ç»Ÿæ€§èƒ½ä¼˜äºé¢å‘è¡Œçš„ç³»ç»Ÿæ€§èƒ½ï¼Ÿ è®ºæ–‡ç›´æ¥ç»™å‡ºç»“è®ºï¼Œé¢å‘åˆ—çš„ç³»ç»Ÿä¸­ä¼˜åŒ–ä¸»è¦æœ‰ï¼š å»¶è¿Ÿç‰©åŒ–Late Materialization å—éå†Block Iteration å‹ç¼©Compression éšå¼è¿æ¥Invisible Joinsï¼ˆæœ¬æ–‡åˆ›æ–°ä¼˜åŒ–ç‚¹ï¼‰ åˆ°è¿™é‡Œï¼Œä½œè€…æå‡ºäº†ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼š é—®é¢˜ However, because each of these techniques was described in a separate research paper, no work has analyzed exactly which of these gains are most signiï¬cant. å®šé‡æ¥çœ‹ï¼Œè¿™å‡ ç§ä¼˜åŒ–æ‰‹æ®µåˆ†åˆ«å¯ä»¥ä¸ºé¢å‘åˆ—çš„ç³»ç»Ÿæå‡å¤šå°‘æ€§èƒ½å‘¢ï¼Ÿ æ¥ä¸‹æ¥çš„å·¥ä½œä¸­ï¼Œä½œè€…é€ä¸ªç§»é™¤ C-Store æ•°æ®åº“ä¸­çš„ä¸Šè¿°ä¼˜åŒ–æ‰‹æ®µæ¥è¿›è¡Œæµ‹è¯•ï¼Œæœ€ç»ˆå‘ç°ï¼š å‹ç¼©å¸¦æ¥çš„æ€§èƒ½æå‡è¦çœ‹å…·ä½“çš„æ•°æ®ï¼Œæœ€å¤šæ—¶å¯ä»¥æå‡ä¸€ä¸ªæ•°é‡çº§ å»¶è¿Ÿç‰©åŒ–å¯ä»¥æå‡ 3 å€ å—éå†å’Œéšå¼è¿æ¥å¯ä»¥æå‡çº¦ 1.5 å€ ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:2:0","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"é¢å‘è¡Œçš„æ‰§è¡Œ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:3:0","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"å‚ç›´åˆ†è¡¨å‚ç›´åˆ†è¡¨å°†è¡¨ç»“æ„æ‹†åˆ†æˆäºŒå…ƒç»„ï¼Œé€šè¿‡æŸç§æœºåˆ¶å†å°†æ‰€æœ‰å­—æ®µç»„åˆæˆä¹‹å‰çš„æ•°æ®ã€‚ç¬¬ä¸€ååº”å¯èƒ½éœ€è¦åœ¨è¡¨ä¸­å¢åŠ ä¸€ä¸ªä¸»é”®å­—æ®µPrimary Keyï¼Œä½†æ˜¯ä¸»é”®å­—æ®µå¯èƒ½ä¼šæ¯”è¾ƒå¤§ï¼Œå¹¶ä¸”å¾ˆå¤šæ—¶å€™ä¸»é”®æ˜¯å¤åˆä¸»é”®ï¼Œæ‰€ä»¥é€šå¸¸éœ€è¦å‘æ¯ä¸ªè¡¨æ·»åŠ ä¸€ä¸ªæ•´æ•° â€œpositionâ€ åˆ—ã€‚ä½†æ˜¯æŸ¥è¯¢ä¸­å¦‚æœéœ€è¦å¤šä¸ªåˆ—ï¼Œå°±å¾—åŸºäº position åˆ—åšé¢å¤–çš„ join æ“ä½œã€‚å¦‚æœä¸ºäº†åŠ é€Ÿ join å†å¼•å…¥ç´¢å¼•ï¼Œåˆ™åˆä¼šå¢åŠ å­˜å‚¨å’Œ I/O çš„å¼€é”€ï¼Œå¾ˆéš¾æœ‰ä¼˜åŠ¿ã€‚ ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:3:1","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"ç´¢å¼•æŸ¥è¯¢å‚ç›´åˆ†è¡¨ä¼šå¼•å…¥ä¸¤ä¸ªæ–°é—®é¢˜ï¼š å®ƒéœ€è¦åœ¨æ¯ä¸€åˆ—ä¸Šå¢åŠ ä¸€ä¸ª position å­—æ®µç”¨æ¥è¿˜åŸä¹‹å‰çš„è®°å½•ï¼Œè¿™ä¼šæµªè´¹å¤§é‡çš„ç£ç›˜ç©ºé—´å’Œç£ç›˜å¸¦å®½ï¼› å¤§å¤šæ•°è¡Œå¼å­˜å‚¨åœ¨æ¯ä¸ªå…ƒç»„ä¸Šä¼šå­˜å‚¨ä¸€ä¸ªå¤§çš„å¤´éƒ¨æ•°æ®ï¼Œè¿™åˆè¿›ä¸€æ­¥æµªè´¹äº†ç£ç›˜ç©ºé—´ã€‚ ç´¢å¼•æŸ¥è¯¢å¯ä»¥é¿å…ä¸Šè¿°é—®é¢˜ã€‚ä¸ºäº†ä¸å‘ç”Ÿå›è¡¨æŸ¥è¯¢ï¼ŒåŠ¿å¿…è¦å°† query ä¸­ä»»æ„æ¡ä»¶çš„å­—æ®µï¼Œéƒ½é€šè¿‡å¯¹åº”å­—æ®µçš„ç´¢å¼•æ¥è¿‡æ»¤å‡ºå„ç§ä¸»é”®åˆ—è¡¨ï¼Œç„¶ååšåˆå¹¶è®¡ç®—ã€‚å¦‚æœæŸäº›å­—æ®µå¯¹åº”çš„æ¡ä»¶æ— æ³•è¢«å…¶ç´¢å¼•å¿«é€Ÿè¿‡æ»¤æ•°æ®çš„è¯ï¼Œå°±ä¼šå¯¼è‡´ç´¢å¼•çš„å…¨æ‰«æï¼Œä¸”è¿™æ ·çš„æ‰«æå¯èƒ½ä¼šæœ‰å¤šæ¬¡ã€‚æœ€ç»ˆé€ æˆå¤šä¸ªç´¢å¼•æ‰«æï¼Œåˆå¹¶ä¸»é”®åˆ—çš„é€Ÿåº¦è¿˜ä¸å¦‚ä¸€è¶Ÿæ‰«æåŸå§‹è¡¨æ•°æ®å¹¶è¿‡æ»¤çš„é€Ÿåº¦ã€‚å¦å¤–ï¼Œå¤§é‡å†—ä½™çš„å…ƒä¿¡æ¯å’Œå¤´ä¿¡æ¯ä¹Ÿä¼šé€ æˆå·¨å¤§çš„æ€§èƒ½æŸå¤±ã€‚å› æ­¤ï¼Œæ•´ä½“çš„å­˜å‚¨ã€I/O å¼€é”€éƒ½å¾ˆå¤§ã€‚ ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:3:2","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"ç‰©åŒ–è§†å›¾å®Œå…¨æ ¹æ®é¢„å®šä¹‰çš„ SQL æ¥ç”Ÿæˆç¡®å®šçš„ç‰©åŒ–è§†å›¾ï¼Œä¸”å…¶ä¸­ä¸ä¼šå…³è”å¤šä½™çš„åˆ—ã€‚æ˜¾ç„¶è¿™ç§æ–¹å¼æŸ¥è¯¢æ€§èƒ½å¾ˆå¥½ï¼ˆæ’å…¥æ€§èƒ½å·®ï¼‰ï¼ŒI/O æ•ˆç‡é«˜ï¼Œä½†è¿™ç§æ–¹æ³•åˆåªèƒ½åº”ä»˜æå…¶æœ‰é™çš„åœºæ™¯ã€‚ ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:3:3","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"é¢å‘åˆ—çš„æ‰§è¡Œ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:4:0","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"å‹ç¼©å‹ç¼©ï¼Œå°±æ˜¯å°†ç›¸ä¼¼åº¦å¾ˆé«˜ã€ä¿¡æ¯ç†µå¾ˆä½çš„æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼Œç”¨æ›´å°çš„ç©ºé—´è¡¨è¾¾ç›¸åŒçš„ä¿¡æ¯é‡ã€‚åˆ—å­˜çš„æ•°æ®å¾€å¾€ç±»å‹ç›¸åŒï¼Œç›¸åŒçš„ç‰¹å¾æ›´å¤šï¼Œæ›´å®¹æ˜“è¢«å‹ç¼©ï¼Œæ‰€ä»¥åˆ—å­˜ç³»ç»Ÿçš„å‹ç¼©ä¼˜åŒ–æ¯”è¡Œå­˜ç³»ç»Ÿæ›´åŠ æœ‰æ•ˆã€‚ å‹ç¼©ä¼˜åŒ–å¸¦æ¥çš„ä¼˜åŠ¿æœ‰ï¼š å‹ç¼©åçš„æ•°æ®é‡æ›´å°ï¼Œå¯ä»¥å‡å°‘ç¡¬ç›˜å­˜å‚¨ç©ºé—´ï¼ŒåŒæ—¶ç¡¬ç›˜çš„æ•°æ®é‡å˜å°‘åœ¨è¯»å–æ—¶å°±å¯ä»¥å‡å°‘ I/O å‹åŠ›ï¼› æœ‰äº›æ—¶å€™è§£å‹ç¼©çš„è¿‡ç¨‹å¯ä»¥çœç•¥æ‰ï¼Œä»è€Œç›´æ¥å¯¹å‹ç¼©åçš„æ•°æ®è¿›è¡Œæ“ä½œã€‚æ¯”å¦‚ä½¿ç”¨ Run-Length ç¼–ç æ–¹å¼è¿›è¡Œå‹ç¼©çš„æ•°æ®ï¼Œå°±å¯ä»¥ç›´æ¥è¿›è¡ŒæŸäº›è¿ç®—ã€‚ Run-Length å‹ç¼© å¯¹äºåŸå§‹åºåˆ—ä¸º 1, 1, 2, 2, 3, 3, 3 çš„æ•°æ®ï¼Œå‹ç¼©åè¡¨è¾¾ä¸º 1 * 2, 2 * 2, 3 * 3ã€‚å½“æˆ‘ä»¬è¦å¯¹è¿™ä¸€åˆ—è¿›è¡Œ sum æˆ–è€… count è¿ç®—æ—¶ï¼ŒåŸå§‹æ•°æ®å¯ä»¥ç›´æ¥è½¬æ¢ä¸º $sum(1 * 2 + 2 * 2 + 3 * 3) $ å’Œ $ count(2 + 2 + 3)$ï¼Œä¸ä»…ä¸éœ€è¦è§£å‹ç¼©ï¼Œè€Œä¸”è¿˜æé«˜äº†è®¡ç®—æ•ˆç‡ã€‚ å¦å¤–ï¼Œå‹ç¼©ä¼˜åŒ–æœ€å¥½å¯ä»¥é…åˆ sort ä½¿ç”¨ï¼Œå¦‚æœæ•°æ®æ˜¯ç»è¿‡æ’åºçš„ï¼Œåˆ™æ›´å®¹æ˜“æ‰¾åˆ°ç›¸é‚»æ•°æ®çš„åŒè´¨åŒ–ç‰¹å¾ï¼Œè·å¾—æ›´å¥½çš„å‹ç¼©æ•ˆæœã€‚ ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:4:1","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"å»¶è¿Ÿç‰©åŒ–ç‰©åŒ–Materialization æ˜¯æŒ‡ä¸ºäº†æŠŠåº•å±‚é¢å‘åˆ—çš„å­˜å‚¨æ ¼å¼è·Ÿè¦æ±‚çš„è¡Œå¼æ ¼å¼å¯¹ä¸Šï¼Œéœ€è¦åœ¨æŸ¥è¯¢çš„æŸä¸ªé˜¶æ®µè½¬æ¢ä¸€ä¸‹ã€‚ Materialization ç†è§£ç‰©åŒ–çš„æ¦‚å¿µåï¼Œå»¶è¿Ÿç‰©åŒ–å°±å¾ˆå¥½ç†è§£äº†ï¼Œæ„æ€å°±æ˜¯æŠŠç‰©åŒ–çš„æ—¶æœºå°½é‡åœ°æ‹–å»¶åˆ°æ•´ä¸ªæŸ¥è¯¢å£°æ˜çš„åæœŸã€‚å»¶è¿Ÿç‰©åŒ–æ„å‘³ç€åœ¨æŸ¥è¯¢æ‰§è¡Œçš„å‰ä¸€æ®µæ—¶é—´å†…ï¼ŒæŸ¥è¯¢æ‰§è¡Œçš„æ¨¡å‹ä¸æ˜¯å…³ç³»ä»£æ•°ï¼Œè€Œæ˜¯åŸºäº Column çš„ã€‚ ä¾‹å¦‚ä¸‹é¢çš„æŸ¥è¯¢ï¼š selectnamefrompersonwhereid\u003e10andage\u003e20 ä¸€èˆ¬çš„åšæ³•æ˜¯ä»æ–‡ä»¶ç³»ç»Ÿè¯»å‡ºä¸‰åˆ—çš„æ•°æ®ï¼Œé©¬ä¸Šç‰©åŒ–æˆä¸€è¡Œè¡Œçš„ person æ•°æ®ï¼Œç„¶ååº”ç”¨ä¸¤ä¸ªè¿‡æ»¤æ¡ä»¶ï¼š$id \u003e 10$ å’Œ $age \u003e 20$ï¼Œè¿‡æ»¤å®Œäº†ä¹‹åä»æ•°æ®é‡Œé¢æŠ½å‡º name å­—æ®µï¼Œä½œä¸ºæœ€åçš„ç»“æœï¼Œå¤§è‡´çš„è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š Early Materialization è€Œå»¶è¿Ÿç‰©åŒ–çš„åšæ³•åˆ™ä¼šå…ˆä¸æ‹¼å‡ºè¡Œå¼æ•°æ®ï¼Œç›´æ¥åœ¨ Column æ•°æ®ä¸Šåˆ†åˆ«åº”ç”¨ä¸¤ä¸ªè¿‡æ»¤æ¡ä»¶ï¼Œä»è€Œå¾—åˆ°ä¸¤ä¸ªæ»¡è¶³è¿‡æ»¤æ¡ä»¶çš„ bitmapï¼Œç„¶åå†æŠŠä¸¤ä¸ª bitmap åšä½ä¸çš„æ“ä½œå¾—åˆ°åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶çš„æ‰€æœ‰çš„ bitmapï¼Œå› ä¸ºæœ€åç”¨æˆ·éœ€è¦çš„åªæ˜¯ name å­—æ®µè€Œå·²ï¼Œå› æ­¤ä¸‹ä¸€æ­¥æˆ‘ä»¬æ‹¿ç€è¿™äº› position å¯¹ name å­—æ®µçš„æ•°æ®è¿›è¡Œè¿‡æ»¤å°±å¾—åˆ°äº†æœ€ç»ˆçš„ç»“æœã€‚å¦‚ä¸‹å›¾ï¼š Late Materialization å»¶è¿Ÿç‰©åŒ–æœ‰å››ä¸ªæ–¹é¢çš„å¥½å¤„ï¼š å…³ç³»ä»£æ•°é‡Œé¢çš„ selection å’Œ aggregation æ“ä½œä¸‹å…¶å®ä¸éœ€è¦æ•´è¡Œæ•°æ®ï¼Œæ­¤æ—¶è¿‡æ—©ç‰©åŒ–ä¼šæµªè´¹ï¼› å¦‚æœæ•°æ®æ˜¯è¢«å‹ç¼©è¿‡çš„ï¼Œç‰©åŒ–çš„è¿‡ç¨‹å°±å¿…é¡»å¯¹æ•°æ®è¿›è¡Œè§£å‹ï¼Œè¿™ä¼šå½±å“å‹ç¼©å¸¦æ¥çš„å¥½å¤„ï¼› åˆ—å¼çš„å†…å­˜ç»„ç»‡å½¢å¼å¯¹ CPU Cache éå¸¸å‹å¥½ï¼Œä»è€Œæé«˜è®¡ç®—æ•ˆç‡ï¼Œç›¸åè¡Œå¼çš„ç»„ç»‡å½¢å¼å› ä¸ºéå¿…è¦çš„åˆ—å ç”¨äº† Cache Line çš„ç©ºé—´ï¼ŒCache æ•ˆç‡ä½ï¼› å—éå†çš„ä¼˜åŒ–æ‰‹æ®µå¯¹ Column ç±»å‹çš„æ•°æ®æ•ˆæœæ›´å¥½ï¼Œå› ä¸ºæ•°æ®ä»¥ Column å½¢å¼ä¿å­˜åœ¨ä¸€èµ·ï¼Œæ•°æ®æ˜¯å®šé•¿çš„å¯èƒ½æ€§æ›´å¤§ï¼Œè€Œå¦‚æœ Row å½¢å¼ä¿å­˜åœ¨ä¸€èµ·æ•°æ®æ˜¯å®šé•¿çš„å¯èƒ½æ€§éå¸¸å°ï¼ˆå› ä¸ºä½ ä¸€è¡Œæ•°æ®é‡Œé¢åªè¦æœ‰ä¸€ä¸ªæ˜¯éå®šé•¿çš„ï¼Œæ¯”å¦‚ VARCHARï¼Œé‚£ä¹ˆæ•´è¡Œæ•°æ®éƒ½æ˜¯éå®šé•¿çš„ï¼‰ã€‚ ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:4:2","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"å—éå†è¡Œå­˜æ¨¡å‹ä¸­ï¼Œæ¯ä¸€ä¸ªç®—å­åœ¨å¤„ç†æ•°æ®çš„æ—¶å€™ï¼Œéƒ½è¦å…ˆè¿­ä»£ä¸€æ¡æ•°æ®ï¼Œç„¶åé€šè¿‡å®šä¹‰çš„æ¥å£ä»æ•°æ®ä¸­è·å–åˆ°æŸä¸ªå­—æ®µçš„å€¼ï¼Œç„¶åå†å¯¹å€¼è¿›è¡Œæ“ä½œã€‚è¿™ä¸ªæµç¨‹ä½¿å¾—æ¯å¤„ç†ä¸€æ¡æ•°æ®å°±å¾—é¢å¤–è°ƒç”¨ä¸€ä¸¤æ¬¡ç”¨æ¥è·å–æ•°æ®çš„å‡½æ•°ï¼ˆä¸€èˆ¬ç§°ä¸ºç«å±±æ¨¡å‹ï¼‰ã€‚ è€Œåœ¨åˆ—å¼å­˜å‚¨ä¸­ï¼Œæ¯ä¸€æ¬¡å—è¿­ä»£éƒ½å¯ä»¥è·å–åˆ°å¤šæ¡æ•°æ®ï¼Œå¹¶ä¸”å½“éœ€è¦å¯¹æŸä¸€åˆ—æ“ä½œæ—¶ï¼Œå¯ä»¥å°†ä¸€æ•´å—åˆ—çš„å€¼ä¼ é€’ç»™å¤„ç†å‡½æ•°ã€‚åŒæ—¶ä¸éœ€è¦é¢å¤–è°ƒç”¨å‡½æ•°è·å–å€¼ï¼Œå¹¶ä¸”å¦‚æœåˆ—æ˜¯ç­‰å®½çš„fixed-widthï¼Œå¯ä»¥ç›´æ¥ä½œä¸ºæ•°ç»„æ¥è¿­ä»£ã€‚ ä½¿ç”¨ä¸Šè¿°æ–¹æ³•æ—¶ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨ CPU çš„å¾ˆå¤šä¼˜åŠ¿ï¼ˆSIMDåŠ é€Ÿã€cache lineé€‚é…ã€CPU pipelineç­‰ï¼‰ã€‚ ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:4:3","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"éšå¼è¿æ¥æœ€åæœ¬æ–‡æå‡ºäº†ä¸€ä¸ªå…·æœ‰åˆ›æ–°æ€§çš„æ€§èƒ½ä¼˜åŒ–æªæ–½ï¼šéšå¼è¿æ¥ã€‚éšå¼è¿æ¥é’ˆå¯¹çš„åœºæ™¯æ˜¯æ•°ä»“é‡Œé¢çš„æ˜Ÿå‹æ¨¡å‹Star Schemaï¼Œ å¦‚æœç”¨æˆ·æŸ¥è¯¢ç¬¦åˆä¸‹é¢çš„æ¨¡å¼å°±å¯ä»¥åº”ç”¨éšå¼è¿æ¥ï¼š Star Schema é’ˆå¯¹è¿™ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬ç»™å‡ºä¸€ä¸ª Join çš„åœºæ™¯ï¼Œä¾‹å¦‚ä»¥ä¸‹çš„ SQL SELECTc.nation,s.nation,d.year,sum(lo.revenue)asrevenueFROMcustomerASc,lineorderASlo,supplierASs,dwdateASdWHERElo.custkey=c.custkeyANDlo.suppkey=s.suppkeyANDlo.orderdate=d.datekeyANDc.region=â€™ASIAâ€™ANDs.region=â€™ASIAâ€™ANDd.year\u003e=1992andd.year\u003c=1997GROUPBYc.nation,s.nation,d.yearORDERBYd.yearasc,revenuedesc; æŒ‰ç…§ Selectivity ä¾æ¬¡ Join è¿™ç§æ–¹å¼å¾ˆç®€å•ï¼Œå°±æ˜¯æŒ‰ç…§è°“è¯çš„é€‰æ‹©æ€§æ¥ä¾æ¬¡æ‰§è¡Œ joinã€‚ ä¾‹å¦‚ï¼Œc.region = 'ASIA' çš„é€‰æ‹©æ€§å¾ˆå¼ºï¼Œåˆ™é¦–å…ˆä½¿ç”¨è¿™ä¸ªæ¡ä»¶è¿‡æ»¤ customer è¡¨ï¼Œç„¶åä½¿ç”¨ customer è¡¨å» Join LineOrder è¡¨ï¼Œæ‰€ä»¥ customer è¡¨ä¸­çš„ nation å­—æ®µå°±è¢«å¢åŠ åˆ°äº† customer-order è¡¨ä¸­ã€‚ä¾æ¬¡ç±»æ¨ï¼Œå»å®Œæˆ supplier å’Œ date è¡¨çš„ Joinã€‚ è¿™ç§æ–¹å¼çš„ç¼ºç‚¹ä¸ºï¼šä¸€å¼€å§‹å°±å¼€å§‹åš Join ï¼Œåç»­æ— æ³•äº«å—ä¸Šé¢æåˆ°çš„å»¶è¿Ÿç‰©åŒ–çš„å¥½å¤„ã€‚ ä¼ ç»Ÿå»¶è¿Ÿç‰©åŒ–çš„ Join è¿™ä¸ªæ–¹å¼å¯ä»¥è§„é¿ä¸€å¼€å§‹åš Join çš„è¡Œä¸ºï¼Œå…·ä½“æ–¹æ³•ä¸ºï¼š ç”¨ c.region = 'ASIA' è¿‡æ»¤ custom è¡¨ï¼Œå¹¶æ‹¿åˆ°æ»¡è¶³æ¡ä»¶çš„ custom key çš„é›†åˆï¼ŒåŒæ—¶è®°å½• custom è¡¨ä¸­æ»¡è¶³æ¡ä»¶çš„è®°å½•çš„ä½ç½® ç”¨ 1 ä¸­è·å¾—çš„ custom key æ¥è¿‡æ»¤ orderline è¡¨ï¼Œå¹¶æ‹¿åˆ°æ»¡è¶³æ¡ä»¶çš„è®°å½•çš„ä½ç½® éå† 2 ä¸­è·å¾—çš„ä½ç½®åˆ—è¡¨ï¼Œæå– suppplier keyã€order date å’Œ revenue å¹¶ä¸”å€ŸåŠ© custom key å’Œ 1 ä¸­è·å–åˆ°çš„ä½ç½®ä¿¡æ¯ï¼Œæå– custom è¡¨ä¸­çš„ c.nation å­—æ®µ supplier å’Œ date è¡¨çš„ Join ç±»ä¼¼å¤„ç† è¿™ç§æ–¹å¼çš„ç¼ºç‚¹ä¸ºï¼šåœ¨ 3 ä¸­æå– c.nation çš„æ“ä½œä¸ºéšæœºè®¿é—®ï¼Œä¼šäº§ç”Ÿè¾ƒå¤§çš„å¼€é”€ã€‚ éšå¼è¿æ¥ éšå¼è¿æ¥æ˜¯æœ¬æ–‡æ–°æå‡ºçš„ä¸€ç§æ–¹æ³•ï¼Œç”¨äºä¸Šæ–‡ä¸­æåˆ°çš„æ˜Ÿå‹æ¨¡å‹çš„ Join åœºæ™¯ã€‚å®ƒä¼˜åŒ–äº†ä¼ ç»Ÿå»¶è¿Ÿç‰©åŒ– Join çš„ç¼ºç‚¹ï¼Œå°½å¯èƒ½å‡å°‘éšæœºè¯»å–çš„æ•°æ®ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚å…·ä½“çš„æ‰§è¡Œæ­¥éª¤ä¸ºï¼š åœ¨æ¯ä¸ªç»´åº¦è¡¨ä¸Šåº”ç”¨å¯¹åº”çš„è¿‡æ»¤æ¡ä»¶ï¼Œå¾—åˆ°æ¯ä¸ªç»´åº¦è¡¨Dimension Tableæ»¡è¶³æ¡ä»¶çš„è®°å½•çš„ keyï¼ŒåŒæ—¶è¿™ä¸ª key ä¹Ÿåº”è¯¥æ˜¯äº‹å®è¡¨Fact Tableçš„å¤–é”®Foreign Keyã€‚ The first phase of the joins needed to execute Query 3.1 from the Star Schema benchmark on some sample data éå†äº‹å®è¡¨çš„å„ä¸ªå¤–é”®åˆ—ï¼Œä½¿ç”¨ 1 ä¸­å¾—åˆ°çš„ key æ¥åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•çš„ä½ç½®ä¿¡æ¯çš„ bitmapï¼Œå¹¶å°†è¿™äº› bitmap åš AND æ“ä½œï¼Œç”Ÿæˆæœ€ç»ˆè¿‡æ»¤ç»“æœçš„ bitmapã€‚ The second phase of the joins needed to execute Query 3.1 from the Star Schema benchmark on some sample data åˆ©ç”¨ 2 ä¸­å¾—åˆ°çš„ bitmap ä¾æ¬¡æå–å„ä¸ªç»´åº¦è¡¨çš„å¤–é”®ï¼Œä½¿ç”¨ç»´åº¦è¡¨çš„é”®æ¥æå–ç»´åº¦è¡¨ä¸­æŸ¥è¯¢æ‰€éœ€è¦çš„å…¶ä»–åˆ—ã€‚å¦‚æœç»´åº¦è¡¨çš„é”®æ˜¯æ’è¿‡åºçš„ã€ä» 1 å¼€å§‹è¿ç»­çš„å€¼ï¼Œæ„å‘³ç€ç»´åº¦è¡¨é‡Œé¢çš„åˆ—å¯ä»¥é€šè¿‡ç±»ä¼¼è®¿é—®æ•°ç»„ä¸€æ ·çš„æ–¹å¼æå–å‡ºæ¥ï¼ˆè¿™ä¸€ç‚¹ä¼šæ¯”ä¼ ç»Ÿçš„å»¶è¿Ÿç‰©åŒ–æ–¹æ³•å¿«å¾ˆå¤šï¼‰ã€‚ The third phase of the joins needed to execute Query 3.1 from the Star Schema benchmark on some sample data ç›¸æ¯”äºå»¶è¿Ÿç‰©åŒ–ï¼Œéšå¼è¿æ¥å¯ä»¥å‡å°‘ I/O çš„éšæœºè®¿é—®ï¼Œä½†ä»…æ˜¯è¿™æ ·ï¼Œæ— æ³•å¤§å¹…åº¦æå‡æ€§èƒ½ã€‚è®ºæ–‡è®¤ä¸ºåœ¨å¾ˆå¤šç»´åº¦è¡¨å†…ç¬¦åˆè¿‡æ»¤æ¡ä»¶çš„æ•°æ®å¾€å¾€æ˜¯è¿ç»­çš„ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠLookup Joinå˜æˆèŒƒå›´æŸ¥è¯¢ã€‚å¦‚æœç»´åº¦è¡¨çš„æ•°æ®ä¸è¿ç»­ï¼Œå¯ä»¥é€šè¿‡ Dictionary Encoding æ–¹å¼ï¼Œé‡æ–°æŒ‰åºç¼–ç ã€‚ Dictionary Encoding Referennces doc: https://docs.kinetica.com/7.1/concepts/dictionary_encoding/ ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:4:4","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"æ€»ç»“è¯»è¿™ç¯‡è®ºæ–‡æœ€å¤§çš„æ”¶è·æ˜¯é¦–å…ˆæ˜ç¡®äº†æ˜¯å“ªäº›å› ç´ ä¿ƒä½¿åˆ—å¼å­˜å‚¨å¯¹ OLAP æ€§èƒ½å¯ä»¥å¤§å¹…æå‡â€”â€”å‹ç¼©ã€å»¶è¿Ÿç‰©åŒ–ã€å—éå†ã€éšå¼è¿æ¥ã€‚ è®ºæ–‡ä¸‰ä½ä½œè€…ç³»ç»Ÿç³»ç»Ÿè§£ç­”äº†åˆ—å¼å­˜å‚¨ä¸è¡Œå¼å­˜å‚¨çš„åŒºåˆ«ï¼Œé€šè¿‡å®éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œåˆ—å¼å­˜å‚¨æ˜¯å› ä¸ºå…¶å†…éƒ¨æ¶æ„è€Œå…·æœ‰æ›´å¥½çš„æ€§èƒ½ï¼Œè€Œä¸æ˜¯ç†æ‰€å½“ç„¶çš„ç†ç”±â€”â€”æ›´å°‘çš„ I/Oã€‚ä¸ä»…ä»…é™äºå†…éƒ¨æ¶æ„ï¼ŒæŸ¥è¯¢å¼•æ“å±‚çš„å„ç§ä¼˜åŒ–ä¹ŸåŒæ ·æ˜¯åˆ—å¼å­˜å‚¨æ€§èƒ½æå‡çš„å…³é”®ã€‚ ","date":"2021-09-05","objectID":"/column-stores-vs-row-stores/:5:0","tags":["è®ºæ–‡","å­˜å‚¨","åˆ—å¼å­˜å‚¨","è¡Œå¼å­˜å‚¨"],"title":"åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨ï¼šå®ƒä»¬ä¹‹é—´çš„æœ¬è´¨åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ","uri":"/column-stores-vs-row-stores/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡ä»‹ç»äº†ä¸ºä»€ä¹ˆéœ€è¦ K8s service ä»¥åŠç›¸å…³ç”¨ä¾‹è§£è¯»å’Œæ¶æ„è®¾è®¡","date":"2021-08-28","objectID":"/kubernetes-service/","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"éœ€æ±‚æ¥æº","date":"2021-08-28","objectID":"/kubernetes-service/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡å‘ç°åœ¨ K8s é›†ç¾¤é‡Œé¢ä¼šé€šè¿‡ pod å»éƒ¨ç½²åº”ç”¨ï¼Œä¸ä¼ ç»Ÿçš„åº”ç”¨éƒ¨ç½²ä¸åŒï¼Œä¼ ç»Ÿåº”ç”¨éƒ¨ç½²åœ¨ç»™å®šçš„æœºå™¨ä¸Šé¢å»éƒ¨ç½²ï¼Œæˆ‘ä»¬çŸ¥é“æ€ä¹ˆå»è°ƒç”¨åˆ«çš„æœºå™¨çš„ IP åœ°å€ã€‚ä½†æ˜¯åœ¨ K8s é›†ç¾¤é‡Œé¢åº”ç”¨æ˜¯é€šè¿‡ pod å»éƒ¨ç½²çš„ï¼Œ è€Œ pod ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„ã€‚åœ¨ pod çš„ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ä¸­ï¼Œæ¯”å¦‚å®ƒåˆ›å»ºæˆ–é”€æ¯ï¼Œå®ƒçš„ IP åœ°å€éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™æ ·å°±ä¸èƒ½ä½¿ç”¨ä¼ ç»Ÿçš„éƒ¨ç½²æ–¹å¼ï¼Œä¸èƒ½æŒ‡å®š IP å»è®¿é—®æŒ‡å®šçš„åº”ç”¨ã€‚ å¦å¤–åœ¨ K8s çš„åº”ç”¨éƒ¨ç½²é‡Œï¼Œä¹‹å‰è™½ç„¶å­¦ä¹ äº† deployment çš„åº”ç”¨éƒ¨ç½²æ¨¡å¼ï¼Œä½†è¿˜æ˜¯éœ€è¦åˆ›å»ºä¸€ä¸ª pod ç»„ï¼Œç„¶åè¿™äº› pod ç»„éœ€è¦æä¾›ä¸€ä¸ªç»Ÿä¸€çš„è®¿é—®å…¥å£ï¼Œä»¥åŠæ€ä¹ˆå»æ§åˆ¶æµé‡è´Ÿè½½å‡è¡¡åˆ°è¿™ä¸ªç»„é‡Œé¢ã€‚æ¯”å¦‚è¯´æµ‹è¯•ç¯å¢ƒã€é¢„å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒï¼Œå…¶å®åœ¨éƒ¨ç½²çš„è¿‡ç¨‹ä¸­éœ€è¦ä¿æŒåŒæ ·çš„ä¸€ä¸ªéƒ¨ç½²æ¨¡æ¿ä»¥åŠè®¿é—®æ–¹å¼ã€‚å› ä¸ºè¿™æ ·å°±å¯ä»¥ç”¨åŒä¸€å¥—åº”ç”¨çš„æ¨¡æ¿åœ¨ä¸åŒçš„ç¯å¢ƒä¸­ç›´æ¥å‘å¸ƒã€‚ ","date":"2021-08-28","objectID":"/kubernetes-service/:1:1","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Serviceï¼šKubernetes ä¸­çš„æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡æœ€ååº”ç”¨æœåŠ¡éœ€è¦æš´éœ²åˆ°å¤–éƒ¨å»è®¿é—®ï¼Œéœ€è¦æä¾›ç»™å¤–éƒ¨çš„ç”¨æˆ·å»è°ƒç”¨çš„ã€‚æˆ‘ä»¬ä¸ŠèŠ‚äº†è§£åˆ° pod çš„ç½‘ç»œè·Ÿæœºå™¨ä¸æ˜¯åŒä¸€ä¸ªæ®µçš„ç½‘ç»œï¼Œé‚£æ€ä¹ˆè®© pod ç½‘ç»œæš´éœ²åˆ°å»ç»™å¤–éƒ¨è®¿é—®å‘¢ï¼Ÿè¿™æ—¶å°±éœ€è¦æœåŠ¡å‘ç°ã€‚ Service åœ¨ K8s é‡Œé¢ï¼ŒæœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡å°±æ˜¯ K8s Serviceã€‚ä¸Šå›¾å°±æ˜¯åœ¨ K8s é‡Œ Service çš„æ¶æ„ï¼ŒK8s Service å‘ä¸Šæä¾›äº†å¤–éƒ¨ç½‘ç»œä»¥åŠ pod ç½‘ç»œçš„è®¿é—®ï¼Œå³å¤–éƒ¨ç½‘ç»œå¯ä»¥é€šè¿‡ service å»è®¿é—®ï¼Œpod ç½‘ç»œä¹Ÿå¯ä»¥é€šè¿‡ K8s Service å»è®¿é—®ã€‚ å‘ä¸‹ï¼ŒK8s å¯¹æ¥äº†å¦å¤–ä¸€ç»„ podï¼Œå³å¯ä»¥é€šè¿‡ K8s Service çš„æ–¹å¼å»è´Ÿè½½å‡è¡¡åˆ°ä¸€ç»„ pod ä¸Šé¢å»ï¼Œè¿™æ ·ç›¸å½“äºè§£å†³äº†å‰é¢æ‰€è¯´çš„å¤å‘æ€§é—®é¢˜ï¼Œæˆ–è€…æä¾›äº†ç»Ÿä¸€çš„è®¿é—®å…¥å£å»åšæœåŠ¡å‘ç°ï¼Œç„¶ååˆå¯ä»¥ç»™å¤–éƒ¨ç½‘ç»œè®¿é—®ï¼Œè§£å†³ä¸åŒçš„ pod ä¹‹é—´çš„è®¿é—®ï¼Œæä¾›ç»Ÿä¸€çš„è®¿é—®åœ°å€ã€‚ ","date":"2021-08-28","objectID":"/kubernetes-service/:1:2","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç”¨ä¾‹è§£è¯»ä¸‹é¢è¿›è¡Œå®é™…çš„ä¸€ä¸ªç”¨ä¾‹è§£è¯»ï¼Œçœ‹ pod K8s çš„ service è¦æ€ä¹ˆå»å£°æ˜ã€æ€ä¹ˆå»ä½¿ç”¨ï¼Ÿ ","date":"2021-08-28","objectID":"/kubernetes-service/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Service è¯­æ³• apiVersion:v1kind:Servicemetadata:name:my-servicelabels:app:my-servicespec:selector:app:MyAppports:- protocol:TCPport:80targetPort:9376 é¦–å…ˆæ¥çœ‹ K8s Service çš„ä¸€ä¸ªè¯­æ³•ï¼Œä¸Šæ–‡å®é™…å°±æ˜¯ K8s çš„ä¸€ä¸ªå£°æ˜ç»“æ„ã€‚è¿™ä¸ªç»“æ„é‡Œæœ‰å¾ˆå¤šè¯­æ³•ï¼Œè·Ÿä¹‹å‰æ‰€ä»‹ç»çš„ K8s çš„ä¸€äº›æ ‡å‡†å¯¹è±¡æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€‚æ¯”å¦‚è¯´æ ‡ç­¾ label å»åšä¸€äº›é€‰æ‹©ã€selector å»åšä¸€äº›é€‰æ‹©ã€label å»å£°æ˜å®ƒçš„ä¸€äº› label æ ‡ç­¾ç­‰ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼Œå°±æ˜¯å®šä¹‰äº†ç”¨äº K8s Service æœåŠ¡å‘ç°çš„ä¸€ä¸ªåè®®ä»¥åŠç«¯å£ã€‚ç»§ç»­æ¥çœ‹è¿™ä¸ªæ¨¡æ¿ï¼Œå£°æ˜äº†ä¸€ä¸ªåå« my-service çš„ä¸€ä¸ª K8s Serviceï¼Œå®ƒæœ‰ä¸€ä¸ª app:my-service çš„ labelï¼Œå®ƒé€‰æ‹©äº† app:MyApp è¿™æ ·ä¸€ä¸ª label çš„ pod ä½œä¸ºå®ƒçš„åç«¯ã€‚ æœ€åæ˜¯å®šä¹‰çš„æœåŠ¡å‘ç°çš„åè®®ä»¥åŠç«¯å£ï¼Œè¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬å®šä¹‰çš„æ˜¯ TCP åè®®ï¼Œç«¯å£æ˜¯ 80ï¼Œç›®çš„ç«¯å£æ˜¯ 9376ï¼Œæ•ˆæœæ˜¯è®¿é—®åˆ°è¿™ä¸ª service 80 ç«¯å£ä¼šè¢«è·¯ç”±åˆ°åç«¯çš„ targetPortï¼Œå°±æ˜¯åªè¦è®¿é—®åˆ°è¿™ä¸ª service 80 ç«¯å£çš„éƒ½ä¼šè´Ÿè½½å‡è¡¡åˆ°åç«¯ appï¼šMyApp è¿™ç§ label çš„ pod çš„ 9376 ç«¯å£ã€‚ ","date":"2021-08-28","objectID":"/kubernetes-service/:2:1","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"åˆ›å»ºå’ŒæŸ¥çœ‹ Serviceå¦‚ä½•å»åˆ›å»ºåˆšæ‰å£°æ˜çš„è¿™ä¸ª service å¯¹è±¡ï¼Œä»¥åŠå®ƒåˆ›å»ºä¹‹åæ˜¯ä»€ä¹ˆæ ·çš„æ•ˆæœå‘¢ï¼Ÿé€šè¿‡ç®€å•çš„å‘½ä»¤ï¼š kubectl apply -f service.yaml æˆ–è€…æ˜¯ kubectl created -f service.yaml ä¸Šé¢çš„å‘½ä»¤å¯ä»¥ç®€å•åœ°å»åˆ›å»ºè¿™æ ·ä¸€ä¸ª serviceã€‚åˆ›å»ºå¥½åï¼Œå¯ä»¥é€šè¿‡ kubectl discribe service å»æŸ¥çœ‹ service åˆ›å»ºä¹‹åçš„ä¸€ä¸ªç»“æœã€‚ ","date":"2021-08-28","objectID":"/kubernetes-service/:2:2","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"é›†ç¾¤å†…è®¿é—® Serviceåœ¨é›†ç¾¤é‡Œé¢ï¼Œå…¶ä»– pod è¦æ€ä¹ˆè®¿é—®åˆ°æˆ‘ä»¬æ‰€åˆ›å»ºçš„è¿™ä¸ª service å‘¢ï¼Ÿæœ‰ä¸‰ç§æ–¹å¼ï¼š é¦–å…ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ service çš„è™šæ‹Ÿ IP å»è®¿é—®ï¼Œæ¯”å¦‚è¯´åˆšåˆ›å»ºçš„ my-service è¿™ä¸ªæœåŠ¡ï¼Œé€šè¿‡ kubectl get svc æˆ–è€… kubectl discribe service éƒ½å¯ä»¥çœ‹åˆ°å®ƒçš„è™šæ‹Ÿ IP åœ°å€æ˜¯ 172.29.3.27ï¼Œç«¯å£æ˜¯ 80ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡è¿™ä¸ªè™šæ‹Ÿ IP åŠç«¯å£åœ¨ pod é‡Œé¢ç›´æ¥è®¿é—®åˆ°è¿™ä¸ª service çš„åœ°å€ã€‚ ç¬¬äºŒç§æ–¹å¼ç›´æ¥è®¿é—®æœåŠ¡åï¼Œä¾é  DNS è§£æï¼Œå°±æ˜¯åŒä¸€ä¸ª namespace é‡Œ pod å¯ä»¥ç›´æ¥é€šè¿‡ service çš„åå­—å»è®¿é—®åˆ°åˆšæ‰æ‰€å£°æ˜çš„è¿™ä¸ª serviceã€‚ä¸åŒçš„ namespace é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ service åå­—åŠ â€œ.â€ï¼Œç„¶ååŠ  service æ‰€åœ¨çš„å“ªä¸ª namespace å»è®¿é—®è¿™ä¸ª serviceï¼Œä¾‹å¦‚æˆ‘ä»¬ç›´æ¥ç”¨ curl å»è®¿é—®ï¼Œå°±æ˜¯ my-service:80 å°±å¯ä»¥è®¿é—®åˆ°è¿™ä¸ª serviceã€‚ ç¬¬ä¸‰ç§æ˜¯é€šè¿‡ç¯å¢ƒå˜é‡è®¿é—®ï¼Œåœ¨åŒä¸€ä¸ª namespace é‡Œçš„ pod å¯åŠ¨æ—¶ï¼ŒK8s ä¼šæŠŠ service çš„ä¸€äº› IP åœ°å€ã€ç«¯å£ï¼Œä»¥åŠä¸€äº›ç®€å•çš„é…ç½®ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡çš„æ–¹å¼æ”¾åˆ° K8s çš„ pod é‡Œé¢ã€‚åœ¨ K8s pod çš„å®¹å™¨å¯åŠ¨ä¹‹åï¼Œé€šè¿‡è¯»å–ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡æ¯”è¯»å–åˆ° namespace é‡Œé¢å…¶ä»– service é…ç½®çš„ä¸€ä¸ªåœ°å€ï¼Œæˆ–è€…æ˜¯å®ƒçš„ç«¯å£å·ç­‰ç­‰ã€‚æ¯”å¦‚åœ¨é›†ç¾¤çš„æŸä¸€ä¸ª pod é‡Œé¢ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ curl $ å–åˆ°ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼ï¼Œæ¯”å¦‚å–åˆ° MY_SERVICE_SERVICE_HOST å°±æ˜¯å®ƒçš„ä¸€ä¸ª IP åœ°å€ï¼ŒMY_SERVICE å°±æ˜¯åˆšæ‰æˆ‘ä»¬å£°æ˜çš„ MY_SERVICEï¼ŒSERVICE_PORT å°±æ˜¯å®ƒçš„ç«¯å£å·ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥è¯·æ±‚åˆ°é›†ç¾¤é‡Œé¢çš„ MY_SERVICE è¿™ä¸ª serviceã€‚ ","date":"2021-08-28","objectID":"/kubernetes-service/:2:3","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Headless Serviceservice æœ‰ä¸€ä¸ªç‰¹åˆ«çš„å½¢æ€å°±æ˜¯ Headless Serviceã€‚service åˆ›å»ºçš„æ—¶å€™å¯ä»¥æŒ‡å®š clusterIP:Noneï¼Œå‘Šè¯‰ K8s è¯´æˆ‘ä¸éœ€è¦ clusterIPï¼ˆå°±æ˜¯åˆšæ‰æ‰€è¯´çš„é›†ç¾¤é‡Œé¢çš„ä¸€ä¸ªè™šæ‹Ÿ IPï¼‰ï¼Œç„¶å K8s å°±ä¸ä¼šåˆ†é…ç»™è¿™ä¸ª service ä¸€ä¸ªè™šæ‹Ÿ IP åœ°å€ï¼Œå®ƒæ²¡æœ‰è™šæ‹Ÿ IP åœ°å€æ€ä¹ˆåšåˆ°è´Ÿè½½å‡è¡¡ä»¥åŠç»Ÿä¸€çš„è®¿é—®å…¥å£å‘¢ï¼Ÿ å®ƒæ˜¯è¿™æ ·æ¥æ“ä½œçš„ï¼špod å¯ä»¥ç›´æ¥é€šè¿‡ service_name ç”¨ DNS çš„æ–¹å¼è§£æåˆ°æ‰€æœ‰åç«¯ pod çš„ IP åœ°å€ï¼Œé€šè¿‡ DNS çš„ A è®°å½•çš„æ–¹å¼ä¼šè§£æåˆ°æ‰€æœ‰åç«¯çš„ Pod çš„åœ°å€ï¼Œç”±å®¢æˆ·ç«¯é€‰æ‹©ä¸€ä¸ªåç«¯çš„ IP åœ°å€ï¼Œè¿™ä¸ª A è®°å½•ä¼šéšç€ pod çš„ç”Ÿå‘½å‘¨æœŸå˜åŒ–ï¼Œè¿”å›çš„ A è®°å½•åˆ—è¡¨ä¹Ÿå‘ç”Ÿå˜åŒ–ï¼Œè¿™æ ·å°±è¦æ±‚å®¢æˆ·ç«¯åº”ç”¨è¦ä» A è®°å½•æŠŠæ‰€æœ‰ DNS è¿”å›åˆ° A è®°å½•çš„åˆ—è¡¨é‡Œé¢ IP åœ°å€ä¸­ï¼Œå®¢æˆ·ç«¯è‡ªå·±å»é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„åœ°å€å»è®¿é—® podã€‚ apiVersion:v1kind:Servicemetadata:name:my-servicelabels:app:my-servicespec:selector:app:MyAppclusterIP:Noneports:- protocol:TCPport:80targetPort:9376 Headless Service å¯ä»¥ä»ä¸Šå›¾çœ‹ä¸€ä¸‹è·Ÿåˆšæ‰æˆ‘ä»¬å£°æ˜çš„æ¨¡æ¿çš„åŒºåˆ«ï¼Œå°±æ˜¯åœ¨ä¸­é—´åŠ äº†ä¸€ä¸ª clusterIP:Noneï¼Œå³è¡¨æ˜ä¸éœ€è¦è™šæ‹Ÿ IPã€‚å®é™…æ•ˆæœå°±æ˜¯é›†ç¾¤çš„ pod è®¿é—® my-service æ—¶ï¼Œä¼šç›´æ¥è§£æåˆ°æ‰€æœ‰çš„ service å¯¹åº” pod çš„ IP åœ°å€ï¼Œè¿”å›ç»™ podï¼Œç„¶å pod é‡Œé¢è‡ªå·±å»é€‰æ‹©ä¸€ä¸ª IP åœ°å€å»ç›´æ¥è®¿é—®ã€‚ ","date":"2021-08-28","objectID":"/kubernetes-service/:2:4","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å‘é›†ç¾¤å¤–æš´éœ² Serviceå‰é¢ä»‹ç»çš„éƒ½æ˜¯åœ¨é›†ç¾¤é‡Œé¢ node æˆ–è€… pod å»è®¿é—® serviceï¼Œservice æ€ä¹ˆå»å‘å¤–æš´éœ²å‘¢ï¼Ÿæ€ä¹ˆæŠŠåº”ç”¨å®é™…æš´éœ²ç»™å…¬ç½‘å»è®¿é—®å‘¢ï¼Ÿè¿™é‡Œ service ä¹Ÿæœ‰ä¸¤ç§ç±»å‹å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ˜¯ NodePortï¼Œä¸€ä¸ªæ˜¯ LoadBalancerã€‚ NodePort and LoadBalancer NodePort çš„æ–¹å¼å°±æ˜¯åœ¨é›†ç¾¤çš„ node ä¸Šé¢ï¼ˆå³é›†ç¾¤çš„èŠ‚ç‚¹çš„å®¿ä¸»æœºä¸Šé¢ï¼‰å»æš´éœ²èŠ‚ç‚¹ä¸Šçš„ä¸€ä¸ªç«¯å£ï¼Œè¿™æ ·ç›¸å½“äºåœ¨èŠ‚ç‚¹çš„ä¸€ä¸ªç«¯å£ä¸Šé¢è®¿é—®åˆ°ä¹‹åå°±ä¼šå†å»åšä¸€å±‚è½¬å‘ï¼Œè½¬å‘åˆ°è™šæ‹Ÿçš„ IP åœ°å€ä¸Šé¢ï¼Œå°±æ˜¯åˆšåˆšå®¿ä¸»æœºä¸Šé¢ service è™šæ‹Ÿ IP åœ°å€ã€‚ LoadBalancer ç±»å‹å°±æ˜¯åœ¨ NodePort ä¸Šé¢åˆåšäº†ä¸€å±‚è½¬æ¢ï¼Œåˆšæ‰æ‰€è¯´çš„ NodePort å…¶å®æ˜¯é›†ç¾¤é‡Œé¢æ¯ä¸ªèŠ‚ç‚¹ä¸Šé¢ä¸€ä¸ªç«¯å£ï¼ŒLoadBalancer æ˜¯åœ¨æ‰€æœ‰çš„èŠ‚ç‚¹å‰åˆæŒ‚ä¸€ä¸ªè´Ÿè½½å‡è¡¡ã€‚æ¯”å¦‚åœ¨é˜¿é‡Œäº‘ä¸ŠæŒ‚ä¸€ä¸ª SLBï¼Œè¿™ä¸ªè´Ÿè½½å‡è¡¡ä¼šæä¾›ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ï¼Œå¹¶æŠŠæ‰€æœ‰å®ƒæ¥è§¦åˆ°çš„æµé‡è´Ÿè½½å‡è¡¡åˆ°æ¯ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹çš„ node pod ä¸Šé¢å»ã€‚ç„¶å node pod å†è½¬åŒ–æˆ ClusterIPï¼Œå»è®¿é—®åˆ°å®é™…çš„ pod ä¸Šé¢ã€‚ ","date":"2021-08-28","objectID":"/kubernetes-service/:2:5","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ¶æ„è®¾è®¡ Kubernetes Service Architecture å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒK8s æœåŠ¡å‘ç°ä»¥åŠ K8s Service æ˜¯è¿™æ ·æ•´ä½“çš„ä¸€ä¸ªæ¶æ„ã€‚ K8s åˆ†ä¸º master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹ï¼š master é‡Œé¢ä¸»è¦æ˜¯ K8s ç®¡æ§çš„å†…å®¹ï¼› worker èŠ‚ç‚¹é‡Œé¢æ˜¯å®é™…è·‘ç”¨æˆ·åº”ç”¨çš„ä¸€ä¸ªåœ°æ–¹ã€‚ åœ¨ K8s master èŠ‚ç‚¹é‡Œé¢æœ‰ APIServerï¼Œå°±æ˜¯ç»Ÿä¸€ç®¡ç† K8s æ‰€æœ‰å¯¹è±¡çš„åœ°æ–¹ï¼Œæ‰€æœ‰çš„ç»„ä»¶éƒ½ä¼šæ³¨å†Œåˆ° APIServer ä¸Šé¢å»ç›‘å¬è¿™ä¸ªå¯¹è±¡çš„å˜åŒ–ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬åˆšæ‰çš„ç»„ä»¶ pod ç”Ÿå‘½å‘¨æœŸå‘ç”Ÿå˜åŒ–ï¼Œè¿™äº›äº‹ä»¶ã€‚ è¿™é‡Œé¢æœ€å…³é”®çš„æœ‰ä¸‰ä¸ªç»„ä»¶ï¼š ä¸€ä¸ªæ˜¯ Cloud Controller Managerï¼Œè´Ÿè´£å»é…ç½® LoadBalancer çš„ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ç»™å¤–éƒ¨å»è®¿é—®ï¼› å¦å¤–ä¸€ä¸ªå°±æ˜¯ Corednsï¼Œå°±æ˜¯é€šè¿‡ Coredns å»è§‚æµ‹ APIServer é‡Œé¢çš„ service åç«¯ pod çš„ä¸€ä¸ªå˜åŒ–ï¼Œå»é…ç½® service çš„ DNS è§£æï¼Œå®ç°å¯ä»¥é€šè¿‡ service çš„åå­—ç›´æ¥è®¿é—®åˆ° service çš„è™šæ‹Ÿ IPï¼Œæˆ–è€…æ˜¯ Headless ç±»å‹çš„ Service ä¸­çš„ IP åˆ—è¡¨çš„è§£æï¼› ç„¶ååœ¨æ¯ä¸ª node é‡Œé¢ä¼šæœ‰ kube-proxy è¿™ä¸ªç»„ä»¶ï¼Œå®ƒé€šè¿‡ç›‘å¬ service ä»¥åŠ pod å˜åŒ–ï¼Œç„¶åå®é™…å»é…ç½®é›†ç¾¤é‡Œé¢çš„ node pod æˆ–è€…æ˜¯è™šæ‹Ÿ IP åœ°å€çš„ä¸€ä¸ªè®¿é—®ã€‚ å®é™…è®¿é—®é“¾è·¯æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿæ¯”å¦‚è¯´ä»é›†ç¾¤å†…éƒ¨çš„ä¸€ä¸ª Client Pod3 å»è®¿é—® Serviceï¼Œå°±ç±»ä¼¼äºåˆšæ‰æ‰€æ¼”ç¤ºçš„ä¸€ä¸ªæ•ˆæœã€‚Client Pod3 é¦–å…ˆé€šè¿‡ Coredns è¿™é‡Œå»è§£æå‡º ServiceIPï¼ŒCoredns ä¼šè¿”å›ç»™å®ƒ ServiceName æ‰€å¯¹åº”çš„ service IP æ˜¯ä»€ä¹ˆï¼Œè¿™ä¸ª Client Pod3 å°±ä¼šæ‹¿è¿™ä¸ª Service IP å»åšè¯·æ±‚ï¼Œå®ƒçš„è¯·æ±‚åˆ°å®¿ä¸»æœºçš„ç½‘ç»œä¹‹åï¼Œå°±ä¼šè¢« kube-proxy æ‰€é…ç½®çš„ iptables æˆ–è€… IPVS å»åšä¸€å±‚æ‹¦æˆªå¤„ç†ï¼Œä¹‹åå»è´Ÿè½½å‡è¡¡åˆ°æ¯ä¸€ä¸ªå®é™…çš„åç«¯ pod ä¸Šé¢å»ï¼Œè¿™æ ·å°±å®ç°äº†ä¸€ä¸ªè´Ÿè½½å‡è¡¡ä»¥åŠæœåŠ¡å‘ç°ã€‚ å¯¹äºå¤–éƒ¨çš„æµé‡ï¼Œæ¯”å¦‚è¯´åˆšæ‰é€šè¿‡å…¬ç½‘è®¿é—®çš„ä¸€ä¸ªè¯·æ±‚ã€‚å®ƒæ˜¯é€šè¿‡å¤–éƒ¨çš„ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ Cloud Controller Manager å»ç›‘å¬ service çš„å˜åŒ–ä¹‹åï¼Œå»é…ç½®çš„ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼Œç„¶åè½¬å‘åˆ°èŠ‚ç‚¹ä¸Šçš„ä¸€ä¸ª NodePort ä¸Šé¢å»ï¼ŒNodePort ä¹Ÿä¼šç»è¿‡ kube-proxy çš„ä¸€ä¸ªé…ç½®çš„ä¸€ä¸ª iptablesï¼ŒæŠŠ NodePort çš„æµé‡è½¬æ¢æˆ ClusterIPï¼Œç´§æ¥ç€è½¬æ¢æˆåç«¯çš„ä¸€ä¸ª pod çš„ IP åœ°å€ï¼Œå»åšè´Ÿè½½å‡è¡¡ä»¥åŠæœåŠ¡å‘ç°ã€‚è¿™å°±æ˜¯æ•´ä¸ª K8s æœåŠ¡å‘ç°ä»¥åŠ K8s Service æ•´ä½“çš„ç»“æ„ã€‚ ","date":"2021-08-28","objectID":"/kubernetes-service/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å†…å®¹æ€»ç»“ ä¸ºä»€ä¹ˆäº‘åŸç”Ÿçš„åœºæ™¯éœ€è¦æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ åœ¨ Kubernetes ä¸­å¦‚ä½•ä½¿ç”¨ Kubernetes çš„ Service åšæœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ Kubernetes é›†ç¾¤ä¸­ Service æ¶‰åŠåˆ°çš„ç»„ä»¶å’Œå¤§æ¦‚å®ç°åŸç† ","date":"2021-08-28","objectID":"/kubernetes-service/:4:0","tags":["äº‘åŸç”Ÿ","Kubernetes","Service","è´Ÿè½½å‡è¡¡"],"title":"Kubernetes æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡","uri":"/kubernetes-service/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡ä»‹ç»äº†Kubernetes åŸºæœ¬ç½‘ç»œæ¨¡å‹ã€Netns æ¢ç§˜ã€ä¸»æµç½‘ç»œæ–¹æ¡ˆç®€ä»‹ã€Network Policy çš„ç”¨å¤„","date":"2021-08-22","objectID":"/kubernetes-network-concept/","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Kubernetes åŸºæœ¬ç½‘ç»œæ¨¡å‹Kubernetes å¯¹ä¸€ä¸ªå®¹å™¨ç½‘ç»œæ˜¯å¦åˆæ ¼åšå‡ºäº†é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯ Kubernetes çš„å®¹å™¨ç½‘ç»œæ¨¡å‹ã€‚å¯ä»¥æŠŠå®ƒå½’ç»“ä¸ºçº¦æ³•ä¸‰ç« å’Œå››å¤§ç›®æ ‡ã€‚ çº¦æ³•ä¸‰ç« çš„æ„æ€æ˜¯ï¼šåœ¨è¯„ä»·ä¸€ä¸ªå®¹å™¨ç½‘ç»œæˆ–è€…è®¾è®¡å®¹å™¨ç½‘ç»œçš„æ—¶å€™ï¼Œå®ƒçš„å‡†å…¥æ¡ä»¶ã€‚å®ƒéœ€è¦æ»¡è¶³å“ªä¸‰æ¡ï¼Ÿ æ‰èƒ½è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªåˆæ ¼çš„ç½‘ç»œæ–¹æ¡ˆã€‚ å››å¤§ç›®æ ‡æ„æ€æ˜¯åœ¨è®¾è®¡è¿™ä¸ªç½‘ç»œçš„æ‹“æ‰‘ï¼Œè®¾è®¡ç½‘ç»œçš„å…·ä½“åŠŸèƒ½çš„å®ç°çš„æ—¶å€™ï¼Œè¦å»æƒ³æ¸…æ¥šï¼Œèƒ½ä¸èƒ½è¾¾æˆè¿é€šæ€§ç­‰è¿™å‡ å¤§æŒ‡æ ‡ã€‚ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"çº¦æ³•ä¸‰ç«  ç¬¬ä¸€æ¡ï¼šä»»æ„ä¸¤ä¸ª pod ä¹‹é—´å…¶å®æ˜¯å¯ä»¥ç›´æ¥é€šä¿¡çš„ï¼Œæ— éœ€ç»è¿‡æ˜¾å¼åœ°ä½¿ç”¨ NAT æ¥æ¥æ”¶æ•°æ®å’Œåœ°å€çš„è½¬æ¢ï¼› ç¬¬äºŒæ¡ï¼šnode ä¸ pod ä¹‹é—´æ˜¯å¯ä»¥ç›´æ¥é€šä¿¡çš„ï¼Œæ— éœ€ä½¿ç”¨æ˜æ˜¾çš„åœ°å€è½¬æ¢ï¼› ç¬¬ä¸‰æ¡ï¼špod çœ‹åˆ°è‡ªå·±çš„ IP è·Ÿåˆ«äººçœ‹è§å®ƒæ‰€ç”¨çš„IPæ˜¯ä¸€æ ·çš„ï¼Œä¸­é—´ä¸èƒ½ç»è¿‡è½¬æ¢ã€‚ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:1:1","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å››å¤§ç›®æ ‡ å¤–éƒ¨ä¸–ç•Œå’Œ service ä¹‹é—´æ˜¯æ€ä¹ˆé€šä¿¡çš„ï¼Ÿå°±æ˜¯æœ‰ä¸€ä¸ªäº’è”ç½‘æˆ–è€…æ˜¯å…¬å¸å¤–éƒ¨çš„ä¸€ä¸ªç”¨æˆ·ï¼Œæ€ä¹ˆç”¨åˆ° serviceï¼Ÿservice ç‰¹æŒ‡ K8s é‡Œé¢çš„æœåŠ¡æ¦‚å¿µã€‚ service å¦‚ä½•ä¸å®ƒåç«¯çš„ pod é€šè®¯ï¼Ÿ pod å’Œ pod ä¹‹é—´è°ƒç”¨æ˜¯æ€ä¹ˆåšåˆ°é€šä¿¡çš„ï¼Ÿ æœ€åå°±æ˜¯ pod å†…éƒ¨å®¹å™¨ä¸å®¹å™¨ä¹‹é—´çš„é€šä¿¡ï¼Ÿ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:1:2","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å¯¹åŸºæœ¬çº¦æŸçš„è§£é‡Šå¯¹åŸºæœ¬çº¦æŸï¼Œå¯ä»¥åšå‡ºè¿™æ ·ä¸€äº›è§£è¯»ï¼šå› ä¸ºå®¹å™¨çš„ç½‘ç»œå‘å±•å¤æ‚æ€§å°±åœ¨äºå®ƒå…¶å®æ˜¯å¯„ç”Ÿåœ¨ Host ç½‘ç»œä¹‹ä¸Šçš„ã€‚ä»è¿™ä¸ªè§’åº¦è®²ï¼Œå¯ä»¥æŠŠå®¹å™¨ç½‘ç»œæ–¹æ¡ˆå¤§ä½“åˆ†ä¸º Underlay/Overlay ä¸¤å¤§æ´¾åˆ«ï¼š Underlay çš„æ ‡å‡†æ˜¯å®ƒä¸ Host ç½‘ç»œæ˜¯åŒå±‚çš„ï¼Œä»å¤–åœ¨å¯è§çš„ä¸€ä¸ªç‰¹å¾å°±æ˜¯å®ƒæ˜¯ä¸æ˜¯ä½¿ç”¨äº† Host ç½‘ç»œåŒæ ·çš„ç½‘æ®µã€è¾“å…¥è¾“å‡ºåŸºç¡€è®¾å¤‡ã€å®¹å™¨çš„ IP åœ°å€æ˜¯ä¸æ˜¯éœ€è¦ä¸ Host ç½‘ç»œå–å¾—ååŒï¼ˆæ¥è‡ªåŒä¸€ä¸ªä¸­å¿ƒåˆ†é…æˆ–ç»Ÿä¸€åˆ’åˆ†ï¼‰ã€‚è¿™å°±æ˜¯ Underlayï¼› Overlay ä¸ä¸€æ ·çš„åœ°æ–¹å°±åœ¨äºå®ƒå¹¶ä¸éœ€è¦ä» Host ç½‘ç»œçš„ IPM çš„ç®¡ç†çš„ç»„ä»¶å»ç”³è¯·IPï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå®ƒåªéœ€è¦è·Ÿ Host ç½‘ç»œä¸å†²çªï¼Œè¿™ä¸ª IP å¯ä»¥è‡ªç”±åˆ†é…çš„ã€‚ Underlay/Overlay ä¸¤å¤§æ´¾åˆ«ä¸»è¦çš„å·®å¼‚åœ¨äºæ˜¯å¦ä¸Hostç½‘ç»œåŒå±‚ï¼Œè¿™æ ·å¯¹äºå¾®æœåŠ¡å‘ç°åŠæ²»ç†ï¼Œå®¹å™¨å¯è®¿é—®æ–¹å¼éƒ½é€ æˆå¾ˆå¤§çš„å·®å¼‚ï¼Œæ‰€ä»¥ç¤¾åŒºåŒå­¦ä»¥ perPodperIP è¿™ç§ç®€å•æ­¦æ–­çš„æ¨¡å‹ï¼Œæ‘’å¼ƒäº†æ˜¾ç¤ºç«¯å£æ˜ å°„ç­‰ NAT é…ç½®ï¼Œç»Ÿä¸€äº†å®¹å™¨ç½‘ç»œå¯¹å¤–æœåŠ¡çš„è§†è§’ã€‚ Network ä¸ºä»€ä¹ˆç¤¾åŒºä¼šæå‡º perPodperIP è¿™ç§ç®€å•æ­¦æ–­çš„æ¨¡å‹å‘¢ï¼Ÿæˆ‘ä¸ªäººæ˜¯è§‰å¾—è¿™æ ·ä¸ºåé¢çš„ service ç®¡ç†ä¸€äº›æœåŠ¡çš„è·Ÿè¸ªæ€§èƒ½ç›‘æ§ï¼Œå¸¦æ¥äº†éå¸¸å¤šçš„å¥½å¤„ã€‚å› ä¸ºä¸€ä¸ª IP ä¸€è´¯åˆ°åº•ï¼Œå¯¹ case æˆ–è€…å„ç§ä¸å¤§çš„äº‹æƒ…éƒ½ä¼šæœ‰å¾ˆå¤§çš„å¥½å¤„ã€‚ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:1:3","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Netns æ¢ç§˜","date":"2021-08-22","objectID":"/kubernetes-network-concept/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Netns ç©¶ç«Ÿå®ç°äº†ä»€ä¹ˆNetwork Namespace é‡Œé¢èƒ½ç½‘ç»œå®ç°çš„å†…æ ¸åŸºç¡€ã€‚ç‹­ä¹‰ä¸Šæ¥è¯´ runC å®¹å™¨æŠ€æœ¯æ˜¯ä¸ä¾èµ–äºä»»ä½•ç¡¬ä»¶çš„ï¼Œå®ƒçš„æ‰§è¡ŒåŸºç¡€å°±æ˜¯å®ƒçš„å†…æ ¸é‡Œé¢ï¼Œè¿›ç¨‹çš„å†…æ ¸ä»£è¡¨å°±æ˜¯ taskï¼Œå®ƒå¦‚æœä¸éœ€è¦éš”ç¦»ï¼Œé‚£ä¹ˆç”¨çš„æ˜¯ä¸»æœºçš„ç©ºé—´ï¼ˆ namespaceï¼‰ï¼Œå¹¶ä¸éœ€è¦ç‰¹åˆ«è®¾ç½®çš„ç©ºé—´éš”ç¦»æ•°æ®ç»“æ„ï¼ˆ nsproxy-namespace proxyï¼‰ã€‚ ä»æ„Ÿå®˜ä¸Šæ¥çœ‹ä¸€ä¸ªéš”ç¦»çš„ç½‘ç»œç©ºé—´ï¼Œå®ƒä¼šæ‹¥æœ‰è‡ªå·±çš„ç½‘å¡æˆ–è€…è¯´æ˜¯ç½‘ç»œè®¾å¤‡ã€‚ç½‘å¡å¯èƒ½æ˜¯è™šæ‹Ÿçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ç‰©ç†ç½‘å¡ï¼Œå®ƒä¼šæ‹¥æœ‰è‡ªå·±çš„ IP åœ°å€ã€IP è¡¨å’Œè·¯ç”±è¡¨ã€æ‹¥æœ‰è‡ªå·±çš„åè®®æ ˆçŠ¶æ€ã€‚è¿™é‡Œé¢ç‰¹æŒ‡å°±æ˜¯ TCP/Ipåè®®æ ˆï¼Œå®ƒä¼šæœ‰è‡ªå·±çš„statusï¼Œä¼šæœ‰è‡ªå·±çš„ iptablesã€ipvsã€‚ ä»æ•´ä¸ªæ„Ÿå®˜ä¸Šæ¥è®²ï¼Œè¿™å°±ç›¸å½“äºæ‹¥æœ‰äº†ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ç½‘ç»œï¼Œå®ƒä¸ä¸»æœºç½‘ç»œæ˜¯éš”ç¦»çš„ã€‚å½“ç„¶åè®®æ ˆçš„ä»£ç è¿˜æ˜¯å…¬ç”¨çš„ï¼Œåªæ˜¯æ•°æ®ç»“æ„ä¸ç›¸åŒã€‚ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:2:1","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Pod ä¸ Netns çš„å…³ç³» Netns è¿™å¼ å›¾å¯ä»¥æ¸…æ™°è¡¨æ˜ pod é‡Œ Netns çš„å…³ç³»ï¼Œæ¯ä¸ª pod éƒ½æœ‰ç€ç‹¬ç«‹çš„ç½‘ç»œç©ºé—´ï¼Œpod net container ä¼šå…±äº«è¿™ä¸ªç½‘ç»œç©ºé—´ã€‚ä¸€èˆ¬ K8s ä¼šæ¨èé€‰ç”¨ Loopback æ¥å£ï¼Œåœ¨ pod net container ä¹‹é—´è¿›è¡Œé€šä¿¡ï¼Œè€Œæ‰€æœ‰çš„ container é€šè¿‡ pod çš„ IP å¯¹å¤–æä¾›æœåŠ¡ã€‚å¦å¤–å¯¹äºå®¿ä¸»æœºä¸Šçš„ Root Netnsï¼Œå¯ä»¥æŠŠå®ƒçœ‹åšä¸€ä¸ªç‰¹æ®Šçš„ç½‘ç»œç©ºé—´ï¼Œåªä¸è¿‡å®ƒçš„ Pid æ˜¯1ã€‚ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:2:2","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä¸»æµç½‘ç»œæ–¹æ¡ˆç®€ä»‹","date":"2021-08-22","objectID":"/kubernetes-network-concept/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å…¸å‹çš„å®¹å™¨ç½‘ç»œå®ç°æ–¹æ¡ˆå®¹å™¨ç½‘ç»œæ–¹æ¡ˆå¯èƒ½æ˜¯ K8s é‡Œæœ€ä¸ºç™¾èŠ±é½æ”¾çš„ä¸€ä¸ªé¢†åŸŸï¼Œå®ƒæœ‰ç€å„ç§å„æ ·çš„å®ç°ã€‚å®¹å™¨ç½‘ç»œçš„å¤æ‚æ€§ï¼Œå…¶å®åœ¨äºå®ƒéœ€è¦è·Ÿåº•å±‚ Iass å±‚çš„ç½‘ç»œåšåè°ƒã€éœ€è¦åœ¨æ€§èƒ½è·Ÿ IP åˆ†é…çš„çµæ´»æ€§ä¸Šåšä¸€äº›é€‰æ‹©ï¼Œè¿™ä¸ªæ–¹æ¡ˆæ˜¯å¤šç§å¤šæ ·çš„ã€‚ ä¸‹é¢ç®€å•ä»‹ç»å‡ ä¸ªæ¯”è¾ƒä¸»è¦çš„æ–¹æ¡ˆï¼šåˆ†åˆ«æ˜¯ Flannelã€Calicoã€Canal ï¼Œæœ€åæ˜¯ WeaveNetï¼Œä¸­é—´çš„å¤§å¤šæ•°æ–¹æ¡ˆéƒ½æ˜¯é‡‡ç”¨äº†è·Ÿ Calico ç±»ä¼¼çš„ç­–ç•¥è·¯ç”±çš„æ–¹æ³•ã€‚ Flannel æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§ä¸€ç»Ÿçš„æ–¹æ¡ˆï¼Œå®ƒæä¾›äº†å¤šç§çš„ç½‘ç»œ backendã€‚ä¸åŒçš„ backend å®ç°äº†ä¸åŒçš„æ‹“æ‰‘ï¼Œå®ƒå¯ä»¥è¦†ç›–å¤šç§åœºæ™¯ï¼› Calico ä¸»è¦æ˜¯é‡‡ç”¨äº†ç­–ç•¥è·¯ç”±ï¼ŒèŠ‚ç‚¹ä¹‹é—´é‡‡ç”¨ BGP çš„åè®®ï¼Œå»è¿›è¡Œè·¯ç”±çš„åŒæ­¥ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯åŠŸèƒ½æ¯”è¾ƒä¸°å¯Œï¼Œå°¤å…¶æ˜¯å¯¹ Network Point æ”¯æŒæ¯”è¾ƒå¥½ï¼Œå¤§å®¶éƒ½çŸ¥é“ Calico å¯¹åº•å±‚ç½‘ç»œçš„è¦æ±‚ï¼Œä¸€èˆ¬æ˜¯éœ€è¦ mac åœ°å€èƒ½å¤Ÿç›´é€šï¼Œä¸èƒ½è·¨äºŒå±‚åŸŸï¼› å½“ç„¶ä¹Ÿæœ‰ä¸€äº›ç¤¾åŒºçš„åŒå­¦ä¼šæŠŠ Flannel çš„ä¼˜ç‚¹å’Œ Calico çš„ä¼˜ç‚¹åšä¸€äº›é›†æˆã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºå«æ¥å‹çš„åˆ›æ–°é¡¹ç›® Ciliumï¼› æœ€åè®²ä¸€ä¸‹ WeaveNetï¼Œå¦‚æœå¤§å®¶åœ¨ä½¿ç”¨ä¸­éœ€è¦å¯¹æ•°æ®åšä¸€äº›åŠ å¯†ï¼Œå¯ä»¥é€‰æ‹©ç”¨ WeaveNetï¼Œå®ƒçš„åŠ¨æ€æ–¹æ¡ˆå¯ä»¥å®ç°æ¯”è¾ƒå¥½çš„åŠ å¯†ã€‚ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Flannel æ–¹æ¡ˆ Flannel Flannel æ–¹æ¡ˆæ˜¯ç›®å‰ä½¿ç”¨æœ€ä¸ºæ™®éçš„ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªå…¸å‹çš„å®¹å™¨ç½‘æ–¹æ¡ˆã€‚å®ƒé¦–å…ˆè¦è§£å†³çš„æ˜¯ container çš„åŒ…å¦‚ä½•åˆ°è¾¾ Hostï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯åŠ ä¸€ä¸ª Bridge çš„æ–¹å¼ã€‚å®ƒçš„ backend å…¶å®æ˜¯ç‹¬ç«‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªåŒ…å¦‚ä½•ç¦»å¼€ Hostï¼Œæ˜¯é‡‡ç”¨å“ªç§å°è£…æ–¹å¼ï¼Œè¿˜æ˜¯ä¸éœ€è¦å°è£…ï¼Œéƒ½æ˜¯å¯é€‰æ‹©çš„ã€‚ ç°åœ¨æ¥ä»‹ç»ä¸‰ç§ä¸»è¦çš„ backendï¼š ä¸€ç§æ˜¯ç”¨æˆ·æ€çš„ udpï¼Œè¿™ç§æ˜¯æœ€æ—©æœŸçš„å®ç°ï¼› ç„¶åæ˜¯å†…æ ¸çš„ Vxlanï¼Œè¿™ä¸¤ç§éƒ½ç®—æ˜¯ overlay çš„æ–¹æ¡ˆã€‚Vxlan çš„æ€§èƒ½ä¼šæ¯”è¾ƒå¥½ä¸€ç‚¹ï¼Œä½†æ˜¯å®ƒå¯¹å†…æ ¸çš„ç‰ˆæœ¬æ˜¯æœ‰è¦æ±‚çš„ï¼Œéœ€è¦å†…æ ¸æ”¯æŒ Vxlan çš„ç‰¹æ€§åŠŸèƒ½ï¼› å¦‚æœä½ çš„é›†ç¾¤è§„æ¨¡ä¸å¤Ÿå¤§ï¼Œåˆå¤„äºåŒä¸€ä¸ªäºŒå±‚åŸŸï¼Œä¹Ÿå¯ä»¥é€‰æ‹©é‡‡ç”¨ host-gw çš„æ–¹å¼ã€‚è¿™ç§æ–¹å¼çš„ backend åŸºæœ¬ä¸Šæ˜¯ç”±ä¸€æ®µå¹¿æ’­è·¯ç”±è§„åˆ™æ¥å¯åŠ¨çš„ï¼Œæ€§èƒ½æ¯”è¾ƒé«˜ã€‚ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Network Policy çš„ç”¨å¤„","date":"2021-08-22","objectID":"/kubernetes-network-concept/:4:0","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Network Policy åŸºæœ¬æ¦‚å¿µNetwork Policy æä¾›äº†åŸºäºç­–ç•¥çš„ç½‘ç»œæ§åˆ¶ï¼Œç”¨äºéš”ç¦»åº”ç”¨å¹¶å‡å°‘æ”»å‡»é¢ã€‚å®ƒä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨æ¨¡æ‹Ÿä¼ ç»Ÿçš„åˆ†æ®µç½‘ç»œï¼Œå¹¶é€šè¿‡ç­–ç•¥æ§åˆ¶å®ƒä»¬ä¹‹é—´çš„æµé‡ä»¥åŠæ¥è‡ªå¤–éƒ¨çš„æµé‡ã€‚ åœ¨ä½¿ç”¨ Network Policy ä¹‹å‰ï¼Œéœ€è¦æ³¨æ„ï¼š apiserver å¼€å¯ extensions/v1beta1/networkpolicies ç½‘ç»œæ’ä»¶è¦æ”¯æŒ Network Policyï¼Œå¦‚ Calicoã€Romanaã€Weave Net å’Œ trireme ç­‰ åˆšæ‰æåˆ°äº† Kubernetes ç½‘ç»œçš„åŸºæœ¬æ¨¡å‹æ˜¯éœ€è¦ pod ä¹‹é—´å…¨äº’è”ï¼Œè¿™ä¸ªå°†å¸¦æ¥ä¸€äº›é—®é¢˜ï¼šå¯èƒ½åœ¨ä¸€ä¸ª K8s é›†ç¾¤é‡Œï¼Œæœ‰ä¸€äº›è°ƒç”¨é“¾ä¹‹é—´æ˜¯ä¸ä¼šç›´æ¥è°ƒç”¨çš„ã€‚ åŸºæœ¬ä¸Šå®ƒçš„æƒ³æ³•æ˜¯è¿™æ ·çš„ï¼šå®ƒé‡‡ç”¨å„ç§é€‰æ‹©å™¨ï¼ˆæ ‡ç­¾æˆ– namespaceï¼‰ï¼Œæ‰¾åˆ°ä¸€ç»„ podï¼Œæˆ–è€…æ‰¾åˆ°ç›¸å½“äºé€šè®¯çš„ä¸¤ç«¯ï¼Œç„¶åé€šè¿‡æµçš„ç‰¹å¾æè¿°æ¥å†³å®šå®ƒä»¬ä¹‹é—´æ˜¯ä¸æ˜¯å¯ä»¥è”é€šï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç™½åå•çš„æœºåˆ¶ã€‚ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:4:1","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"é…ç½®å®ä¾‹ apiVersion:networking.k8s.io/v1kind:NetworkPolicymetadata:name:test-network-policynamespace:defaultspec:podSelector:matchLabels:role:dbpolicyTypes:- Ingress- Egressingress:- from:- ipBlock:cidr:172.17.0.0/16except:- 172.17.1.0/24- namespaceSelector:matchLabels:project:myproject- podSelector:matchLabels:role:frontendports:- protocol:TCPport:6379egress:- to:- ipBlock:cidr:10.0.0.0/24ports:- protocol:TCPport:5978 åŠŸèƒ½ï¼š é€šè¿‡ä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨ï¼ˆåŒ…æ‹¬ namespaceSelector å’Œ podSelectorï¼‰æ¥æ§åˆ¶ Pod ä¹‹é—´çš„æµé‡ã€‚ è¦å†³å®šä¸‰ä»¶äº‹ï¼š æ§åˆ¶å¯¹è±¡ï¼šé€šè¿‡ spec å­—æ®µï¼ŒpodSelector ç­‰æ¡ä»¶ç­›é€‰ æµæ–¹å‘ï¼šIngressï¼ˆå…¥ Pod æµé‡ï¼‰+ fromï¼ŒEgressï¼ˆå‡º Pod æµé‡ï¼‰+ toï¼› æµç‰¹å¾ï¼šå¯¹ç«¯ï¼ˆé€šè¿‡ name/pod Selectorï¼‰ï¼ŒIPæ®µï¼ˆipBlockï¼‰ï¼Œåè®®ï¼ˆprotocolï¼‰ï¼Œç«¯å£ï¼ˆportï¼‰ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:4:2","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å†…å®¹æ€»ç»“ åœ¨ pod çš„å®¹å™¨ç½‘ç»œä¸­æ ¸å¿ƒæ¦‚å¿µå°±æ˜¯ IPï¼ŒIP å°±æ˜¯æ¯ä¸ª pod å¯¹å¤–é€šè®¯çš„åœ°å€åŸºç¡€ï¼Œå¿…é¡»å†…å¤–ä¸€è‡´ï¼Œç¬¦åˆ K8s çš„æ¨¡å‹ç‰¹å¾ï¼› é‚£ä¹ˆåœ¨ä»‹ç»ç½‘ç»œæ–¹æ¡ˆçš„æ—¶å€™ï¼Œå½±å“å®¹å™¨ç½‘ç»œæ€§èƒ½æœ€å…³é”®çš„å°±æ˜¯æ‹“æ‰‘ã€‚è¦èƒ½å¤Ÿç†è§£ä½ çš„åŒ…ç«¯åˆ°ç«¯æ˜¯æ€ä¹ˆè”é€šçš„ï¼Œä¸­é—´æ€ä¹ˆä» container åˆ°è¾¾ Hostï¼ŒHost å‡ºäº† container æ˜¯è¦å°è£…è¿˜æ˜¯è§£å°è£…ï¼Ÿè¿˜æ˜¯é€šè¿‡ç­–ç•¥è·¯ç”±ï¼Ÿæœ€ç»ˆåˆ°è¾¾å¯¹ç«¯æ˜¯æ€ä¹ˆè§£å‡ºæ¥çš„ï¼Ÿ å®¹å™¨ç½‘ç»œé€‰æ‹©å’Œè®¾è®¡é€‰æ‹©ã€‚å¦‚æœä½ å¹¶ä¸æ¸…æ¥šä½ çš„å¤–éƒ¨ç½‘ç»œï¼Œæˆ–è€…ä½ éœ€è¦ä¸€ä¸ªæ™®é€‚æ€§æœ€å¼ºçš„æ–¹æ¡ˆï¼Œå‡è®¾è¯´ä½ å¯¹ mac æ˜¯å¦ç›´è¿ä¸å¤ªæ¸…æ¥šã€å¯¹å¤–éƒ¨è·¯ç”±å™¨çš„è·¯ç”±è¡¨èƒ½å¦æ§åˆ¶ä¹Ÿä¸å¤ªæ¸…æ¥šï¼Œé‚£ä¹ˆä½ å¯ä»¥é€‰æ‹© Flannel åˆ©ç”¨ Vxlan ä½œä¸º backend çš„è¿™ç§æ–¹æ¡ˆã€‚å¦‚æœä½ ç¡®ä¿¡ä½ çš„ç½‘ç»œæ˜¯ 2 å±‚å¯ç›´è¿çš„ï¼Œä½ å¯ä»¥è¿›è¡Œé€‰ç”¨ Calico æˆ–è€… Flannel-Hostgw ä½œä¸ºä¸€ä¸ª backendï¼› æœ€åå°±æ˜¯å¯¹ Network Policyï¼Œåœ¨è¿ç»´å’Œä½¿ç”¨çš„æ—¶å€™ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å®ç°å¯¹è¿›å‡ºæµçš„ç²¾ç¡®æ§åˆ¶ã€‚å®ç°çš„æ–¹æ³•æˆ‘ä»¬ä¹Ÿä»‹ç»äº†ï¼Œè¦æƒ³æ¸…æ¥šä½ è¦æ§åˆ¶è°ï¼Œç„¶åä½ çš„æµè¦æ€ä¹ˆå»å®šä¹‰ã€‚ ","date":"2021-08-22","objectID":"/kubernetes-network-concept/:5:0","tags":["äº‘åŸç”Ÿ","Kubernetes","ç½‘ç»œ"],"title":"Kubernetesç½‘ç»œæ¦‚å¿µåŠç­–ç•¥æ§åˆ¶","uri":"/kubernetes-network-concept/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡ä»‹ç»äº†ç›‘æ§å’Œæ—¥å¿—çš„èƒŒæ™¯ä¿¡æ¯ã€ç›‘æ§æ–¹æ¡ˆçš„æ¼”è¿›ã€æ—¥å¿—é‡‡é›†çš„ä¸€äº›ç»†èŠ‚ä»¥åŠå¸¸è§çš„æ—¥å¿—çš„å¼€æºç³»ç»Ÿ","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"èƒŒæ™¯ç›‘æ§å’Œæ—¥å¿—æ˜¯å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿçš„é‡è¦åŸºç¡€è®¾æ–½ï¼Œç›‘æ§å¯ä»¥å¸®åŠ©å¼€å‘è€…æŸ¥çœ‹ç³»ç»Ÿçš„è¿è¡ŒçŠ¶æ€ï¼Œè€Œæ—¥å¿—å¯ä»¥ååŠ©é—®é¢˜çš„æ’æŸ¥å’Œè¯Šæ–­ã€‚ åœ¨ Kubernetes ä¸­ï¼Œç›‘æ§å’Œæ—¥å¿—å±äºç”Ÿæ€çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¹¶ä¸æ˜¯æ ¸å¿ƒç»„ä»¶ï¼Œå› æ­¤å¤§éƒ¨åˆ†çš„èƒ½åŠ›ä¾èµ–ä¸Šå±‚çš„äº‘å‚å•†çš„é€‚é…ã€‚Kubernetes å®šä¹‰äº†ä»‹å…¥çš„æ¥å£æ ‡å‡†å’Œè§„èŒƒï¼Œä»»ä½•ç¬¦åˆæ¥å£æ ‡å‡†çš„ç»„ä»¶éƒ½å¯ä»¥å¿«é€Ÿé›†æˆã€‚ ","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç›‘æ§","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç›‘æ§ç±»å‹ èµ„æºç›‘æ§ æ¯”è¾ƒå¸¸è§çš„åƒ CPUã€å†…å­˜ã€ç½‘ç»œè¿™ç§èµ„æºç±»çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œé€šå¸¸è¿™äº›æŒ‡æ ‡ä¼šä»¥æ•°å€¼ã€ç™¾åˆ†æ¯”çš„å•ä½è¿›è¡Œç»Ÿè®¡ï¼Œæ˜¯æœ€å¸¸è§çš„ä¸€ä¸ªç›‘æ§æ–¹å¼ã€‚è¿™ç§ç›‘æ§æ–¹å¼åœ¨å¸¸è§„çš„ç›‘æ§é‡Œé¢ï¼Œç±»ä¼¼é¡¹ç›® zabbix telegraphï¼Œè¿™äº›ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥åšåˆ°çš„ã€‚ æ€§èƒ½ç›‘æ§ æ€§èƒ½ç›‘æ§æŒ‡çš„å°±æ˜¯ APM ç›‘æ§ï¼Œä¹Ÿå°±æ˜¯è¯´å¸¸è§çš„ä¸€äº›åº”ç”¨æ€§èƒ½ç±»çš„ç›‘æ§æŒ‡æ ‡çš„æ£€æŸ¥ã€‚é€šå¸¸æ˜¯é€šè¿‡ä¸€äº› Hook çš„æœºåˆ¶åœ¨è™šæ‹Ÿæœºå±‚ã€å­—èŠ‚ç æ‰§è¡Œå±‚é€šè¿‡éšå¼è°ƒç”¨ï¼Œæˆ–è€…æ˜¯åœ¨åº”ç”¨å±‚æ˜¾ç¤ºæ³¨å…¥ï¼Œè·å–æ›´æ·±å±‚æ¬¡çš„ä¸€ä¸ªç›‘æ§æŒ‡æ ‡ï¼Œä¸€èˆ¬æ˜¯ç”¨æ¥åº”ç”¨çš„è°ƒä¼˜å’Œè¯Šæ–­çš„ã€‚æ¯”è¾ƒå¸¸è§çš„ç±»ä¼¼åƒ jvm æˆ–è€… php çš„ Zend Engineï¼Œé€šè¿‡ä¸€äº›å¸¸è§çš„ Hook æœºåˆ¶ï¼Œæ‹¿åˆ°ç±»ä¼¼åƒ jvm é‡Œé¢çš„ GC çš„æ¬¡æ•°ï¼Œå„ç§å†…å­˜ä»£çš„ä¸€ä¸ªåˆ†å¸ƒä»¥åŠç½‘ç»œè¿æ¥æ•°çš„ä¸€äº›æŒ‡æ ‡ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥è¿›è¡Œåº”ç”¨çš„æ€§èƒ½è¯Šæ–­å’Œè°ƒä¼˜ã€‚ å®‰å…¨ç›‘æ§ å®‰å…¨ç›‘æ§ä¸»è¦æ˜¯å¯¹å®‰å…¨è¿›è¡Œçš„ä¸€ç³»åˆ—çš„ç›‘æ§ç­–ç•¥ï¼Œç±»ä¼¼åƒè¶Šæƒç®¡ç†ã€å®‰å…¨æ¼æ´æ‰«æç­‰ç­‰ã€‚ äº‹ä»¶ç›‘æ§ ä»æ­£å¸¸çš„çŠ¶æ€è½¬æ¢æˆå¦ä¸€ä¸ªæ­£å¸¸çš„çŠ¶æ€çš„æ—¶å€™ï¼Œä¼šå‘ç”Ÿä¸€ä¸ª normal çš„äº‹ä»¶ï¼Œè€Œä»ä¸€ä¸ªæ­£å¸¸çŠ¶æ€è½¬æ¢æˆä¸€ä¸ªå¼‚å¸¸çŠ¶æ€çš„æ—¶å€™ï¼Œä¼šå‘ç”Ÿä¸€ä¸ª warning çš„äº‹ä»¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œwarning çš„äº‹ä»¶æ˜¯æˆ‘ä»¬æ¯”è¾ƒå…³å¿ƒçš„ï¼Œè€Œäº‹ä»¶ç›‘æ§å°±æ˜¯å¯ä»¥æŠŠ normal çš„äº‹ä»¶æˆ–è€…æ˜¯ warning äº‹ä»¶ç¦»çº¿åˆ°ä¸€ä¸ªæ•°æ®ä¸­å¿ƒï¼Œç„¶åé€šè¿‡æ•°æ®ä¸­å¿ƒçš„åˆ†æä»¥åŠæŠ¥è­¦ã€‚ ","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:2:1","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s ç›‘æ§æ¼”è¿›åœ¨æ—©æœŸï¼Œä¹Ÿå°±æ˜¯ 1.10 ä»¥å‰çš„ K8s ç‰ˆæœ¬ã€‚å¤§å®¶éƒ½ä¼šä½¿ç”¨ç±»ä¼¼åƒ Heapster è¿™æ ·çš„ç»„ä»¶æ¥å»è¿›è¡Œç›‘æ§çš„é‡‡é›†ï¼ŒHeapster çš„è®¾è®¡åŸç†å…¶å®ä¹Ÿæ¯”è¾ƒç®€å•ã€‚ Heapster é‡‡é›†å’Œæ¶ˆè´¹é“¾è·¯ é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨æ¯ä¸€ä¸ª Kubernetes ä¸Šé¢æœ‰ä¸€ä¸ªåŒ…è£¹å¥½çš„ cadvisorï¼Œè¿™ä¸ª cadvisor æ˜¯è´Ÿè´£æ•°æ®é‡‡é›†çš„ç»„ä»¶ã€‚å½“ cadvisor æŠŠæ•°æ®é‡‡é›†å®Œæˆï¼ŒKubernetes ä¼šæŠŠ cadvisor é‡‡é›†åˆ°çš„æ•°æ®è¿›è¡ŒåŒ…è£¹ï¼Œæš´éœ²æˆç›¸åº”çš„ APIã€‚åœ¨æ—©æœŸçš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯æœ‰ä¸‰ç§ä¸åŒçš„ APIï¼š summary æ¥å£ï¼› kubelet æ¥å£ï¼› Prometheus æ¥å£ï¼› è¿™ä¸‰ç§æ¥å£ï¼Œå…¶å®å¯¹åº”çš„æ•°æ®æºéƒ½æ˜¯ cadvisorï¼Œåªæ˜¯æ•°æ®æ ¼å¼æœ‰æ‰€ä¸åŒã€‚è€Œåœ¨ Heapster é‡Œé¢ï¼Œå…¶å®æ”¯æŒäº† summary æ¥å£å’Œ kubelet ä¸¤ç§æ•°æ®é‡‡é›†æ¥å£ï¼ŒHeapster ä¼šå®šæœŸå»æ¯ä¸€ä¸ªèŠ‚ç‚¹æ‹‰å–æ•°æ®ï¼Œåœ¨è‡ªå·±çš„å†…å­˜é‡Œé¢è¿›è¡Œèšåˆï¼Œç„¶åå†æš´éœ²ç›¸åº”çš„ serviceï¼Œä¾›ä¸Šå±‚çš„æ¶ˆè´¹è€…è¿›è¡Œä½¿ç”¨ã€‚åœ¨ K8s ä¸­æ¯”è¾ƒå¸¸è§çš„æ¶ˆè´¹è€…ï¼Œç±»ä¼¼åƒ dashboardï¼Œæˆ–è€…æ˜¯ HPA-Controllerï¼Œå®ƒé€šè¿‡è°ƒç”¨ service è·å–ç›¸åº”çš„ç›‘æ§æ•°æ®ï¼Œæ¥å®ç°ç›¸åº”çš„å¼¹æ€§ä¼¸ç¼©ï¼Œä»¥åŠç›‘æ§æ•°æ®çš„ä¸€ä¸ªå±•ç¤ºã€‚ è¿™ä¸ªæ˜¯ä»¥å‰çš„ä¸€ä¸ªæ•°æ®æ¶ˆè´¹é“¾è·¯ï¼Œè¿™æ¡æ¶ˆè´¹é“¾è·¯çœ‹ä¸Šå»å¾ˆæ¸…æ™°ï¼Œä¹Ÿæ²¡æœ‰å¤ªå¤šçš„ä¸€ä¸ªé—®é¢˜ï¼Œé‚£ä¸ºä»€ä¹ˆ Kubernetes ä¼šå°† Heapster æ”¾å¼ƒæ‰è€Œè½¬æ¢åˆ° metrics-service å‘¢ï¼Ÿå…¶å®è¿™ä¸ªä¸»è¦çš„ä¸€ä¸ªåŠ¨åŠ›æ¥æºæ˜¯ç”±äº Heapster åœ¨åšç›‘æ§æ•°æ®æ¥å£çš„æ ‡å‡†åŒ–ã€‚ä¸ºä»€ä¹ˆè¦åšç›‘æ§æ•°æ®æ¥å£æ ‡å‡†åŒ–å‘¢ï¼Ÿ ç¬¬ä¸€ç‚¹åœ¨äºå®¢æˆ·çš„éœ€æ±‚æ˜¯åƒå˜ä¸‡åŒ–çš„ï¼Œæ¯”å¦‚è¯´ä»Šå¤©ç”¨ Heapster è¿›è¡Œäº†åŸºç¡€æ•°æ®çš„ä¸€ä¸ªèµ„æºé‡‡é›†ï¼Œé‚£æ˜å¤©çš„æ—¶å€™ï¼Œæˆ‘æƒ³åœ¨åº”ç”¨é‡Œé¢æš´éœ²åœ¨çº¿äººæ•°çš„ä¸€ä¸ªæ•°æ®æ¥å£ï¼Œæ”¾åˆ°è‡ªå·±çš„æ¥å£ç³»ç»Ÿé‡Œè¿›è¡Œæ•°æ®çš„ä¸€ä¸ªå±•ç°ï¼Œä»¥åŠç±»ä¼¼åƒ HPA çš„ä¸€ä¸ªæ•°æ®æ¶ˆè´¹ã€‚é‚£è¿™ä¸ªåœºæ™¯åœ¨ Heapster ä¸‹èƒ½ä¸èƒ½åšå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸å¯ä»¥çš„ï¼Œæ‰€ä»¥è¿™å°±æ˜¯ Heapster è‡ªèº«æ‰©å±•æ€§çš„å¼Šç«¯ï¼› ç¬¬äºŒç‚¹æ˜¯ Heapster é‡Œé¢ä¸ºäº†ä¿è¯æ•°æ®çš„ç¦»çº¿èƒ½åŠ›ï¼Œæä¾›äº†å¾ˆå¤šçš„ sinkï¼Œè€Œè¿™ä¸ª sink åŒ…å«äº†ç±»ä¼¼åƒ influxdbã€slsã€é’‰é’‰ç­‰ç­‰ä¸€ç³»åˆ— sinkã€‚è¿™ä¸ª sink ä¸»è¦åšçš„æ˜¯æŠŠæ•°æ®é‡‡é›†ä¸‹æ¥ï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªæ•°æ®ç¦»çº¿èµ°ï¼Œç„¶åå¾ˆå¤šå®¢æˆ·ä¼šç”¨ influxdb åšè¿™ä¸ªæ•°æ®ç¦»çº¿ï¼Œåœ¨ influxdb ä¸Šå»æ¥å…¥ç±»ä¼¼åƒ grafana ç›‘æ§æ•°æ®çš„ä¸€ä¸ªå¯è§†åŒ–çš„è½¯ä»¶ï¼Œæ¥å®è·µç›‘æ§æ•°æ®çš„å¯è§†åŒ–ã€‚ ä½†æ˜¯åæ¥ç¤¾åŒºå‘ç°ï¼Œè¿™äº› sink å¾ˆå¤šæ—¶å€™éƒ½æ˜¯æ²¡æœ‰äººæ¥ç»´æŠ¤çš„ã€‚è¿™ä¹Ÿå¯¼è‡´æ•´ä¸ª Heapster çš„é¡¹ç›®æœ‰å¾ˆå¤šçš„ bugï¼Œè¿™ä¸ª bug ä¸€ç›´å­˜ç•™åœ¨ç¤¾åŒºé‡Œé¢ï¼Œæ˜¯æ²¡æœ‰äººä¿®å¤çš„ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ä¼šç»™ç¤¾åŒºçš„é¡¹ç›®çš„æ´»è·ƒåº¦åŒ…æ‹¬é¡¹ç›®çš„ç¨³å®šæ€§å¸¦æ¥äº†å¾ˆå¤šçš„æŒ‘æˆ˜ã€‚ åŸºäºè¿™ä¸¤ç‚¹åŸå› ï¼ŒK8s æŠŠ Heapster è¿›è¡Œäº† break æ‰ï¼Œç„¶ååšäº†ä¸€ä¸ªç²¾ç®€ç‰ˆçš„ç›‘æ§é‡‡é›†ç»„ä»¶ï¼Œå«åš metrics-serverã€‚ Heapster å†…éƒ¨ç»„æˆ ä¸Šå›¾æ˜¯ Heapster å†…éƒ¨çš„ä¸€ä¸ªæ¶æ„ã€‚å¤§å®¶å¯ä»¥å‘ç°å®ƒåˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼š ç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯ core éƒ¨åˆ†ï¼Œç„¶åä¸Šå±‚æ˜¯æœ‰ä¸€ä¸ªé€šè¿‡æ ‡å‡†çš„ http æˆ–è€… https æš´éœ²çš„è¿™ä¸ª APIã€‚ ç„¶åä¸­é—´æ˜¯ source çš„éƒ¨åˆ†ï¼Œsource éƒ¨åˆ†ç›¸å½“äºæ˜¯é‡‡é›†æ•°æ®æš´éœ²çš„ä¸åŒçš„æ¥å£ã€‚ ç„¶å processor çš„éƒ¨åˆ†æ˜¯è¿›è¡Œæ•°æ®è½¬æ¢ä»¥åŠæ•°æ®èšåˆçš„éƒ¨åˆ†ã€‚ æœ€åæ˜¯ sink éƒ¨åˆ†ï¼Œsink éƒ¨åˆ†æ˜¯è´Ÿè´£æ•°æ®ç¦»çº¿çš„ï¼Œè¿™ä¸ªæ˜¯æ—©æœŸçš„ Heapster çš„ä¸€ä¸ªåº”ç”¨çš„æ¶æ„ã€‚ é‚£åˆ°åæœŸçš„æ—¶å€™å‘¢ï¼ŒK8s åšäº†è¿™ä¸ªç›‘æ§æ¥å£çš„ä¸€ä¸ªæ ‡å‡†åŒ–ï¼Œé€æ¸å°±æŠŠ Heapster è¿›è¡Œäº†è£å‰ªï¼Œè½¬åŒ–æˆäº† metrics-serverã€‚ Metrics Server å†…éƒ¨ç»„æˆ ç›®å‰ 0.3.1 ç‰ˆæœ¬çš„ metrics-server å¤§è‡´çš„ä¸€ä¸ªç»“æ„å°±å˜æˆäº†ä¸Šå›¾è¿™æ ·ï¼Œæ˜¯éå¸¸ç®€å•çš„ï¼šæœ‰ä¸€ä¸ª core å±‚ã€ä¸­é—´çš„ source å±‚ï¼Œä»¥åŠç®€å•çš„ API å±‚ï¼Œé¢å¤–å¢åŠ äº† API Registration è¿™å±‚ã€‚è¿™å±‚çš„ä½œç”¨å°±æ˜¯å®ƒå¯ä»¥æŠŠç›¸åº”çš„æ•°æ®æ¥å£æ³¨å†Œåˆ° K8s çš„ API server ä¹‹ä¸Šï¼Œä»¥åå®¢æˆ·ä¸å†éœ€è¦é€šè¿‡è¿™ä¸ª API å±‚å»è®¿é—® metrics-serverï¼Œè€Œæ˜¯å¯ä»¥é€šè¿‡è¿™ä¸ª API æ³¨å†Œå±‚ï¼Œé€šè¿‡ API server è®¿é—® API æ³¨å†Œå±‚ï¼Œå†åˆ° metrics-serverã€‚è¿™æ ·çš„è¯ï¼ŒçœŸæ­£çš„æ•°æ®æ¶ˆè´¹æ–¹å¯èƒ½æ„ŸçŸ¥åˆ°çš„å¹¶ä¸æ˜¯ä¸€ä¸ª metrics-serverï¼Œè€Œæ˜¯è¯´æ„ŸçŸ¥åˆ°çš„æ˜¯å®ç°äº†è¿™æ ·ä¸€ä¸ª API çš„å…·ä½“çš„å®ç°ï¼Œè€Œè¿™ä¸ªå®ç°æ˜¯ metrics-serverã€‚è¿™ä¸ªå°±æ˜¯ metrics-server æ”¹åŠ¨æœ€å¤§çš„ä¸€ä¸ªåœ°æ–¹ã€‚ ","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:2:2","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s ç›‘æ§æ¥å£æ ‡å‡†åœ¨ K8s é‡Œé¢é’ˆå¯¹äºç›‘æ§ï¼Œæœ‰ä¸‰ç§ä¸åŒçš„æ¥å£æ ‡å‡†ã€‚å®ƒå°†ç›‘æ§çš„æ•°æ®æ¶ˆè´¹èƒ½åŠ›è¿›è¡Œäº†æ ‡å‡†åŒ–å’Œè§£è€¦ï¼Œå®ç°äº†ä¸€ä¸ªä¸ç¤¾åŒºçš„èåˆï¼Œç¤¾åŒºé‡Œé¢ä¸»è¦åˆ†ä¸ºä¸‰ç±»ã€‚ ç¬¬ä¸€ç±» Resource Metrice å¯¹åº”çš„æ¥å£æ˜¯ metrics.k8s.ioï¼Œä¸»è¦çš„å®ç°å°±æ˜¯ metrics-serverï¼Œå®ƒæä¾›çš„æ˜¯èµ„æºçš„ç›‘æ§ï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯èŠ‚ç‚¹çº§åˆ«ã€pod çº§åˆ«ã€namespace çº§åˆ«ã€class çº§åˆ«ã€‚è¿™ç±»çš„ç›‘æ§æŒ‡æ ‡éƒ½å¯ä»¥é€šè¿‡ metrics.k8s.io è¿™ä¸ªæ¥å£è·å–åˆ°ã€‚ ç¬¬äºŒç±» Custom Metrics å¯¹åº”çš„ API æ˜¯ custom.metrics.k8s.ioï¼Œä¸»è¦çš„å®ç°æ˜¯ Prometheusã€‚å®ƒæä¾›çš„æ˜¯èµ„æºç›‘æ§å’Œè‡ªå®šä¹‰ç›‘æ§ï¼Œèµ„æºç›‘æ§å’Œä¸Šé¢çš„èµ„æºç›‘æ§å…¶å®æ˜¯æœ‰è¦†ç›–å…³ç³»çš„ï¼Œè€Œè¿™ä¸ªè‡ªå®šä¹‰ç›‘æ§æŒ‡çš„æ˜¯ï¼šæ¯”å¦‚åº”ç”¨ä¸Šé¢æƒ³æš´éœ²ä¸€ä¸ªç±»ä¼¼åƒåœ¨çº¿äººæ•°ï¼Œæˆ–è€…è¯´è°ƒç”¨åé¢çš„è¿™ä¸ªæ•°æ®åº“çš„ MySQL çš„æ…¢æŸ¥è¯¢ã€‚è¿™äº›å…¶å®éƒ½æ˜¯å¯ä»¥åœ¨åº”ç”¨å±‚åšè‡ªå·±çš„å®šä¹‰çš„ï¼Œç„¶åå¹¶é€šè¿‡æ ‡å‡†çš„ Prometheus çš„ clientï¼Œæš´éœ²å‡ºç›¸åº”çš„ metricsï¼Œç„¶åå†è¢« Prometheus è¿›è¡Œé‡‡é›†ã€‚ è€Œè¿™ç±»çš„æ¥å£ä¸€æ—¦é‡‡é›†ä¸Šæ¥ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡ç±»ä¼¼åƒ custom.metrics.k8s.io è¿™æ ·ä¸€ä¸ªæ¥å£çš„æ ‡å‡†æ¥è¿›è¡Œæ•°æ®æ¶ˆè´¹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨å¦‚æœä»¥è¿™ç§æ–¹å¼æ¥å…¥çš„ Prometheusï¼Œé‚£ä½ å°±å¯ä»¥é€šè¿‡ custom.metrics.k8s.io è¿™ä¸ªæ¥å£æ¥è¿›è¡Œ HPAï¼Œè¿›è¡Œæ•°æ®æ¶ˆè´¹ã€‚ ç¬¬ä¸‰ç±» External Metrics External Metrics å…¶å®æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„ä¸€ç±»ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ K8s ç°åœ¨å·²ç»æˆä¸ºäº†äº‘åŸç”Ÿæ¥å£çš„ä¸€ä¸ªå®ç°æ ‡å‡†ã€‚å¾ˆå¤šæ—¶å€™åœ¨äº‘ä¸Šæ‰“äº¤é“çš„æ˜¯äº‘æœåŠ¡ï¼Œæ¯”å¦‚è¯´åœ¨ä¸€ä¸ªåº”ç”¨é‡Œé¢ç”¨åˆ°äº†å‰é¢çš„æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåé¢çš„æ˜¯ RBS æ•°æ®åº“ã€‚é‚£æœ‰æ—¶åœ¨è¿›è¡Œæ•°æ®æ¶ˆè´¹çš„æ—¶å€™ï¼ŒåŒæ—¶éœ€è¦å»æ¶ˆè´¹ä¸€äº›äº‘äº§å“çš„ç›‘æ§æŒ‡æ ‡ï¼Œç±»ä¼¼åƒæ¶ˆæ¯é˜Ÿåˆ—ä¸­æ¶ˆæ¯çš„æ•°ç›®ï¼Œæˆ–è€…æ˜¯æ¥å…¥å±‚ SLB çš„ connection æ•°ç›®ï¼ŒSLB ä¸Šå±‚çš„ 200 ä¸ªè¯·æ±‚æ•°ç›®ç­‰ç­‰ï¼Œè¿™äº›ç›‘æ§æŒ‡æ ‡ã€‚ é‚£æ€ä¹ˆå»æ¶ˆè´¹å‘¢ï¼Ÿä¹Ÿæ˜¯åœ¨ K8s é‡Œé¢å®ç°äº†ä¸€ä¸ªæ ‡å‡†ï¼Œå°±æ˜¯ external.metrics.k8s.ioã€‚ä¸»è¦çš„å®ç°å‚å•†å°±æ˜¯å„ä¸ªäº‘å‚å•†çš„ providerï¼Œé€šè¿‡è¿™ä¸ª provider å¯ä»¥é€šè¿‡äº‘èµ„æºçš„ç›‘æ§æŒ‡æ ‡ã€‚ ","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:2:3","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Promethues - å¼€æºç¤¾åŒºçš„ç›‘æ§â€œæ ‡å‡†â€æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„å¼€æºç¤¾åŒºé‡Œé¢çš„ç›‘æ§æ–¹æ¡ˆï¼Œå°±æ˜¯ Prometheusã€‚Prometheus ä¸ºä»€ä¹ˆè¯´æ˜¯å¼€æºç¤¾åŒºçš„ç›‘æ§æ ‡å‡†å‘¢ï¼Ÿ ä¸€æ˜¯å› ä¸ºé¦–å…ˆ Prometheus æ˜¯ CNCF äº‘åŸç”Ÿç¤¾åŒºçš„ä¸€ä¸ªæ¯•ä¸šé¡¹ç›®ã€‚ç„¶åç¬¬äºŒä¸ªæ˜¯ç°åœ¨æœ‰è¶Šæ¥è¶Šå¤šçš„å¼€æºé¡¹ç›®éƒ½ä»¥ Prometheus ä½œä¸ºç›‘æ§æ ‡å‡†ï¼Œç±»ä¼¼è¯´æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„ Sparkã€Tensorflowã€Flink è¿™äº›é¡¹ç›®ï¼Œå…¶å®å®ƒéƒ½æœ‰æ ‡å‡†çš„ Prometheus çš„é‡‡é›†æ¥å£ã€‚ ç¬¬äºŒä¸ªæ˜¯å¯¹äºç±»ä¼¼åƒæ¯”è¾ƒå¸¸è§çš„ä¸€äº›æ•°æ®åº“ã€ä¸­é—´ä»¶è¿™ç±»çš„é¡¹ç›®ï¼Œå®ƒéƒ½æœ‰ç›¸åº”çš„ Prometheus é‡‡é›†å®¢æˆ·ç«¯ã€‚ç±»ä¼¼åƒ ETCDã€zookeeperã€MySQL æˆ–è€…è¯´ PostgreSQLï¼Œè¿™äº›å…¶å®éƒ½æœ‰ç›¸åº”çš„è¿™ä¸ª Prometheus çš„æ¥å£ï¼Œå¦‚æœæ²¡æœ‰çš„ï¼Œç¤¾åŒºé‡Œé¢ä¹Ÿä¼šæœ‰ç›¸åº”çš„ exporter è¿›è¡Œæ¥å£çš„ä¸€ä¸ªå®ç°ã€‚ Promethues ä¸Šå›¾æ˜¯ Prometheus é‡‡é›†çš„æ•°æ®é“¾è·¯ï¼Œå®ƒä¸»è¦å¯ä»¥åˆ†ä¸ºä¸‰ç§ä¸åŒçš„æ•°æ®é‡‡é›†é“¾è·¯ã€‚ ç¬¬ä¸€ç§ï¼Œæ˜¯è¿™ä¸ª push çš„æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡ pushgateway è¿›è¡Œæ•°æ®é‡‡é›†ï¼Œç„¶åæ•°æ®çº¿åˆ° pushgatewayï¼Œç„¶å Prometheus å†é€šè¿‡ pull çš„æ–¹å¼å» pushgateway å»æ‹‰æ•°æ®ã€‚è¿™ç§é‡‡é›†æ–¹å¼ä¸»è¦åº”å¯¹çš„åœºæ™¯å°±æ˜¯ä½ çš„è¿™ä¸ªä»»åŠ¡å¯èƒ½æ˜¯æ¯”è¾ƒçŸ­æš‚çš„ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬çŸ¥é“ Prometheusï¼Œæœ€å¸¸è§çš„é‡‡é›†æ–¹å¼æ˜¯æ‹‰æ¨¡å¼ï¼Œé‚£å¸¦æ¥ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œä¸€æ—¦ä½ çš„æ•°æ®å£°æ˜å‘¨æœŸçŸ­äºæ•°æ®çš„é‡‡é›†å‘¨æœŸï¼Œæ¯”å¦‚æˆ‘é‡‡é›†å‘¨æœŸæ˜¯ 30sï¼Œè€Œæˆ‘è¿™ä¸ªä»»åŠ¡å¯èƒ½è¿è¡Œ 15s å°±å®Œäº†ã€‚è¿™ç§åœºæ™¯ä¹‹ä¸‹ï¼Œå¯èƒ½ä¼šé€ æˆæœ‰äº›æ•°æ®æ¼é‡‡ã€‚å¯¹äºè¿™ç§åœºæ™¯æœ€ç®€å•çš„ä¸€ä¸ªåšæ³•å°±æ˜¯å…ˆé€šè¿‡ pushgatewayï¼Œå…ˆæŠŠä½ çš„ metrics pushä¸‹æ¥ï¼Œç„¶åå†é€šè¿‡ pull çš„æ–¹å¼ä» pushgateway å»æ‹‰æ•°æ®ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥åšåˆ°ï¼ŒçŸ­æ—¶é—´çš„ä¸ä¸¢ä½œä¸šä»»åŠ¡ã€‚ ç¬¬äºŒç§æ˜¯æ ‡å‡†çš„ pull æ¨¡å¼ï¼Œå®ƒæ˜¯ç›´æ¥é€šè¿‡æ‹‰æ¨¡å¼å»å¯¹åº”çš„æ•°æ®çš„ä»»åŠ¡ä¸Šé¢å»æ‹‰å–æ•°æ®ã€‚ ç¬¬ä¸‰ç§æ˜¯ Prometheus on Prometheusï¼Œå°±æ˜¯å¯ä»¥é€šè¿‡å¦ä¸€ä¸ª Prometheus æ¥å»åŒæ­¥æ•°æ®åˆ°è¿™ä¸ª Prometheusã€‚ è¿™æ˜¯ä¸‰ç§ Prometheus ä¸­çš„é‡‡é›†æ–¹å¼ã€‚é‚£ä»æ•°æ®æºä¸Šé¢ï¼Œé™¤äº†æ ‡å‡†çš„é™æ€é…ç½®ï¼ŒPrometheus ä¹Ÿæ”¯æŒ service discoveryã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡ä¸€äº›æœåŠ¡å‘ç°çš„æœºåˆ¶ï¼ŒåŠ¨æ€åœ°å»å‘ç°ä¸€äº›é‡‡é›†å¯¹è±¡ã€‚åœ¨ K8s é‡Œé¢æ¯”è¾ƒå¸¸è§çš„æ˜¯å¯ä»¥æœ‰ Kubernetes çš„è¿™ç§åŠ¨æ€å‘ç°æœºåˆ¶ï¼Œåªéœ€è¦é…ç½®ä¸€äº› annotationï¼Œå®ƒå°±å¯ä»¥è‡ªåŠ¨åœ°æ¥é…ç½®é‡‡é›†ä»»åŠ¡æ¥è¿›è¡Œæ•°æ®é‡‡é›†ï¼Œæ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚ åœ¨æŠ¥è­¦ä¸Šé¢ï¼ŒPrometheus æä¾›äº†ä¸€ä¸ªå¤–ç½®ç»„ä»¶å« Alentmanagerï¼Œå®ƒå¯ä»¥å°†ç›¸åº”çš„æŠ¥è­¦ä¿¡æ¯é€šè¿‡é‚®ä»¶æˆ–è€…çŸ­ä¿¡çš„æ–¹å¼è¿›è¡Œæ•°æ®çš„ä¸€ä¸ªå‘Šè­¦ã€‚åœ¨æ•°æ®æ¶ˆè´¹ä¸Šé¢ï¼Œå¯ä»¥é€šè¿‡ä¸Šå±‚çš„ API clientsï¼Œå¯ä»¥é€šè¿‡ web UIï¼Œå¯ä»¥é€šè¿‡ Grafana è¿›è¡Œæ•°æ®çš„å±•ç°å’Œæ•°æ®çš„æ¶ˆè´¹ã€‚ æ€»ç»“èµ·æ¥ Prometheus æœ‰å¦‚ä¸‹äº”ä¸ªç‰¹ç‚¹ï¼š ç¬¬ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯ç®€ä»‹å¼ºå¤§çš„æ¥å…¥æ ‡å‡†ï¼Œå¼€å‘è€…åªéœ€è¦å®ç° Prometheus Client è¿™æ ·ä¸€ä¸ªæ¥å£æ ‡å‡†ï¼Œå°±å¯ä»¥ç›´æ¥å®ç°æ•°æ®çš„ä¸€ä¸ªé‡‡é›†ï¼› ç¬¬äºŒç§å°±æ˜¯å¤šç§çš„æ•°æ®é‡‡é›†ã€ç¦»çº¿çš„æ–¹å¼ã€‚å¯ä»¥é€šè¿‡ push çš„æ–¹å¼ã€ pull çš„æ–¹å¼ã€Prometheus on Prometheusçš„æ–¹å¼æ¥è¿›è¡Œæ•°æ®çš„é‡‡é›†å’Œç¦»çº¿ï¼› ç¬¬ä¸‰ç§å°±æ˜¯å’Œ K8s çš„å…¼å®¹ï¼› ç¬¬å››ç§å°±æ˜¯ä¸°å¯Œçš„æ’ä»¶æœºåˆ¶ä¸ç”Ÿæ€ï¼› ç¬¬äº”ä¸ªæ˜¯ Prometheus Operator çš„ä¸€ä¸ªåŠ©åŠ›ï¼ŒPrometheus Operator å¯èƒ½æ˜¯ç›®å‰æˆ‘ä»¬è§åˆ°çš„æ‰€æœ‰ Operator é‡Œé¢åšçš„æœ€å¤æ‚çš„ï¼Œä½†æ˜¯å®ƒé‡Œé¢ä¹Ÿæ˜¯æŠŠ Prometheus è¿™ç§åŠ¨æ€èƒ½åŠ›åšåˆ°æ·‹æ¼“å°½è‡´çš„ä¸€ä¸ª Operatorï¼Œå¦‚æœåœ¨ K8s é‡Œé¢ä½¿ç”¨ Prometheusï¼Œæ¯”è¾ƒæ¨èå¤§å®¶ä½¿ç”¨ Prometheus Operator çš„æ–¹å¼æ¥å»è¿›è¡Œéƒ¨ç½²å’Œè¿ç»´ã€‚ ","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:2:4","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ—¥å¿—","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ—¥å¿—çš„åœºæ™¯1. ä¸»æœºå†…æ ¸çš„æ—¥å¿— ç¬¬ä¸€ä¸ªæ˜¯ä¸»æœºå†…æ ¸çš„æ—¥å¿—ï¼Œä¸»æœºå†…æ ¸æ—¥å¿—å¯ä»¥ååŠ©å¼€å‘è€…è¿›è¡Œä¸€äº›å¸¸è§çš„é—®é¢˜ä¸è¯Šæ–­ï¼Œæ¯”å¦‚è¯´ç½‘æ ˆçš„å¼‚å¸¸ï¼Œç±»ä¼¼åƒæˆ‘ä»¬çš„ iptables markï¼Œå®ƒå¯ä»¥çœ‹åˆ°æœ‰ controller table è¿™æ ·çš„ä¸€äº› messageï¼› ç¬¬äºŒä¸ªæ˜¯é©±åŠ¨å¼‚å¸¸ï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯ä¸€äº›ç½‘ç»œæ–¹æ¡ˆé‡Œé¢æœ‰çš„æ—¶å€™å¯èƒ½ä¼šå‡ºç°é©±åŠ¨å¼‚å¸¸ï¼Œæˆ–è€…è¯´æ˜¯ç±»ä¼¼ GPU çš„ä¸€äº›åœºæ™¯ï¼Œé©±åŠ¨å¼‚å¸¸å¯èƒ½æ˜¯æ¯”è¾ƒå¸¸è§çš„ä¸€äº›é”™è¯¯ï¼› ç¬¬ä¸‰ä¸ªå°±æ˜¯æ–‡ä»¶ç³»ç»Ÿå¼‚å¸¸ï¼Œåœ¨æ—©æœŸ docker è¿˜ä¸æ˜¯å¾ˆæˆç†Ÿçš„åœºæ™¯ä¹‹ä¸‹ï¼Œoverlayfs æˆ–è€…æ˜¯ AUFSï¼Œå®é™…ä¸Šæ˜¯ä¼šç»å¸¸å‡ºç°é—®é¢˜çš„ã€‚åœ¨è¿™äº›å‡ºç°é—®é¢˜åï¼Œå¼€å‘è€…æ˜¯æ²¡æœ‰å¤ªå¥½çš„åŠæ³•æ¥å»è¿›è¡Œç›‘æ§å’Œè¯Šæ–­çš„ã€‚è¿™ä¸€éƒ¨åˆ†ï¼Œå…¶å®æ˜¯å¯ä»¥ä¸»æœºå†…æ ¸æ—¥å¿—é‡Œé¢æ¥æŸ¥çœ‹åˆ°ä¸€äº›å¼‚å¸¸ï¼› å†å¾€ä¸‹æ˜¯å½±å“èŠ‚ç‚¹çš„ä¸€äº›å¼‚å¸¸ï¼Œæ¯”å¦‚è¯´å†…æ ¸é‡Œé¢çš„ä¸€äº› kernel panicï¼Œæˆ–è€…æ˜¯ä¸€äº› OOMï¼Œè¿™äº›ä¹Ÿä¼šåœ¨ä¸»æœºæ—¥å¿—é‡Œé¢æœ‰ç›¸åº”çš„ä¸€äº›åæ˜ ã€‚ 2. Runtime çš„æ—¥å¿— ç¬¬äºŒä¸ªæ˜¯ runtime çš„æ—¥å¿—ï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯ Docker çš„ä¸€äº›æ—¥å¿—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ docker çš„æ—¥å¿—æ¥æ’æŸ¥ç±»ä¼¼åƒåˆ é™¤ä¸€äº› Pod Hang è¿™ä¸€ç³»åˆ—çš„é—®é¢˜ã€‚ 3. æ ¸å¿ƒç»„ä»¶çš„æ—¥å¿— ç¬¬ä¸‰ä¸ªæ˜¯æ ¸å¿ƒç»„ä»¶çš„æ—¥å¿—ï¼Œåœ¨ K8s é‡Œé¢æ ¸å¿ƒç»„ä»¶åŒ…å«äº†ç±»ä¼¼åƒä¸€äº›å¤–ç½®çš„ä¸­é—´ä»¶ï¼Œç±»ä¼¼åƒ etcdï¼Œæˆ–è€…åƒä¸€äº›å†…ç½®çš„ç»„ä»¶ï¼Œç±»ä¼¼åƒ API serverã€kube-schedulerã€controller-mangerã€kubelet ç­‰ç­‰è¿™ä¸€ç³»åˆ—çš„ç»„ä»¶ã€‚è€Œè¿™äº›ç»„ä»¶çš„æ—¥å¿—å¯ä»¥å¸®æˆ‘ä»¬æ¥çœ‹åˆ°æ•´ä¸ª K8s é›†ç¾¤é‡Œé¢ç®¡æ§é¢çš„ä¸€ä¸ªèµ„æºçš„ä½¿ç”¨é‡ï¼Œç„¶åä»¥åŠç›®å‰è¿è¡Œçš„ä¸€ä¸ªçŠ¶æ€æ˜¯å¦æœ‰ä¸€äº›å¼‚å¸¸ã€‚ è¿˜æœ‰çš„å°±æ˜¯ç±»ä¼¼åƒä¸€äº›æ ¸å¿ƒçš„ä¸­é—´ä»¶ï¼Œå¦‚ Ingress è¿™ç§ç½‘ç»œä¸­é—´ä»¶ï¼Œå®ƒå¯ä»¥å¸®æˆ‘ä»¬æ¥çœ‹åˆ°æ•´ä¸ªçš„ä¸€ä¸ªæ¥å…¥å±‚çš„ä¸€ä¸ªæµé‡ï¼Œé€šè¿‡ Ingress çš„æ—¥å¿—ï¼Œå¯ä»¥åšåˆ°ä¸€ä¸ªå¾ˆå¥½çš„æ¥å…¥å±‚çš„ä¸€ä¸ªåº”ç”¨åˆ†æã€‚ 4. éƒ¨ç½²åº”ç”¨çš„æ—¥å¿— æœ€åæ˜¯éƒ¨ç½²åº”ç”¨çš„æ—¥å¿—ï¼Œå¯ä»¥é€šè¿‡åº”ç”¨çš„æ—¥å¿—æ¥æŸ¥çœ‹ä¸šåŠ¡å±‚çš„ä¸€ä¸ªçŠ¶æ€ã€‚æ¯”å¦‚è¯´å¯ä»¥çœ‹ä¸šåŠ¡å±‚æœ‰æ²¡æœ‰ 500 çš„è¯·æ±‚ï¼Ÿæœ‰æ²¡æœ‰ä¸€äº› panicï¼Ÿæœ‰æ²¡æœ‰ä¸€äº›å¼‚å¸¸çš„é”™è¯¯çš„è®¿é—®ï¼Ÿé‚£è¿™äº›å…¶å®éƒ½å¯ä»¥é€šè¿‡åº”ç”¨æ—¥å¿—æ¥è¿›è¡ŒæŸ¥çœ‹çš„ã€‚ ","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ—¥å¿—çš„é‡‡é›† Logging é¦–å…ˆæ˜¯å®¿ä¸»æœºæ–‡ä»¶ï¼Œè¿™ç§åœºæ™¯æ¯”è¾ƒå¸¸è§çš„æ˜¯è¯´æˆ‘çš„è¿™ä¸ªå®¹å™¨é‡Œé¢ï¼Œé€šè¿‡ç±»ä¼¼åƒ volumeï¼ŒæŠŠæ—¥å¿—æ–‡ä»¶å†™åˆ°äº†å®¿ä¸»æœºä¹‹ä¸Šã€‚é€šè¿‡å®¿ä¸»æœºçš„æ—¥å¿—è½®è½¬çš„ç­–ç•¥è¿›è¡Œæ—¥å¿—çš„è½®è½¬ï¼Œç„¶åå†é€šè¿‡æˆ‘çš„å®¿ä¸»æœºä¸Šçš„è¿™ä¸ª agent è¿›è¡Œé‡‡é›†ï¼› ç¬¬äºŒç§æ˜¯å®¹å™¨å†…æœ‰æ—¥å¿—æ–‡ä»¶ï¼Œé‚£è¿™ç§å¸¸è§æ–¹å¼æ€ä¹ˆå¤„ç†å‘¢ï¼Œæ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªæ–¹å¼æ˜¯è¯´æˆ‘é€šè¿‡ä¸€ä¸ª Sidecar çš„ streaming çš„ containerï¼Œè½¬å†™åˆ° stdoutï¼Œé€šè¿‡ stdout å†™åˆ°ç›¸åº”çš„ log-fileï¼Œç„¶åå†é€šè¿‡æœ¬åœ°çš„ä¸€ä¸ªæ—¥å¿—è½®è½¬ï¼Œç„¶åä»¥åŠå¤–éƒ¨çš„ä¸€ä¸ª agent é‡‡é›†ï¼› ç¬¬ä¸‰ç§æˆ‘ä»¬ç›´æ¥å†™åˆ° stdoutï¼Œè¿™ç§æ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªç­–ç•¥ï¼Œç¬¬ä¸€ç§å°±æ˜¯ç›´æ¥æˆ‘æ‹¿è¿™ä¸ª agent å»é‡‡é›†åˆ°è¿œç«¯ï¼Œç¬¬äºŒç§æˆ‘ç›´æ¥é€šè¿‡ç±»ä¼¼åƒä¸€äº› sls çš„æ ‡å‡† API é‡‡é›†åˆ°è¿œç«¯ã€‚ é‚£ç¤¾åŒºé‡Œé¢å…¶å®æ¯”è¾ƒæ¨èçš„æ˜¯ä½¿ç”¨ Fluentd çš„ä¸€ä¸ªé‡‡é›†æ–¹æ¡ˆï¼ŒFluentd æ˜¯åœ¨æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šé¢éƒ½ä¼šèµ·ç›¸åº”çš„ agentï¼Œç„¶åè¿™ä¸ª agent ä¼šæŠŠæ•°æ®æ±‡é›†åˆ°ä¸€ä¸ª Fluentd çš„ä¸€ä¸ª serverï¼Œè¿™ä¸ª server é‡Œé¢å¯ä»¥å°†æ•°æ®ç¦»çº¿åˆ°ç›¸åº”çš„ç±»ä¼¼åƒ elasticsearchï¼Œç„¶åå†é€šè¿‡ kibana åšå±•ç°ï¼›æˆ–è€…æ˜¯ç¦»çº¿åˆ° influxdbï¼Œç„¶åé€šè¿‡ Grafana åšå±•ç°ã€‚è¿™ä¸ªå…¶å®æ˜¯ç¤¾åŒºé‡Œç›®å‰æ¯”è¾ƒæ¨èçš„ä¸€ä¸ªåšæ³•ã€‚ ","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ€»ç»“ é¦–å…ˆä¸»è¦ä¸ºå¤§å®¶ä»‹ç»äº†ç›‘æ§ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šå››ç§å®¹å™¨åœºæ™¯ä¸‹çš„å¸¸è§çš„ç›‘æ§æ–¹å¼ï¼›Kubernetes çš„ç›‘æ§æ¼”è¿›å’Œæ¥å£æ ‡å‡†ï¼›ä¸¤ç§å¸¸ç”¨çš„æ¥æºçš„ç›‘æ§æ–¹æ¡ˆï¼› åœ¨æ—¥å¿—ä¸Šæˆ‘ä»¬ä¸»è¦ä»‹ç»äº†å››ç§ä¸åŒçš„åœºæ™¯ï¼Œä»‹ç»äº† Fluentd çš„ä¸€ä¸ªé‡‡é›†æ–¹æ¡ˆã€‚ ","date":"2021-08-15","objectID":"/kubernetes-monitor-and-log/:4:0","tags":["äº‘åŸç”Ÿ","Kubernetes","ç›‘æ§","æ—¥å¿—","é—®é¢˜è¯Šæ–­"],"title":"Kubernetes ç›‘æ§ä¸æ—¥å¿—","uri":"/kubernetes-monitor-and-log/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡ä»‹ç»äº† K8s Liveness å’Œ Readiness çš„ä½¿ç”¨æ–¹å¼ã€å¸¸è§é—®é¢˜çš„è¯Šæ–­ã€è¿œç¨‹è°ƒè¯•çš„æ–¹å¼","date":"2021-08-07","objectID":"/kubernetes-debug/","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"éœ€æ±‚æ¥æºé¦–å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œæ•´ä¸ªéœ€æ±‚çš„æ¥æºï¼šå½“æŠŠåº”ç”¨è¿ç§»åˆ° Kubernetes ä¹‹åï¼Œè¦å¦‚ä½•å»ä¿éšœåº”ç”¨çš„å¥åº·ä¸ç¨³å®šå‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢æ¥è¿›è¡Œå¢å¼ºï¼š é¦–å…ˆæ˜¯æé«˜åº”ç”¨çš„å¯è§‚æµ‹æ€§ï¼› ç¬¬äºŒæ˜¯æé«˜åº”ç”¨çš„å¯æ¢å¤èƒ½åŠ›ã€‚ ä»å¯è§‚æµ‹æ€§ä¸Šæ¥è®²ï¼Œå¯ä»¥åœ¨ä¸‰ä¸ªæ–¹é¢æ¥å»åšå¢å¼ºï¼š é¦–å…ˆæ˜¯åº”ç”¨çš„å¥åº·çŠ¶æ€ä¸Šé¢ï¼Œå¯ä»¥å®æ—¶åœ°è¿›è¡Œè§‚æµ‹ï¼› ç¬¬äºŒä¸ªæ˜¯å¯ä»¥è·å–åº”ç”¨çš„èµ„æºä½¿ç”¨æƒ…å†µï¼› ç¬¬ä¸‰ä¸ªæ˜¯å¯ä»¥æ‹¿åˆ°åº”ç”¨çš„å®æ—¶æ—¥å¿—ï¼Œè¿›è¡Œé—®é¢˜çš„è¯Šæ–­ä¸åˆ†æã€‚ å½“å‡ºç°äº†é—®é¢˜ä¹‹åï¼Œé¦–å…ˆè¦åšçš„äº‹æƒ…æ˜¯è¦é™ä½å½±å“çš„èŒƒå›´ï¼Œè¿›è¡Œé—®é¢˜çš„è°ƒè¯•ä¸è¯Šæ–­ã€‚æœ€åå½“å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œç†æƒ³çš„çŠ¶å†µæ˜¯ï¼šå¯ä»¥é€šè¿‡å’Œ K8s é›†æˆçš„è‡ªæ„ˆæœºåˆ¶è¿›è¡Œå®Œæ•´çš„æ¢å¤ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Liveness ä¸ Readiness","date":"2021-08-07","objectID":"/kubernetes-debug/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"åˆè¯† Liveness ä¸ ReadinessLiveness probe ä¹Ÿå«å°±ç»ªæŒ‡é’ˆï¼Œç”¨æ¥åˆ¤æ–­ä¸€ä¸ª pod æ˜¯å¦å¤„åœ¨å°±ç»ªçŠ¶æ€ã€‚å½“ä¸€ä¸ª pod å¤„åœ¨å°±ç»ªçŠ¶æ€çš„æ—¶å€™ï¼Œå®ƒæ‰èƒ½å¤Ÿå¯¹å¤–æä¾›ç›¸åº”çš„æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ¥å…¥å±‚çš„æµé‡æ‰èƒ½æ‰“åˆ°ç›¸åº”çš„ podã€‚å½“è¿™ä¸ª pod ä¸å¤„åœ¨å°±ç»ªçŠ¶æ€çš„æ—¶å€™ï¼Œæ¥å…¥å±‚ä¼šæŠŠç›¸åº”çš„æµé‡ä»è¿™ä¸ª pod ä¸Šé¢è¿›è¡Œæ‘˜é™¤ã€‚ æ¥çœ‹ä¸€ä¸‹ç®€å•çš„ä¸€ä¸ªä¾‹å­ï¼š å¦‚ä¸‹å›¾å…¶å®å°±æ˜¯ä¸€ä¸ª Readiness å°±ç»ªçš„ä¸€ä¸ªä¾‹å­ï¼š Readiness Probe Ready å½“è¿™ä¸ª pod æŒ‡é’ˆåˆ¤æ–­ä¸€ç›´å¤„åœ¨å¤±è´¥çŠ¶æ€çš„æ—¶å€™ï¼Œå…¶å®æ¥å…¥å±‚çš„æµé‡ä¸ä¼šæ‰“åˆ°ç°åœ¨è¿™ä¸ª pod ä¸Šã€‚ Readiness Probe Fail å½“è¿™ä¸ª pod çš„çŠ¶æ€ä» FAIL çš„çŠ¶æ€è½¬æ¢æˆ success çš„çŠ¶æ€æ—¶ï¼Œå®ƒæ‰èƒ½å¤ŸçœŸå®åœ°æ‰¿è½½è¿™ä¸ªæµé‡ã€‚ Liveness æŒ‡é’ˆä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œå®ƒæ˜¯å­˜æ´»æŒ‡é’ˆï¼Œç”¨æ¥åˆ¤æ–­ä¸€ä¸ª pod æ˜¯å¦å¤„åœ¨å­˜æ´»çŠ¶æ€ã€‚å½“ä¸€ä¸ª pod å¤„åœ¨ä¸å­˜æ´»çŠ¶æ€çš„æ—¶å€™ï¼Œä¼šå‡ºç°ä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿ Liveness Probe Fail è¿™ä¸ªæ—¶å€™ä¼šç”±ä¸Šå±‚çš„åˆ¤æ–­æœºåˆ¶æ¥åˆ¤æ–­è¿™ä¸ª pod æ˜¯å¦éœ€è¦è¢«é‡æ–°æ‹‰èµ·ã€‚é‚£å¦‚æœä¸Šå±‚é…ç½®çš„é‡å¯ç­–ç•¥æ˜¯ restart always çš„è¯ï¼Œé‚£ä¹ˆæ­¤æ—¶è¿™ä¸ª pod ä¼šç›´æ¥è¢«é‡æ–°æ‹‰èµ·ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:2:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä½¿ç”¨æ–¹å¼æ¢æµ‹æ–¹å¼Liveness æŒ‡é’ˆå’Œ Readiness æŒ‡é’ˆæ”¯æŒä¸‰ç§ä¸åŒçš„æ¢æµ‹æ–¹å¼ï¼š ç¬¬ä¸€ç§æ˜¯ httpGetã€‚å®ƒæ˜¯é€šè¿‡å‘é€ http Get è¯·æ±‚æ¥è¿›è¡Œåˆ¤æ–­çš„ï¼Œå½“è¿”å›ç æ˜¯ 200-399 ä¹‹é—´çš„çŠ¶æ€ç æ—¶ï¼Œæ ‡è¯†è¿™ä¸ªåº”ç”¨æ˜¯å¥åº·çš„ï¼› ç¬¬äºŒç§æ¢æµ‹æ–¹å¼æ˜¯ Execã€‚å®ƒæ˜¯é€šè¿‡æ‰§è¡Œå®¹å™¨ä¸­çš„ä¸€ä¸ªå‘½ä»¤æ¥åˆ¤æ–­å½“å‰çš„æœåŠ¡æ˜¯å¦æ˜¯æ­£å¸¸çš„ï¼Œå½“å‘½ä»¤è¡Œçš„è¿”å›ç»“æœæ˜¯ 0ï¼Œåˆ™æ ‡è¯†å®¹å™¨æ˜¯å¥åº·çš„ï¼› ç¬¬ä¸‰ç§æ¢æµ‹æ–¹å¼æ˜¯ tcpSocketã€‚å®ƒæ˜¯é€šè¿‡æ¢æµ‹å®¹å™¨çš„ IP å’Œ Port è¿›è¡Œ TCP å¥åº·æ£€æŸ¥ï¼Œå¦‚æœè¿™ä¸ª TCP çš„é“¾æ¥èƒ½å¤Ÿæ­£å¸¸è¢«å»ºç«‹ï¼Œé‚£ä¹ˆæ ‡è¯†å½“å‰è¿™ä¸ªå®¹å™¨æ˜¯å¥åº·çš„ã€‚ æ¢æµ‹ç»“æœä»æ¢æµ‹ç»“æœæ¥è®²ä¸»è¦åˆ†ä¸ºä¸‰ç§ï¼š ç¬¬ä¸€ç§æ˜¯ successï¼Œå½“çŠ¶æ€æ˜¯ success çš„æ—¶å€™ï¼Œè¡¨ç¤º container é€šè¿‡äº†å¥åº·æ£€æŸ¥ï¼Œä¹Ÿå°±æ˜¯ Liveness probe æˆ– Readiness probe æ˜¯æ­£å¸¸çš„ä¸€ä¸ªçŠ¶æ€ï¼› ç¬¬äºŒç§æ˜¯ Failureï¼ŒFailure è¡¨ç¤ºçš„æ˜¯è¿™ä¸ª container æ²¡æœ‰é€šè¿‡å¥åº·æ£€æŸ¥ï¼Œå¦‚æœæ²¡æœ‰é€šè¿‡å¥åº·æ£€æŸ¥çš„è¯ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ä¼šè¿›è¡Œç›¸åº”çš„ä¸€ä¸ªå¤„ç†ï¼Œé‚£åœ¨ Readiness å¤„ç†çš„ä¸€ä¸ªæ–¹å¼å°±æ˜¯é€šè¿‡ serviceã€‚service å±‚å°†æ²¡æœ‰é€šè¿‡ Readiness çš„ pod è¿›è¡Œæ‘˜é™¤ï¼Œè€Œ Liveness å°±æ˜¯å°†è¿™ä¸ª pod è¿›è¡Œé‡æ–°æ‹‰èµ·ï¼Œæˆ–è€…æ˜¯åˆ é™¤ã€‚ ç¬¬ä¸‰ç§çŠ¶æ€æ˜¯ Unknownï¼ŒUnknown æ˜¯è¡¨ç¤ºè¯´å½“å‰çš„æ‰§è¡Œçš„æœºåˆ¶æ²¡æœ‰è¿›è¡Œå®Œæ•´çš„ä¸€ä¸ªæ‰§è¡Œï¼Œå¯èƒ½æ˜¯å› ä¸ºç±»ä¼¼åƒè¶…æ—¶æˆ–è€…åƒä¸€äº›è„šæœ¬æ²¡æœ‰åŠæ—¶è¿”å›ï¼Œé‚£ä¹ˆæ­¤æ—¶ Readiness-probe æˆ– Liveness-probe ä¼šä¸åšä»»ä½•çš„ä¸€ä¸ªæ“ä½œï¼Œä¼šç­‰å¾…ä¸‹ä¸€æ¬¡çš„æœºåˆ¶æ¥è¿›è¡Œæ£€éªŒã€‚ é‚£åœ¨ kubelet é‡Œé¢æœ‰ä¸€ä¸ªå« ProbeManager çš„ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶é‡Œé¢ä¼šåŒ…å« Liveness-probe æˆ– Readiness-probeï¼Œè¿™ä¸¤ä¸ª probe ä¼šå°†ç›¸åº”çš„ Liveness è¯Šæ–­å’Œ Readiness è¯Šæ–­ä½œç”¨åœ¨ pod ä¹‹ä¸Šï¼Œæ¥å®ç°ä¸€ä¸ªå…·ä½“çš„åˆ¤æ–­ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:2:2","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Pod Probe Specä¸‹é¢ä»‹ç»è¿™ä¸‰ç§æ–¹å¼ä¸åŒçš„æ£€æµ‹æ–¹å¼çš„ä¸€ä¸ª yaml æ–‡ä»¶çš„ä½¿ç”¨ã€‚ é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹ execï¼Œexec çš„ä½¿ç”¨å…¶å®éå¸¸ç®€å•ã€‚å¦‚ä¸‹YAMLæ‰€ç¤ºï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ª Liveness probeï¼Œå®ƒé‡Œé¢é…ç½®äº†ä¸€ä¸ª exec çš„ä¸€ä¸ªè¯Šæ–­ã€‚æ¥ä¸‹æ¥ï¼Œå®ƒåˆé…ç½®äº†ä¸€ä¸ª command çš„å­—æ®µï¼Œè¿™ä¸ª command å­—æ®µé‡Œé¢é€šè¿‡ cat ä¸€ä¸ªå…·ä½“çš„æ–‡ä»¶æ¥åˆ¤æ–­å½“å‰ Liveness probe çš„çŠ¶æ€ï¼Œå½“è¿™ä¸ªæ–‡ä»¶é‡Œé¢è¿”å›çš„ç»“æœæ˜¯ 0 æ—¶ï¼Œæˆ–è€…è¯´è¿™ä¸ªå‘½ä»¤è¿”å›æ˜¯ 0 æ—¶ï¼Œå®ƒä¼šè®¤ä¸ºæ­¤æ—¶è¿™ä¸ª pod æ˜¯å¤„åœ¨å¥åº·çš„ä¸€ä¸ªçŠ¶æ€ã€‚ apiVersion:v1kind:Podmetadata:labels:test:livenessname:liveness-execspec:containers:- name:livenessimage:k8s.gcr.io/busyboxargs:- /bin/sh- -c- touch /tmp/healthy:sleep 30; rm -rf /tmp/healthy; sleep 600livenessProbe:exec:command:- cat- /tmp/healthyinitialDelaySeconds:5periodSeconds:5 é‚£å†æ¥çœ‹ä¸€ä¸‹è¿™ä¸ª httpGetï¼ŒhttpGet é‡Œé¢æœ‰ä¸€ä¸ªå­—æ®µæ˜¯è·¯å¾„ï¼Œç¬¬äºŒä¸ªå­—æ®µæ˜¯ portï¼Œç¬¬ä¸‰ä¸ªæ˜¯ headersã€‚è¿™ä¸ªåœ°æ–¹æœ‰æ—¶éœ€è¦é€šè¿‡ç±»ä¼¼åƒ header å¤´çš„ä¸€ä¸ªæœºåˆ¶åš health çš„ä¸€ä¸ªåˆ¤æ–­æ—¶ï¼Œéœ€è¦é…ç½®è¿™ä¸ª headerï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œå¯èƒ½åªéœ€è¦é€šè¿‡ health å’Œ port çš„æ–¹å¼å°±å¯ä»¥äº†ã€‚ apiVersion:v1kind:Podmetadata:labels:test:livenessname:liveness-httpspec:containers:- name:livenessimage:k8s.gcr.io/livenessargs:- /serverlivenessProbe:httpGet:path:/healthzport:8080httpHeaders:- name:Custom-Headervalue:AwesomeinitialDelaySeconds:3periodSeconds:3 ç¬¬ä¸‰ç§æ˜¯ tcpSocketï¼ŒtcpSocket çš„ä½¿ç”¨æ–¹å¼å…¶å®ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä½ åªéœ€è¦è®¾ç½®ä¸€ä¸ªæ£€æµ‹çš„ç«¯å£ï¼Œåƒè¿™ä¸ªä¾‹å­é‡Œé¢ä½¿ç”¨çš„æ˜¯ 8080 ç«¯å£ï¼Œå½“è¿™ä¸ª 8080 ç«¯å£ tcp connect å®¡æ ¸æ­£å¸¸è¢«å»ºç«‹çš„æ—¶å€™ï¼Œé‚£ tecSocketï¼ŒProbe ä¼šè®¤ä¸ºæ˜¯å¥åº·çš„ä¸€ä¸ªçŠ¶æ€ã€‚ apiVersion:v1kind:Podmetadata:labels:app:goproxyname:goproxyspec:containers:- name:goproxyimage:k8s.gcr.io/goproxy:0.1ports:- containerPort:8080readinessProbe:tcpSocket:port:8080initialDelaySeconds:5periodSeconds:10livenessProbe:tcpSocket:port:8080initialDelaySeconds:15periodSeconds:20 æ­¤å¤–è¿˜æœ‰å¦‚ä¸‹çš„äº”ä¸ªå‚æ•°ï¼Œæ˜¯ Global çš„å‚æ•°ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°å« initialDelaySecondsï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯è¯´è¿™ä¸ª pod å¯åŠ¨å»¶è¿Ÿå¤šä¹…è¿›è¡Œä¸€æ¬¡æ£€æŸ¥ï¼Œæ¯”å¦‚è¯´ç°åœ¨æœ‰ä¸€ä¸ª Java çš„åº”ç”¨ï¼Œå®ƒå¯åŠ¨çš„æ—¶é—´å¯èƒ½ä¼šæ¯”è¾ƒé•¿ï¼Œå› ä¸ºæ¶‰åŠåˆ° jvm çš„å¯åŠ¨ï¼ŒåŒ…æ‹¬ Java è‡ªèº« jar çš„åŠ è½½ã€‚æ‰€ä»¥å‰æœŸï¼Œå¯èƒ½æœ‰ä¸€æ®µæ—¶é—´æ˜¯æ²¡æœ‰åŠæ³•è¢«æ£€æµ‹çš„ï¼Œè€Œè¿™ä¸ªæ—¶é—´åˆæ˜¯å¯é¢„æœŸçš„ï¼Œé‚£è¿™æ—¶å¯èƒ½è¦è®¾ç½®ä¸€ä¸‹ initialDelaySecondsï¼› ç¬¬äºŒä¸ªæ˜¯ periodSecondsï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æ£€æµ‹çš„æ—¶é—´é—´éš”ï¼Œæ­£å¸¸é»˜è®¤çš„è¿™ä¸ªå€¼æ˜¯ 10 ç§’ï¼› ç¬¬ä¸‰ä¸ªå­—æ®µæ˜¯ timeoutSecondsï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æ£€æµ‹çš„è¶…æ—¶æ—¶é—´ï¼Œå½“è¶…æ—¶æ—¶é—´ä¹‹å†…æ²¡æœ‰æ£€æµ‹æˆåŠŸï¼Œé‚£å®ƒä¼šè®¤ä¸ºæ˜¯å¤±è´¥çš„ä¸€ä¸ªçŠ¶æ€ï¼› ç¬¬å››ä¸ªæ˜¯ successThresholdï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯ï¼šå½“è¿™ä¸ª pod ä»æ¢æµ‹å¤±è´¥åˆ°å†ä¸€æ¬¡åˆ¤æ–­æ¢æµ‹æˆåŠŸï¼Œæ‰€éœ€è¦çš„é˜ˆå€¼æ¬¡æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ 1 æ¬¡ï¼Œè¡¨ç¤ºåŸæœ¬æ˜¯å¤±è´¥çš„ï¼Œé‚£æ¥ä¸‹æ¥æ¢æµ‹è¿™ä¸€æ¬¡æˆåŠŸäº†ï¼Œå°±ä¼šè®¤ä¸ºè¿™ä¸ª pod æ˜¯å¤„åœ¨ä¸€ä¸ªæ¢é’ˆçŠ¶æ€æ­£å¸¸çš„ä¸€ä¸ªçŠ¶æ€ï¼› æœ€åä¸€ä¸ªå‚æ•°æ˜¯ failureThresholdï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æ¢æµ‹å¤±è´¥çš„é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤å€¼æ˜¯ 3ï¼Œè¡¨ç¤ºçš„æ˜¯å½“ä»ä¸€ä¸ªå¥åº·çš„çŠ¶æ€è¿ç»­æ¢æµ‹ 3 æ¬¡å¤±è´¥ï¼Œé‚£æ­¤æ—¶ä¼šåˆ¤æ–­å½“å‰è¿™ä¸ªpodçš„çŠ¶æ€å¤„åœ¨ä¸€ä¸ªå¤±è´¥çš„çŠ¶æ€ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:2:3","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Liveness ä¸ Readiness æ€»ç»“ ä»‹ç» Liveness æŒ‡é’ˆæ˜¯å­˜æ´»æŒ‡é’ˆï¼Œå®ƒç”¨æ¥åˆ¤æ–­å®¹å™¨æ˜¯å¦å­˜æ´»ã€åˆ¤æ–­ pod æ˜¯å¦ runningã€‚å¦‚æœ Liveness æŒ‡é’ˆåˆ¤æ–­å®¹å™¨ä¸å¥åº·ï¼Œæ­¤æ—¶ä¼šé€šè¿‡ kubelet æ€æ‰ç›¸åº”çš„ podï¼Œå¹¶æ ¹æ®é‡å¯ç­–ç•¥æ¥åˆ¤æ–­æ˜¯å¦é‡å¯è¿™ä¸ªå®¹å™¨ã€‚å¦‚æœé»˜è®¤ä¸é…ç½® Liveness æŒ‡é’ˆï¼Œåˆ™é»˜è®¤æƒ…å†µä¸‹è®¤ä¸ºå®ƒè¿™ä¸ªæ¢æµ‹é»˜è®¤è¿”å›æ˜¯æˆåŠŸçš„ã€‚ Readiness æŒ‡é’ˆç”¨æ¥åˆ¤æ–­è¿™ä¸ªå®¹å™¨æ˜¯å¦å¯åŠ¨å®Œæˆï¼Œå³ pod çš„ condition æ˜¯å¦ readyã€‚å¦‚æœæ¢æµ‹çš„ä¸€ä¸ªç»“æœæ˜¯ä¸æˆåŠŸï¼Œé‚£ä¹ˆæ­¤æ—¶å®ƒä¼šä» pod ä¸Š Endpoint ä¸Šç§»é™¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä»æ¥å…¥å±‚ä¸Šé¢ä¼šæŠŠå‰ä¸€ä¸ª pod è¿›è¡Œæ‘˜é™¤ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡åˆ¤æ–­æˆåŠŸï¼Œè¿™ä¸ª pod æ‰ä¼šå†æ¬¡æŒ‚åˆ°ç›¸åº”çš„ endpoint ä¹‹ä¸Šã€‚ æ£€æµ‹å¤±è´¥ å¯¹äºæ£€æµ‹å¤±è´¥ä¸Šé¢æ¥è®² Liveness æŒ‡é’ˆæ˜¯ç›´æ¥æ€æ‰è¿™ä¸ª podï¼Œè€Œ Readiness æŒ‡é’ˆæ˜¯åˆ‡æ‰ endpoint åˆ°è¿™ä¸ª pod ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæŠŠè¿™ä¸ªæµé‡ä»è¿™ä¸ª pod ä¸Šé¢è¿›è¡Œåˆ‡æ‰ã€‚ é€‚ç”¨åœºæ™¯ Liveness æŒ‡é’ˆé€‚ç”¨åœºæ™¯æ˜¯æ”¯æŒé‚£äº›å¯ä»¥é‡æ–°æ‹‰èµ·çš„åº”ç”¨ï¼Œè€Œ Readiness æŒ‡é’ˆä¸»è¦åº”å¯¹çš„æ˜¯å¯åŠ¨ä¹‹åæ— æ³•ç«‹å³å¯¹å¤–æä¾›æœåŠ¡çš„è¿™äº›åº”ç”¨ã€‚ æ³¨æ„äº‹é¡¹ åœ¨ä½¿ç”¨ Liveness æŒ‡é’ˆå’Œ Readiness æŒ‡é’ˆçš„æ—¶å€™æœ‰ä¸€äº›æ³¨æ„äº‹é¡¹ã€‚å› ä¸ºä¸è®ºæ˜¯ Liveness æŒ‡é’ˆè¿˜æ˜¯ Readiness æŒ‡é’ˆéƒ½éœ€è¦é…ç½®åˆé€‚çš„æ¢æµ‹æ–¹å¼ï¼Œä»¥å…è¢«è¯¯æ“ä½œã€‚ ç¬¬ä¸€ä¸ªæ˜¯è°ƒå¤§è¶…æ—¶çš„é˜ˆå€¼ï¼Œå› ä¸ºåœ¨å®¹å™¨é‡Œé¢æ‰§è¡Œä¸€ä¸ª shell è„šæœ¬ï¼Œå®ƒçš„æ‰§è¡Œæ—¶é•¿æ˜¯éå¸¸é•¿çš„ï¼Œå¹³æ—¶åœ¨ä¸€å° ecs æˆ–è€…åœ¨ä¸€å° vm ä¸Šæ‰§è¡Œï¼Œå¯èƒ½ 3 ç§’é’Ÿè¿”å›çš„ä¸€ä¸ªè„šæœ¬åœ¨å®¹å™¨é‡Œé¢éœ€è¦ 30 ç§’é’Ÿã€‚æ‰€ä»¥è¿™ä¸ªæ—¶é—´æ˜¯éœ€è¦åœ¨å®¹å™¨é‡Œé¢äº‹å…ˆè¿›è¡Œä¸€ä¸ªåˆ¤æ–­çš„ï¼Œé‚£å¦‚æœå¯ä»¥è°ƒå¤§è¶…æ—¶é˜ˆå€¼çš„æ–¹å¼ï¼Œæ¥é˜²æ­¢ç”±äºå®¹å™¨å‹åŠ›æ¯”è¾ƒå¤§çš„æ—¶å€™å‡ºç°å¶å‘çš„è¶…æ—¶ï¼› ç¬¬äºŒä¸ªæ˜¯è°ƒæ•´åˆ¤æ–­çš„ä¸€ä¸ªæ¬¡æ•°ï¼Œ3 æ¬¡çš„é»˜è®¤å€¼å…¶å®åœ¨æ¯”è¾ƒçŸ­å‘¨æœŸçš„åˆ¤æ–­å‘¨æœŸä¹‹ä¸‹ï¼Œä¸ä¸€å®šæ˜¯æœ€ä½³å®è·µï¼Œé€‚å½“è°ƒæ•´ä¸€ä¸‹åˆ¤æ–­çš„æ¬¡æ•°ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹å¼ï¼› ç¬¬ä¸‰ä¸ªæ˜¯ execï¼Œå¦‚æœæ˜¯ä½¿ç”¨ shell è„šæœ¬çš„è¿™ä¸ªåˆ¤æ–­ï¼Œè°ƒç”¨æ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼Œæ¯”è¾ƒå»ºè®®å¤§å®¶å¯ä»¥ä½¿ç”¨ç±»ä¼¼åƒä¸€äº›ç¼–è¯‘æ€§çš„è„šæœ¬ Golang æˆ–è€…ä¸€äº› C è¯­è¨€ã€C++ ç¼–è¯‘å‡ºæ¥çš„è¿™ä¸ªäºŒè¿›åˆ¶çš„ binary è¿›è¡Œåˆ¤æ–­ï¼Œé‚£è¿™ç§é€šå¸¸ä¼šæ¯” shell è„šæœ¬çš„æ‰§è¡Œæ•ˆç‡é«˜ 30% åˆ° 50%ï¼› ç¬¬å››ä¸ªæ˜¯å¦‚æœä½¿ç”¨ tcpSocket æ–¹å¼è¿›è¡Œåˆ¤æ–­çš„æ—¶å€™ï¼Œå¦‚æœé‡åˆ°äº† TLS çš„æœåŠ¡ï¼Œé‚£å¯èƒ½ä¼šé€ æˆåè¾¹ TLS é‡Œé¢æœ‰å¾ˆå¤šè¿™ç§æœªå¥å…¨çš„ tcp connectionï¼Œé‚£è¿™ä¸ªæ—¶å€™éœ€è¦è‡ªå·±å¯¹ä¸šåŠ¡åœºæ™¯ä¸Šæ¥åˆ¤æ–­ï¼Œè¿™ç§çš„é“¾æ¥æ˜¯å¦ä¼šå¯¹ä¸šåŠ¡é€ æˆå½±å“ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:2:4","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"é—®é¢˜è¯Šæ–­","date":"2021-08-07","objectID":"/kubernetes-debug/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"äº†è§£çŠ¶æ€æœºåˆ¶é¦–å…ˆè¦äº†è§£ä¸€ä¸‹ K8s ä¸­çš„ä¸€ä¸ªè®¾è®¡ç†å¿µï¼Œå°±æ˜¯è¿™ä¸ªçŠ¶æ€æœºåˆ¶ã€‚å› ä¸º K8s æ˜¯æ•´ä¸ªçš„ä¸€ä¸ªè®¾è®¡æ˜¯é¢å‘çŠ¶æ€æœºçš„ï¼Œå®ƒé‡Œé¢é€šè¿‡ yaml çš„æ–¹å¼æ¥å®šä¹‰çš„æ˜¯ä¸€ä¸ªæœŸæœ›åˆ°è¾¾çš„ä¸€ä¸ªçŠ¶æ€ï¼Œè€ŒçœŸæ­£è¿™ä¸ª yaml åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šç”±å„ç§å„æ ·çš„ controlleræ¥è´Ÿè´£æ•´ä½“çš„çŠ¶æ€ä¹‹é—´çš„ä¸€ä¸ªè½¬æ¢ã€‚ æ¯”å¦‚è¯´ä¸Šé¢çš„å›¾ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ª Pod çš„ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸã€‚åˆšå¼€å§‹å®ƒå¤„åœ¨ä¸€ä¸ª pending çš„çŠ¶æ€ï¼Œé‚£æ¥ä¸‹æ¥å¯èƒ½ä¼šè½¬æ¢åˆ°ç±»ä¼¼åƒ runningï¼Œä¹Ÿå¯èƒ½è½¬æ¢åˆ° Unknownï¼Œç”šè‡³å¯ä»¥è½¬æ¢åˆ° failedã€‚ç„¶åï¼Œå½“ running æ‰§è¡Œäº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå®ƒå¯ä»¥è½¬æ¢åˆ°ç±»ä¼¼åƒ successded æˆ–è€…æ˜¯ failedï¼Œç„¶åå½“å‡ºç°åœ¨ unknown è¿™ä¸ªçŠ¶æ€æ—¶ï¼Œå¯èƒ½ç”±äºä¸€äº›çŠ¶æ€çš„æ¢å¤ï¼Œå®ƒä¼šé‡æ–°æ¢å¤åˆ° running æˆ–è€… successded æˆ–è€…æ˜¯ failedã€‚ å…¶å® K8s æ•´ä½“çš„ä¸€ä¸ªçŠ¶æ€å°±æ˜¯åŸºäºè¿™ç§ç±»ä¼¼åƒçŠ¶æ€æœºçš„ä¸€ä¸ªæœºåˆ¶è¿›è¡Œè½¬æ¢çš„ï¼Œè€Œä¸åŒçŠ¶æ€ä¹‹é—´çš„è½¬åŒ–éƒ½ä¼šåœ¨ç›¸åº”çš„ K8så¯¹è±¡ä¸Šé¢ç•™ä¸‹æ¥ç±»ä¼¼åƒ Status æˆ–è€…åƒ Conditions çš„ä¸€äº›å­—æ®µæ¥è¿›è¡Œè¡¨ç¤ºã€‚ ä¸€ä¸ª pod é‡Œé¢æœ‰å¤šä¸ª containerï¼Œæ¯ä¸ª container ä¸Šé¢åˆä¼šæœ‰ä¸€ä¸ªå­—æ®µå« Stateï¼Œç„¶å State çš„çŠ¶æ€è¡¨ç¤ºå½“å‰è¿™ä¸ª container çš„ä¸€ä¸ªèšåˆçŠ¶æ€ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å¸¸è§å¼‚å¸¸Pod åœç•™åœ¨ Pendingç¬¬ä¸€ä¸ªå°±æ˜¯ pending çŠ¶æ€ï¼Œpending è¡¨ç¤ºè°ƒåº¦å™¨æ²¡æœ‰è¿›è¡Œä»‹å…¥ã€‚æ­¤æ—¶å¯ä»¥é€šè¿‡ kubectl describe pod æ¥æŸ¥çœ‹ç›¸åº”çš„äº‹ä»¶ï¼Œå¦‚æœç”±äºèµ„æºæˆ–è€…è¯´ç«¯å£å ç”¨ï¼Œæˆ–è€…æ˜¯ç”±äº node selector é€ æˆ pod æ— æ³•è°ƒåº¦çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨ç›¸åº”çš„äº‹ä»¶é‡Œé¢çœ‹åˆ°ç›¸åº”çš„ç»“æœï¼Œè¿™ä¸ªç»“æœé‡Œé¢ä¼šè¡¨ç¤ºè¯´æœ‰å¤šå°‘ä¸ªä¸æ»¡è¶³çš„ nodeï¼Œæœ‰å¤šå°‘æ˜¯å› ä¸º CPU ä¸æ»¡è¶³ï¼Œæœ‰å¤šå°‘æ˜¯ç”±äº node ä¸æ»¡è¶³ï¼Œæœ‰å¤šå°‘æ˜¯ç”±äº tag æ‰“æ ‡é€ æˆçš„ä¸æ»¡è¶³ã€‚ Pod åœç•™åœ¨ waitingé‚£ç¬¬äºŒä¸ªçŠ¶æ€å°±æ˜¯ pod å¯èƒ½ä¼šåœç•™åœ¨ waiting çš„çŠ¶æ€ï¼Œpod çš„ states å¤„åœ¨ waiting çš„æ—¶å€™ï¼Œé€šå¸¸è¡¨ç¤ºè¯´è¿™ä¸ª pod çš„é•œåƒæ²¡æœ‰æ­£å¸¸æ‹‰å–ï¼ŒåŸå› å¯èƒ½æ˜¯ç”±äºè¿™ä¸ªé•œåƒæ˜¯ç§æœ‰é•œåƒï¼Œä½†æ˜¯æ²¡æœ‰é…ç½® Pod secretï¼›é‚£ç¬¬äºŒç§æ˜¯è¯´å¯èƒ½ç”±äºè¿™ä¸ªé•œåƒåœ°å€æ˜¯ä¸å­˜åœ¨çš„ï¼Œé€ æˆè¿™ä¸ªé•œåƒæ‹‰å–ä¸ä¸‹æ¥ï¼›è¿˜æœ‰ä¸€ä¸ªæ˜¯è¯´è¿™ä¸ªé•œåƒå¯èƒ½æ˜¯ä¸€ä¸ªå…¬ç½‘çš„é•œåƒï¼Œé€ æˆé•œåƒçš„æ‹‰å–å¤±è´¥ã€‚ Pod ä¸æ–­è¢«æ‹‰å–å¹¶ä¸”å¯ä»¥çœ‹åˆ° crashingç¬¬ä¸‰ç§æ˜¯ pod ä¸æ–­è¢«æ‹‰èµ·ï¼Œè€Œä¸”å¯ä»¥çœ‹åˆ°ç±»ä¼¼åƒ backoffã€‚è¿™ä¸ªé€šå¸¸è¡¨ç¤ºè¯´ pod å·²ç»è¢«è°ƒåº¦å®Œæˆäº†ï¼Œä½†æ˜¯å¯åŠ¨å¤±è´¥ï¼Œé‚£è¿™ä¸ªæ—¶å€™é€šå¸¸è¦å…³æ³¨çš„åº”è¯¥æ˜¯è¿™ä¸ªåº”ç”¨è‡ªèº«çš„ä¸€ä¸ªçŠ¶æ€ï¼Œå¹¶ä¸æ˜¯è¯´é…ç½®æ˜¯å¦æ­£ç¡®ã€æƒé™æ˜¯å¦æ­£ç¡®ï¼Œæ­¤æ—¶éœ€è¦æŸ¥çœ‹çš„åº”è¯¥æ˜¯ pod çš„å…·ä½“æ—¥å¿—ã€‚ Pod å¤„åœ¨ Runing ä½†æ˜¯æ²¡æœ‰æ­£å¸¸å·¥ä½œç¬¬å››ç§ pod å¤„åœ¨ running çŠ¶æ€ï¼Œä½†æ˜¯æ²¡æœ‰æ­£å¸¸å¯¹å¤–æœåŠ¡ã€‚é‚£æ­¤æ—¶æ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªç‚¹å°±å¯èƒ½æ˜¯ç”±äºä¸€äº›éå¸¸ç»†ç¢çš„é…ç½®ï¼Œç±»ä¼¼åƒæœ‰ä¸€äº›å­—æ®µå¯èƒ½æ‹¼å†™é”™è¯¯ï¼Œé€ æˆäº† yaml ä¸‹å‘ä¸‹å»äº†ï¼Œä½†æ˜¯æœ‰ä¸€æ®µæ²¡æœ‰æ­£å¸¸åœ°ç”Ÿæ•ˆï¼Œä»è€Œä½¿å¾—è¿™ä¸ª pod å¤„åœ¨ running çš„çŠ¶æ€æ²¡æœ‰å¯¹å¤–æœåŠ¡ï¼Œé‚£æ­¤æ—¶å¯ä»¥é€šè¿‡ apply-validate-f pod.yaml çš„æ–¹å¼æ¥è¿›è¡Œåˆ¤æ–­å½“å‰ yaml æ˜¯å¦æ˜¯æ­£å¸¸çš„ï¼Œå¦‚æœ yaml æ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å¯èƒ½è¦è¯Šæ–­é…ç½®çš„ç«¯å£æ˜¯å¦æ˜¯æ­£å¸¸çš„ï¼Œä»¥åŠ Liveness æˆ– Readiness æ˜¯å¦å·²ç»é…ç½®æ­£ç¡®ã€‚ Service æ— æ³•æ­£å¸¸çš„å·¥ä½œæœ€åä¸€ç§å°±æ˜¯ service æ— æ³•æ­£å¸¸å·¥ä½œçš„æ—¶å€™ï¼Œè¯¥æ€ä¹ˆå»åˆ¤æ–­å‘¢ï¼Ÿé‚£æ¯”è¾ƒå¸¸è§çš„ service å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œæ˜¯è‡ªå·±çš„ä½¿ç”¨ä¸Šé¢å‡ºç°äº†é—®é¢˜ã€‚å› ä¸º service å’Œåº•å±‚çš„ pod ä¹‹é—´çš„å…³è”å…³ç³»æ˜¯é€šè¿‡ selector çš„æ–¹å¼æ¥åŒ¹é…çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ pod ä¸Šé¢é…ç½®äº†ä¸€äº› labelï¼Œç„¶å service é€šè¿‡ match label çš„æ–¹å¼å’Œè¿™ä¸ª pod è¿›è¡Œç›¸äº’å…³è”ã€‚å¦‚æœè¿™ä¸ª label é…ç½®çš„æœ‰é—®é¢˜ï¼Œå¯èƒ½ä¼šé€ æˆè¿™ä¸ª service æ— æ³•æ‰¾åˆ°åé¢çš„ endpointï¼Œä»è€Œé€ æˆç›¸åº”çš„ service æ²¡æœ‰åŠæ³•å¯¹å¤–æä¾›æœåŠ¡ï¼Œé‚£å¦‚æœ service å‡ºç°å¼‚å¸¸çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªè¦çœ‹çš„æ˜¯è¿™ä¸ª service åé¢æ˜¯ä¸æ˜¯æœ‰ä¸€ä¸ªçœŸæ­£çš„ endpointï¼Œå…¶æ¬¡æ¥çœ‹è¿™ä¸ª endpoint æ˜¯å¦å¯ä»¥å¯¹å¤–æä¾›æ­£å¸¸çš„æœåŠ¡ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"è¿œç¨‹è°ƒè¯•","date":"2021-08-07","objectID":"/kubernetes-debug/:4:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Pod è¿œç¨‹è°ƒè¯•é¦–å…ˆæŠŠä¸€ä¸ªåº”ç”¨éƒ¨ç½²åˆ°é›†ç¾¤é‡Œé¢çš„æ—¶å€™ï¼Œå‘ç°é—®é¢˜çš„æ—¶å€™ï¼Œéœ€è¦è¿›è¡Œå¿«é€ŸéªŒè¯ï¼Œæˆ–è€…è¯´ä¿®æ”¹çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦ç±»ä¼¼åƒç™»é™†è¿›è¿™ä¸ªå®¹å™¨æ¥è¿›è¡Œä¸€äº›è¯Šæ–­ã€‚ è¿›å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„Pod kubectl exec -it pod-name /bin/bash è¿›å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡ŒåŒ…å«å¤šå®¹å™¨çš„Pod kubectl exec -it pod-name -c container-name /bin/bash æ¯”å¦‚è¯´å¯ä»¥é€šè¿‡ exec çš„æ–¹å¼è¿›å…¥ä¸€ä¸ª podã€‚åƒè¿™æ¡å‘½ä»¤é‡Œé¢ï¼Œé€šè¿‡ kubectl exec-it pod-name åé¢å†å¡«å†™ä¸€ä¸ªç›¸åº”çš„å‘½ä»¤ï¼Œæ¯”å¦‚è¯´ /bin/bashï¼Œè¡¨ç¤ºå¸Œæœ›åˆ°è¿™ä¸ª pod é‡Œé¢è¿›å…¥ä¸€ä¸ªäº¤äº’å¼çš„ä¸€ä¸ª bashã€‚ç„¶ååœ¨ bash é‡Œé¢å¯ä»¥åšä¸€äº›ç›¸åº”çš„å‘½ä»¤ï¼Œæ¯”å¦‚è¯´ä¿®æ”¹ä¸€äº›é…ç½®ï¼Œé€šè¿‡ supervisor å»é‡æ–°æ‹‰èµ·è¿™ä¸ªåº”ç”¨ï¼Œéƒ½æ˜¯å¯ä»¥çš„ã€‚ é‚£å¦‚æœæŒ‡å®šè¿™ä¸€ä¸ª pod é‡Œé¢å¯èƒ½åŒ…å«ç€å¤šä¸ª containerï¼Œè¿™ä¸ªæ—¶å€™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæ€ä¹ˆé€šè¿‡ pod æ¥æŒ‡å®š container å‘¢ï¼Ÿå…¶å®è¿™ä¸ªæ—¶å€™æœ‰ä¸€ä¸ªå‚æ•°å«åš -cï¼Œå¦‚ä¸Šå›¾ä¸‹æ–¹çš„å‘½ä»¤æ‰€ç¤ºã€‚-c åé¢æ˜¯ä¸€ä¸ª container-nameï¼Œå¯ä»¥é€šè¿‡ pod åœ¨æŒ‡å®š -c åˆ°è¿™ä¸ª container-nameï¼Œå…·ä½“æŒ‡å®šè¦è¿›å…¥å“ªä¸ª containerï¼Œåé¢å†è·Ÿä¸Šç›¸åº”çš„å…·ä½“çš„å‘½ä»¤ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥å®ç°ä¸€ä¸ªå¤šå®¹å™¨çš„å‘½ä»¤çš„ä¸€ä¸ªè¿›å…¥ï¼Œä»è€Œå®ç°å¤šå®¹å™¨çš„ä¸€ä¸ªè¿œç¨‹è°ƒè¯•ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:4:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Service è¿œç¨‹è°ƒè¯•é‚£ä¹ˆ service çš„è¿œç¨‹è°ƒè¯•è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿservice çš„è¿œç¨‹è°ƒè¯•å…¶å®åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š ç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯è¯´æˆ‘æƒ³å°†ä¸€ä¸ªæœåŠ¡æš´éœ²åˆ°è¿œç¨‹çš„ä¸€ä¸ªé›†ç¾¤ä¹‹å†…ï¼Œè®©è¿œç¨‹é›†ç¾¤å†…çš„ä¸€äº›åº”ç”¨æ¥å»è°ƒç”¨æœ¬åœ°çš„ä¸€ä¸ªæœåŠ¡ï¼Œè¿™æ˜¯ä¸€æ¡åå‘çš„ä¸€ä¸ªé“¾è·¯ï¼› è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯æˆ‘æƒ³è®©è¿™ä¸ªæœ¬åœ°æœåŠ¡èƒ½å¤Ÿå»è°ƒè¿œç¨‹çš„æœåŠ¡ï¼Œé‚£ä¹ˆè¿™æ˜¯ä¸€æ¡æ­£å‘çš„é“¾è·¯ã€‚ åœ¨åå‘åˆ—å…¥ä¸Šé¢æœ‰è¿™æ ·ä¸€ä¸ªå¼€æºç»„ä»¶ï¼Œå«åš Telepresenceï¼Œå®ƒå¯ä»¥å°†æœ¬åœ°çš„åº”ç”¨ä»£ç†åˆ°è¿œç¨‹é›†ç¾¤ä¸­çš„ä¸€ä¸ª service ä¸Šé¢ï¼Œä½¿ç”¨å®ƒçš„æ–¹å¼éå¸¸ç®€å•ã€‚ é¦–å…ˆå…ˆå°† Telepresence çš„ä¸€ä¸ª Proxy åº”ç”¨éƒ¨ç½²åˆ°è¿œç¨‹çš„ K8s é›†ç¾¤é‡Œé¢ã€‚ç„¶åå°†è¿œç¨‹å•ä¸€ä¸ª deployment swap åˆ°æœ¬åœ°çš„ä¸€ä¸ª applicationï¼Œä½¿ç”¨çš„å‘½ä»¤å°±æ˜¯ Telepresence-swap-deployment $DEPLOYMENT_NAME ç„¶åä»¥åŠè¿œç¨‹çš„ DEPLOYMENT_NAMEã€‚é€šè¿‡è¿™ç§æ–¹å¼å°±å¯ä»¥å°†æœ¬åœ°ä¸€ä¸ª application ä»£ç†åˆ°è¿œç¨‹çš„ service ä¹‹ä¸Šã€å¯ä»¥å°†åº”ç”¨åœ¨è¿œç¨‹é›†ç¾¤é‡Œé¢è¿›è¡Œæœ¬åœ°è°ƒè¯•. ç¬¬äºŒä¸ªæ˜¯å¦‚æœæœ¬åœ°åº”ç”¨éœ€è¦è°ƒç”¨è¿œç¨‹é›†ç¾¤çš„æœåŠ¡æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ port-forward çš„æ–¹å¼å°†è¿œç¨‹çš„åº”ç”¨è°ƒç”¨åˆ°æœ¬åœ°çš„ç«¯å£ä¹‹ä¸Šã€‚æ¯”å¦‚è¯´ç°åœ¨è¿œç¨‹çš„é‡Œé¢æœ‰ä¸€ä¸ª API serverï¼Œè¿™ä¸ª API server æä¾›äº†ä¸€äº›ç«¯å£ï¼Œæœ¬åœ°åœ¨è°ƒè¯• Code æ—¶å€™ï¼Œæƒ³è¦ç›´æ¥è°ƒç”¨è¿™ä¸ª API serverï¼Œé‚£ä¹ˆè¿™æ—¶ï¼Œæ¯”è¾ƒç®€å•çš„ä¸€ä¸ªæ–¹å¼å°±æ˜¯é€šè¿‡ port-forward çš„æ–¹å¼ã€‚ kubectl port-forward svc/app -n app-namespace å®ƒçš„ä½¿ç”¨æ–¹å¼æ˜¯ kubectl port-forwardï¼Œç„¶å service åŠ ä¸Šè¿œç¨‹çš„ service nameï¼Œå†åŠ ä¸Šç›¸åº”çš„ namespaceï¼Œåé¢è¿˜å¯ä»¥åŠ ä¸Šä¸€äº›é¢å¤–çš„å‚æ•°ï¼Œæ¯”å¦‚è¯´ç«¯å£çš„ä¸€ä¸ªæ˜ å°„ï¼Œé€šè¿‡è¿™ç§æœºåˆ¶å°±å¯ä»¥æŠŠè¿œç¨‹çš„ä¸€ä¸ªåº”ç”¨ä»£ç†åˆ°æœ¬åœ°çš„ç«¯å£ä¹‹ä¸Šï¼Œæ­¤æ—¶é€šè¿‡è®¿é—®æœ¬åœ°ç«¯å£å°±å¯ä»¥è®¿é—®è¿œç¨‹çš„æœåŠ¡ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:4:2","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"kubectl-debugæœ€åå†ç»™å¤§å®¶ä»‹ç»ä¸€ä¸ªå¼€æºçš„è°ƒè¯•å·¥å…·ï¼Œå®ƒä¹Ÿæ˜¯ kubectl çš„ä¸€ä¸ªæ’ä»¶ï¼Œå« kubectl-debugã€‚æˆ‘ä»¬çŸ¥é“åœ¨ K8s é‡Œé¢ï¼Œåº•å±‚çš„å®¹å™¨ runtime æ¯”è¾ƒå¸¸è§çš„å°±æ˜¯ç±»ä¼¼åƒ docker æˆ–è€…æ˜¯ containerdï¼Œä¸è®ºæ˜¯ docker è¿˜æ˜¯ containerdï¼Œå®ƒä»¬ä½¿ç”¨çš„ä¸€ä¸ªæœºåˆ¶éƒ½æ˜¯åŸºäº Linux namespace çš„ä¸€ä¸ªæ–¹å¼è¿›è¡Œè™šæ‹ŸåŒ–å’Œéš”ç¦»çš„ã€‚ é€šå¸¸æƒ…å†µä¸‹ ï¼Œå¹¶ä¸ä¼šåœ¨é•œåƒé‡Œé¢å¸¦ç‰¹åˆ«å¤šçš„è°ƒè¯•å·¥å…·ï¼Œç±»ä¼¼åƒ netstat telnet ç­‰ç­‰è¿™äº› ï¼Œå› ä¸ºè¿™ä¸ªä¼šé€ æˆåº”ç”¨æ•´ä½“éå¸¸å†—ä½™ã€‚é‚£ä¹ˆå¦‚æœæƒ³è¦è°ƒè¯•çš„æ—¶å€™è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå…¶å®è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä¾èµ–ç±»ä¼¼äºåƒ kubectl-debug è¿™æ ·ä¸€ä¸ªå·¥å…·ã€‚ kubectl-debug è¿™ä¸ªå·¥å…·æ˜¯ä¾èµ–äº Linux namespace çš„æ–¹å¼æ¥å»åšçš„ï¼Œå®ƒå¯ä»¥ datash ä¸€ä¸ª Linux namespace åˆ°ä¸€ä¸ªé¢å¤–çš„ containerï¼Œç„¶ååœ¨è¿™ä¸ª container é‡Œé¢æ‰§è¡Œä»»ä½•çš„ debug åŠ¨ä½œï¼Œå…¶å®å’Œç›´æ¥å» debug è¿™ä¸ª Linux namespace æ˜¯ä¸€è‡´çš„ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„æ“ä½œï¼Œç»™å¤§å®¶æ¥ä»‹ç»ä¸€ä¸‹ï¼š è¿™ä¸ªåœ°æ–¹å…¶å®å·²ç»å®‰è£…å¥½äº† kubectl-debugï¼Œå®ƒæ˜¯ kubectl çš„ä¸€ä¸ªæ’ä»¶ã€‚æ‰€ä»¥è¿™ä¸ªæ—¶å€™ï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡ kubectl-debug è¿™æ¡å‘½ä»¤æ¥å»è¯Šæ–­è¿œç¨‹çš„ä¸€ä¸ª podã€‚åƒè¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œå½“æ‰§è¡Œ debug çš„æ—¶å€™ï¼Œå®é™…ä¸Šå®ƒé¦–å…ˆä¼šå…ˆæ‹‰å–ä¸€äº›é•œåƒï¼Œè¿™ä¸ªé•œåƒé‡Œé¢å®é™…ä¸Šä¼šé»˜è®¤å¸¦ä¸€äº›è¯Šæ–­çš„å·¥å…·ã€‚å½“è¿™ä¸ªé•œåƒå¯ç”¨çš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠè¿™ä¸ª debug container è¿›è¡Œå¯åŠ¨ã€‚ä¸æ­¤åŒæ—¶ä¼šæŠŠè¿™ä¸ª container å’Œç›¸åº”çš„ä½ è¦è¯Šæ–­çš„è¿™ä¸ª container çš„ namespace è¿›è¡ŒæŒ‚é ï¼Œä¹Ÿå°±è¯´æ­¤æ—¶è¿™ä¸ª container å’Œä½ æ˜¯åŒ namespace çš„ï¼Œç±»ä¼¼åƒç½‘ç»œç«™ï¼Œæˆ–è€…æ˜¯ç±»ä¼¼åƒå†…æ ¸çš„ä¸€äº›å‚æ•°ï¼Œå…¶å®éƒ½å¯ä»¥åœ¨è¿™ä¸ª debug container é‡Œé¢å®æ—¶åœ°è¿›è¡ŒæŸ¥çœ‹ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:4:3","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬èŠ‚æ€»ç»“ å…³äº Liveness å’Œ Readiness çš„æŒ‡é’ˆã€‚Liveness probe å°±æ˜¯ä¿æ´»æŒ‡é’ˆï¼Œå®ƒæ˜¯ç”¨æ¥çœ‹ pod æ˜¯å¦å­˜æ´»çš„ï¼Œè€Œ Readiness probe æ˜¯å°±ç»ªæŒ‡é’ˆï¼Œå®ƒæ˜¯åˆ¤æ–­è¿™ä¸ª pod æ˜¯å¦å°±ç»ªçš„ï¼Œå¦‚æœå°±ç»ªäº†ï¼Œå°±å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ã€‚è¿™ä¸ªå°±æ˜¯ Liveness å’Œ Readiness éœ€è¦è®°ä½çš„éƒ¨åˆ†ï¼› åº”ç”¨è¯Šæ–­çš„ä¸‰ä¸ªæ­¥éª¤ï¼šé¦–å…ˆ describe ç›¸åº”çš„ä¸€ä¸ªçŠ¶æ€ï¼›ç„¶åæä¾›çŠ¶æ€æ¥æ’æŸ¥å…·ä½“çš„ä¸€ä¸ªè¯Šæ–­æ–¹å‘ï¼›æœ€åæ¥æŸ¥çœ‹ç›¸åº”å¯¹è±¡çš„ä¸€ä¸ª event è·å–æ›´è¯¦ç»†çš„ä¸€ä¸ªä¿¡æ¯ï¼› æä¾› pod ä¸€ä¸ªæ—¥å¿—æ¥å®šä½åº”ç”¨çš„è‡ªèº«çš„ä¸€ä¸ªçŠ¶æ€ï¼› è¿œç¨‹è°ƒè¯•çš„ä¸€ä¸ªç­–ç•¥ï¼Œå¦‚æœæƒ³æŠŠæœ¬åœ°çš„åº”ç”¨ä»£ç†åˆ°è¿œç¨‹é›†ç¾¤ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ Telepresence è¿™æ ·çš„å·¥å…·æ¥å®ç°ï¼Œå¦‚æœæƒ³æŠŠè¿œç¨‹çš„åº”ç”¨ä»£ç†åˆ°æœ¬åœ°ï¼Œç„¶ååœ¨æœ¬åœ°è¿›è¡Œè°ƒç”¨æˆ–è€…æ˜¯è°ƒè¯•ï¼Œå¯ä»¥ç”¨ç±»ä¼¼åƒ port-forward è¿™ç§æœºåˆ¶æ¥å®ç°ã€‚ ","date":"2021-08-07","objectID":"/kubernetes-debug/:5:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é—®é¢˜è¯Šæ–­","debug"],"title":"Kubernetes é—®é¢˜è¯Šæ–­","uri":"/kubernetes-debug/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡ä»‹ç»äº†å­˜å‚¨å¿«ç…§æ¦‚å¿µã€ä½¿ç”¨ä¸å·¥ä½œåŸç†ã€å­˜å‚¨æ‹“æ‰‘è°ƒåº¦èƒŒæ™¯ã€æ¦‚å¿µã€ä½¿ç”¨ä¸å·¥ä½œåŸç†","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"åŸºç¡€çŸ¥è¯†","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å­˜å‚¨å¿«ç…§äº§ç”ŸèƒŒæ™¯åœ¨ä½¿ç”¨å­˜å‚¨æ—¶ï¼Œä¸ºäº†æé«˜æ•°æ®æ“ä½œçš„å®¹é”™æ€§ï¼Œæˆ‘ä»¬é€šå¸¸æœ‰éœ€è¦å¯¹çº¿ä¸Šæ•°æ®è¿›è¡Œsnapshotï¼Œä»¥åŠèƒ½å¿«é€Ÿrestoreçš„èƒ½åŠ›ã€‚å¦å¤–ï¼Œå½“éœ€è¦å¯¹çº¿ä¸Šæ•°æ®è¿›è¡Œå¿«é€Ÿçš„å¤åˆ¶ä»¥åŠè¿ç§»ç­‰åŠ¨ä½œï¼Œå¦‚è¿›è¡Œç¯å¢ƒçš„å¤åˆ¶ã€æ•°æ®å¼€å‘ç­‰åŠŸèƒ½æ—¶ï¼Œéƒ½å¯ä»¥é€šè¿‡å­˜å‚¨å¿«ç…§æ¥æ»¡è¶³éœ€æ±‚ï¼Œè€Œ K8s ä¸­é€šè¿‡ CSI Snapshotter controller æ¥å®ç°å­˜å‚¨å¿«ç…§çš„åŠŸèƒ½ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:1:1","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å­˜å‚¨å¿«ç…§ç”¨æˆ·æ¥å£-Snapshotæˆ‘ä»¬çŸ¥é“ï¼ŒK8s ä¸­é€šè¿‡ pvc ä»¥åŠ pv çš„è®¾è®¡ä½“ç³»æ¥ç®€åŒ–ç”¨æˆ·å¯¹å­˜å‚¨çš„ä½¿ç”¨ï¼Œè€Œå­˜å‚¨å¿«ç…§çš„è®¾è®¡å…¶å®æ˜¯ä»¿ç…§ pvc \u0026 pv ä½“ç³»çš„è®¾è®¡æ€æƒ³ã€‚å½“ç”¨æˆ·éœ€è¦å­˜å‚¨å¿«ç…§çš„åŠŸèƒ½æ—¶ï¼Œå¯ä»¥é€šè¿‡ VolumeSnapshot å¯¹è±¡æ¥å£°æ˜ï¼Œå¹¶æŒ‡å®šç›¸åº”çš„ VolumeSnapshotClass å¯¹è±¡ï¼Œä¹‹åç”±é›†ç¾¤ä¸­çš„ç›¸å…³ç»„ä»¶åŠ¨æ€ç”Ÿæˆå­˜å‚¨å¿«ç…§ä»¥åŠå­˜å‚¨å¿«ç…§å¯¹åº”çš„å¯¹è±¡ VolumeSnapshotContentã€‚å¦‚ä¸‹å¯¹æ¯”å›¾æ‰€ç¤ºï¼ŒåŠ¨æ€ç”Ÿæˆ VolumeSnapshotContent å’ŒåŠ¨æ€ç”Ÿæˆ pv çš„æµç¨‹æ˜¯éå¸¸ç›¸ä¼¼çš„ã€‚ Snapshot ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:1:2","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å­˜å‚¨å¿«ç…§ç”¨æˆ·æ¥å£-Restoreæœ‰äº†å­˜å‚¨å¿«ç…§ä¹‹åï¼Œå¦‚ä½•å°†å¿«ç…§æ•°æ®å¿«é€Ÿæ¢å¤è¿‡æ¥å‘¢ï¼Ÿ Restore å¦‚ä¸Šæ‰€ç¤ºçš„æµç¨‹ï¼Œå¯ä»¥å€ŸåŠ© PVC å¯¹è±¡å°†å…¶çš„ dataSource å­—æ®µæŒ‡å®šä¸º VolumeSnapshot å¯¹è±¡ã€‚è¿™æ ·å½“ PVC æäº¤ä¹‹åï¼Œä¼šç”±é›†ç¾¤ä¸­çš„ç›¸å…³ç»„ä»¶æ‰¾åˆ° dataSource æ‰€æŒ‡å‘çš„å­˜å‚¨å¿«ç…§æ•°æ®ï¼Œç„¶åæ–°åˆ›å»ºå¯¹åº”çš„å­˜å‚¨ä»¥åŠ pv å¯¹è±¡ï¼Œå°†å­˜å‚¨å¿«ç…§æ•°æ®æ¢å¤åˆ°æ–°çš„ pv ä¸­ï¼Œè¿™æ ·æ•°æ®å°±æ¢å¤å›æ¥äº†ï¼Œè¿™å°±æ˜¯å­˜å‚¨å¿«ç…§çš„restoreç”¨æ³•ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:1:3","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Topolopy-å«ä¹‰é¦–å…ˆäº†è§£ä¸€ä¸‹æ‹“æ‰‘æ˜¯ä»€ä¹ˆæ„æ€ï¼šè¿™é‡Œæ‰€è¯´çš„æ‹“æ‰‘æ˜¯ K8s é›†ç¾¤ä¸­ä¸ºç®¡ç†çš„ nodes åˆ’åˆ†çš„ä¸€ç§â€œä½ç½®â€å…³ç³»ï¼Œæ„æ€ä¸ºï¼šå¯ä»¥é€šè¿‡åœ¨ node çš„ labels ä¿¡æ¯é‡Œé¢å¡«å†™æŸä¸€ä¸ª node å±äºæŸä¸€ä¸ªæ‹“æ‰‘ã€‚ å¸¸è§çš„æœ‰ä¸‰ç§ï¼Œè¿™ä¸‰ç§åœ¨ä½¿ç”¨æ—¶ç»å¸¸ä¼šé‡åˆ°çš„ï¼š ç¬¬ä¸€ç§ï¼Œåœ¨ä½¿ç”¨äº‘å­˜å‚¨æœåŠ¡çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ° regionï¼Œä¹Ÿå°±æ˜¯åœ°åŒºçš„æ¦‚å¿µï¼Œåœ¨ K8s ä¸­å¸¸é€šè¿‡ label failure-domain.beta.kubernetes.io/region æ¥æ ‡è¯†ã€‚è¿™ä¸ªæ˜¯ä¸ºäº†æ ‡è¯†å•ä¸ª K8s é›†ç¾¤ç®¡ç†çš„è·¨ region çš„ nodes åˆ°åº•å±äºå“ªä¸ªåœ°åŒºï¼› ç¬¬äºŒç§ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ˜¯å¯ç”¨åŒºï¼Œä¹Ÿå°±æ˜¯ available zoneï¼Œåœ¨ K8s ä¸­å¸¸é€šè¿‡ label failure-domain.beta.kubernetes.io/zone æ¥æ ‡è¯†ã€‚è¿™ä¸ªæ˜¯ä¸ºäº†æ ‡è¯†å•ä¸ª K8s é›†ç¾¤ç®¡ç†çš„è·¨ zone çš„ nodes åˆ°åº•å±äºå“ªä¸ªå¯ç”¨åŒºï¼› ç¬¬ä¸‰ç§ï¼Œæ˜¯ hostnameï¼Œå°±æ˜¯å•æœºç»´åº¦ï¼Œæ˜¯æ‹“æ‰‘åŸŸä¸º node èŒƒå›´ï¼Œåœ¨ K8s ä¸­å¸¸é€šè¿‡ label kubernetes.io/hostname æ¥æ ‡è¯†ï¼Œè¿™ä¸ªåœ¨æ–‡ç« çš„æœ€åè®² local pv çš„æ—¶å€™ï¼Œä¼šå†è¯¦ç»†æè¿°ã€‚ ä¸Šé¢è®²åˆ°çš„ä¸‰ä¸ªæ‹“æ‰‘æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œè€Œæ‹“æ‰‘å…¶å®æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰çš„ã€‚å¯ä»¥å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²æ¥è¡¨ç¤ºä¸€ä¸ªæ‹“æ‰‘åŸŸï¼Œè¿™ä¸ª key æ‰€å¯¹åº”çš„å€¼å…¶å®å°±æ˜¯æ‹“æ‰‘åŸŸä¸‹ä¸åŒçš„æ‹“æ‰‘ä½ç½®ã€‚ ä¸¾ä¸ªä¾‹å­ï¼šå¯ä»¥ç”¨ rackï¼Œä¹Ÿå°±æ˜¯æœºæˆ¿ä¸­çš„æœºæ¶è¿™ä¸ªçº¬åº¦æ¥åšä¸€ä¸ªæ‹“æ‰‘åŸŸã€‚è¿™æ ·å°±å¯ä»¥å°†ä¸åŒæœºæ¶ (rack) ä¸Šé¢çš„æœºå™¨æ ‡è®°ä¸ºä¸åŒçš„æ‹“æ‰‘ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥å°†ä¸åŒæœºæ¶ä¸Šæœºå™¨çš„ä½ç½®å…³ç³»é€šè¿‡ rack è¿™ä¸ªçº¬åº¦æ¥æ ‡è¯†ã€‚å±äº rack1 ä¸Šçš„æœºå™¨ï¼Œnode label ä¸­éƒ½æ·»åŠ  rack çš„æ ‡è¯†ï¼Œå®ƒçš„ value å°±æ ‡è¯†æˆ rack1ï¼Œå³ rack=rack1ï¼›å¦å¤–ä¸€ç»„æœºæ¶ä¸Šçš„æœºå™¨å¯ä»¥æ ‡è¯†ä¸º rack=rack2ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡æœºæ¶çš„çº¬åº¦å°±æ¥åŒºåˆ†æ¥ K8s ä¸­çš„ node æ‰€å¤„çš„ä½ç½®ã€‚ æ¥ä¸‹æ¥å°±ä¸€èµ·æ¥çœ‹çœ‹æ‹“æ‰‘åœ¨ K8s å­˜å‚¨ä¸­çš„ä½¿ç”¨ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:1:4","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å­˜å‚¨æ‹“æ‰‘è°ƒåº¦äº§ç”ŸèƒŒæ™¯ä¸Šä¸€èŠ‚è¯¾æˆ‘ä»¬è¯´è¿‡ï¼ŒK8s ä¸­é€šè¿‡ PV çš„ PVC ä½“ç³»å°†å­˜å‚¨èµ„æºå’Œè®¡ç®—èµ„æºåˆ†å¼€ç®¡ç†äº†ã€‚å¦‚æœåˆ›å»ºå‡ºæ¥çš„ PVæœ‰\"è®¿é—®ä½ç½®\"çš„é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡ nodeAffinity æ¥æŒ‡å®šå“ªäº› node å¯ä»¥è®¿é—®è¿™ä¸ª PVã€‚ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªè®¿é—®ä½ç½®çš„é™åˆ¶ï¼Ÿ å› ä¸ºåœ¨ K8s ä¸­åˆ›å»º pod çš„æµç¨‹å’Œåˆ›å»º PV çš„æµç¨‹ï¼Œå…¶å®å¯ä»¥è®¤ä¸ºæ˜¯å¹¶è¡Œè¿›è¡Œçš„ï¼Œè¿™æ ·çš„è¯ï¼Œå°±æ²¡æœ‰åŠæ³•æ¥ä¿è¯ pod æœ€ç»ˆè¿è¡Œçš„ node æ˜¯èƒ½è®¿é—®åˆ° æœ‰ä½ç½®é™åˆ¶çš„ PV å¯¹åº”çš„å­˜å‚¨ï¼Œæœ€ç»ˆå¯¼è‡´ pod æ²¡æ³•æ­£å¸¸è¿è¡Œã€‚è¿™é‡Œæ¥ä¸¾ä¸¤ä¸ªç»å…¸çš„ä¾‹å­ï¼š é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ Local PV çš„ä¾‹å­ï¼ŒLocal PV æ˜¯å°†ä¸€ä¸ª node ä¸Šçš„æœ¬åœ°å­˜å‚¨å°è£…ä¸º PVï¼Œé€šè¿‡ä½¿ç”¨ PV çš„æ–¹å¼æ¥è®¿é—®æœ¬åœ°å­˜å‚¨ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰ Local PV çš„éœ€æ±‚å‘¢ï¼Ÿç®€å•æ¥è¯´ï¼Œåˆšå¼€å§‹ä½¿ç”¨ PV æˆ– PVC ä½“ç³»çš„æ—¶å€™ï¼Œä¸»è¦æ˜¯ç”¨æ¥é’ˆå¯¹åˆ†å¸ƒå¼å­˜å‚¨çš„ï¼Œåˆ†å¸ƒå¼å­˜å‚¨ä¾èµ–äºç½‘ç»œï¼Œå¦‚æœæŸäº›ä¸šåŠ¡å¯¹ I/O çš„æ€§èƒ½è¦æ±‚éå¸¸é«˜ï¼Œå¯èƒ½é€šè¿‡ç½‘ç»œè®¿é—®åˆ†å¸ƒå¼å­˜å‚¨æ²¡åŠæ³•æ»¡è¶³å®ƒçš„æ€§èƒ½éœ€æ±‚ã€‚è¿™ä¸ªæ—¶å€™éœ€è¦ä½¿ç”¨æœ¬åœ°å­˜å‚¨ï¼Œåˆ¨é™¤äº†ç½‘ç»œçš„ overheadï¼Œæ€§èƒ½å¾€å¾€ä¼šæ¯”è¾ƒé«˜ã€‚ä½†æ˜¯ç”¨æœ¬åœ°å­˜å‚¨ä¹Ÿæ˜¯æœ‰åå¤„çš„ï¼åˆ†å¸ƒå¼å­˜å‚¨å¯ä»¥é€šè¿‡å¤šå‰¯æœ¬æ¥ä¿è¯é«˜å¯ç”¨ï¼Œä½†æœ¬åœ°å­˜å‚¨å°±éœ€è¦ä¸šåŠ¡è‡ªå·±ç”¨ç±»ä¼¼ Raft åè®®æ¥å®ç°å¤šå‰¯æœ¬é«˜å¯ç”¨ã€‚ æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹ Local PV åœºæ™¯å¯èƒ½å¦‚æœæ²¡æœ‰å¯¹PVåšâ€œè®¿é—®ä½ç½®â€çš„é™åˆ¶ä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Ÿ No Visit Restriction å½“ç”¨æˆ·åœ¨æäº¤å®Œ PVC çš„æ—¶å€™ï¼ŒK8s PV controllerå¯èƒ½ç»‘å®šçš„æ˜¯ node2 ä¸Šé¢çš„ PVã€‚ä½†æ˜¯ï¼ŒçœŸæ­£ä½¿ç”¨è¿™ä¸ª PV çš„ podï¼Œåœ¨è¢«è°ƒåº¦çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½è°ƒåº¦åœ¨ node1 ä¸Šï¼Œæœ€ç»ˆå¯¼è‡´è¿™ä¸ª pod åœ¨èµ·æ¥çš„æ—¶å€™æ²¡åŠæ³•å»ä½¿ç”¨è¿™å—å­˜å‚¨ï¼Œå› ä¸º pod çœŸå®æƒ…å†µæ˜¯è¦ä½¿ç”¨ node2 ä¸Šé¢çš„å­˜å‚¨ã€‚ ç¬¬äºŒä¸ª(å¦‚æœä¸å¯¹ PV åšâ€œè®¿é—®ä½ç½®â€çš„é™åˆ¶ä¼šå‡ºé—®é¢˜çš„)åœºæ™¯ï¼š No Visit Restriction å¦‚æœæ­å»ºçš„ K8s é›†ç¾¤ç®¡ç†çš„ nodes åˆ†å¸ƒåœ¨å•ä¸ªåŒºåŸŸå¤šä¸ªå¯ç”¨åŒºå†…ã€‚åœ¨åˆ›å»ºåŠ¨æ€å­˜å‚¨çš„æ—¶å€™ï¼Œåˆ›å»ºå‡ºæ¥çš„å­˜å‚¨å±äºå¯ç”¨åŒº 2ï¼Œä½†ä¹‹ååœ¨æäº¤ä½¿ç”¨è¯¥å­˜å‚¨çš„ podï¼Œå®ƒå¯èƒ½ä¼šè¢«è°ƒåº¦åˆ°å¯ç”¨åŒº 1 äº†ï¼Œé‚£å°±å¯èƒ½æ²¡åŠæ³•ä½¿ç”¨è¿™å—å­˜å‚¨ã€‚å› æ­¤åƒé˜¿é‡Œäº‘çš„äº‘ç›˜ï¼Œä¹Ÿå°±æ˜¯å—å­˜å‚¨ï¼Œå½“å‰ä¸èƒ½è·¨å¯ç”¨åŒºä½¿ç”¨ï¼Œå¦‚æœåˆ›å»ºçš„å­˜å‚¨å…¶å®å±äºå¯ç”¨åŒº 2ï¼Œä½†æ˜¯ pod è¿è¡Œåœ¨å¯ç”¨åŒº 1ï¼Œå°±æ²¡åŠæ³•ä½¿ç”¨è¿™å—å­˜å‚¨ï¼Œè¿™æ˜¯ç¬¬äºŒä¸ªå¸¸è§çš„é—®é¢˜åœºæ™¯ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹ K8s ä¸­å¦‚ä½•é€šè¿‡å­˜å‚¨æ‹“æ‰‘è°ƒåº¦æ¥è§£å†³ä¸Šé¢çš„é—®é¢˜çš„ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:1:5","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å­˜å‚¨æ‹“æ‰‘è°ƒåº¦é¦–å…ˆæ€»ç»“ä¸€ä¸‹ä¹‹å‰çš„ä¸¤ä¸ªé—®é¢˜ï¼Œå®ƒä»¬éƒ½æ˜¯ PV åœ¨ç»™ PVC ç»‘å®šæˆ–è€…åŠ¨æ€ç”Ÿæˆ PV çš„æ—¶å€™ï¼Œæˆ‘å¹¶ä¸çŸ¥é“åé¢å°†ä½¿ç”¨å®ƒçš„ pod å°†è°ƒåº¦åœ¨å“ªäº› node ä¸Šã€‚ä½† PV æœ¬èº«çš„ä½¿ç”¨ï¼Œæ˜¯å¯¹ pod æ‰€åœ¨çš„ node æœ‰æ‹“æ‰‘ä½ç½®çš„é™åˆ¶çš„ï¼Œå¦‚ Local PV åœºæ™¯æ˜¯æˆ‘è¦è°ƒåº¦åœ¨æŒ‡å®šçš„ node ä¸Šæˆ‘æ‰èƒ½ä½¿ç”¨é‚£å— PVï¼Œè€Œå¯¹ç¬¬äºŒä¸ªé—®é¢˜åœºæ™¯å°±æ˜¯è¯´è·¨å¯ç”¨åŒºçš„è¯ï¼Œå¿…é¡»è¦åœ¨å°†ä½¿ç”¨è¯¥ PV çš„ pod è°ƒåº¦åˆ°åŒä¸€ä¸ªå¯ç”¨åŒºçš„ node ä¸Šæ‰èƒ½ä½¿ç”¨é˜¿é‡Œäº‘äº‘ç›˜æœåŠ¡ï¼Œé‚£ K8s ä¸­æ€æ ·å»è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ ç®€å•æ¥è¯´ï¼Œåœ¨ K8s ä¸­å°† PV å’Œ PVC çš„ binding æ“ä½œå’ŒåŠ¨æ€åˆ›å»º PV çš„æ“ä½œåšäº† delayï¼Œdelay åˆ° pod è°ƒåº¦ç»“æœå‡ºæ¥ä¹‹åï¼Œå†å»åšè¿™ä¸¤ä¸ªæ“ä½œã€‚è¿™æ ·çš„è¯æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ é¦–å…ˆï¼Œå¦‚æœè¦æ˜¯æ‰€è¦ä½¿ç”¨çš„ PV æ˜¯é¢„åˆ†é…çš„ï¼Œå¦‚ Local PVï¼Œå…¶å®ä½¿ç”¨è¿™å— PV çš„ pod å®ƒå¯¹åº”çš„ PVC å…¶å®è¿˜æ²¡æœ‰åšç»‘å®šï¼Œå°±å¯ä»¥é€šè¿‡è°ƒåº¦å™¨åœ¨è°ƒåº¦çš„è¿‡ç¨‹ä¸­ï¼Œç»“åˆ pod çš„è®¡ç®—èµ„æºéœ€æ±‚(å¦‚ cpu/mem) ä»¥åŠ pod çš„ PVC éœ€æ±‚ï¼Œé€‰æ‹©çš„ node æ—¢è¦æ»¡è¶³è®¡ç®—èµ„æºçš„éœ€æ±‚åˆè¦ pod ä½¿ç”¨çš„ pvc è¦èƒ½ binding çš„ pv çš„ nodeaffinity é™åˆ¶; å…¶æ¬¡å¯¹åŠ¨æ€ç”Ÿæˆ PV çš„åœºæ™¯å…¶å®å°±ç›¸å½“äºæ˜¯å¦‚æœçŸ¥é“ pod è¿è¡Œçš„ node ä¹‹åï¼Œå°±å¯ä»¥æ ¹æ® node ä¸Šè®°å½•çš„æ‹“æ‰‘ä¿¡æ¯æ¥åŠ¨æ€çš„åˆ›å»ºè¿™ä¸ª PVï¼Œä¹Ÿå°±æ˜¯ä¿è¯æ–°åˆ›å»ºå‡ºæ¥çš„ PV çš„æ‹“æ‰‘ä½ç½®ä¸è¿è¡Œçš„ node æ‰€åœ¨çš„æ‹“æ‰‘ä½ç½®æ˜¯ä¸€è‡´çš„ï¼Œå¦‚ä¸Šé¢æ‰€è¿°çš„é˜¿é‡Œäº‘äº‘ç›˜çš„ä¾‹å­ï¼Œæ—¢ç„¶çŸ¥é“ pod è¦è¿è¡Œåˆ°å¯ç”¨åŒº 1ï¼Œé‚£ä¹‹ååˆ›å»ºå­˜å‚¨æ—¶æŒ‡å®šåœ¨å¯ç”¨åŒº 1 åˆ›å»ºå³å¯ã€‚ ä¸ºäº†å®ç°ä¸Šé¢æ‰€è¯´çš„å»¶è¿Ÿç»‘å®šå’Œå»¶è¿Ÿåˆ›å»º PVï¼Œéœ€è¦åœ¨ K8s ä¸­çš„æ”¹åŠ¨æ¶‰åŠåˆ°çš„ç›¸å…³ç»„ä»¶æœ‰ä¸‰ä¸ªï¼š PV Controller ä¹Ÿå°±æ˜¯ persistent volume controllerï¼Œå®ƒéœ€è¦æ”¯æŒå»¶è¿Ÿ Binding è¿™ä¸ªæ“ä½œã€‚ å¦ä¸€ä¸ªæ˜¯åŠ¨æ€ç”Ÿæˆ PV çš„ç»„ä»¶ï¼Œå¦‚æœ pod è°ƒåº¦ç»“æœå‡ºæ¥ä¹‹åï¼Œå®ƒè¦æ ¹æ® pod çš„æ‹“æ‰‘ä¿¡æ¯æ¥å»åŠ¨æ€çš„åˆ›å»º PVã€‚ ç¬¬ä¸‰ç»„ä»¶ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€ä¸ªæ”¹åŠ¨ç‚¹å°±æ˜¯ kube-schedulerã€‚åœ¨ä¸º pod é€‰æ‹© node èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå®ƒä¸ä»…è¦è€ƒè™‘ pod å¯¹ CPU/MEM çš„è®¡ç®—èµ„æºçš„éœ€æ±‚ï¼Œå®ƒè¿˜è¦è€ƒè™‘è¿™ä¸ª pod å¯¹å­˜å‚¨çš„éœ€æ±‚ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®å®ƒçš„ PVCï¼Œå®ƒè¦å…ˆå»çœ‹ä¸€ä¸‹å½“å‰è¦é€‰æ‹©çš„ nodeï¼Œèƒ½å¦æ»¡è¶³èƒ½å’Œè¿™ä¸ª PVC èƒ½åŒ¹é…çš„ PV çš„ nodeAffinityï¼›æˆ–è€…æ˜¯åŠ¨æ€ç”Ÿæˆ PV çš„è¿‡ç¨‹ï¼Œå®ƒè¦æ ¹æ® StorageClass ä¸­æŒ‡å®šçš„æ‹“æ‰‘é™åˆ¶æ¥ check å½“å‰çš„ node æ˜¯ä¸æ˜¯æ»¡è¶³è¿™ä¸ªæ‹“æ‰‘é™åˆ¶ï¼Œè¿™æ ·å°±èƒ½ä¿è¯è°ƒåº¦å™¨æœ€ç»ˆé€‰æ‹©å‡ºæ¥çš„ node å°±èƒ½æ»¡è¶³å­˜å‚¨æœ¬èº«å¯¹æ‹“æ‰‘çš„é™åˆ¶ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:1:6","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç”¨ä¾‹è§£è¯»","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Volume Snapshot/Restoreç¤ºä¾‹ # åˆ›å»º VolumeSnapshotClass å¯¹è±¡apiVersion:snapshot.storage.k8s.io/v1alpha1kind:VolumeSnapshotClassmetadata:name:disk-snapshotclasssnapshotter:diskplugin.csi.aliyun.com# æŒ‡å®šVolumeSnapshotæ—¶ä½¿ç”¨çš„Volume Plugin # åˆ›å»ºVolumeSnapshotå¯¹è±¡apiVersion:snapshot.storage.k8s.io/v1alpha1kind:VolumeSnapshotmetadata:name:disk-snapshotspec:snapshotClassName:disk-snapshotclasssource:name:disk-pvc # Snapshotçš„æ•°æ®æºkind:PersistentVolumeClaim # ä»snapshotä¸­æ¢å¤æ•°æ®åˆ°æ–°ç”Ÿæˆçš„PVå¯¹è±¡ä¸­apiVersion:v1kind:PersistentVolumeClaimmetadata:name:restore-pvcspec:dataSource:name:disk-snapshotkind:VolumeSnapshotapiGroup:snapshot.storage.k8s.io ä¸‹é¢æ¥çœ‹ä¸€ä¸‹å­˜å‚¨å¿«ç…§å¦‚ä½•ä½¿ç”¨ï¼šé¦–å…ˆéœ€è¦é›†ç¾¤ç®¡ç†å‘˜ï¼Œåœ¨é›†ç¾¤ä¸­åˆ›å»º VolumeSnapshotClass å¯¹è±¡ï¼ŒVolumeSnapshotClass ä¸­ä¸€ä¸ªé‡è¦å­—æ®µå°±æ˜¯ Snapshotï¼Œå®ƒæ˜¯æŒ‡å®šçœŸæ­£åˆ›å»ºå­˜å‚¨å¿«ç…§æ‰€ä½¿ç”¨çš„å·æ’ä»¶ï¼Œè¿™ä¸ªå·æ’ä»¶æ˜¯éœ€è¦æå‰éƒ¨ç½²çš„ï¼Œç¨åå†è¯´è¿™ä¸ªå·æ’ä»¶ã€‚ æ¥ä¸‹æ¥ç”¨æˆ·ä»–å¦‚æœè¦åšçœŸæ­£çš„å­˜å‚¨å¿«ç…§ï¼Œéœ€è¦å£°æ˜ä¸€ä¸ª VolumeSnapshotClassï¼ŒVolumeSnapshotClass é¦–å…ˆå®ƒè¦æŒ‡å®šçš„æ˜¯ VolumeSnapshotClassNameï¼Œæ¥ç€å®ƒè¦æŒ‡å®šçš„ä¸€ä¸ªéå¸¸é‡è¦çš„å­—æ®µå°±æ˜¯ sourceï¼Œè¿™ä¸ª source å…¶å®å°±æ˜¯æŒ‡å®šå¿«ç…§çš„æ•°æ®æºæ˜¯å•¥ã€‚è¿™ä¸ªåœ°æ–¹æŒ‡å®š name ä¸º disk-pvcï¼Œä¹Ÿå°±æ˜¯è¯´é€šè¿‡è¿™ä¸ª pvc å¯¹è±¡æ¥åˆ›å»ºå­˜å‚¨å¿«ç…§ã€‚æäº¤è¿™ä¸ª VolumeSnapshot å¯¹è±¡ä¹‹åï¼Œé›†ç¾¤ä¸­çš„ç›¸å…³ç»„ä»¶å®ƒä¼šæ‰¾åˆ°è¿™ä¸ª PVC å¯¹åº”çš„ PV å­˜å‚¨ï¼Œå¯¹è¿™ä¸ª PV å­˜å‚¨åšä¸€æ¬¡å¿«ç…§ã€‚ æœ‰äº†å­˜å‚¨å¿«ç…§ä¹‹åï¼Œé‚£æ¥ä¸‹æ¥æ€ä¹ˆå»ç”¨å­˜å‚¨å¿«ç…§æ¢å¤æ•°æ®å‘¢ï¼Ÿè¿™ä¸ªå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œé€šè¿‡å£°æ˜ä¸€ä¸ªæ–°çš„ PVC å¯¹è±¡å¹¶åœ¨å®ƒçš„ spec ä¸‹é¢çš„ DataSource ä¸­æ¥å£°æ˜æˆ‘çš„æ•°æ®æºæ¥è‡ªäºå“ªä¸ª VolumeSnapshotï¼Œè¿™é‡ŒæŒ‡å®šçš„æ˜¯ disk-snapshot å¯¹è±¡ï¼Œå½“æˆ‘è¿™ä¸ª PVC æäº¤ä¹‹åï¼Œé›†ç¾¤ä¸­çš„ç›¸å…³ç»„ä»¶ï¼Œå®ƒä¼šåŠ¨æ€ç”Ÿæˆæ–°çš„ PV å­˜å‚¨ï¼Œè¿™ä¸ªæ–°çš„ PV å­˜å‚¨ä¸­çš„æ•°æ®å°±æ¥æºäºè¿™ä¸ª Snapshot ä¹‹å‰åšçš„å­˜å‚¨å¿«ç…§ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:2:1","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Local PV ç¤ºä¾‹ # åˆ›å»ºä¸€ä¸ªno-provisioner StorageClasså¯¹è±¡ï¼Œç”¨çš„æ˜¯å‘Šè¯‰PV# Controlleré‡åˆ° .spec.storageClassName ä¸º local-storage çš„# PVC æš‚ä¸åšBindingæ“ä½œkind:StorageClassapiVersion:storage.k8s.io/v1metadata:name:local-storageprovisioner:kubernetes.io/no-provisionervolumeBindingMode:WaitForFirstConsumer# deley binding apiVersion:v1kind:PersistentVolumeClaimmetadata:name:local-pvcspec:storageClassName:local-storageaccessModes:- ReadWriteOnce # åˆ›å»ºLocal PVå¯¹è±¡apiVersion:v1kind:PersistentVolumemetadata:name:local-pvspec:storageClassname:local-storagelocal:path:/sharenodeAffinity:# é™åˆ¶è¯¥PVåªèƒ½åœ¨node1ä¸Šè¢«ä½¿ç”¨required:nodeSelectorTerms:- matchExpressions:- key:kubernetes.io/hostname# æ‹“æ‰‘åŸŸé™åˆ¶ï¼š å•nodeå¯è®¿é—®operator:Invalues:- node1 Local PV å¤§éƒ¨åˆ†ä½¿ç”¨çš„æ—¶å€™éƒ½æ˜¯é€šè¿‡é™æ€åˆ›å»ºçš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¦å…ˆå»å£°æ˜ PV å¯¹è±¡ï¼Œæ—¢ç„¶ Local PV åªèƒ½æ˜¯æœ¬åœ°è®¿é—®ï¼Œå°±éœ€è¦åœ¨å£°æ˜ PV å¯¹è±¡çš„ï¼Œåœ¨ PV å¯¹è±¡ä¸­é€šè¿‡ nodeAffinity æ¥é™åˆ¶æˆ‘è¿™ä¸ª PV åªèƒ½åœ¨å• node ä¸Šè®¿é—®ï¼Œä¹Ÿå°±æ˜¯ç»™è¿™ä¸ª PV åŠ ä¸Šæ‹“æ‰‘é™åˆ¶ã€‚å¦‚ä¸Šå›¾æ‹“æ‰‘çš„ key ç”¨ kubernetes.io/hostname æ¥åšæ ‡è®°ï¼Œä¹Ÿå°±æ˜¯åªèƒ½åœ¨ node1 è®¿é—®ã€‚å¦‚æœæƒ³ç”¨è¿™ä¸ª PVï¼Œä½ çš„ pod å¿…é¡»è¦è°ƒåº¦åˆ° node1 ä¸Šã€‚ æ—¢ç„¶æ˜¯é™æ€åˆ›å»º PV çš„æ–¹å¼ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ storageClassname å‘¢ï¼Ÿå‰é¢ä¹Ÿè¯´äº†ï¼Œåœ¨ Local PV ä¸­ï¼Œå¦‚æœè¦æƒ³è®©å®ƒæ­£å¸¸å·¥ä½œï¼Œéœ€è¦ç”¨åˆ°å»¶è¿Ÿç»‘å®šç‰¹æ€§æ‰è¡Œï¼Œé‚£æ—¢ç„¶æ˜¯å»¶è¿Ÿç»‘å®šï¼Œå½“ç”¨æˆ·åœ¨å†™å®Œ PVC æäº¤ä¹‹åï¼Œå³ä½¿é›†ç¾¤ä¸­æœ‰ç›¸å…³çš„ PV èƒ½è·Ÿå®ƒåŒ¹é…ï¼Œå®ƒä¹Ÿæš‚æ—¶ä¸èƒ½åšåŒ¹é…ï¼Œä¹Ÿå°±æ˜¯è¯´ PV controller ä¸èƒ½é©¬ä¸Šå»åš bindingï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±è¦é€šè¿‡ä¸€ç§æ‰‹æ®µæ¥å‘Šè¯‰ PV controllerï¼Œä»€ä¹ˆæƒ…å†µä¸‹æ˜¯ä¸èƒ½ç«‹å³åš bindingã€‚è¿™é‡Œçš„ storageClass å°±æ˜¯ä¸ºäº†èµ·åˆ°è¿™ä¸ªå‰¯ä½œç”¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° storageClass é‡Œé¢çš„ provisioner æŒ‡å®šçš„æ˜¯ no-provisionerï¼Œå…¶å®å°±æ˜¯ç›¸å½“äºå‘Šè¯‰ K8s å®ƒä¸ä¼šå»åŠ¨æ€åˆ›å»º PVï¼Œå®ƒä¸»è¦ç”¨åˆ° storageclass çš„ VolumeBindingMode å­—æ®µï¼Œå« WaitForFirstConsumerï¼Œå¯ä»¥å…ˆç®€å•åœ°è®¤ä¸ºå®ƒæ˜¯å»¶è¿Ÿç»‘å®šã€‚ å½“ç”¨æˆ·å¼€å§‹æäº¤ PVC çš„æ—¶å€™ï¼Œpv controller åœ¨çœ‹åˆ°è¿™ä¸ª pvc çš„æ—¶å€™ï¼Œå®ƒä¼šæ‰¾åˆ°ç›¸åº”çš„ storageClassï¼Œå‘ç°è¿™ä¸ª BindingMode æ˜¯å»¶è¿Ÿç»‘å®šï¼Œå®ƒå°±ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚ ä¹‹åå½“çœŸæ­£ä½¿ç”¨è¿™ä¸ª pvc çš„ podï¼Œåœ¨è°ƒåº¦çš„æ—¶å€™ï¼Œå½“å®ƒæ°å¥½è°ƒåº¦åœ¨ç¬¦åˆ pv nodeaffinity çš„ node çš„ä¸Šé¢åï¼Œè¿™ä¸ª pod é‡Œé¢æ‰€ä½¿ç”¨çš„ PVC æ‰ä¼šçœŸæ­£åœ°ä¸ PV åšç»‘å®šï¼Œè¿™æ ·å°±ä¿è¯æˆ‘ pod è°ƒåº¦åˆ°è¿™å° node ä¸Šä¹‹åï¼Œè¿™ä¸ª PVC æ‰ä¸è¿™ä¸ª PV ç»‘å®šï¼Œæœ€ç»ˆä¿è¯çš„æ˜¯åˆ›å»ºå‡ºæ¥çš„ pod èƒ½è®¿é—®è¿™å— Local PVï¼Œä¹Ÿå°±æ˜¯é™æ€ Provisioning åœºæ™¯ä¸‹æ€ä¹ˆå»æ»¡è¶³ PV çš„æ‹“æ‰‘é™åˆ¶ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:2:2","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"é™åˆ¶ Dynamic Provisioning PV æ‹“æ‰‘ç¤ºä¾‹ apiVersion:storage.k8s.io/v1kind:StorageClassmetadata:name:csi-diskprovisioner:diskplugin.csi.aliyun.comparameters:regionId:cn-hangzhoufsType:ext4type:cloud_ssdvolumeBindingMode:WaitForFirstConsumerallowedTopologies:- matchLabelExpressions:# æ‹“æ‰‘åŸŸé™åˆ¶ï¼šåŠ¨æ€åˆ›å»ºçš„PVåªèƒ½åœ¨å¯ç”¨åŒºcn-hangzhou-dè¢«ä½¿ç”¨- key:topology.diskplugin.csi.aliyun.com/zonevalues:- cn-hanghzou-dreclaimPolicy:Delete apiVersion:v1kind:PersistentVolumeClaimmetadata:name:disk-pvcspec:accessMode:- ReadWriteOncestorageClassName:csi-disk åŠ¨æ€å°±æ˜¯æŒ‡åŠ¨æ€åˆ›å»º PV å°±æœ‰æ‹“æ‰‘ä½ç½®çš„é™åˆ¶ï¼Œé‚£æ€ä¹ˆå»æŒ‡å®šï¼Ÿ é¦–å…ˆåœ¨ storageclass è¿˜æ˜¯éœ€è¦æŒ‡å®š BindingModeï¼Œå°±æ˜¯ WaitForFirstConsumerï¼Œå°±æ˜¯å»¶è¿Ÿç»‘å®šã€‚ å…¶æ¬¡ç‰¹åˆ«é‡è¦çš„ä¸€ä¸ªå­—æ®µå°±æ˜¯ allowedTopologiesï¼Œé™åˆ¶å°±åœ¨è¿™ä¸ªåœ°æ–¹ã€‚ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°æ‹“æ‰‘é™åˆ¶æ˜¯å¯ç”¨åŒºçš„çº§åˆ«ï¼Œè¿™é‡Œå…¶å®æœ‰ä¸¤å±‚æ„æ€ï¼š ç¬¬ä¸€å±‚æ„æ€å°±æ˜¯è¯´æˆ‘åœ¨åŠ¨æ€åˆ›å»º PV çš„æ—¶å€™ï¼Œåˆ›å»ºå‡ºæ¥çš„ PV å¿…é¡»æ˜¯åœ¨è¿™ä¸ªå¯ç”¨åŒºå¯ä»¥è®¿é—®çš„; ç¬¬äºŒå±‚å«ä¹‰æ˜¯å› ä¸ºå£°æ˜çš„æ˜¯å»¶è¿Ÿç»‘å®šï¼Œé‚£è°ƒåº¦å™¨åœ¨å‘ç°ä½¿ç”¨å®ƒçš„ PVC æ­£å¥½å¯¹åº”çš„æ˜¯è¯¥ storageclass çš„æ—¶å€™ï¼Œè°ƒåº¦ pod å°±è¦é€‰æ‹©ä½äºè¯¥å¯ç”¨åŒºçš„ nodesã€‚ æ€»ä¹‹ï¼Œå°±æ˜¯è¦ä»ä¸¤æ–¹é¢ä¿è¯ï¼Œä¸€æ˜¯åŠ¨æ€åˆ›å»ºå‡ºæ¥çš„å­˜å‚¨æ—¶è¦èƒ½è¢«è¿™ä¸ªå¯ç”¨åŒºè®¿é—®çš„ï¼ŒäºŒæ˜¯æˆ‘è°ƒåº¦å™¨åœ¨é€‰æ‹© node çš„æ—¶å€™ï¼Œè¦è½åœ¨è¿™ä¸ªå¯ç”¨åŒºå†…çš„ï¼Œè¿™æ ·çš„è¯å°±ä¿è¯æˆ‘çš„å­˜å‚¨å’Œæˆ‘è¦ä½¿ç”¨å­˜å‚¨çš„è¿™ä¸ª pod å®ƒæ‰€å¯¹åº”çš„ nodeï¼Œå®ƒä»¬ä¹‹é—´çš„æ‹“æ‰‘åŸŸæ˜¯åœ¨åŒä¸€ä¸ªæ‹“æ‰‘åŸŸï¼Œç”¨æˆ·åœ¨å†™ PVC æ–‡ä»¶çš„æ—¶å€™ï¼Œå†™æ³•æ˜¯è·Ÿä»¥å‰çš„å†™æ³•æ˜¯ä¸€æ ·çš„ï¼Œä¸»è¦æ˜¯åœ¨ storageclass ä¸­è¦åšä¸€äº›æ‹“æ‰‘é™åˆ¶ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:2:3","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å¤„ç†æµç¨‹","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"kubernetes å¯¹ Volume Snapshot/Restore å¤„ç†æµç¨‹ Volume Snapshot/Restore Flow é¦–å…ˆæ¥çœ‹ä¸€ä¸‹å­˜å‚¨å¿«ç…§çš„å¤„ç†æµç¨‹ï¼Œè¿™é‡Œæ¥é¦–å…ˆè§£é‡Šä¸€ä¸‹ csi éƒ¨åˆ†ã€‚K8s ä¸­å¯¹å­˜å‚¨çš„æ‰©å±•åŠŸèƒ½éƒ½æ˜¯æ¨èé€šè¿‡ csi out-of-tree çš„æ–¹å¼æ¥å®ç°çš„ã€‚ csi å®ç°å­˜å‚¨æ‰©å±•ä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†ï¼š ç¬¬ä¸€éƒ¨åˆ†æ˜¯ç”± K8s ç¤¾åŒºæ¨åŠ¨å®ç°çš„ csi controller éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„ csi-snapshottor controller ä»¥åŠ csi-provisioner controllerï¼Œè¿™äº›ä¸»è¦æ˜¯é€šç”¨çš„ controller éƒ¨åˆ†; å¦å¤–ä¸€éƒ¨åˆ†æ˜¯ç”±ç‰¹å®šçš„äº‘å­˜å‚¨å‚å•†ç”¨è‡ªèº« OpenAPI å®ç°çš„ä¸åŒçš„ csi-plugin éƒ¨åˆ†ï¼Œä¹Ÿå«å­˜å‚¨çš„ driver éƒ¨åˆ†ã€‚ ä¸¤éƒ¨åˆ†éƒ¨ä»¶é€šè¿‡ unix domain socket é€šä¿¡è¿æ¥åˆ°ä¸€èµ·ã€‚æœ‰è¿™ä¸¤éƒ¨åˆ†ï¼Œæ‰èƒ½å½¢æˆä¸€ä¸ªçœŸæ­£çš„å­˜å‚¨æ‰©å±•åŠŸèƒ½ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“ç”¨æˆ·æäº¤ VolumeSnapshot å¯¹è±¡ä¹‹åï¼Œä¼šè¢« csi-snapshottor controller watch åˆ°ã€‚ä¹‹åå®ƒä¼šé€šè¿‡ GPPC è°ƒç”¨åˆ° csi-pluginï¼Œcsi-plugin é€šè¿‡ OpenAPI æ¥çœŸæ­£å®ç°å­˜å‚¨å¿«ç…§çš„åŠ¨ä½œï¼Œç­‰å­˜å‚¨å¿«ç…§å·²ç»ç”Ÿæˆä¹‹åï¼Œä¼šè¿”å›åˆ° csi-snapshottor controller ä¸­ï¼Œcsi-snapshottor controller ä¼šå°†å­˜å‚¨å¿«ç…§ç”Ÿæˆçš„ç›¸å…³ä¿¡æ¯æ”¾åˆ° VolumeSnapshotContent å¯¹è±¡ä¸­å¹¶å°†ç”¨æˆ·æäº¤çš„ VolumeSnapshot åš boundã€‚è¿™ä¸ª bound å…¶å®å°±æœ‰ç‚¹ç±»ä¼¼ PV å’Œ PVC çš„ bound ä¸€æ ·ã€‚ æœ‰äº†å­˜å‚¨å¿«ç…§ï¼Œå¦‚ä½•å»ä½¿ç”¨å­˜å‚¨å¿«ç…§æ¢å¤ä¹‹å‰çš„æ•°æ®å‘¢ï¼Ÿå‰é¢ä¹Ÿè¯´è¿‡ï¼Œé€šè¿‡å£°æ˜ä¸€ä¸ªæ–°çš„ PVC å¯¹è±¡ï¼Œå¹¶ä¸”æŒ‡å®šä»–çš„ dataSource ä¸º Snapshot å¯¹è±¡ï¼Œå½“æäº¤ PVC çš„æ—¶å€™ä¼šè¢« csi-provisioner watch åˆ°ï¼Œä¹‹åä¼šé€šè¿‡ GRPC å»åˆ›å»ºå­˜å‚¨ã€‚è¿™é‡Œåˆ›å»ºå­˜å‚¨è·Ÿä¹‹å‰è®²è§£çš„ csi-provisioner æœ‰ä¸€ä¸ªä¸å¤ªä¸€æ ·çš„åœ°æ–¹ï¼Œå°±æ˜¯å®ƒé‡Œé¢è¿˜æŒ‡å®šäº† Snapshot çš„ IDï¼Œå½“å»äº‘å‚å•†åˆ›å»ºå­˜å‚¨æ—¶ï¼Œéœ€è¦å¤šåšä¸€æ­¥æ“ä½œï¼Œå³å°†ä¹‹å‰çš„å¿«ç…§æ•°æ®æ¢å¤åˆ°æ–°åˆ›å»ºçš„å­˜å‚¨ä¸­ã€‚ä¹‹åæµç¨‹è¿”å›åˆ° csi-provisionerï¼Œå®ƒä¼šå°†æ–°åˆ›å»ºçš„å­˜å‚¨çš„ç›¸å…³ä¿¡æ¯å†™åˆ°ä¸€ä¸ªæ–°çš„ PV å¯¹è±¡ä¸­ï¼Œæ–°çš„ PV å¯¹è±¡è¢« PV controller watch åˆ°å®ƒä¼šå°†ç”¨æˆ·æäº¤çš„ PVC ä¸ PV åšä¸€ä¸ª boundï¼Œä¹‹å pod å°±å¯ä»¥é€šè¿‡ PVC æ¥ä½¿ç”¨ Restore å‡ºæ¥çš„æ•°æ®äº†ã€‚è¿™æ˜¯ K8s ä¸­å¯¹å­˜å‚¨å¿«ç…§çš„å¤„ç†æµç¨‹ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"kubernetes å¯¹ Volume Topology-aware Scheduling å¤„ç†æµç¨‹ Volume Topolopy-Aware Scheduling Flow ç¬¬ä¸€ä¸ªæ­¥éª¤å…¶å®å°±æ˜¯è¦å»å£°æ˜å»¶è¿Ÿç»‘å®šï¼Œè¿™ä¸ªé€šè¿‡ StorageClass æ¥åšçš„ï¼Œä¸Šé¢å·²ç»é˜è¿°è¿‡ï¼Œè¿™é‡Œå°±ä¸åšè¯¦ç»†æè¿°äº†ã€‚ æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹è°ƒåº¦å™¨ï¼Œä¸Šå›¾ä¸­çº¢è‰²éƒ¨åˆ†å°±æ˜¯è°ƒåº¦å™¨æ–°åŠ çš„å­˜å‚¨æ‹“æ‰‘è°ƒåº¦é€»è¾‘ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ä¸åŠ çº¢è‰²éƒ¨åˆ†æ—¶è°ƒåº¦å™¨çš„ä¸ºä¸€ä¸ª pod é€‰æ‹© node æ—¶ï¼Œå®ƒçš„å¤§æ¦‚æµç¨‹ï¼š é¦–å…ˆç”¨æˆ·æäº¤å®Œ pod ä¹‹åï¼Œä¼šè¢«è°ƒåº¦å™¨ watch åˆ°ï¼Œå®ƒå°±ä¼šå»é¦–å…ˆåšé¢„é€‰ï¼Œé¢„é€‰å°±æ˜¯è¯´å®ƒä¼šå°†é›†ç¾¤ä¸­çš„æ‰€æœ‰ node éƒ½æ¥ä¸è¿™ä¸ª pod å®ƒéœ€è¦çš„èµ„æºåšåŒ¹é…ï¼› å¦‚æœåŒ¹é…ä¸Šï¼Œå°±ç›¸å½“äºè¿™ä¸ª node å¯ä»¥ä½¿ç”¨ï¼Œå½“ç„¶å¯èƒ½ä¸æ­¢ä¸€ä¸ª node å¯ä»¥ä½¿ç”¨ï¼Œæœ€ç»ˆä¼šé€‰å‡ºæ¥ä¸€æ‰¹ nodeï¼› ç„¶åå†ç»è¿‡ç¬¬äºŒä¸ªé˜¶æ®µä¼˜é€‰ï¼Œä¼˜é€‰å°±ç›¸å½“äºæˆ‘è¦å¯¹è¿™äº› node åšä¸€ä¸ªæ‰“åˆ†çš„è¿‡ç¨‹ï¼Œé€šè¿‡æ‰“åˆ†æ‰¾åˆ°æœ€åŒ¹é…çš„ä¸€ä¸ª nodeï¼› ä¹‹åè°ƒåº¦å™¨å°†è°ƒåº¦ç»“æœå†™åˆ° pod é‡Œé¢çš„ spec.nodeName å­—æ®µé‡Œé¢ï¼Œç„¶åä¼šè¢«ç›¸åº”çš„ node ä¸Šé¢çš„ kubelet watch åˆ°ï¼Œæœ€åå°±å¼€å§‹åˆ›å»º pod çš„æ•´ä¸ªæµç¨‹ã€‚ é‚£ç°åœ¨çœ‹ä¸€ä¸‹åŠ ä¸Šå·ç›¸å…³çš„è°ƒåº¦çš„æ—¶å€™ï¼Œç­›é€‰ node(ç¬¬äºŒä¸ªæ­¥éª¤)åˆæ˜¯æ€ä¹ˆåšçš„ï¼Ÿ å…ˆå°±è¦æ‰¾åˆ° pod ä¸­ä½¿ç”¨çš„æ‰€æœ‰ PVCï¼Œæ‰¾åˆ°å·²ç» bound çš„ PVCï¼Œä»¥åŠéœ€è¦å»¶è¿Ÿç»‘å®šçš„è¿™äº› PVCï¼› å¯¹äºå·²ç» bound çš„ PVCï¼Œè¦ check ä¸€ä¸‹å®ƒå¯¹åº”çš„ PV é‡Œé¢çš„ nodeAffinity ä¸å½“å‰ node çš„æ‹“æ‰‘æ˜¯å¦åŒ¹é… ã€‚å¦‚æœä¸åŒ¹é…ï¼Œ å°±è¯´æ˜è¿™ä¸ª node ä¸èƒ½è¢«è°ƒåº¦ã€‚å¦‚æœåŒ¹é…ï¼Œç»§ç»­å¾€ä¸‹èµ°ï¼Œå°±è¦å»çœ‹ä¸€ä¸‹éœ€è¦å»¶è¿Ÿç»‘å®šçš„ PVCï¼› å¯¹äºéœ€è¦å»¶è¿Ÿç»‘å®šçš„ PVCã€‚å…ˆå»è·å–é›†ç¾¤ä¸­å­˜é‡çš„ PVï¼Œæ»¡è¶³ PVC éœ€æ±‚çš„ï¼Œå…ˆæŠŠå®ƒå…¨éƒ¨æå‡ºæ¥ï¼Œç„¶åå†å°†å®ƒä»¬ä¸€ä¸€ä¸å½“å‰çš„ node labels ä¸Šçš„æ‹“æ‰‘åšåŒ¹é…ï¼Œå¦‚æœå®ƒä»¬(å­˜é‡çš„ PV)éƒ½ä¸åŒ¹é…ï¼Œé‚£å°±è¯´æ˜å½“å‰çš„å­˜é‡çš„ PV ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œå°±è¦è¿›ä¸€æ­¥å»çœ‹ä¸€ä¸‹å¦‚æœè¦åŠ¨æ€åˆ›å»º PV å½“å‰ node æ˜¯å¦æ»¡è¶³æ‹“æ‰‘é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¿˜è¦è¿›ä¸€æ­¥å» check StorageClass ä¸­çš„æ‹“æ‰‘é™åˆ¶ï¼Œå¦‚æœ StorageClass ä¸­å£°æ˜çš„æ‹“æ‰‘é™åˆ¶ä¸å½“å‰çš„ node ä¸Šé¢å·²ç»æœ‰çš„ labels é‡Œé¢çš„æ‹“æ‰‘æ˜¯ç›¸åŒ¹é…çš„ï¼Œé‚£å…¶å®è¿™ä¸ª node å°±å¯ä»¥ä½¿ç”¨ï¼Œå¦‚æœä¸åŒ¹é…ï¼Œè¯´æ˜è¯¥ node å°±ä¸èƒ½è¢«è°ƒåº¦ã€‚ ç»è¿‡è¿™ä¸Šé¢æ­¥éª¤ä¹‹åï¼Œå°±æ‰¾åˆ°äº†æ‰€æœ‰å³æ»¡è¶³ pod è®¡ç®—èµ„æºéœ€æ±‚åˆæ»¡è¶³ pod å­˜å‚¨èµ„æºéœ€æ±‚çš„æ‰€æœ‰ nodesã€‚ å½“ node é€‰å‡ºæ¥ä¹‹åï¼Œç¬¬ä¸‰ä¸ªæ­¥éª¤å°±æ˜¯è°ƒåº¦å™¨å†…éƒ¨åšçš„ä¸€ä¸ªä¼˜åŒ–ã€‚è¿™é‡Œç®€å•è¿‡ä¸€ä¸‹ï¼Œå°±æ˜¯æ›´æ–°ç»è¿‡é¢„é€‰å’Œä¼˜é€‰ä¹‹åï¼Œpod çš„ node ä¿¡æ¯ï¼Œä»¥åŠ PV å’Œ PVC åœ¨ scheduler ä¸­åšçš„ä¸€äº› cache ä¿¡æ¯ã€‚ ç¬¬å››ä¸ªæ­¥éª¤ä¹Ÿæ˜¯é‡è¦çš„ä¸€æ­¥ï¼Œå·²ç»é€‰æ‹©å‡ºæ¥ node çš„ Podï¼Œä¸ç®¡å…¶ä½¿ç”¨çš„ PVC æ˜¯è¦ binding å·²ç»å­˜åœ¨çš„ PVï¼Œè¿˜æ˜¯è¦åšåŠ¨æ€åˆ›å»º PVï¼Œè¿™æ—¶å°±å¯ä»¥å¼€å§‹åšã€‚ç”±è°ƒåº¦å™¨æ¥è§¦å‘ï¼Œè°ƒåº¦å™¨å®ƒå°±ä¼šå»æ›´æ–° PVC å¯¹è±¡å’Œ PV å¯¹è±¡é‡Œé¢çš„ç›¸å…³ä¿¡æ¯ï¼Œç„¶åå»è§¦å‘ PV controller å»åš binding æ“ä½œï¼Œæˆ–è€…æ˜¯ç”± csi-provisioner å»åšåŠ¨æ€åˆ›å»ºæµç¨‹ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ€»ç»“ é€šè¿‡å¯¹æ¯” PVC\u0026PV ä½“ç³»è®²è§£äº†å­˜å‚¨å¿«ç…§çš„ç›¸å…³ K8s èµ„æºå¯¹è±¡ä»¥åŠä½¿ç”¨æ–¹æ³•ï¼› é€šè¿‡ä¸¤ä¸ªå®é™…åœºæ™¯é‡åˆ°çš„é—®é¢˜å¼•å‡ºå­˜å‚¨æ‹“æ‰‘è°ƒåº¦åŠŸèƒ½å¿…è¦æ€§ï¼Œä»¥åŠ K8s ä¸­å¦‚ä½•é€šè¿‡æ‹“æ‰‘è°ƒåº¦æ¥è§£å†³è¿™äº›é—®é¢˜ï¼› é€šè¿‡å‰–æ K8s ä¸­å­˜å‚¨å¿«ç…§å’Œå­˜å‚¨æ‹“æ‰‘è°ƒåº¦å†…éƒ¨è¿è¡Œæœºåˆ¶ï¼Œæ·±å…¥ç†è§£è¯¥éƒ¨åˆ†åŠŸèƒ½çš„å·¥ä½œåŸç†ã€‚ ","date":"2021-07-31","objectID":"/application-storage-and-persistent-data-volume-storage-snapshot/:4:0","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","å­˜å‚¨å¿«ç…§","æ‹“æ‰‘è°ƒåº¦"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - å­˜å‚¨å¿«ç…§ä¸æ‹“æ‰‘è°ƒåº¦","uri":"/application-storage-and-persistent-data-volume-storage-snapshot/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡ä»‹ç»äº† K8s Volume ä½¿ç”¨åœºæ™¯ã€PVC/PV/StorageClass åŸºæœ¬æ“ä½œå’Œæ¦‚å¿µè§£æã€PVC+PV ä½“ç³»çš„è®¾è®¡ä¸å®ç°åŸç†","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Volumes ä»‹ç»","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Pod Volumesé¦–å…ˆæ¥çœ‹ä¸€ä¸‹ Pod Volumes çš„ä½¿ç”¨åœºæ™¯ï¼š åœºæ™¯ä¸€ï¼šå¦‚æœ pod ä¸­çš„æŸä¸€ä¸ªå®¹å™¨åœ¨è¿è¡Œæ—¶å¼‚å¸¸é€€å‡ºï¼Œè¢« kubelet é‡æ–°æ‹‰èµ·ä¹‹åï¼Œå¦‚ä½•ä¿è¯ä¹‹å‰å®¹å™¨äº§ç”Ÿçš„é‡è¦æ•°æ®æ²¡æœ‰ä¸¢å¤±ï¼Ÿ åœºæ™¯äºŒï¼šå¦‚æœåŒä¸€ä¸ª pod ä¸­çš„å¤šä¸ªå®¹å™¨æƒ³è¦å…±äº«æ•°æ®ï¼Œåº”è¯¥å¦‚ä½•å»åšï¼Ÿ ä»¥ä¸Šä¸¤ä¸ªåœºæ™¯ï¼Œå…¶å®éƒ½å¯ä»¥å€ŸåŠ© Volumes æ¥å¾ˆå¥½åœ°è§£å†³ï¼Œæ¥ä¸‹æ¥é¦–å…ˆçœ‹ä¸€ä¸‹ Pod Volumes çš„å¸¸è§ç±»å‹ï¼š æœ¬åœ°å­˜å‚¨ï¼Œå¸¸ç”¨çš„æœ‰ emptydir/hostpathï¼› ç½‘ç»œå­˜å‚¨ï¼šç½‘ç»œå­˜å‚¨å½“å‰çš„å®ç°æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ in-treeï¼Œå®ƒçš„å®ç°çš„ä»£ç æ˜¯æ”¾åœ¨ K8s ä»£ç ä»“åº“ä¸­çš„ï¼Œéšç€k8så¯¹å­˜å‚¨ç±»å‹æ”¯æŒçš„å¢å¤šï¼Œè¿™ç§æ–¹å¼ä¼šç»™k8sæœ¬èº«çš„ç»´æŠ¤å’Œå‘å±•å¸¦æ¥å¾ˆå¤§çš„è´Ÿæ‹…ï¼›è€Œç¬¬äºŒç§å®ç°æ–¹å¼æ˜¯ out-of-treeï¼Œå®ƒçš„å®ç°å…¶å®æ˜¯ç»™ K8s æœ¬èº«è§£è€¦çš„ï¼Œé€šè¿‡æŠ½è±¡æ¥å£å°†ä¸åŒå­˜å‚¨çš„driverå®ç°ä»k8sä»£ç ä»“åº“ä¸­å‰¥ç¦»ï¼Œå› æ­¤out-of-tree æ˜¯åé¢ç¤¾åŒºä¸»æ¨çš„ä¸€ç§å®ç°ç½‘ç»œå­˜å‚¨æ’ä»¶çš„æ–¹å¼ï¼› Projected Volumesï¼šå®ƒå…¶å®æ˜¯å°†ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œå¦‚ secret/configmap ç”¨å·çš„å½¢å¼æŒ‚è½½åœ¨å®¹å™¨ä¸­ï¼Œè®©å®¹å™¨ä¸­çš„ç¨‹åºå¯ä»¥é€šè¿‡POSIXæ¥å£æ¥è®¿é—®é…ç½®æ•°æ®ï¼› PV ä¸ PVC å°±æ˜¯æœ¬æ–‡è¦é‡ç‚¹ä»‹ç»çš„å†…å®¹ã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:1:1","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Persistent Volumesæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹ PVï¼ˆPersistent Volumesï¼‰ã€‚æ—¢ç„¶å·²ç»æœ‰äº† Pod Volumesï¼Œä¸ºä»€ä¹ˆåˆè¦å¼•å…¥ PV å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ pod ä¸­å£°æ˜çš„ volume ç”Ÿå‘½å‘¨æœŸä¸ pod æ˜¯ç›¸åŒçš„ï¼Œä»¥ä¸‹æœ‰å‡ ç§å¸¸è§çš„åœºæ™¯ï¼š åœºæ™¯ä¸€ï¼špod é‡å»ºé”€æ¯ï¼Œå¦‚ç”¨ Deployment ç®¡ç†çš„ podï¼Œåœ¨åšé•œåƒå‡çº§çš„è¿‡ç¨‹ä¸­ï¼Œä¼šäº§ç”Ÿæ–°çš„ podå¹¶ä¸”åˆ é™¤æ—§çš„ pod ï¼Œé‚£æ–°æ—§ pod ä¹‹é—´å¦‚ä½•å¤ç”¨æ•°æ®ï¼Ÿ åœºæ™¯äºŒï¼šå®¿ä¸»æœºå®•æœºçš„æ—¶å€™ï¼Œè¦æŠŠä¸Šé¢çš„ pod è¿ç§»ï¼Œè¿™ä¸ªæ—¶å€™ StatefulSet ç®¡ç†çš„ podï¼Œå…¶å®å·²ç»å®ç°äº†å¸¦å·è¿ç§»çš„è¯­ä¹‰ã€‚è¿™æ—¶é€šè¿‡ Pod Volumes æ˜¾ç„¶æ˜¯åšä¸åˆ°çš„ï¼› åœºæ™¯ä¸‰ï¼šå¤šä¸ª pod ä¹‹é—´ï¼Œå¦‚æœæƒ³è¦å…±äº«æ•°æ®ï¼Œåº”è¯¥å¦‚ä½•å»å£°æ˜å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼ŒåŒä¸€ä¸ª pod ä¸­å¤šä¸ªå®¹å™¨æƒ³å…±äº«æ•°æ®ï¼Œå¯ä»¥å€ŸåŠ© Pod Volumes æ¥è§£å†³ï¼›å½“å¤šä¸ª pod æƒ³å…±äº«æ•°æ®æ—¶ï¼ŒPod Volumes å°±å¾ˆéš¾å»è¡¨è¾¾è¿™ç§è¯­ä¹‰ï¼› åœºæ™¯å››ï¼šå¦‚æœè¦æƒ³å¯¹æ•°æ®å·åšä¸€äº›åŠŸèƒ½æ‰©å±•æ€§ï¼Œå¦‚ï¼šsnapshotã€resize è¿™äº›åŠŸèƒ½ï¼Œåˆåº”è¯¥å¦‚ä½•å»åšå‘¢ï¼Ÿ ä»¥ä¸Šåœºæ™¯ä¸­ï¼Œé€šè¿‡ Pod Volumes å¾ˆéš¾å‡†ç¡®åœ°è¡¨è¾¾å®ƒçš„å¤ç”¨/å…±äº«è¯­ä¹‰ï¼Œå¯¹å®ƒçš„æ‰©å±•ä¹Ÿæ¯”è¾ƒå›°éš¾ã€‚å› æ­¤ K8s ä¸­åˆå¼•å…¥äº† Persistent Volumes æ¦‚å¿µï¼Œå®ƒå¯ä»¥å°†å­˜å‚¨å’Œè®¡ç®—åˆ†ç¦»ï¼Œé€šè¿‡ä¸åŒçš„ç»„ä»¶æ¥ç®¡ç†å­˜å‚¨èµ„æºå’Œè®¡ç®—èµ„æºï¼Œç„¶åè§£è€¦ pod å’Œ Volume ä¹‹é—´ç”Ÿå‘½å‘¨æœŸçš„å…³è”ã€‚è¿™æ ·ï¼Œå½“æŠŠ pod åˆ é™¤ä¹‹åï¼Œå®ƒä½¿ç”¨çš„PVä»ç„¶å­˜åœ¨ï¼Œè¿˜å¯ä»¥è¢«æ–°å»ºçš„ pod å¤ç”¨ã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:1:2","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"PVCè®¾è®¡æ„å›¾ èŒè´£åˆ†ç¦»ï¼ŒPVCä¸­åªç”¨å£°æ˜è‡ªå·±éœ€è¦çš„å­˜å‚¨sizeã€access nodeç­‰ä¸šåŠ¡çœŸæ­£å…³å¿ƒçš„å­˜å‚¨éœ€æ±‚ï¼ŒPVå’Œå…¶å¯¹åº”çš„åç«¯å­˜å‚¨ä¿¡æ¯åˆ™ç”±äº¤ç»™cluster adminç»Ÿä¸€è¿ç»´å’Œç®¡æ§ï¼Œå®‰å…¨è®¿é—®ç­–ç•¥æ›´å®¹æ˜“æ§åˆ¶ã€‚ PVCç®€åŒ–äº†Userå¯¹å­˜å‚¨çš„éœ€æ±‚ï¼ŒPVæ‰æ˜¯å­˜å‚¨çš„å®é™…ä¿¡æ¯çš„æ‰¿è½½ä½“ï¼Œé€šè¿‡kube-controller-managerä¸­çš„PersisentVolumeControllerå°†PVCä¸åˆé€‚çš„PV boundåˆ°ä¸€èµ·ï¼Œä»è€Œæ»¡è¶³Userå¯¹å­˜å‚¨çš„å®é™…éœ€æ±‚ã€‚ PVCåƒæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­æŠ½è±¡å‡ºæ¥çš„æ¥å£ï¼ŒPVæ˜¯æ¥å£å¯¹åº”çš„å®ç°ã€‚ access nodeæ˜¯ä»€ä¹ˆï¼Ÿå…¶å®å°±æ˜¯ï¼šæˆ‘è¦ä½¿ç”¨çš„å­˜å‚¨æ˜¯å¯ä»¥è¢«å¤šä¸ªnodeå…±äº«è¿˜æ˜¯åªèƒ½å•nodeç‹¬å è®¿é—®(æ³¨æ„æ˜¯node levelè€Œä¸æ˜¯pod level)ï¼Ÿåªè¯»è¿˜æ˜¯è¯»å†™è®¿é—®ï¼Ÿç”¨æˆ·åªç”¨å…³å¿ƒè¿™äº›ä¸œè¥¿ï¼Œä¸å­˜å‚¨ç›¸å…³çš„å®ç°ç»†èŠ‚æ˜¯ä¸éœ€è¦å…³å¿ƒçš„ã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:1:3","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Static Volume Provisioningé™æ€ Provisioningï¼šç”±é›†ç¾¤ç®¡ç†å‘˜äº‹å…ˆå»è§„åˆ’è¿™ä¸ªé›†ç¾¤ä¸­çš„ç”¨æˆ·ä¼šæ€æ ·ä½¿ç”¨å­˜å‚¨ï¼Œå®ƒä¼šå…ˆé¢„åˆ†é…ä¸€äº›å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯é¢„å…ˆåˆ›å»ºä¸€äº› PVï¼›ç„¶åç”¨æˆ·åœ¨æäº¤è‡ªå·±çš„å­˜å‚¨éœ€æ±‚ï¼ˆä¹Ÿå°±æ˜¯ PVCï¼‰çš„æ—¶å€™ï¼ŒK8s å†…éƒ¨ç›¸å…³ç»„ä»¶ä¼šå¸®åŠ©å®ƒæŠŠ PVC å’Œ PV åšç»‘å®šï¼›ä¹‹åç”¨æˆ·å†é€šè¿‡ pod å»ä½¿ç”¨å­˜å‚¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡ PVC æ‰¾åˆ°ç›¸åº”çš„ PVï¼Œå®ƒå°±å¯ä»¥ä½¿ç”¨äº†ã€‚ Static Volume Provisioning é™æ€äº§ç”Ÿæ–¹å¼æœ‰ä»€ä¹ˆä¸è¶³å‘¢ï¼Ÿå¯ä»¥çœ‹åˆ°ï¼Œé¦–å…ˆéœ€è¦é›†ç¾¤ç®¡ç†å‘˜é¢„åˆ†é…ï¼Œé¢„åˆ†é…å…¶å®æ˜¯å¾ˆéš¾é¢„æµ‹ç”¨æˆ·çœŸå®éœ€æ±‚çš„ã€‚ä¸¾ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼šå¦‚æœç”¨æˆ·éœ€è¦çš„æ˜¯ 20Gï¼Œç„¶è€Œé›†ç¾¤ç®¡ç†å‘˜åœ¨åˆ†é…çš„æ—¶å€™å¯èƒ½æœ‰ 80G ã€100G çš„ï¼Œä½†æ²¡æœ‰ 20G çš„ï¼Œè¿™æ ·å°±å¾ˆéš¾æ»¡è¶³ç”¨æˆ·çš„çœŸå®éœ€æ±‚ï¼Œä¹Ÿä¼šé€ æˆèµ„æºæµªè´¹ã€‚æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹å¼å‘¢ï¼Ÿ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:1:4","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Dynamic Volume ProvisioningåŠ¨æ€ä¾›ç»™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯è¯´ç°åœ¨é›†ç¾¤ç®¡ç†å‘˜ä¸é¢„åˆ†é… PVï¼Œä»–å†™äº†ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶ï¼Œè¿™ä¸ªæ¨¡æ¿æ–‡ä»¶æ˜¯ç”¨æ¥è¡¨ç¤ºåˆ›å»ºæŸä¸€ç±»å‹å­˜å‚¨ï¼ˆå—å­˜å‚¨ï¼Œæ–‡ä»¶å­˜å‚¨ç­‰ï¼‰æ‰€éœ€çš„ä¸€äº›å‚æ•°ï¼Œè¿™äº›å‚æ•°æ˜¯ç”¨æˆ·ä¸å…³å¿ƒçš„ï¼Œç»™å­˜å‚¨æœ¬èº«å®ç°æœ‰å…³çš„å‚æ•°ã€‚ç”¨æˆ·åªéœ€è¦æäº¤è‡ªèº«çš„å­˜å‚¨éœ€æ±‚ï¼Œä¹Ÿå°±æ˜¯PVCæ–‡ä»¶ï¼Œå¹¶åœ¨ PVC ä¸­æŒ‡å®šä½¿ç”¨çš„å­˜å‚¨æ¨¡æ¿ï¼ˆStorageClassï¼‰ã€‚ Dynamic Volume Provisioning K8s é›†ç¾¤ä¸­çš„ç®¡æ§ç»„ä»¶ï¼Œä¼šç»“åˆ PVC å’Œ StorageClass çš„ä¿¡æ¯åŠ¨æ€ï¼Œç”Ÿæˆç”¨æˆ·æ‰€éœ€è¦çš„å­˜å‚¨ï¼ˆPVï¼‰ï¼Œå°† PVC å’Œ PV è¿›è¡Œç»‘å®šåï¼Œpod å°±å¯ä»¥ä½¿ç”¨ PV äº†ã€‚é€šè¿‡ StorageClass é…ç½®ç”Ÿæˆå­˜å‚¨æ‰€éœ€è¦çš„å­˜å‚¨æ¨¡æ¿ï¼Œå†ç»“åˆç”¨æˆ·çš„éœ€æ±‚åŠ¨æ€åˆ›å»º PV å¯¹è±¡ï¼Œåšåˆ°æŒ‰éœ€åˆ†é…ï¼Œåœ¨æ²¡æœ‰å¢åŠ ç”¨æˆ·ä½¿ç”¨éš¾åº¦çš„åŒæ—¶ä¹Ÿè§£æ”¾äº†é›†ç¾¤ç®¡ç†å‘˜çš„è¿ç»´å·¥ä½œã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:1:5","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç”¨ä¾‹è§£è¯»æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹ Pod Volumesã€PVã€PVC åŠ StorageClass å…·ä½“æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚ apiVersion:v1kind:Podmetadata:name:test-podspec:containers:- name:container-1Image:ubuntu:18.04volumeMounts:- name:cache-volumemountPath:/cache # å®¹å™¨å†…æŒ‚è½½è·¯å¾„subPath:cache1 # åœ¨cache-volumeå»ºç«‹å­ç›®å½•cache1- name:hostpath-volumemountPath:/datareadOnly:true# åªè¯»æŒ‚è½½- name:container-2image:ubuntu:18.04volumeMounts:- mountPath:/cachename:cache-volumesubPath:cache2volumes:- name:cache-volume# å®¿ä¸»æœºä¸Šè·¯å¾„ï¼š/var/lib/kubelet/pods/\u003cPodUID\u003e/volumes/kubernetes.io-empty-dir/cache-volumeemptyDir:{}- name:hostpath-volumehostPath:path:/tmp/data # å®¿ä¸»ä¸Šè·¯å¾„ï¼Œpodåˆ é™¤ä¹‹åè¯¥ç›®å½•ä»ç„¶å­˜åœ¨ å£°æ˜çš„ä¸¤ä¸ªå·ï¼Œä¸€ä¸ªæ˜¯ç”¨çš„æ˜¯ emptyDirï¼Œå¦å¤–ä¸€ä¸ªç”¨çš„æ˜¯ hostPathï¼Œè¿™ä¸¤ç§éƒ½æ˜¯æœ¬åœ°å·ã€‚åœ¨å®¹å™¨ä¸­åº”è¯¥æ€ä¹ˆå»ä½¿ç”¨è¿™ä¸ªå·å‘¢ï¼Ÿå®ƒå…¶å®å¯ä»¥é€šè¿‡ volumeMounts è¿™ä¸ªå­—æ®µï¼ŒvolumeMounts å­—æ®µé‡Œé¢æŒ‡å®šçš„ name å…¶å®å°±æ˜¯å®ƒä½¿ç”¨çš„å“ªä¸ªå·ï¼ŒmountPath å°±æ˜¯å®¹å™¨ä¸­çš„æŒ‚è½½è·¯å¾„ã€‚ è¿™é‡Œè¿˜æœ‰ä¸ª subPathï¼ŒsubPath æ˜¯ä»€ä¹ˆï¼Ÿ å…ˆçœ‹ä¸€ä¸‹ï¼Œè¿™ä¸¤ä¸ªå®¹å™¨éƒ½æŒ‡å®šä½¿ç”¨äº†åŒä¸€ä¸ªå·ï¼Œå°±æ˜¯è¿™ä¸ª cache-volumeã€‚é‚£ä¹ˆï¼Œåœ¨å¤šä¸ªå®¹å™¨å…±äº«åŒä¸€ä¸ªå·çš„æ—¶å€™ï¼Œä¸ºäº†éš”ç¦»æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ subPath æ¥å®Œæˆè¿™ä¸ªæ“ä½œã€‚å®ƒä¼šåœ¨å·é‡Œé¢å»ºç«‹ä¸¤ä¸ªå­ç›®å½•ï¼Œç„¶åå®¹å™¨ 1 å¾€ cache ä¸‹é¢å†™çš„æ•°æ®å…¶å®éƒ½å†™åœ¨å­ç›®å½• cache1 äº†ï¼Œå®¹å™¨ 2 å¾€ cache å†™çš„ç›®å½•ï¼Œå…¶æ•°æ®æœ€ç»ˆä¼šè½åœ¨è¿™ä¸ªå·é‡Œå­ç›®å½•ä¸‹é¢çš„ cache2 ä¸‹ã€‚ è¿˜æœ‰ä¸€ä¸ª readOnly å­—æ®µï¼ŒreadOnly çš„æ„æ€å…¶å®å°±æ˜¯åªè¯»æŒ‚è½½ï¼Œè¿™ä¸ªæŒ‚è½½ä½ å¾€æŒ‚è½½ç‚¹ä¸‹é¢å®é™…ä¸Šæ˜¯æ²¡æœ‰åŠæ³•å»å†™æ•°æ®çš„ã€‚ å¦å¤–emptyDirã€hostPath éƒ½æ˜¯æœ¬åœ°å­˜å‚¨ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆç»†å¾®çš„å·®åˆ«å‘¢ï¼ŸemptyDir å…¶å®æ˜¯åœ¨ pod åˆ›å»ºçš„è¿‡ç¨‹ä¸­ä¼šä¸´æ—¶åˆ›å»ºçš„ä¸€ä¸ªç›®å½•ï¼Œè¿™ä¸ªç›®å½•éšç€ pod åˆ é™¤ä¹Ÿä¼šè¢«åˆ é™¤ï¼Œé‡Œé¢çš„æ•°æ®ä¼šè¢«æ¸…ç©ºæ‰ï¼›hostPath é¡¾åæ€ä¹‰ï¼Œå…¶å®å°±æ˜¯å®¿ä¸»æœºä¸Šçš„ä¸€ä¸ªè·¯å¾„ï¼Œåœ¨ pod åˆ é™¤ä¹‹åï¼Œè¿™ä¸ªç›®å½•è¿˜æ˜¯å­˜åœ¨çš„ï¼Œå®ƒçš„æ•°æ®ä¹Ÿä¸ä¼šè¢«ä¸¢å¤±ã€‚è¿™å°±æ˜¯å®ƒä»¬ä¸¤è€…ä¹‹é—´ä¸€ä¸ªç»†å¾®çš„å·®åˆ«ã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"PV Spec é‡è¦å­—æ®µè§£æ Capacityï¼šè¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯å­˜å‚¨å¯¹è±¡çš„å¤§å°ï¼› AccessModesï¼šä¹Ÿæ˜¯ç”¨æˆ·éœ€è¦å…³å¿ƒçš„ï¼Œå°±æ˜¯è¯´æˆ‘ä½¿ç”¨è¿™ä¸ª PV çš„æ–¹å¼ã€‚å®ƒæœ‰ä¸‰ç§ä½¿ç”¨æ–¹å¼ã€‚ ä¸€ç§æ˜¯å• node è¯»å†™è®¿é—®ï¼› ç¬¬äºŒç§æ˜¯å¤šä¸ª node åªè¯»è®¿é—®ï¼Œæ˜¯å¸¸è§çš„ä¸€ç§æ•°æ®çš„å…±äº«æ–¹å¼ï¼› ç¬¬ä¸‰ç§æ˜¯å¤šä¸ª node ä¸Šè¯»å†™è®¿é—®ã€‚ ç”¨æˆ·åœ¨æäº¤ PVC çš„æ—¶å€™ï¼Œæœ€é‡è¦çš„ä¸¤ä¸ªå­—æ®µ â€”â€” Capacity å’Œ AccessModesã€‚åœ¨æäº¤ PVC åï¼Œk8s é›†ç¾¤ä¸­çš„ç›¸å…³ç»„ä»¶æ˜¯å¦‚ä½•å»æ‰¾åˆ°åˆé€‚çš„ PV å‘¢ï¼Ÿé¦–å…ˆå®ƒæ˜¯é€šè¿‡ä¸º PV å»ºç«‹çš„ AccessModes ç´¢å¼•æ‰¾åˆ°æ‰€æœ‰èƒ½å¤Ÿæ»¡è¶³ç”¨æˆ·çš„ PVC é‡Œé¢çš„ AccessModes è¦æ±‚çš„ PV listï¼Œç„¶åæ ¹æ®PVCçš„ Capacityï¼ŒStorageClassName, Label Selector è¿›ä¸€æ­¥ç­›é€‰ PVï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶çš„ PV æœ‰å¤šä¸ªï¼Œé€‰æ‹© PV çš„ size æœ€å°çš„ï¼Œaccessmodes åˆ—è¡¨æœ€çŸ­çš„ PVï¼Œä¹Ÿå³æœ€å°é€‚åˆåŸåˆ™ã€‚ ReclaimPolicyï¼šè¿™ä¸ªå°±æ˜¯åˆšæ‰æåˆ°çš„ï¼Œæˆ‘çš„ç”¨æˆ·æ–¹ PV çš„ PVC åœ¨åˆ é™¤ä¹‹åï¼Œæˆ‘çš„ PV åº”è¯¥åšå¦‚ä½•å¤„ç†ï¼Ÿå¸¸è§çš„æœ‰ä¸‰ç§æ–¹å¼ã€‚ ç¬¬ä¸€ç§æ–¹å¼æˆ‘ä»¬å°±ä¸è¯´äº†ï¼Œç°åœ¨ K8s ä¸­å·²ç»ä¸æ¨èä½¿ç”¨äº†ï¼› ç¬¬äºŒç§æ–¹å¼ deleteï¼Œä¹Ÿå°±æ˜¯è¯´ PVC è¢«åˆ é™¤ä¹‹åï¼ŒPV ä¹Ÿä¼šè¢«åˆ é™¤ï¼› ç¬¬ä¸‰ç§æ–¹å¼ Retainï¼Œå°±æ˜¯ä¿ç•™ï¼Œä¿ç•™ä¹‹åï¼Œåé¢è¿™ä¸ª PV éœ€è¦ç®¡ç†å‘˜æ¥æ‰‹åŠ¨å¤„ç†ã€‚ StorageClassNameï¼šStorageClassName è¿™ä¸ªæˆ‘ä»¬åˆšæ‰è¯´äº†ï¼Œæˆ‘ä»¬åŠ¨æ€ Provisioning æ—¶å¿…é¡»æŒ‡å®šçš„ä¸€ä¸ªå­—æ®µï¼Œå°±æ˜¯è¯´æˆ‘ä»¬è¦æŒ‡å®šåˆ°åº•ç”¨å“ªä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶æ¥ç”Ÿæˆ PV ï¼› NodeAffinityï¼šå°±æ˜¯è¯´æˆ‘åˆ›å»ºå‡ºæ¥çš„ PVï¼Œå®ƒèƒ½è¢«å“ªäº› node å»æŒ‚è½½ä½¿ç”¨ï¼Œå…¶å®æ˜¯æœ‰é™åˆ¶çš„ã€‚ç„¶åé€šè¿‡ NodeAffinity æ¥å£°æ˜å¯¹nodeçš„é™åˆ¶ï¼Œè¿™æ ·å…¶å®å¯¹ ä½¿ç”¨è¯¥PVçš„podè°ƒåº¦ä¹Ÿæœ‰é™åˆ¶ï¼Œå°±æ˜¯è¯´ pod å¿…é¡»è¦è°ƒåº¦åˆ°è¿™äº›èƒ½è®¿é—® PV çš„ node ä¸Šï¼Œæ‰èƒ½ä½¿ç”¨è¿™å— PVï¼Œè¿™ä¸ªå­—æ®µåœ¨æˆ‘ä»¬ä¸‹ä¸€è®²è®²è§£å­˜å‚¨æ‹“æ‰‘è°ƒåº¦æ—¶åœ¨ç»†è¯´ã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:2:1","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"PVçŠ¶æ€æµè½¬ PV State Flow é¦–å…ˆåœ¨åˆ›å»º PV å¯¹è±¡åï¼Œå®ƒä¼šå¤„åœ¨çŸ­æš‚çš„pending çŠ¶æ€ï¼›ç­‰çœŸæ­£çš„ PV åˆ›å»ºå¥½ä¹‹åï¼Œå®ƒå°±å¤„åœ¨ available çŠ¶æ€ã€‚ available çŠ¶æ€æ„æ€å°±æ˜¯å¯ä»¥ä½¿ç”¨çš„çŠ¶æ€ï¼Œç”¨æˆ·åœ¨æäº¤ PVC ä¹‹åï¼Œè¢« K8s ç›¸å…³ç»„ä»¶åšå®Œ boundï¼ˆå³ï¼šæ‰¾åˆ°ç›¸åº”çš„ PVï¼‰ï¼Œè¿™ä¸ªæ—¶å€™ PV å’Œ PVC å°±ç»“åˆåˆ°ä¸€èµ·äº†ï¼Œæ­¤æ—¶ä¸¤è€…éƒ½å¤„åœ¨ bound çŠ¶æ€ã€‚å½“ç”¨æˆ·åœ¨ä½¿ç”¨å®Œ PVCï¼Œå°†å…¶åˆ é™¤åï¼Œè¿™ä¸ª PV å°±å¤„åœ¨ released çŠ¶æ€ï¼Œä¹‹åå®ƒåº”è¯¥è¢«åˆ é™¤è¿˜æ˜¯è¢«ä¿ç•™å‘¢ï¼Ÿè¿™ä¸ªå°±ä¼šä¾èµ–æˆ‘ä»¬åˆšæ‰è¯´çš„ ReclaimPolicyã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªç‚¹éœ€è¦ç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ï¼šå½“ PV å·²ç»å¤„åœ¨ released çŠ¶æ€ä¸‹ï¼Œå®ƒæ˜¯æ²¡æœ‰åŠæ³•ç›´æ¥å›åˆ° available çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´æ¥ä¸‹æ¥æ— æ³•è¢«ä¸€ä¸ªæ–°çš„ PVC å»åšç»‘å®šã€‚å¦‚æœæˆ‘ä»¬æƒ³æŠŠå·²ç» released çš„ PV å¤ç”¨ï¼Œæˆ‘ä»¬è¿™ä¸ªæ—¶å€™é€šå¸¸åº”è¯¥æ€ä¹ˆå»åšå‘¢ï¼Ÿ ç¬¬ä¸€ç§æ–¹å¼ï¼šæˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ª PV å¯¹è±¡ï¼Œç„¶åæŠŠä¹‹å‰çš„ released çš„ PV çš„ç›¸å…³å­—æ®µçš„ä¿¡æ¯å¡«åˆ°æ–°çš„ PV å¯¹è±¡é‡Œé¢ï¼Œè¿™æ ·çš„è¯ï¼Œè¿™ä¸ª PV å°±å¯ä»¥ç»“åˆæ–°çš„ PVC äº†ï¼›ç¬¬äºŒç§æ˜¯æˆ‘ä»¬åœ¨åˆ é™¤ pod ä¹‹åï¼Œä¸è¦å»åˆ é™¤ PVC å¯¹è±¡ï¼Œè¿™æ ·ç»™ PV ç»‘å®šçš„ PVC è¿˜æ˜¯å­˜åœ¨çš„ï¼Œä¸‹æ¬¡ pod ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡ PVC å»å¤ç”¨ã€‚K8sä¸­çš„ StatefulSet ç®¡ç†çš„ Pod å¸¦å­˜å‚¨çš„è¿ç§»å°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼ã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:2:2","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ¶æ„è®¾è®¡","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"PVå’ŒPVCçš„å¤„ç†æµç¨‹ PV/PVC Handle Flow csi æ˜¯ä»€ä¹ˆï¼Ÿcsi çš„å…¨ç§°æ˜¯ container storage interfaceï¼Œå®ƒæ˜¯K8sç¤¾åŒºåé¢å¯¹å­˜å‚¨æ’ä»¶å®ç°(out of tree)çš„å®˜æ–¹æ¨èæ–¹å¼ã€‚csi çš„å®ç°å¤§ä½“å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š ç¬¬ä¸€éƒ¨åˆ†æ˜¯ç”±k8sç¤¾åŒºé©±åŠ¨å®ç°çš„é€šç”¨çš„éƒ¨åˆ†ï¼Œåƒæˆ‘ä»¬è¿™å¼ å›¾ä¸­çš„ csi-provisionerå’Œ csi-attacher controllerï¼› å¦å¤–ä¸€ç§æ˜¯ç”±äº‘å­˜å‚¨å‚å•†å®è·µçš„ï¼Œå¯¹æ¥äº‘å­˜å‚¨å‚å•†çš„ OpenApiï¼Œä¸»è¦æ˜¯å®ç°çœŸæ­£çš„ create/delete/mount/unmount å­˜å‚¨çš„ç›¸å…³æ“ä½œï¼Œå¯¹åº”åˆ°ä¸Šå›¾ä¸­çš„csi-controller-serverå’Œcsi-node-serverã€‚ æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹ï¼Œå½“ç”¨æˆ·æäº¤ yaml ä¹‹åï¼Œk8så†…éƒ¨çš„å¤„ç†æµç¨‹ã€‚ç”¨æˆ·åœ¨æäº¤ PVCyaml çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šåœ¨é›†ç¾¤ä¸­ç”Ÿæˆä¸€ä¸ª PVC å¯¹è±¡ï¼Œç„¶å PVC å¯¹è±¡ä¼šè¢« csi-provisioner controller watchåˆ°ï¼Œcsi-provisioner ä¼šç»“åˆ PVC å¯¹è±¡ä»¥åŠ PVC å¯¹è±¡ä¸­å£°æ˜çš„ storageClassï¼Œé€šè¿‡ GRPC è°ƒç”¨ csi-controller-serverï¼Œç„¶åï¼Œåˆ°äº‘å­˜å‚¨æœåŠ¡è¿™è¾¹å»åˆ›å»ºçœŸæ­£çš„å­˜å‚¨ï¼Œå¹¶æœ€ç»ˆåˆ›å»ºå‡ºæ¥ PV å¯¹è±¡ã€‚æœ€åï¼Œç”±é›†ç¾¤ä¸­çš„ PV controller å°† PVC å’Œ PV å¯¹è±¡åš bound ä¹‹åï¼Œè¿™ä¸ª PV å°±å¯ä»¥è¢«ä½¿ç”¨äº†ã€‚ ç”¨æˆ·åœ¨æäº¤ pod ä¹‹åï¼Œé¦–å…ˆä¼šè¢«è°ƒåº¦å™¨è°ƒåº¦é€‰ä¸­æŸä¸€ä¸ªåˆé€‚çš„nodeï¼Œä¹‹åè¯¥ node ä¸Šé¢çš„ kubelet åœ¨åˆ›å»º pod æµç¨‹ä¸­ä¼šé€šè¿‡é¦–å…ˆ csi-node-server å°†æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ PV æŒ‚è½½åˆ°æˆ‘ä»¬ pod å¯ä»¥ä½¿ç”¨çš„è·¯å¾„ï¼Œç„¶å kubelet å¼€å§‹ create \u0026\u0026 start pod ä¸­çš„æ‰€æœ‰ containerã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"PVã€PVCä»¥åŠé€šè¿‡csiä½¿ç”¨å­˜å‚¨æµç¨‹ PV/PVC Usage Flow ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š ç¬¬ä¸€ä¸ªé˜¶æ®µ(Createé˜¶æ®µ)æ˜¯ç”¨æˆ·æäº¤å®Œ PVCï¼Œç”± csi-provisioner åˆ›å»ºå­˜å‚¨ï¼Œå¹¶ç”Ÿæˆ PV å¯¹è±¡ï¼Œä¹‹å PV controller å°† PVC åŠç”Ÿæˆçš„ PV å¯¹è±¡åš boundï¼Œbound ä¹‹åï¼Œcreate é˜¶æ®µå°±å®Œæˆäº†ï¼› ä¹‹åç”¨æˆ·åœ¨æäº¤ pod yaml çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šè¢«è°ƒåº¦é€‰ä¸­æŸä¸€ä¸ª åˆé€‚çš„nodeï¼Œç­‰ pod çš„è¿è¡Œ node è¢«é€‰å‡ºæ¥ä¹‹åï¼Œä¼šè¢« AD Controller watch åˆ° pod é€‰ä¸­çš„ nodeï¼Œå®ƒä¼šå»æŸ¥æ‰¾ pod ä¸­ä½¿ç”¨äº†å“ªäº› PVã€‚ç„¶åå®ƒä¼šç”Ÿæˆä¸€ä¸ªå†…éƒ¨çš„å¯¹è±¡å« VolumeAttachment å¯¹è±¡ï¼Œä»è€Œå»è§¦å‘ csi-attacherå»è°ƒç”¨csi-controller-server å»åšçœŸæ­£çš„ attache æ“ä½œï¼Œattachæ“ä½œè°ƒåˆ°äº‘å­˜å‚¨å‚å•†OpenAPIã€‚è¿™ä¸ª attach æ“ä½œå°±æ˜¯å°†å­˜å‚¨ attachåˆ° pod å°†ä¼šè¿è¡Œçš„ node ä¸Šé¢ã€‚ç¬¬äºŒä¸ªé˜¶æ®µ â€”â€” attaché˜¶æ®µå®Œæˆï¼› ç„¶åæˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ç¬¬ä¸‰ä¸ªé˜¶æ®µã€‚ç¬¬ä¸‰ä¸ªé˜¶æ®µ å‘ç”Ÿåœ¨kubelet åˆ›å»º podçš„è¿‡ç¨‹ä¸­ï¼Œå®ƒåœ¨åˆ›å»º pod çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆè¦å»åšä¸€ä¸ª mountï¼Œè¿™é‡Œçš„ mount æ“ä½œæ˜¯ä¸ºäº†å°†å·²ç»attachåˆ°è¿™ä¸ª node ä¸Šé¢é‚£å—ç›˜ï¼Œè¿›ä¸€æ­¥ mount åˆ° pod å¯ä»¥ä½¿ç”¨çš„ä¸€ä¸ªå…·ä½“è·¯å¾„ï¼Œä¹‹å kubelet æ‰å¼€å§‹åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ã€‚è¿™å°±æ˜¯ PV åŠ  PVC åˆ›å»ºå­˜å‚¨ä»¥åŠä½¿ç”¨å­˜å‚¨çš„ç¬¬ä¸‰ä¸ªé˜¶æ®µ â€”â€” mount é˜¶æ®µã€‚ æ€»çš„æ¥è¯´ï¼Œæœ‰ä¸‰ä¸ªé˜¶æ®µï¼šç¬¬ä¸€ä¸ª create é˜¶æ®µï¼Œä¸»è¦æ˜¯åˆ›å»ºå­˜å‚¨ï¼›ç¬¬äºŒä¸ª attach é˜¶æ®µï¼Œå°±æ˜¯å°†é‚£å—å­˜å‚¨æŒ‚è½½åˆ° node ä¸Šé¢(é€šå¸¸ä¸ºå°†å­˜å‚¨loadåˆ°nodeçš„/devä¸‹é¢)ï¼›ç¬¬ä¸‰ä¸ª mount é˜¶æ®µï¼Œå°†å¯¹åº”çš„å­˜å‚¨è¿›ä¸€æ­¥æŒ‚è½½åˆ° pod å¯ä»¥ä½¿ç”¨çš„è·¯å¾„ã€‚è¿™å°±æ˜¯æˆ‘ä»¬çš„ PVCã€PVã€å·²ç»é€šè¿‡CSIå®ç°çš„å·ä»åˆ›å»ºåˆ°ä½¿ç”¨çš„å®Œæ•´æµç¨‹ã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ€»ç»“ ä»‹ç»äº† K8s Volume çš„ä½¿ç”¨åœºæ™¯ï¼Œä»¥åŠæœ¬èº«å±€é™æ€§ï¼› é€šè¿‡ä»‹ç» K8s çš„ PVC å’Œ PV ä½“ç³»ï¼Œè¯´æ˜ K8s é€šè¿‡ PVC å’Œ PV ä½“ç³»å¢å¼ºäº† K8s Volumes åœ¨å¤š Pod å…±äº«/è¿ç§»/å­˜å‚¨æ‰©å±•ç­‰åœºæ™¯ä¸‹çš„èƒ½åŠ›çš„å¿…è¦æ€§ä»¥åŠè®¾è®¡æ€æƒ³ï¼› é€šè¿‡ä»‹ç» PVï¼ˆå­˜å‚¨ï¼‰çš„ä¸åŒä¾›ç»™æ¨¡å¼ (static and dynamic)ï¼Œå­¦ä¹ äº†å¦‚ä½•é€šè¿‡ä¸åŒæ–¹å¼ä¸ºé›†ç¾¤ä¸­çš„ Pod ä¾›ç»™æ‰€éœ€çš„å­˜å‚¨ï¼› é€šè¿‡ PVC\u0026PV åœ¨ K8s ä¸­å®Œæ•´çš„å¤„ç†æµç¨‹ï¼Œæ·±å…¥ç†è§£ PVC\u0026PV çš„å·¥ä½œåŸç†ã€‚ ","date":"2021-07-25","objectID":"/application-storage-and-persistent-data-volume-core-knowledge/:4:0","tags":["äº‘åŸç”Ÿ","Kubernetes","å­˜å‚¨","PV","PVC"],"title":"åº”ç”¨å­˜å‚¨å’ŒæŒä¹…åŒ–æ•°æ®å· - æ ¸å¿ƒçŸ¥è¯†","uri":"/application-storage-and-persistent-data-volume-core-knowledge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡ç³»ç»Ÿä»‹ç»äº† ConfigMapã€Secretã€Pod èº«ä»½è®¤è¯ã€å®¹å™¨èµ„æºå’Œå®‰å…¨ã€InitContainer","date":"2021-07-17","objectID":"/application-configuration-management/","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"éœ€æ±‚æ¥æº","date":"2021-07-17","objectID":"/application-configuration-management/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"èƒŒæ™¯é—®é¢˜é¦–å…ˆä¸€èµ·æ¥çœ‹ä¸€ä¸‹éœ€æ±‚æ¥æºã€‚å¤§å®¶åº”è¯¥éƒ½æœ‰è¿‡è¿™æ ·çš„ç»éªŒï¼Œç”¨ä¸€ä¸ªå®¹å™¨é•œåƒæ¥å¯åŠ¨ä¸€ä¸ª containerã€‚è¦å¯åŠ¨è¿™ä¸ªå®¹å™¨ï¼Œå…¶å®æœ‰å¾ˆå¤šéœ€è¦é…å¥—çš„é—®é¢˜å¾…è§£å†³ï¼š ç¬¬ä¸€ï¼Œæ¯”å¦‚è¯´ä¸€äº›å¯å˜çš„é…ç½®ã€‚å› ä¸ºæˆ‘ä»¬ä¸å¯èƒ½æŠŠä¸€äº›å¯å˜çš„é…ç½®å†™åˆ°é•œåƒé‡Œé¢ï¼Œå½“è¿™ä¸ªé…ç½®éœ€è¦å˜åŒ–çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦æˆ‘ä»¬é‡æ–°ç¼–è¯‘ä¸€æ¬¡é•œåƒï¼Œè¿™ä¸ªè‚¯å®šæ˜¯ä¸èƒ½æ¥å—çš„ï¼› ç¬¬äºŒå°±æ˜¯ä¸€äº›æ•æ„Ÿä¿¡æ¯çš„å­˜å‚¨å’Œä½¿ç”¨ã€‚æ¯”å¦‚è¯´åº”ç”¨éœ€è¦ä½¿ç”¨ä¸€äº›å¯†ç ï¼Œæˆ–è€…ç”¨ä¸€äº› tokenï¼› ç¬¬ä¸‰å°±æ˜¯æˆ‘ä»¬å®¹å™¨è¦è®¿é—®é›†ç¾¤è‡ªèº«ã€‚æ¯”å¦‚æˆ‘è¦è®¿é—® kube-apiserverï¼Œé‚£ä¹ˆæœ¬èº«å°±æœ‰ä¸€ä¸ªèº«ä»½è®¤è¯çš„é—®é¢˜ï¼› ç¬¬å››å°±æ˜¯å®¹å™¨åœ¨èŠ‚ç‚¹ä¸Šè¿è¡Œä¹‹åï¼Œå®ƒçš„èµ„æºéœ€æ±‚ï¼› ç¬¬äº”ä¸ªå°±æ˜¯å®¹å™¨åœ¨èŠ‚ç‚¹ä¸Šï¼Œå®ƒä»¬æ˜¯å…±äº«å†…æ ¸çš„ï¼Œé‚£ä¹ˆå®ƒçš„ä¸€ä¸ªå®‰å…¨ç®¡æ§æ€ä¹ˆåŠï¼Ÿ æœ€åä¸€ç‚¹ï¼Œå®¹å™¨å¯åŠ¨ä¹‹å‰çš„ä¸€ä¸ªå‰ç½®æ¡ä»¶æ£€éªŒã€‚æ¯”å¦‚è¯´ï¼Œä¸€ä¸ªå®¹å™¨å¯åŠ¨ä¹‹å‰ï¼Œå¯èƒ½è¦ç¡®è®¤ä¸€ä¸‹ DNS æœåŠ¡æ˜¯ä¸æ˜¯å¥½ç”¨ï¼Ÿåˆæˆ–è€…ç¡®è®¤ä¸€ä¸‹ç½‘ç»œæ˜¯ä¸æ˜¯è”é€šçš„ï¼Ÿé‚£ä¹ˆè¿™äº›å…¶å®å°±æ˜¯ä¸€äº›å‰ç½®çš„æ ¡éªŒã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:1:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Pod çš„é…ç½®ç®¡ç†åœ¨ Kubernetes é‡Œé¢ï¼Œå®ƒæ˜¯æ€ä¹ˆåšè¿™äº›é…ç½®ç®¡ç†çš„å‘¢ï¼Ÿå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š é…ç½® è¯´æ˜ ConfigMap å¯å˜é…ç½® Secret æ•æ„Ÿä¿¡æ¯ ServiceAccount èº«ä»½è®¤è¯ Spec.Containers[].Resources.limits/requests èµ„æºé…ç½® Spec.Containers[].Resources.SecrityContext å®‰å…¨ç®¡æ§ Spec.InitContainers å‰ç½®æ ¡éªŒ ","date":"2021-07-17","objectID":"/application-configuration-management/:1:2","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ConfigMap","date":"2021-07-17","objectID":"/application-configuration-management/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ConfigMap ä»‹ç»ConfigMap å®ƒæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ã€ä»¥åŠå®ƒå¸¦æ¥çš„ä¸€ä¸ªå¥½å¤„ã€‚å®ƒå…¶å®ä¸»è¦æ˜¯ç®¡ç†ä¸€äº›å¯å˜é…ç½®ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬åº”ç”¨çš„ä¸€äº›é…ç½®æ–‡ä»¶ï¼Œæˆ–è€…è¯´å®ƒé‡Œé¢çš„ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œæˆ–è€…ä¸€äº›å‘½ä»¤è¡Œå‚æ•°ã€‚ å®ƒçš„å¥½å¤„åœ¨äºå®ƒå¯ä»¥è®©ä¸€äº›å¯å˜é…ç½®å’Œå®¹å™¨é•œåƒè¿›è¡Œè§£è€¦ï¼Œè¿™æ ·ä¹Ÿä¿è¯äº†å®¹å™¨çš„å¯ç§»æ¤æ€§ã€‚ apiVersion:v1kind:ConfigMapmetadata:lables:app:flanneltier:nodename:kube-flannnel-cfgnamespace:kube-systemdata:cni-conf.json:|{ \"name\": \"cbr0\", \"type\": \"\"flannel\", \"delegate\": { \"isDefaultGateway\": true } }net-conf.json:|{ \"Network\": \"172.27.0.0/16\", \"Backend\": { \"Type\": \"vxlan\" } } è¿™æ˜¯ ConfigMap æœ¬èº«çš„ä¸€ä¸ªå®šä¹‰ï¼Œå®ƒåŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ªæ˜¯ ConfigMap å…ƒä¿¡æ¯ï¼Œæˆ‘ä»¬å…³æ³¨ name å’Œ namespace è¿™ä¸¤ä¸ªä¿¡æ¯ã€‚æ¥ä¸‹æ¥è¿™ä¸ª data é‡Œé¢ï¼Œå¯ä»¥çœ‹åˆ°å®ƒç®¡ç†äº†ä¸¤ä¸ªé…ç½®æ–‡ä»¶ã€‚å®ƒçš„ç»“æ„å…¶å®æ˜¯è¿™æ ·çš„ï¼šä»åå­—çœ‹ConfigMapä¸­åŒ…å«Mapå•è¯ï¼ŒMap å…¶å®å°±æ˜¯ key:valueï¼Œkey æ˜¯ä¸€ä¸ªæ–‡ä»¶åï¼Œvalue æ˜¯è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:2:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ConfigMap åˆ›å»ºæ¨èç”¨ kubectl è¿™ä¸ªå‘½ä»¤æ¥åˆ›å»ºï¼Œå®ƒå¸¦çš„å‚æ•°ä¸»è¦æœ‰ä¸¤ä¸ªï¼šä¸€ä¸ªæ˜¯æŒ‡å®š nameï¼Œç¬¬äºŒä¸ªæ˜¯ DATAã€‚å…¶ä¸­ DATA å¯ä»¥é€šè¿‡æŒ‡å®šæ–‡ä»¶æˆ–è€…æŒ‡å®šç›®å½•ï¼Œä»¥åŠç›´æ¥æŒ‡å®šé”®å€¼å¯¹ã€‚ kubectl create configmap [NAME] [DATA] æŒ‡å®šæ–‡ä»¶çš„è¯ï¼Œæ–‡ä»¶åå°±æ˜¯ Map ä¸­çš„ keyï¼Œæ–‡ä»¶å†…å®¹å°±æ˜¯ Map ä¸­çš„ valueã€‚ç„¶åæŒ‡å®šé”®å€¼å¯¹å°±æ˜¯æŒ‡å®šæ•°æ®é”®å€¼å¯¹ï¼Œå³ï¼škey:value å½¢å¼ï¼Œç›´æ¥æ˜ å°„åˆ° Map çš„key:valueã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:2:2","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ConfigMap ä½¿ç”¨åˆ›å»ºå®Œäº†ä¹‹åï¼Œåº”è¯¥æ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿ ç¬¬ä¸€ç§æ˜¯ç¯å¢ƒå˜é‡ã€‚ç¯å¢ƒå˜é‡çš„è¯é€šè¿‡ valueFromï¼Œç„¶å ConfigMapKeyRef è¿™ä¸ªå­—æ®µï¼Œä¸‹é¢çš„ name æ˜¯æŒ‡å®š ConfigMap åï¼Œkey æ˜¯ ConfigMap.data é‡Œé¢çš„ keyã€‚è¿™æ ·çš„è¯ï¼Œåœ¨ busybox å®¹å™¨å¯åŠ¨åå®¹å™¨ä¸­æ‰§è¡Œ env å°†çœ‹åˆ°ä¸€ä¸ª SPECIAL_LEVEL_KEY ç¯å¢ƒå˜é‡ï¼› ç¬¬äºŒä¸ªæ˜¯å‘½ä»¤è¡Œå‚æ•°ã€‚å‘½ä»¤è¡Œå‚æ•°å…¶å®æ˜¯ç¬¬ä¸€è¡Œçš„ç¯å¢ƒå˜é‡ç›´æ¥æ‹¿åˆ° cmd è¿™ä¸ªå­—æ®µé‡Œé¢æ¥ç”¨ï¼› æœ€åä¸€ä¸ªæ˜¯é€šè¿‡ volume æŒ‚è½½çš„æ–¹å¼ç›´æ¥æŒ‚åˆ°å®¹å™¨çš„æŸä¸€ä¸ªç›®å½•ä¸‹é¢å»ã€‚ä¸Šé¢çš„ä¾‹å­æ˜¯æŠŠ special-config è¿™ä¸ª ConfigMap é‡Œé¢çš„å†…å®¹æŒ‚åˆ°å®¹å™¨é‡Œé¢çš„ /etc/config ç›®å½•ä¸‹ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ä½¿ç”¨çš„ä¸€ç§æ–¹å¼ã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:2:3","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ConfigMap æ³¨æ„è¦ç‚¹ç°åœ¨å¯¹ ConfigMap çš„ä½¿ç”¨åšä¸€ä¸ªæ€»ç»“ï¼Œä»¥åŠå®ƒçš„ä¸€äº›æ³¨æ„ç‚¹ï¼Œæ³¨æ„ç‚¹ä¸€å…±åˆ—äº†ä»¥ä¸‹äº”æ¡ï¼š ConfigMap æ–‡ä»¶çš„å¤§å°ã€‚è™½ç„¶è¯´ ConfigMap æ–‡ä»¶æ²¡æœ‰å¤§å°é™åˆ¶ï¼Œä½†æ˜¯åœ¨ ETCD é‡Œé¢ï¼Œæ•°æ®çš„å†™å…¥æ˜¯æœ‰å¤§å°é™åˆ¶çš„ï¼Œç°åœ¨æ˜¯é™åˆ¶åœ¨ 1MB ä»¥å†…ï¼› ç¬¬äºŒä¸ªæ³¨æ„ç‚¹æ˜¯ pod å¼•å…¥ ConfigMap çš„æ—¶å€™ï¼Œå¿…é¡»æ˜¯ç›¸åŒçš„ Namespace ä¸­çš„ ConfigMapï¼Œå‰é¢å…¶å®å¯ä»¥çœ‹åˆ°ï¼ŒConfigMap.metadata é‡Œé¢æ˜¯æœ‰ namespace å­—æ®µçš„ï¼› ç¬¬ä¸‰ä¸ªæ˜¯ pod å¼•ç”¨çš„ ConfigMapã€‚å‡å¦‚è¿™ä¸ª ConfigMap ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ª pod æ˜¯æ— æ³•åˆ›å»ºæˆåŠŸçš„ï¼Œå…¶å®è¿™ä¹Ÿè¡¨ç¤ºåœ¨åˆ›å»º pod å‰ï¼Œå¿…é¡»å…ˆæŠŠè¦å¼•ç”¨çš„ ConfigMap åˆ›å»ºå¥½ï¼› ç¬¬å››ç‚¹å°±æ˜¯ä½¿ç”¨ envFrom çš„æ–¹å¼ã€‚æŠŠ ConfigMap é‡Œé¢æ‰€æœ‰çš„ä¿¡æ¯å¯¼å…¥æˆç¯å¢ƒå˜é‡æ—¶ï¼Œå¦‚æœ ConfigMap é‡Œæœ‰äº› key æ˜¯æ— æ•ˆçš„ï¼Œæ¯”å¦‚ key çš„åå­—é‡Œé¢å¸¦æœ‰æ•°å­—ï¼Œé‚£ä¹ˆè¿™ä¸ªç¯å¢ƒå˜é‡å…¶å®æ˜¯ä¸ä¼šæ³¨å…¥å®¹å™¨çš„ï¼Œå®ƒä¼šè¢«å¿½ç•¥ã€‚ä½†æ˜¯è¿™ä¸ª pod æœ¬èº«æ˜¯å¯ä»¥åˆ›å»ºçš„ã€‚è¿™ä¸ªå’Œç¬¬ä¸‰ç‚¹æ˜¯ä¸ä¸€æ ·çš„æ–¹å¼ï¼Œæ˜¯ ConfigMap æ–‡ä»¶å­˜åœ¨åŸºç¡€ä¸Šï¼Œæ•´ä½“å¯¼å…¥æˆç¯å¢ƒå˜é‡çš„ä¸€ç§å½¢å¼ï¼› æœ€åä¸€ç‚¹æ˜¯ï¼šä»€ä¹ˆæ ·çš„ pod æ‰èƒ½ä½¿ç”¨ ConfigMapï¼Ÿè¿™é‡Œåªæœ‰é€šè¿‡ K8s api åˆ›å»ºçš„ pod æ‰èƒ½ä½¿ç”¨ ConfigMapï¼Œæ¯”å¦‚è¯´é€šè¿‡ç”¨å‘½ä»¤è¡Œ kubectl æ¥åˆ›å»ºçš„ podï¼Œè‚¯å®šæ˜¯å¯ä»¥ä½¿ç”¨ ConfigMap çš„ï¼Œä½†å…¶ä»–æ–¹å¼åˆ›å»ºçš„ podï¼Œæ¯”å¦‚è¯´ kubelet é€šè¿‡ manifest åˆ›å»ºçš„ static podï¼Œå®ƒæ˜¯ä¸èƒ½ä½¿ç”¨ ConfigMap çš„ã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:2:4","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Secret","date":"2021-07-17","objectID":"/application-configuration-management/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Secret ä»‹ç»Secret æ˜¯ä¸€ä¸ªä¸»è¦ç”¨æ¥å­˜å‚¨å¯†ç  token ç­‰ä¸€äº›æ•æ„Ÿä¿¡æ¯çš„èµ„æºå¯¹è±¡ã€‚å…¶ä¸­ï¼Œæ•æ„Ÿä¿¡æ¯æ˜¯é‡‡ç”¨ base-64 ç¼–ç ä¿å­˜èµ·æ¥çš„ã€‚ Secret ç±»å‹ç§ç±»æ¯”è¾ƒå¤šï¼Œä¸‹é¢åˆ—äº†å¸¸ç”¨çš„å››ç§ç±»å‹ï¼š ç¬¬ä¸€ç§æ˜¯ Opaqueï¼Œå®ƒæ˜¯æ™®é€šçš„ Secret æ–‡ä»¶ï¼› ç¬¬äºŒç§æ˜¯ service-account-tokenï¼Œæ˜¯ç”¨äº service-account èº«ä»½è®¤è¯ç”¨çš„ Secretï¼› ç¬¬ä¸‰ç§æ˜¯ dockerconfigjsonï¼Œè¿™æ˜¯æ‹‰å–ç§æœ‰ä»“åº“é•œåƒçš„ç”¨çš„ä¸€ç§ Secretï¼› ç¬¬å››ç§æ˜¯ bootstrap.tokenï¼Œæ˜¯ç”¨äºèŠ‚ç‚¹æ¥å…¥é›†ç¾¤æ ¡éªŒç”¨çš„ Secretã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Secret åˆ›å»ºSecret æœ‰ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼š ç³»ç»Ÿåˆ›å»ºï¼šæ¯”å¦‚ K8s ä¸ºæ¯ä¸€ä¸ª namespace çš„é»˜è®¤ç”¨æˆ·ï¼ˆdefault ServiceAccountï¼‰åˆ›å»º Secretï¼› ç”¨æˆ·æ‰‹åŠ¨åˆ›å»ºï¼šæ‰‹åŠ¨åˆ›å»ºå‘½ä»¤ï¼Œæ¨è kubectl è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒç›¸å¯¹ ConfigMap ä¼šå¤šä¸€ä¸ª type å‚æ•°ã€‚å…¶ä¸­ data ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå®ƒä¹Ÿæ˜¯å¯ä»¥æŒ‡å®šæ–‡ä»¶å’Œé”®å€¼å¯¹çš„ã€‚type çš„è¯ï¼Œè¦æ˜¯ä½ ä¸æŒ‡å®šçš„è¯ï¼Œé»˜è®¤æ˜¯ Opaque ç±»å‹ã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Secret ä½¿ç”¨åˆ›å»ºå®Œ Secret ä¹‹åï¼Œå†æ¥çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨å®ƒã€‚å®ƒä¸»è¦æ˜¯è¢« pod æ¥ä½¿ç”¨ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ volume å½¢å¼æŒ‚è½½åˆ°å®¹å™¨é‡ŒæŒ‡å®šçš„ç›®å½•ï¼Œç„¶åå®¹å™¨é‡Œçš„ä¸šåŠ¡è¿›ç¨‹å†åˆ°ç›®å½•ä¸‹è¯»å– Secret æ¥è¿›è¡Œä½¿ç”¨ã€‚å¦å¤–åœ¨éœ€è¦è®¿é—®ç§æœ‰é•œåƒä»“åº“æ—¶ï¼Œä¹Ÿæ˜¯é€šè¿‡å¼•ç”¨ Secret æ¥å®ç°ã€‚ æŒ‚è½½åˆ°ç”¨æˆ·æŒ‡å®šç›®å½•çš„æ–¹å¼ï¼š ç¬¬ä¸€ç§æ–¹å¼ï¼šç”¨æˆ·ç›´æ¥æŒ‡å®š ç¬¬äºŒç§æ–¹å¼ï¼šç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼Œè¿‡ç¨‹ä¸­ä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ ca.crtï¼Œä¸€ä¸ªæ˜¯ tokenã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:3:3","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Secret ä½¿ç”¨æ³¨æ„è¦ç‚¹ Secret çš„æ–‡ä»¶å¤§å°é™åˆ¶ã€‚è¿™ä¸ªè·Ÿ ConfigMap ä¸€æ ·ï¼Œä¹Ÿæ˜¯ 1MBã€‚ Secret é‡‡ç”¨äº† base-64 ç¼–ç ï¼Œä½†æ˜¯å®ƒè·Ÿæ˜æ–‡ä¹Ÿæ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚æ‰€ä»¥è¯´ï¼Œå¦‚æœæœ‰ä¸€äº›æœºå¯†ä¿¡æ¯è¦ç”¨ Secret æ¥å­˜å‚¨çš„è¯ï¼Œè¿˜æ˜¯è¦å¾ˆæ…é‡è€ƒè™‘ã€‚ä¹Ÿå°±æ˜¯è¯´è°ä¼šæ¥è®¿é—®ä½ è¿™ä¸ªé›†ç¾¤ï¼Œè°ä¼šæ¥ç”¨ä½ è¿™ä¸ª Secretï¼Œè¿˜æ˜¯è¦æ…é‡è€ƒè™‘ï¼Œå› ä¸ºå®ƒå¦‚æœèƒ½å¤Ÿè®¿é—®è¿™ä¸ªé›†ç¾¤ï¼Œå°±èƒ½æ‹¿åˆ°è¿™ä¸ª Secretã€‚å¦‚æœæ˜¯å¯¹ Secret æ•æ„Ÿä¿¡æ¯è¦æ±‚å¾ˆé«˜ï¼Œå¯¹åŠ å¯†è¿™å—æœ‰å¾ˆå¼ºçš„éœ€æ±‚ï¼Œæ¨èå¯ä»¥ä½¿ç”¨ Kubernetes å’Œå¼€æºçš„ vaultåšä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ¥è§£å†³æ•æ„Ÿä¿¡æ¯çš„åŠ å¯†å’Œæƒé™ç®¡ç†ã€‚ Secret è¯»å–çš„æœ€ä½³å®è·µï¼Œå»ºè®®ä¸è¦ç”¨ list/watchï¼Œå¦‚æœç”¨ list/watch æ“ä½œçš„è¯ï¼Œä¼šæŠŠ namespace ä¸‹çš„æ‰€æœ‰ Secret å…¨éƒ¨æ‹‰å–ä¸‹æ¥ï¼Œè¿™æ ·å…¶å®æš´éœ²äº†æ›´å¤šçš„ä¿¡æ¯ã€‚æ¨èä½¿ç”¨ GET çš„æ–¹æ³•ï¼Œè¿™æ ·åªè·å–ä½ è‡ªå·±éœ€è¦çš„é‚£ä¸ª Secretã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:3:4","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ServiceAccount","date":"2021-07-17","objectID":"/application-configuration-management/:4:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ServiceAccount ä»‹ç»ServiceAccount é¦–å…ˆæ˜¯ç”¨äºè§£å†³ pod åœ¨é›†ç¾¤é‡Œé¢çš„èº«ä»½è®¤è¯é—®é¢˜ï¼Œèº«ä»½è®¤è¯ä¿¡æ¯æ˜¯å­˜åœ¨äº Secret é‡Œé¢ã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:4:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Resource","date":"2021-07-17","objectID":"/application-configuration-management/:5:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å®¹å™¨èµ„æºé…åˆç®¡ç†ç›®å‰å†…éƒ¨æ”¯æŒç±»å‹æœ‰ä¸‰ç§ï¼šCPUã€å†…å­˜ä»¥åŠä¸´æ—¶å­˜å‚¨ã€‚å¦‚æœç”¨æˆ·è§‰å¾—è¿™ä¸‰ç§ä¸å¤Ÿï¼Œå¯ä»¥è‡ªå·±å®šä¹‰æ‰€éœ€çš„èµ„æºï¼Œå¦‚ GPUã€‚é…ç½®èµ„æºæ—¶ï¼Œèµ„æºæŒ‡å®šæ•°é‡å¿…é¡»ä¸ºæ•´æ•°ã€‚ç›®å‰èµ„æºé…ç½®ä¸»è¦åˆ†æˆ request å’Œ limit ä¸¤ç§ç±»å‹ï¼Œä¸€ä¸ªæ˜¯éœ€è¦çš„æ•°é‡ï¼Œä¸€ä¸ªæ˜¯èµ„æºçš„ç•Œé™ã€‚CPUã€å†…å­˜ä»¥åŠä¸´æ—¶å­˜å‚¨éƒ½æ˜¯åœ¨ container ä¸‹çš„ Resource å­—æ®µé‡Œè¿›è¡Œä¸€ä¸ªå£°æ˜ã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:5:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Pod æœåŠ¡è´¨é‡ (QoS) é…ç½®æ ¹æ® CPU å¯¹å®¹å™¨å†…å­˜èµ„æºçš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯¹ pod çš„æœåŠ¡è´¨é‡è¿›è¡Œä¸€ä¸ªåˆ†ç±»ï¼Œåˆ†åˆ«æ˜¯ Guaranteedã€Burstable å’Œ BestEffortã€‚ Guaranteedï¼špod é‡Œé¢æ¯ä¸ªå®¹å™¨éƒ½å¿…é¡»æœ‰å†…å­˜å’Œ CPU çš„ request ä»¥åŠ limit çš„ä¸€ä¸ªå£°æ˜ï¼Œä¸” request å’Œ limit å¿…é¡»æ˜¯ä¸€æ ·çš„ï¼Œè¿™å°±æ˜¯ Guaranteedï¼› Burstableï¼šBurstable è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨å­˜åœ¨å†…å­˜å’Œ CPU çš„ä¸€ä¸ª requestï¼› BestEffortï¼šåªè¦ä¸æ˜¯ Guaranteed å’Œ Burstableï¼Œé‚£å°±æ˜¯ BestEffortã€‚ æœåŠ¡è´¨é‡æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿèµ„æºé…ç½®å¥½åï¼Œå½“è¿™ä¸ªèŠ‚ç‚¹ä¸Š pod å®¹å™¨è¿è¡Œï¼Œæ¯”å¦‚è¯´èŠ‚ç‚¹ä¸Š memory é…é¢èµ„æºä¸è¶³ï¼Œkubeletä¼šæŠŠä¸€äº›ä½ä¼˜å…ˆçº§çš„ï¼Œæˆ–è€…è¯´æœåŠ¡è´¨é‡è¦æ±‚ä¸é«˜çš„ï¼ˆå¦‚ï¼šBestEffortã€Burstableï¼‰pod é©±é€æ‰ã€‚å®ƒä»¬æ˜¯æŒ‰ç…§å…ˆå»é™¤ BestEffortï¼Œå†å»é™¤ Burstable çš„ä¸€ä¸ªé¡ºåºæ¥é©±é€ pod çš„ã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:5:2","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"SecurityContext","date":"2021-07-17","objectID":"/application-configuration-management/:6:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"SecurityContext ä»‹ç»SecurityContext ä¸»è¦æ˜¯ç”¨äºé™åˆ¶å®¹å™¨çš„ä¸€ä¸ªè¡Œä¸ºï¼Œå®ƒèƒ½ä¿è¯ç³»ç»Ÿå’Œå…¶ä»–å®¹å™¨çš„å®‰å…¨ã€‚è¿™ä¸€å—çš„èƒ½åŠ›ä¸æ˜¯ Kubernetes æˆ–è€…å®¹å™¨ runtime æœ¬èº«çš„èƒ½åŠ›ï¼Œè€Œæ˜¯ Kubernetes å’Œ runtime é€šè¿‡ç”¨æˆ·çš„é…ç½®ï¼Œæœ€åä¸‹ä¼ åˆ°å†…æ ¸é‡Œï¼Œå†é€šè¿‡å†…æ ¸çš„æœºåˆ¶è®© SecurityContext æ¥ç”Ÿæ•ˆã€‚ SecurityContext ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªçº§åˆ«ï¼š ç¬¬ä¸€ä¸ªæ˜¯å®¹å™¨çº§åˆ«ï¼Œä»…å¯¹å®¹å™¨ç”Ÿæ•ˆï¼› ç¬¬äºŒä¸ªæ˜¯ pod çº§åˆ«ï¼Œå¯¹ pod é‡Œæ‰€æœ‰å®¹å™¨ç”Ÿæ•ˆï¼› ç¬¬ä¸‰ä¸ªæ˜¯é›†ç¾¤çº§åˆ«ï¼Œå°±æ˜¯ PSPï¼Œå¯¹é›†ç¾¤å†…æ‰€æœ‰ pod ç”Ÿæ•ˆã€‚ æƒé™å’Œè®¿é—®æ§åˆ¶è®¾ç½®é¡¹ï¼Œç°åœ¨ä¸€å…±åˆ—æœ‰ä¸ƒé¡¹ï¼ˆè¿™ä¸ªæ•°é‡åç»­å¯èƒ½ä¼šå˜åŒ–ï¼‰ï¼š ç¬¬ä¸€ä¸ªå°±æ˜¯é€šè¿‡ç”¨æˆ· ID å’Œç»„ ID æ¥æ§åˆ¶æ–‡ä»¶è®¿é—®æƒé™ï¼› ç¬¬äºŒä¸ªæ˜¯ SELinuxï¼Œå®ƒæ˜¯é€šè¿‡ç­–ç•¥é…ç½®æ¥æ§åˆ¶ç”¨æˆ·æˆ–è€…è¿›ç¨‹å¯¹æ–‡ä»¶çš„è®¿é—®æ§åˆ¶ï¼› ç¬¬ä¸‰ä¸ªæ˜¯ç‰¹æƒå®¹å™¨ï¼› ç¬¬å››ä¸ªæ˜¯ Capabilitiesï¼Œå®ƒä¹Ÿæ˜¯ç»™ç‰¹å®šè¿›ç¨‹æ¥é…ç½®ä¸€ä¸ª privileged èƒ½åŠ›ï¼› ç¬¬äº”ä¸ªæ˜¯ AppArmorï¼Œå®ƒä¹Ÿæ˜¯é€šè¿‡ä¸€äº›é…ç½®æ–‡ä»¶æ¥æ§åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„ä¸€ä¸ªè®¿é—®æ§åˆ¶æƒé™ï¼Œæ¯”å¦‚è¯´ä¸€äº›ç«¯å£çš„è¯»å†™ï¼› ç¬¬å…­ä¸ªæ˜¯ä¸€ä¸ªå¯¹ç³»ç»Ÿè°ƒç”¨çš„æ§åˆ¶ï¼› ç¬¬ä¸ƒä¸ªæ˜¯å¯¹å­è¿›ç¨‹èƒ½å¦è·å–æ¯”çˆ¶äº²æ›´å¤šçš„æƒé™çš„ä¸€ä¸ªé™åˆ¶ã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:6:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"InitContainer","date":"2021-07-17","objectID":"/application-configuration-management/:7:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"InitContainer ä»‹ç»é¦–å…ˆä»‹ç» InitContainer å’Œæ™®é€š container çš„åŒºåˆ«ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç‚¹å†…å®¹ï¼š InitContainer é¦–å…ˆä¼šæ¯”æ™®é€š container å…ˆå¯åŠ¨ï¼Œå¹¶ä¸”ç›´åˆ°æ‰€æœ‰çš„ InitContainer æ‰§è¡ŒæˆåŠŸåï¼Œæ™®é€š container æ‰ä¼šè¢«å¯åŠ¨ InitContainer ä¹‹é—´æ˜¯æŒ‰å®šä¹‰çš„æ¬¡åºå»å¯åŠ¨æ‰§è¡Œçš„ï¼Œæ‰§è¡ŒæˆåŠŸä¸€ä¸ªä¹‹åå†æ‰§è¡Œç¬¬äºŒä¸ªï¼Œè€Œæ™®é€šçš„ container æ˜¯å¹¶å‘å¯åŠ¨çš„ï¼› InitContainer æ‰§è¡ŒæˆåŠŸåå°±ç»“æŸé€€å‡ºï¼Œè€Œæ™®é€šå®¹å™¨å¯èƒ½ä¼šä¸€ç›´åœ¨æ‰§è¡Œã€‚å®ƒå¯èƒ½æ˜¯ä¸€ä¸ª longtime çš„ï¼Œæˆ–è€…è¯´å¤±è´¥äº†ä¼šé‡å¯ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ InitContainer å’Œæ™®é€š container ä¸åŒçš„åœ°æ–¹ InitContainer å…¶å®ä¸»è¦ä¸ºæ™®é€š container æœåŠ¡ï¼Œæ¯”å¦‚è¯´å®ƒå¯ä»¥ä¸ºæ™®é€š container å¯åŠ¨ä¹‹å‰åšä¸€ä¸ªåˆå§‹åŒ–ï¼Œæˆ–è€…ä¸ºå®ƒå‡†å¤‡ä¸€äº›é…ç½®æ–‡ä»¶ï¼Œ é…ç½®æ–‡ä»¶å¯èƒ½æ˜¯ä¸€äº›å˜åŒ–çš„ä¸œè¥¿ã€‚å†æ¯”å¦‚åšä¸€äº›å‰ç½®æ¡ä»¶çš„æ ¡éªŒï¼Œå¦‚ç½‘ç»œæ˜¯å¦è”é€šã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:7:1","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç»“æŸè¯­ ConfigMap å’Œ Secret: é¦–å…ˆä»‹ç»äº† ConfigMap å’Œ Secret çš„åˆ›å»ºæ–¹æ³•å’Œä½¿ç”¨åœºæ™¯ï¼Œç„¶åå¯¹ ConfigMap å’Œ Secret çš„å¸¸è§ä½¿ç”¨æ³¨æ„ç‚¹è¿›è¡Œäº†åˆ†ç±»å’Œæ•´ç†ã€‚æœ€åä»‹ç»äº†ç§æœ‰ä»“åº“é•œåƒçš„ä½¿ç”¨å’Œé…ç½®ï¼› Pod èº«ä»½è®¤è¯: é¦–å…ˆä»‹ç»äº† ServiceAccount å’Œ Secret çš„å…³è”å…³ç³»ï¼Œç„¶åä»æºç è§’åº¦å¯¹ Pod èº«ä»½è®¤è¯æµç¨‹å’Œå®ç°ç»†èŠ‚è¿›è¡Œå‰–æï¼ŒåŒæ—¶å¼•å‡ºäº† Pod çš„æƒé™ç®¡ç†(å³ RBAC çš„é…ç½®ç®¡ç†)ï¼› å®¹å™¨èµ„æºå’Œå®‰å…¨ï¼š é¦–å…ˆä»‹ç»äº†å®¹å™¨å¸¸è§èµ„æºç±»å‹ (CPU/Memory) çš„é…ç½®ï¼Œç„¶åå¯¹ Pod æœåŠ¡è´¨é‡åˆ†ç±»è¿›è¡Œè¯¦ç»†çš„ä»‹ç»ã€‚åŒæ—¶å¯¹ SecurityContext æœ‰æ•ˆå±‚çº§å’Œæƒé™é…ç½®é¡¹è¿›è¡Œç®€è¦è¯´æ˜ï¼› InitContainer: é¦–å…ˆä»‹ç»äº† InitContainer å’Œæ™®é€š container çš„åŒºåˆ«ä»¥åŠ InitContainer çš„ç”¨é€”ã€‚ç„¶ååŸºäºå®é™…ç”¨ä¾‹å¯¹ InitContainer çš„ç”¨é€”è¿›è¡Œäº†è¯´æ˜ã€‚ ","date":"2021-07-17","objectID":"/application-configuration-management/:8:0","tags":["äº‘åŸç”Ÿ","Kubernetes","é…ç½®ç®¡ç†"],"title":"åº”ç”¨é…ç½®ç®¡ç†","uri":"/application-configuration-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"é€šè¿‡ç±»æ¯” Deployment æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬ç†è§£äº†ä¸€ä¸‹DaemonSet æ§åˆ¶å™¨çš„å·¥ä½œæµç¨‹ä¸æ–¹å¼ï¼Œå¹¶ä¸”é€šè¿‡å¯¹ DaemonSet çš„æ›´æ–°äº†è§£äº†æ»šåŠ¨æ›´æ–°çš„æ¦‚å¿µå’Œç›¸å¯¹åº”çš„æ“ä½œæ–¹å¼ã€‚","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"éœ€æ±‚æ¥æºå¦‚æœæˆ‘ä»¬æ²¡æœ‰ DaemonSet ä¼šæ€ä¹ˆæ ·ï¼Ÿä¸‹é¢æœ‰å‡ ä¸ªéœ€æ±‚ï¼š é¦–å…ˆå¦‚æœå¸Œæœ›æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿è¡ŒåŒæ ·ä¸€ä¸ª pod æ€ä¹ˆåŠï¼Ÿ å¦‚æœæ–°èŠ‚ç‚¹åŠ å…¥é›†ç¾¤çš„æ—¶å€™ï¼Œæƒ³è¦ç«‹åˆ»æ„ŸçŸ¥åˆ°å®ƒï¼Œç„¶åå»éƒ¨ç½²ä¸€ä¸ª podï¼Œå¸®åŠ©æˆ‘ä»¬åˆå§‹åŒ–ä¸€äº›ä¸œè¥¿ï¼Œè¿™ä¸ªéœ€æ±‚å¦‚ä½•åšï¼Ÿ å¦‚æœæœ‰èŠ‚ç‚¹é€€å‡ºçš„æ—¶å€™ï¼Œå¸Œæœ›å¯¹åº”çš„ pod ä¼šè¢«åˆ é™¤æ‰ï¼Œåº”è¯¥æ€ä¹ˆæ“ä½œï¼Ÿ å¦‚æœ pod çŠ¶æ€å¼‚å¸¸çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åŠæ—¶åœ°ç›‘æ§è¿™ä¸ªèŠ‚ç‚¹å¼‚å¸¸ï¼Œç„¶ååšä¸€äº›ç›‘æ§æˆ–è€…æ±‡æŠ¥çš„ä¸€äº›åŠ¨ä½œï¼Œé‚£ä¹ˆè¿™äº›ä¸œè¥¿è¿ç”¨ä»€ä¹ˆæ§åˆ¶å™¨æ¥åšï¼Ÿ ","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"DaemonSetï¼šå®ˆæŠ¤è¿›ç¨‹æ§åˆ¶å™¨DaemonSet ä¹Ÿæ˜¯ Kubernetes æä¾›çš„ä¸€ä¸ª default controllerï¼Œå®ƒå®é™…æ˜¯åšä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹çš„æ§åˆ¶å™¨ï¼Œå®ƒèƒ½å¸®æˆ‘ä»¬åšåˆ°ä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š é¦–å…ˆèƒ½ä¿è¯é›†ç¾¤å†…çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½è¿è¡Œä¸€ç»„ç›¸åŒçš„ podï¼› åŒæ—¶è¿˜èƒ½æ ¹æ®èŠ‚ç‚¹çš„çŠ¶æ€ä¿è¯æ–°åŠ å…¥çš„èŠ‚ç‚¹è‡ªåŠ¨åˆ›å»ºå¯¹åº”çš„ podï¼› åœ¨ç§»é™¤èŠ‚ç‚¹çš„æ—¶å€™ï¼Œèƒ½åˆ é™¤å¯¹åº”çš„ podï¼› è€Œä¸”å®ƒä¼šè·Ÿè¸ªæ¯ä¸ª pod çš„çŠ¶æ€ï¼Œå½“è¿™ä¸ª pod å‡ºç°å¼‚å¸¸ã€Crash æ‰äº†ï¼Œä¼šåŠæ—¶åœ°å» recovery è¿™ä¸ªçŠ¶æ€ã€‚ ","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç”¨ä¾‹è§£è¯»","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"DaemonSet è¯­æ³• apiVersion:apps/v1kind:DaemonSetmetadata:name:fluentd-elasticsearchnamespace:kube-systemlables:k8s-app:fluentd-loggingspec:selector:matchLabels:name:fluentd-elasticsearchtemplate:metadata:labels:name:fluentd-elasticsearchspec:containers:- name:fluentd-elasticsearchimage:fluent/fluentd:v1.4-1 é¦–å…ˆæ˜¯ kind:DaemonSetã€‚å®ƒä¼šæœ‰ matchLabelï¼Œé€šè¿‡ matchLabel å»ç®¡ç†å¯¹åº”æ‰€å±çš„ podï¼Œè¿™ä¸ª pod.label ä¹Ÿè¦å’Œè¿™ä¸ª DaemonSet.controller.label æƒ³åŒ¹é…ï¼Œå®ƒæ‰èƒ½å»æ ¹æ® label.selector å»æ‰¾åˆ°å¯¹åº”çš„ç®¡ç† Podã€‚ä¸‹é¢ spec.container é‡Œé¢çš„ä¸œè¥¿éƒ½æ˜¯ä¸€è‡´çš„ã€‚ DaemonSet é€‚ç”¨åœºæ™¯ï¼š é›†ç¾¤å­˜å‚¨è¿›ç¨‹ï¼š GlusterFS æˆ–è€… Ceph ä¹‹ç±»çš„ä¸œè¥¿ï¼Œéœ€è¦æ¯å°èŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œä¸€ä¸ªç±»ä¼¼äº Agent çš„ä¸œè¥¿ï¼ŒDaemonSet å°±èƒ½å¾ˆå¥½åœ°æ»¡è¶³è¿™ä¸ªè¯‰æ±‚ï¼› æ—¥å¿—æ”¶é›†è¿›ç¨‹ï¼šlogstash æˆ–è€… fluentdï¼Œè¿™äº›éƒ½æ˜¯åŒæ ·çš„éœ€æ±‚ï¼Œéœ€è¦æ¯å°èŠ‚ç‚¹éƒ½è¿è¡Œä¸€ä¸ª Agentï¼Œè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“æœé›†åˆ°å®ƒçš„çŠ¶æ€ï¼ŒæŠŠå„ä¸ªèŠ‚ç‚¹é‡Œé¢çš„ä¿¡æ¯åŠæ—¶åœ°æ±‡æŠ¥åˆ°ä¸Šé¢ï¼› éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œçš„ç›‘æ§æ”¶é›†å™¨ï¼Œä¾‹å¦‚ Promethuesã€‚ ","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æŸ¥çœ‹ DaemonSet çŠ¶æ€åˆ›å»ºå®Œ DaemonSet ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ kubectl get DaemonSetï¼ˆDaemonSet ç¼©å†™ä¸º dsï¼‰ã€‚ kubectl get ds NAME DESIRED CURRENT READY UP-TO-DATE AVAILABLE NODE SELECTOR AGE fluentd-elasticsearch 4 4 4 4 4 \u003cnone\u003e 4s çŠ¶æ€æè¿°ï¼š DESIREDï¼šéœ€è¦çš„ pod ä¸ªæ•° CURRENTï¼šå½“å‰å·²å­˜åœ¨çš„ pod ä¸ªæ•° READYï¼šå°±ç»ªçš„ä¸ªæ•° UP-TO-DATEï¼šæœ€æ–°åˆ›å»ºçš„ä¸ªæ•° AVAILABLEï¼šå¯ç”¨ pod ä¸ªæ•° NODE SELECTORï¼šèŠ‚ç‚¹é€‰æ‹©æ ‡ç­¾ï¼Œå¯ç”¨äºé€‰æ‹©éƒ¨åˆ†èŠ‚ç‚¹å»è¿è¡Œ podï¼Œè€Œä¸æ˜¯å…¨éƒ¨èŠ‚ç‚¹è¿è¡Œ pod ","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ›´æ–° DaemonSetå…¶å® DaemonSet å’Œ deployment ç‰¹åˆ«åƒï¼Œå®ƒä¹Ÿæœ‰ä¸¤ç§æ›´æ–°ç­–ç•¥ï¼šä¸€ä¸ªæ˜¯ RollingUpdateï¼Œå¦ä¸€ä¸ªæ˜¯ OnDeleteã€‚ RollingUpdate å…¶å®æ¯”è¾ƒå¥½ç†è§£ï¼Œå°±æ˜¯ä¼šä¸€ä¸ªä¸€ä¸ªçš„æ›´æ–°ã€‚å…ˆæ›´æ–°ç¬¬ä¸€ä¸ª podï¼Œç„¶åè€çš„ pod è¢«ç§»é™¤ï¼Œé€šè¿‡å¥åº·æ£€æŸ¥ä¹‹åå†å»è§ç¬¬äºŒä¸ª podï¼Œè¿™æ ·å¯¹äºä¸šåŠ¡ä¸Šæ¥è¯´ä¼šæ¯”è¾ƒå¹³æ»‘åœ°å‡çº§ï¼Œä¸ä¼šä¸­æ–­ï¼› OnDelete å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ›´æ–°ç­–ç•¥ï¼Œå°±æ˜¯æ¨¡æ¿æ›´æ–°ä¹‹åï¼Œpod ä¸ä¼šæœ‰ä»»ä½•å˜åŒ–ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ§åˆ¶ã€‚æˆ‘ä»¬å»åˆ é™¤æŸä¸€ä¸ªèŠ‚ç‚¹å¯¹åº”çš„ podï¼Œå®ƒå°±ä¼šé‡å»ºï¼Œä¸åˆ é™¤çš„è¯å®ƒå°±ä¸ä¼šé‡å»ºï¼Œè¿™æ ·çš„è¯å¯¹äºä¸€äº›æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ§åˆ¶çš„ç‰¹æ®Šéœ€æ±‚ä¹Ÿä¼šæœ‰ç‰¹åˆ«å¥½çš„ä½œç”¨ã€‚ ","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:3:3","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ¶æ„è®¾è®¡","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:4:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"DaemonSet ç®¡ç†æ¨¡å¼ DaemonSet Architecture DaemonSet Controller è´Ÿè´£æ ¹æ®é…ç½®åˆ›å»º Pod DaemonSet Controller è·Ÿè¸ª Job çŠ¶æ€ï¼Œæ ¹æ®é…ç½®åŠæ—¶é‡è¯• Pod æˆ–è€…ç»§ç»­åˆ›å»º DaemonSet Controller ä¼šè‡ªåŠ¨æ·»åŠ  affinity\u0026label æ¥è·Ÿè¸ªå¯¹åº”çš„ podï¼Œå¹¶æ ¹æ®é…ç½®åœ¨æ¯ä¸ªèŠ‚ç‚¹æˆ–è€…é€‚åº”çš„éƒ¨åˆ†èŠ‚ç‚¹åˆ›å»º Pod ","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:4:1","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"DaemonSet æ§åˆ¶å™¨ DaemonSet Controller DaemonSet å…¶å®å’Œ Job controller åšçš„å·®ä¸å¤šï¼šä¸¤è€…éƒ½éœ€è¦æ ¹æ® watch è¿™ä¸ª API Server çš„çŠ¶æ€ã€‚ç°åœ¨ DaemonSet å’Œ Job controller å”¯ä¸€çš„ä¸åŒç‚¹åœ¨äºï¼ŒDaemonsetSet Controlleréœ€è¦å» watch node çš„çŠ¶æ€ï¼Œä½†å…¶å®è¿™ä¸ª node çš„çŠ¶æ€è¿˜æ˜¯é€šè¿‡ API Server ä¼ é€’åˆ° ETCD ä¸Šã€‚ å½“æœ‰ node çŠ¶æ€èŠ‚ç‚¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒä¼šé€šè¿‡ä¸€ä¸ªå†…å­˜æ¶ˆæ¯é˜Ÿåˆ—å‘è¿›æ¥ï¼Œç„¶åDaemonSet controller ä¼šå» watch è¿™ä¸ªçŠ¶æ€ï¼Œçœ‹ä¸€ä¸‹å„ä¸ªèŠ‚ç‚¹ä¸Šæ˜¯éƒ½æœ‰å¯¹åº”çš„ Podï¼Œå¦‚æœæ²¡æœ‰çš„è¯å°±å»åˆ›å»ºã€‚å½“ç„¶å®ƒä¼šå»åšä¸€ä¸ªå¯¹æ¯”ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå®ƒä¼šæ¯”è¾ƒä¸€ä¸‹ç‰ˆæœ¬ï¼Œç„¶ååŠ ä¸Šåˆšæ‰æåˆ°çš„æ˜¯å¦å»åš RollingUpdateï¼Ÿå¦‚æœæ²¡æœ‰çš„è¯å°±ä¼šé‡æ–°åˆ›å»ºï¼ŒOndelete åˆ é™¤ pod çš„æ—¶å€™ä¹Ÿä¼šå»åš check å®ƒåšä¸€éæ£€æŸ¥ï¼Œæ˜¯å¦å»æ›´æ–°ï¼Œæˆ–è€…å»åˆ›å»ºå¯¹åº”çš„ podã€‚ å½“ç„¶æœ€åçš„æ—¶å€™ï¼Œå¦‚æœå…¨éƒ¨æ›´æ–°å®Œäº†ä¹‹åï¼Œå®ƒä¼šæŠŠæ•´ä¸ª DaemonSet çš„çŠ¶æ€å»æ›´æ–°åˆ° API Server ä¸Šï¼Œå®Œæˆæœ€åå…¨éƒ¨çš„æ›´æ–°ã€‚ ","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:4:2","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬èŠ‚æ€»ç»“DaemonSet åŸºç¡€æ“ä½œä¸æ¦‚å¿µè§£æï¼šé€šè¿‡ç±»æ¯” Deployment æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬ç†è§£äº†ä¸€ä¸‹DaemonSet æ§åˆ¶å™¨çš„å·¥ä½œæµç¨‹ä¸æ–¹å¼ï¼Œå¹¶ä¸”é€šè¿‡å¯¹ DaemonSet çš„æ›´æ–°äº†è§£äº†æ»šåŠ¨æ›´æ–°çš„æ¦‚å¿µå’Œç›¸å¯¹åº”çš„æ“ä½œæ–¹å¼ã€‚ ","date":"2021-07-10","objectID":"/application-orchestration-and-management-daemonset/:5:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","DaemonSet"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDaemonSet","uri":"/application-orchestration-and-management-daemonset/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å¦‚ä½•ç®¡ç† Pod ä¸­çš„è¿›ç¨‹ï¼Ÿä¸€åˆ‡ç§˜å¯†éƒ½åœ¨è¿™é‡Œ","date":"2021-07-04","objectID":"/application-orchestration-and-management-job/","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Job","CronJob"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šJob","uri":"/application-orchestration-and-management-job/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Job","date":"2021-07-04","objectID":"/application-orchestration-and-management-job/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Job","CronJob"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šJob","uri":"/application-orchestration-and-management-job/"},{"categories":["äº‘åŸç”Ÿ"],"content":"éœ€æ±‚æ¥æºJob èƒŒæ™¯é—®é¢˜ åœ¨ K8s é‡Œï¼Œæœ€å°çš„è°ƒåº¦å•å…ƒæ˜¯ Podï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ Pod æ¥è¿è¡Œä»»åŠ¡è¿›ç¨‹ã€‚è¿™æ ·åšä¼šäº§ç”Ÿä»¥ä¸‹å‡ ç§é—®é¢˜ï¼š å¦‚ä½•ä¿è¯ Pod å†…è¿›ç¨‹æ­£ç¡®çš„ç»“æŸï¼Ÿ å¦‚ä½•ä¿è¯è¿›ç¨‹è¿è¡Œå¤±è´¥åé‡è¯•ï¼Ÿ å¦‚ä½•ç®¡ç†å¤šä¸ªä»»åŠ¡ï¼Œä¸”ä»»åŠ¡ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Ÿ å¦‚ä½•å¹¶è¡Œåœ°è¿è¡Œä»»åŠ¡ï¼Œå¹¶ç®¡ç†ä»»åŠ¡çš„é˜Ÿåˆ—å¤§å°ï¼Ÿ Jobï¼šç®¡ç†ä»»åŠ¡çš„æ§åˆ¶å™¨ Job æä¾›äº†ä»¥ä¸‹åŠŸèƒ½ï¼š é¦–å…ˆ K8s çš„ Job æ˜¯ä¸€ä¸ªç®¡ç†ä»»åŠ¡çš„æ§åˆ¶å™¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ª Pod æ¥æŒ‡å®š Pod çš„æ•°é‡ï¼Œå¹¶å¯ä»¥ç›‘æ§å®ƒæ˜¯å¦æˆåŠŸåœ°è¿è¡Œæˆ–ç»ˆæ­¢ï¼› å¯ä»¥æ ¹æ® Pod çš„çŠ¶æ€æ¥ç»™ Job è®¾ç½®é‡ç½®çš„æ–¹å¼åŠé‡è¯•çš„æ¬¡æ•°ï¼› å¯ä»¥æ ¹æ®ä¾èµ–å…³ç³»ï¼Œä¿è¯ä¸Šä¸€ä¸ªä»»åŠ¡è¿è¡Œå®Œæˆä¹‹åå†è¿è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼› å¯ä»¥æ§åˆ¶ä»»åŠ¡çš„å¹¶è¡Œåº¦ï¼Œæ ¹æ®å¹¶è¡Œåº¦æ¥ç¡®ä¿ Pod è¿è¡Œè¿‡ç¨‹ä¸­çš„å¹¶è¡Œæ¬¡æ•°å’Œæ€»ä½“å®Œæˆå¤§å°ã€‚ ","date":"2021-07-04","objectID":"/application-orchestration-and-management-job/:1:1","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Job","CronJob"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šJob","uri":"/application-orchestration-and-management-job/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç”¨ä¾‹è§£è¯»Job è¯­æ³• apiVersion:batch/v1kind:Jobmetadata:name:pispec:template:spec:containers:- name:piimage:perlcommand:[\"perl\",\"-Mbignum=bpi\",\"-wle\",\"print bpi(2000)\"]restartPolicy:NeverbackoffLimit:4 restartPolicyï¼šå¯ä»¥è®¾ç½® Neverã€OnFailureã€Always è¿™ä¸‰ç§é‡è¯•ç­–ç•¥ã€‚åœ¨å¸Œæœ› Job éœ€è¦é‡æ–°è¿è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ç”¨ Neverï¼›å¸Œæœ›åœ¨å¤±è´¥çš„æ—¶å€™å†è¿è¡Œï¼Œå†é‡è¯•å¯ä»¥ç”¨ OnFailureï¼›æˆ–è€…ä¸è®ºä»€ä¹ˆæƒ…å†µä¸‹éƒ½é‡æ–°è¿è¡Œæ—¶ Alwaysï¼› backoffLimitï¼šæ§åˆ¶ Job é‡è¯•çš„æ¬¡æ•°ã€‚ å¹¶è¡Œè¿è¡Œ Job apiVersion:batch/v1kind:Jobmetadata:name:paral-1spec:completions:8parallelism:2template:spec:containers:- name:paralimage:ubuntucommand:[\"/bin/sh\"]args:[\"-c\",\"sleep 30; date\"]restartPolicy:OnFailure æœ‰æ—¶ä¼šæœ‰å¹¶è¡Œè¿è¡Œçš„éœ€æ±‚ï¼šå¸Œæœ› Job è¿è¡Œçš„æ—¶å€™å¯ä»¥æœ€å¤§åŒ–çš„å¹¶è¡Œï¼Œå¹¶è¡Œå‡º n ä¸ª Pod å»å¿«é€Ÿåœ°æ‰§è¡Œã€‚åŒæ—¶ï¼Œä¹Ÿä¸å¸Œæœ›åŒæ—¶å¹¶è¡Œçš„ Pod æ•°è¿‡å¤šã€‚ completionsï¼šæŒ‡å®šæœ¬ Pod é˜Ÿåˆ—æ‰§è¡Œæ¬¡æ•°ï¼Œæˆ–è€…ç†è§£ä¸ºæŒ‡å®šå¯ä»¥è¿è¡Œçš„æ€»æ¬¡æ•°ï¼› parallelismï¼šå¹¶è¡Œæ‰§è¡Œçš„ä¸ªæ•°ã€‚ CronJob è¯­æ³• apiVersion:batch/v1beta1kind:CronJobmetadata:name:hellospec:schedule:\"*/1 * * * *\"jobTemplate:spec:template:spec:containers:- name:helloimage:busyboxargs:- /bin/sh- -c- date; echo Hello from the Kubernetes clusterrestartPolicy:OnFailurestartingDeadlineSeconds:10concurrencyPolicy:AllowsuccessfulJobsHistoryLimit:3 CronJobï¼Œä¹Ÿå«åšå®šæ—¶è¿è¡Œ Jobï¼Œå¯ä»¥è®¾å®šä¸€ä¸ªäº‹ä»¶å»æ‰§è¡Œï¼› scheduleï¼šè®¾ç½®æ—¶é—´æ ¼å¼ï¼Œå’Œ Linux çš„ crontime æ˜¯ä¸€æ ·çš„ï¼Œç›´æ¥æ ¹æ® Linux çš„ crontime ä¹¦å†™æ ¼å¼æ¥å†™å°±å¯ä»¥äº† startDeadlineSecondsï¼šæ¯æ¬¡è¿è¡Œ Job çš„æ—¶å€™ï¼Œæœ€é•¿å¯ä»¥ç­‰å¤šé•¿æ—¶é—´ï¼Œæœ‰æ—¶ Job å¯èƒ½è¿è¡Œå¾ˆé•¿æ—¶é—´ä¹Ÿä¸ä¼šå¯åŠ¨ã€‚å¦‚æœè¶…è¿‡è¾ƒé•¿æ—¶é—´çš„è¯ï¼ŒCronJob å°±ä¼šåœæ­¢è¿™ä¸ª Jobï¼› concurrencyPolicyï¼šæ˜¯å¦å…è®¸å¹¶è¡Œè¿è¡Œï¼Œå¦‚æœè®¾ç½®å…è®¸ï¼Œåˆ™ä¸ç®¡å‰é¢çš„ Job æ˜¯å¦è¿è¡Œå®Œæˆï¼Œåé¢çš„ Job æ¯åˆ†é’Ÿéƒ½ä¼šæ‰§è¡Œï¼Œå¦‚æœæ˜¯ falseï¼Œåˆ™ç­‰å¾…ä¸Šä¸ªç»“æŸå†è¿è¡Œä¸‹ä¸€ä¸ªï¼› JobsHistoryLimitï¼šç•™å­˜å†å²ç‰ˆæœ¬æ•°é‡ã€‚ ","date":"2021-07-04","objectID":"/application-orchestration-and-management-job/:1:2","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Job","CronJob"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šJob","uri":"/application-orchestration-and-management-job/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ¶æ„è®¾è®¡ Job Architecture Job Controller åˆ›å»ºç›¸å¯¹åº”çš„ podï¼› Job Controller è·Ÿè¸ª Job çŠ¶æ€ï¼Œæ ¹æ®é…ç½®åŠæ—¶é‡è¯• Pod æˆ–è€…ç»§ç»­åˆ›å»ºï¼› Job Controller ä¼šè‡ªåŠ¨æ·»åŠ  label æ¥è·Ÿè¸ªå¯¹åº”çš„ podï¼Œå¹¶æ ¹æ®é…ç½®å¹¶è¡Œæˆ–ä¸²è¡Œåˆ›å»º Podã€‚ Job æ§åˆ¶å™¨ Job Controller æ‰€æœ‰ Job éƒ½æ˜¯ä¸€ä¸ª controllerï¼Œå®ƒä¼š watch è¿™ä¸ª API Serverï¼Œæ¯æ¬¡æäº¤ä¸€ä¸ª Job çš„ yaml éƒ½ä¼šç»è¿‡ api-server ä¼ åˆ° etcd é‡Œé¢å»ï¼Œç„¶å Job Controller ä¼šæ³¨å†Œå‡ ä¸ª Handlerï¼Œæ¯å½“æœ‰æ·»åŠ ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œçš„æ—¶å€™ï¼Œä¼šé€šè¿‡ä¸€ä¸ªå†…å­˜çº§çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå‘åˆ° controller é‡Œé¢ã€‚ é€šè¿‡ Job Controller æ£€æŸ¥å½“å‰æ˜¯å¦æœ‰è¿è¡Œçš„ Podï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé€šè¿‡ Scale up æŠŠè¿™ä¸ª Pod åˆ›å»ºå‡ºæ¥ï¼›å¦‚æœæœ‰çš„è¯ï¼Œæˆ–è€…å¤§äºè¿™ä¸ªæ•°ï¼Œå¯¹å®ƒè¿›è¡Œ Scale downï¼Œå¦‚æœè¿™æ—¶ Pod å‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦åŠæ—¶æ›´æ–°çŠ¶æ€ã€‚ åŒæ—¶è¦å»æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯å¹¶è¡Œçš„ jobï¼Œæˆ–è€…æ˜¯ä¸²è¡Œçš„ jobï¼Œæ ¹æ®è®¾ç½®çš„é…ç½®å¹¶è¡Œåº¦ã€ä¸²è¡Œåº¦ï¼ŒåŠæ—¶åœ°æŠŠ pod çš„æ•°é‡ç»™åˆ›å»ºå‡ºæ¥ã€‚æœ€åï¼Œå®ƒä¼šæŠŠ job çš„æ•´ä¸ªçš„çŠ¶æ€æ›´æ–°åˆ° API Server é‡Œé¢å»ï¼Œè¿™æ ·å°±èƒ½çœ‹åˆ°å‘ˆç°å‡ºæ¥çš„æœ€ç»ˆæ•ˆæœäº†ã€‚ ","date":"2021-07-04","objectID":"/application-orchestration-and-management-job/:1:3","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Job","CronJob"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šJob","uri":"/application-orchestration-and-management-job/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Deployment ä¿è¯é›†ç¾¤é‡Œå¯ç”¨ Pod æ•°é‡ï¼Œä¸ºæ‰€æœ‰ Pod æ›´æ–°é•œåƒç‰ˆæœ¬ï¼Œä¿è¯æ›´æ–°è¿‡ç¨‹ä¸­çš„æœåŠ¡å¯ç”¨æ€§ï¼Œå®ç°å¿«é€Ÿå›æ»š","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"éœ€æ±‚æ¥æº","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"èƒŒæ™¯é—®é¢˜ç°åœ¨å­˜åœ¨ä¸‰ä¸ªåº”ç”¨ï¼Œåˆ†åˆ«å¯¹åº”ä¸€äº› Podï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥ç®¡ç†é›†ç¾¤ä¸­æ‰€æœ‰çš„ Pod å—ï¼Ÿ å¦‚æœç®¡ç†æ‰€æœ‰çš„ Podï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯é›†ç¾¤é‡Œå¯ç”¨ Pod æ•°é‡ï¼Ÿå¦‚ä½•ä¸ºæ‰€æœ‰ Pod æ›´æ–°é•œåƒç‰ˆæœ¬ï¼Ÿæ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•ä¿è¯æœåŠ¡å¯ç”¨æ€§ï¼Ÿæ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°é—®é¢˜å¦‚ä½•å¿«é€Ÿå›æ»šï¼Ÿ ","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:1:1","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Deploymentï¼šç®¡ç†éƒ¨ç½²å‘å¸ƒçš„æ§åˆ¶å™¨å¯ä»¥é€šè¿‡ Deployment å°†ä¸‰ä¸ªåº”ç”¨åˆ†åˆ«è§„åˆ’åˆ°ä¸åŒçš„ Deploymentï¼Œæ¯ä¸ª Deployment ç®¡ç†ä¸€ç»„ç›¸åŒçš„åº”ç”¨ Podï¼Œè¿™ç»„ Pod æ˜¯ç›¸åŒçš„ä¸€ä¸ªå‰¯æœ¬ã€‚ Deployment Deployment å¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š Deployment å®šä¹‰äº† Pod æœŸæœ›æ•°é‡ï¼› é…ç½® Pod å‘å¸ƒæ–¹å¼ï¼Œå³ controller ä¼šæŒ‰ç…§ç”¨æˆ·ç»™å®šçš„ç­–ç•¥æ¥æ›´æ–° Podï¼Œè€Œä¸”æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è®¾å®šä¸å¯ç”¨ Pod æ•°é‡åœ¨å¤šå°‘èŒƒå›´å†…ï¼› æ›´æ–°è¿‡ç¨‹ä¸­å‘ç°é—®é¢˜å¯ä»¥å›æ»šã€‚ ","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:1:2","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ¶æ„è®¾è®¡","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç®¡ç†æ¨¡å¼ Management Model Deployment åªç®¡ç†ä¸åŒç‰ˆæœ¬çš„ ReplicaSetï¼Œç”± ReplicaSet æ¥ç®¡ç†å…·ä½“çš„ Pod å‰¯æœ¬æ•°ï¼Œæ¯ä¸ª ReplicaSet å¯¹åº” Deployment template çš„ä¸€ä¸ªç‰ˆæœ¬ã€‚ ","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:2:1","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Deployment æ§åˆ¶å™¨ Deployment Controller æ§åˆ¶å™¨é€šè¿‡ Informer ä¸­çš„ Event åšä¸€äº› Handler å’Œ Watchï¼Œæ”¶åˆ°äº‹ä»¶åä¼šåŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚è€Œ Deployment controller ä»é˜Ÿåˆ—ä¸­å–å‡ºæ¥ä¹‹åï¼Œå®ƒçš„é€»è¾‘ä¼šåˆ¤æ–­ Check Pausedï¼Œå¦‚æœ Paused è®¾ç½®ä¸º true çš„è¯ï¼Œå°±è¡¨ç¤ºè¿™ä¸ª Deployment åªä¼šåšä¸€ä¸ªæ•°é‡ä¸Šçš„ç»´æŒï¼Œä¸ä¼šåšæ–°çš„å‘å¸ƒï¼Œå¦‚æœä¸º false çš„è¯ï¼Œå°±ä¼šåš Rolloutã€‚ ","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:2:2","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ReplicaSet æ§åˆ¶å™¨ Replicaset Controller å½“ Deployment åˆ†é… ReplicaSet ä¹‹åï¼ŒReplicaSet æ§åˆ¶å™¨æœ¬èº«ä¹Ÿæ˜¯ä» Informer ä¸­ watch ä¸€äº›äº‹ä»¶ï¼Œè¿™äº›äº‹ä»¶åŒ…å«äº† ReplicaSet å’Œ Pod çš„äº‹ä»¶ã€‚ä»é˜Ÿåˆ—ä¸­å–å‡ºä¹‹åï¼ŒReplicaSet controller çš„é€»è¾‘å¾ˆç®€å•ï¼Œå°±åªç®¡ç†å‰¯æœ¬æ•°ã€‚ ","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:2:3","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å‘å¸ƒæ¨¡æ‹Ÿ Deployment Process Deployment å½“å‰åˆå§‹ç‰ˆæœ¬ä¸º template1ï¼Œåº•ä¸‹æœ‰ä¸‰ä¸ª Podï¼šPod1ã€Pod2ã€Pod3ã€‚ è¿™æ—¶ä¿®æ”¹ template ä¸­ä¸€ä¸ªå®¹å™¨çš„ imageï¼ŒDeployment controller å°±ä¼šæ–°å»ºä¸€ä¸ªå¯¹åº” template2 çš„ ReplicaSetã€‚åˆ›å»ºå‡ºæ¥ä¹‹å ReplicaSet ä¼šé€æ¸ä¿®æ”¹ä¸¤ä¸ª ReplicaSet çš„æ•°é‡ï¼Œæ¯”å¦‚é€æ¸å¢åŠ  ReplicaSet2 ä¸­ replicas çš„æœŸæœ›æ•°é‡ï¼Œé€æ¸å‡å°‘ ReplicaSet1 ä¸­çš„ Pod æ•°é‡ã€‚ ","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:2:4","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"spec å­—æ®µè§£æ MinReadySecondsï¼šDeployment ä¼šæ ¹æ® Pod ready æ¥çœ‹ Pod æ˜¯å¦å¯ç”¨ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬è®¾ç½®äº† MinReadySeconds ä¹‹åï¼Œæ¯”å¦‚è®¾ç½®ä¸º 30 ç§’ï¼Œé‚£ Deployment å°±ä¸€å®šä¼šç­‰åˆ° Pod ready è¶…è¿‡ 30 ç§’ä¹‹åæ‰è®¤ä¸º Pod æ˜¯ available çš„ã€‚Pod available çš„å‰ææ¡ä»¶æ˜¯ Pod readyï¼Œä½†æ˜¯ ready çš„ Pod ä¸ä¸€å®šæ˜¯ available çš„ï¼Œå®ƒä¸€å®šè¦è¶…è¿‡ MinReadySeconds ä¹‹åï¼Œæ‰ä¼šåˆ¤æ–­ä¸º available revisionHistoryLimitï¼šä¿ç•™å†å² revisionï¼Œå³ä¿ç•™å†å² ReplicaSet çš„æ•°é‡ï¼Œé»˜è®¤å€¼ä¸º 10 ä¸ªã€‚è¿™é‡Œå¯ä»¥è®¾ç½®ä¸ºä¸€ä¸ªæˆ–ä¸¤ä¸ªï¼Œå¦‚æœå›æ»šå¯èƒ½æ€§æ¯”è¾ƒå¤§çš„è¯ï¼Œå¯ä»¥è®¾ç½®æ•°é‡è¶…è¿‡ 10ï¼› pausedï¼špaused æ˜¯æ ‡è¯†ï¼ŒDeployment åªåšæ•°é‡ç»´æŒï¼Œä¸åšæ–°çš„å‘å¸ƒï¼Œè¿™é‡Œåœ¨ Debug åœºæ™¯å¯èƒ½ä¼šç”¨åˆ°ï¼› progressDeadlineSecondsï¼šå‰é¢æåˆ°å½“ Deployment å¤„äºæ‰©å®¹æˆ–è€…å‘å¸ƒçŠ¶æ€æ—¶ï¼Œå®ƒçš„ condition ä¼šå¤„äºä¸€ä¸ª processing çš„çŠ¶æ€ï¼Œprocessing å¯ä»¥è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚å¦‚æœè¶…è¿‡è¶…æ—¶æ—¶é—´è¿˜å¤„äº processingï¼Œé‚£ä¹ˆ controller å°†è®¤ä¸ºè¿™ä¸ª Pod ä¼šè¿›å…¥ failed çš„çŠ¶æ€ã€‚ ","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:2:5","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å‡çº§ç­–ç•¥å­—æ®µè§£æDeployment åœ¨ RollingUpdate ä¸­ä¸»è¦æä¾›äº†ä¸¤ä¸ªç­–ç•¥ï¼Œä¸€ä¸ªæ˜¯ MaxUnavailableï¼Œå¦ä¸€ä¸ªæ˜¯ MaxSurgeã€‚ MaxUnavailableï¼šæ»šåŠ¨è¿‡ç¨‹ä¸­æœ€å¤šæœ‰å¤šå°‘ä¸ª Pod ä¸å¯ç”¨ï¼› MaxSurgeï¼šæ»šåŠ¨è¿‡ç¨‹ä¸­æœ€å¤šå­˜åœ¨å¤šå°‘ä¸ª Pod è¶…è¿‡é¢„æœŸ replicas æ•°é‡ã€‚ ä¸Šæ–‡æåˆ°ï¼ŒReplicaSet ä¸º 3 çš„ Deployment åœ¨å‘å¸ƒçš„æ—¶å€™å¯èƒ½å­˜åœ¨ä¸€ç§æƒ…å†µï¼šæ–°ç‰ˆæœ¬çš„ ReplicaSet å’Œæ—§ç‰ˆæœ¬çš„ ReplicaSet éƒ½å¯èƒ½æœ‰ä¸¤ä¸ª replicasï¼ŒåŠ åœ¨ä¸€èµ·å°±æ˜¯ 4 ä¸ªï¼Œè¶…è¿‡äº†æˆ‘ä»¬æœŸæœ›çš„æ•°é‡ä¸‰ä¸ªã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬é»˜è®¤çš„ MaxUnavailable å’Œ MaxSurge éƒ½æ˜¯ 25%ï¼Œé»˜è®¤ Deployment åœ¨å‘å¸ƒçš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½æœ‰ 25% çš„ replica æ˜¯ä¸å¯ç”¨çš„ï¼Œä¹Ÿå¯èƒ½è¶…è¿‡ replica æ•°é‡ 25% æ˜¯å¯ç”¨çš„ï¼Œæœ€é«˜å¯ä»¥è¾¾åˆ° 125% çš„ replica æ•°é‡ã€‚ è¿™é‡Œå…¶å®å¯ä»¥æ ¹æ®ç”¨æˆ·å®é™…åœºæ™¯æ¥åšè®¾ç½®ã€‚æ¯”å¦‚å½“ç”¨æˆ·çš„èµ„æºè¶³å¤Ÿï¼Œä¸”æ›´æ³¨é‡å‘å¸ƒè¿‡ç¨‹ä¸­çš„å¯ç”¨æ€§ï¼Œå¯è®¾ç½® MaxUnavailable è¾ƒå°ã€MaxSurge è¾ƒå¤§ã€‚ä½†å¦‚æœç”¨æˆ·çš„èµ„æºæ¯”è¾ƒç´§å¼ ï¼Œå¯ä»¥è®¾ç½® MaxSurge è¾ƒå°ï¼Œç”šè‡³è®¾ç½®ä¸º 0ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ MaxSurge å’Œ MaxUnavailable ä¸èƒ½åŒæ—¶ä¸º 0ã€‚ ","date":"2021-06-27","objectID":"/application-orchestration-and-management-deployment/:2:6","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’","Deployment"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šDeployment","uri":"/application-orchestration-and-management-deployment/"},{"categories":["LCTT"],"content":"å¯æ‹“å±•æ€§ä¸çµæ´»æ€§ã€å®‰å…¨æ€§å’Œé«˜å¯ä¿¡çš„åä½œã€ä¸å—ä¾›åº”å•†é™åˆ¶ã€é¡¶å°–äººæ‰å’Œç¤¾åŒº","date":"2021-06-12","objectID":"/four-ways-open-source-gives-you-a-competitive-edge/","tags":["LCTT","å¼€æº"],"title":"å¼€æºä¸ºä½ å¸¦æ¥ç«äº‰ä¼˜åŠ¿çš„ 4 ç§æ–¹å¼","uri":"/four-ways-open-source-gives-you-a-competitive-edge/"},{"categories":["LCTT"],"content":" ä½¿ç”¨å¼€æºæŠ€æœ¯å¯ä»¥å¸®åŠ©ç»„ç»‡è·å¾—æ›´å¥½çš„ä¸šåŠ¡ç»“æœã€‚ æ„å»ºæŠ€æœ¯æ ˆæ˜¯æ¯ä¸ªç»„ç»‡çš„ä¸»è¦å†³ç­–ã€‚é€‰æ‹©åˆé€‚çš„å·¥å…·å°†è®©å›¢é˜Ÿè·å¾—æˆåŠŸï¼Œé€‰æ‹©é”™è¯¯çš„è§£å†³æ–¹æ¡ˆæˆ–å¹³å°ä¼šå¯¹ç”Ÿäº§ç‡å’Œåˆ©æ¶¦ç‡äº§ç”Ÿæ¯ç­æ€§å½±å“ã€‚ä¸ºäº†åœ¨å½“ä»Šå¿«èŠ‚å¥çš„ä¸–ç•Œä¸­è„±é¢–è€Œå‡ºï¼Œç»„ç»‡å¿…é¡»æ˜æ™ºåœ°é€‰æ‹©æ•°å­—è§£å†³æ–¹æ¡ˆï¼Œå¥½çš„æ•°å­—è§£å†³æ–¹æ¡ˆå¯ä»¥æå‡å›¢é˜Ÿè¡ŒåŠ¨åŠ›ä¸è¿è¥æ•æ·æ€§ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šå¤šçš„ç»„ç»‡éƒ½é‡‡ç”¨å¼€æºè§£å†³æ–¹æ¡ˆçš„åŸå› ï¼Œè¿™äº›ç»„ç»‡æ¥è‡ªå„è¡Œå„ä¸šï¼Œè§„æ¨¡æœ‰å¤§æœ‰å°ã€‚æ ¹æ® éº¦è‚¯é”¡ æœ€è¿‘çš„æŠ¥å‘Šï¼Œé«˜ç»©æ•ˆç»„ç»‡çš„æœ€å¤§åŒºåˆ«æ˜¯é‡‡ç”¨ä¸åŒçš„å¼€æºæ–¹æ¡ˆã€‚ é‡‡ç”¨å¼€æºæŠ€æœ¯å¯ä»¥å¸®åŠ©ç»„ç»‡æé«˜ç«äº‰ä¼˜åŠ¿ã€è·å¾—æ›´å¥½ä¸šåŠ¡æˆæœçš„åŸå› æœ‰ä»¥ä¸‹å››ç‚¹ã€‚ ","date":"2021-06-12","objectID":"/four-ways-open-source-gives-you-a-competitive-edge/:0:0","tags":["LCTT","å¼€æº"],"title":"å¼€æºä¸ºä½ å¸¦æ¥ç«äº‰ä¼˜åŠ¿çš„ 4 ç§æ–¹å¼","uri":"/four-ways-open-source-gives-you-a-competitive-edge/"},{"categories":["LCTT"],"content":"1ã€å¯æ‹“å±•æ€§å’Œçµæ´»æ€§å¯ä»¥è¯´ï¼ŒæŠ€æœ¯ä¸–ç•Œå‘å±•å¾ˆå¿«ã€‚ä¾‹å¦‚ï¼Œåœ¨ 2014 å¹´ä¹‹å‰ï¼ŒKubernetes å¹¶ä¸å­˜åœ¨ï¼Œä½†ä»Šå¤©ï¼Œå®ƒå´ä»¤äººå°è±¡æ·±åˆ»ï¼Œæ— å¤„ä¸åœ¨ã€‚æ ¹æ® CNCF 2020 äº‘åŸç”Ÿè°ƒæŸ¥ï¼Œ91% çš„å›¢é˜Ÿæ­£åœ¨ä»¥æŸç§å½¢å¼ä½¿ç”¨ Kubernetesã€‚ ç»„ç»‡æŠ•èµ„å¼€æºçš„ä¸€ä¸ªä¸»è¦åŸå› æ˜¯å› ä¸ºå¼€æºèµ‹äºˆç»„ç»‡è¡ŒåŠ¨æ•æ·æ€§ï¼Œç»„ç»‡å¯ä»¥è¿…é€Ÿåœ°å°†æ–°æŠ€æœ¯é›†æˆåˆ°æŠ€æœ¯æ ˆä¸­ã€‚è¿™ä¸ä¼ ç»Ÿæ–¹æ³•ä¸åŒï¼Œåœ¨ä¼ ç»Ÿæ–¹æ³•ä¸­ï¼Œå›¢é˜Ÿéœ€è¦å‡ ä¸ªå­£åº¦ç”šè‡³å‡ å¹´æ¥å®¡æŸ¥ã€å®æ–½ã€é‡‡ç”¨è½¯ä»¶ï¼Œè¿™å¯¼è‡´å›¢é˜Ÿä¸å¯èƒ½å®ç°ç«é€Ÿè½¬å˜ã€‚ å¼€æºè§£å†³æ–¹æ¡ˆå®Œæ•´åœ°æä¾›æºä»£ç ï¼Œå›¢é˜Ÿå¯ä»¥è½»æ¾å°†è½¯ä»¶ä¸ä»–ä»¬æ¯å¤©ä½¿ç”¨çš„å·¥å…·è¿æ¥èµ·æ¥ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œå¼€æºè®©å¼€å‘å›¢é˜Ÿèƒ½å¤Ÿä¸ºæ‰‹å¤´çš„ä¸œè¥¿æ„å»ºå®Œç¾çš„å·¥å…·ï¼Œè€Œä¸æ˜¯è¢«è¿«æ”¹å˜å·¥ä½œæ–¹å¼æ¥é€‚åº”ä¸çµæ´»çš„ä¸“æœ‰å·¥å…·ã€‚ ","date":"2021-06-12","objectID":"/four-ways-open-source-gives-you-a-competitive-edge/:1:0","tags":["LCTT","å¼€æº"],"title":"å¼€æºä¸ºä½ å¸¦æ¥ç«äº‰ä¼˜åŠ¿çš„ 4 ç§æ–¹å¼","uri":"/four-ways-open-source-gives-you-a-competitive-edge/"},{"categories":["LCTT"],"content":"2ã€å®‰å…¨æ€§å’Œé«˜å¯ä¿¡çš„åä½œåœ¨æ•°æ®æ³„éœ²å¤‡å—ç©ç›®çš„æ—¶ä»£ï¼Œç»„ç»‡éœ€è¦é«˜åº¦å®‰å…¨çš„å·¥å…·æ¥ä¿æŠ¤æ•æ„Ÿæ•°æ®çš„å®‰å…¨ã€‚ ä¸“æœ‰è§£å†³æ–¹æ¡ˆä¸­çš„æ¼æ´ä¸æ˜“è¢«å‘ç°ï¼Œè¢«å‘ç°æ—¶ä¸ºæ—¶å·²æ™šã€‚ä¸å¹¸çš„æ˜¯ï¼Œä½¿ç”¨è¿™äº›å¹³å°çš„å›¢é˜Ÿæ— æ³•çœ‹åˆ°æºä»£ç ï¼Œæœ¬è´¨ä¸Šæ˜¯ä»–ä»¬å°†å®‰å…¨æ€§å¤–åŒ…ç»™ç‰¹å®šä¾›åº”å•†ï¼Œå¹¶å¸Œæœ›å¾—åˆ°æœ€å¥½çš„ç»“æœã€‚ é‡‡ç”¨å¼€æºçš„å¦ä¸€ä¸ªä¸»è¦åŸå› æ˜¯å¼€æºå·¥å…·ä½¿ç»„ç»‡èƒ½å¤Ÿè‡ªå·±æŠŠæ§å®‰å…¨ã€‚ä¾‹å¦‚ï¼Œå¼€æºé¡¹ç›®â€”â€”å°¤å…¶æ˜¯æ‹¥æœ‰å¤§å‹å¼€æºç¤¾åŒºçš„é¡¹ç›®â€”â€”å¾€å¾€ä¼šæ”¶åˆ°æ›´è´Ÿè´£ä»»çš„æ¼æ´æŠ«éœ²ï¼Œå› ä¸ºæ¯ä¸ªäººåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­éƒ½å¯ä»¥å½»åº•æ£€æŸ¥æºä»£ç ã€‚ ç”±äºæºä»£ç æ˜¯å…è´¹æä¾›çš„ï¼Œå› æ­¤æŠ«éœ²é€šå¸¸ä¼´éšç€ä¿®å¤ç¼ºé™·çš„è¯¦ç»†å»ºè®®è§£å†³æ–¹æ¡ˆã€‚è¿™äº›æ–¹æ¡ˆä½¿å¾—å¼€å‘å›¢é˜Ÿèƒ½å¤Ÿå¿«é€Ÿè§£å†³é—®é¢˜ï¼Œä¸æ–­å¢å¼ºè½¯ä»¶ã€‚ åœ¨è¿œç¨‹åŠå…¬æ—¶ä»£ï¼Œå¯¹äºåˆ†å¸ƒå¼å›¢é˜Ÿæ¥è¯´ï¼Œåœ¨çŸ¥é“æ•æ„Ÿæ•°æ®å—åˆ°ä¿æŠ¤çš„æƒ…å†µä¸‹è¿›è¡Œåä½œæ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´é‡è¦ã€‚å¼€æºè§£å†³æ–¹æ¡ˆå…è®¸ç»„ç»‡å®¡æ ¸å®‰å…¨æ€§ã€å®Œå…¨æŒæ§è‡ªå·±æ•°æ®ï¼Œå› æ­¤å¼€æºæ–¹æ¡ˆå¯ä»¥ä¿ƒè¿›è¿œç¨‹ç¯å¢ƒä¸‹é«˜å¯ä¿¡åä½œæ–¹å¼çš„æˆé•¿ã€‚ ","date":"2021-06-12","objectID":"/four-ways-open-source-gives-you-a-competitive-edge/:2:0","tags":["LCTT","å¼€æº"],"title":"å¼€æºä¸ºä½ å¸¦æ¥ç«äº‰ä¼˜åŠ¿çš„ 4 ç§æ–¹å¼","uri":"/four-ways-open-source-gives-you-a-competitive-edge/"},{"categories":["LCTT"],"content":"3ã€ä¸å—ä¾›åº”å•†é™åˆ¶æ ¹æ® æœ€è¿‘çš„ä¸€é¡¹ç ”ç©¶ï¼Œ68% çš„ CIO æ‹…å¿ƒå—ä¾›åº”å•†é™åˆ¶ã€‚å½“ä½ å—é™äºä¸€é¡¹æŠ€æœ¯ä¸­ï¼Œä½ ä¼šè¢«è¿«æ¥å—åˆ«äººçš„ç»“è®ºï¼Œè€Œä¸æ˜¯è‡ªå·±åšç»“è®ºã€‚ å½“ç»„ç»‡æ›´æ¢ä¾›åº”å•†æ—¶ï¼Œä¸“æœ‰è§£å†³æ–¹æ¡ˆé€šå¸¸ä¼š ç»™ä½ å¸¦èµ°æ•°æ®å¸¦æ¥æŒ‘æˆ˜ã€‚å¦ä¸€æ–¹é¢ï¼Œå¼€æºå·¥å…·æä¾›äº†ç»„ç»‡éœ€è¦çš„è‡ªç”±åº¦å’Œçµæ´»æ€§ï¼Œä»¥é¿å…å—ä¾›åº”å•†é™åˆ¶ï¼Œå¼€æºå·¥å…·å¯ä»¥è®©ç»„ç»‡æŠŠæ•°æ®å¸¦å»ä»»æ„åœ°æ–¹ã€‚ ","date":"2021-06-12","objectID":"/four-ways-open-source-gives-you-a-competitive-edge/:3:0","tags":["LCTT","å¼€æº"],"title":"å¼€æºä¸ºä½ å¸¦æ¥ç«äº‰ä¼˜åŠ¿çš„ 4 ç§æ–¹å¼","uri":"/four-ways-open-source-gives-you-a-competitive-edge/"},{"categories":["LCTT"],"content":"4ã€é¡¶å°–äººæ‰å’Œç¤¾åŒºéšç€è¶Šæ¥è¶Šå¤šçš„å…¬å¸ æ¥å—è¿œç¨‹åŠå…¬ï¼Œäººæ‰äº‰å¤ºæˆ˜å˜å¾—æ„ˆå‘æ¿€çƒˆã€‚ åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸï¼Œè·å¾—é¡¶å°–äººæ‰å§‹äºèµ‹äºˆå·¥ç¨‹å¸ˆå…ˆè¿›å·¥å…·ï¼Œè®©å·¥ç¨‹å¸ˆåœ¨å·¥ä½œä¸­å……åˆ†å‘æŒ¥æ½œåŠ›ã€‚å¼€å‘äººå‘˜ è¶Šæ¥è¶Šå–œæ¬¢å¼€æºè§£å†³æ–¹æ¡ˆ è€Œä¸æ˜¯ä¸“æœ‰è§£å†³æ–¹æ¡ˆï¼Œç»„ç»‡åº”è¯¥å¼ºçƒˆè€ƒè™‘ç”¨å¼€æºæ›¿ä»£å•†ä¸šè§£å†³æ–¹æ¡ˆï¼Œä»¥å¸å¼•å¸‚åœºä¸Šæœ€å¥½çš„å¼€å‘äººå‘˜ã€‚ é™¤äº†é›‡ä½£ã€ç•™ä½é¡¶å°–äººæ‰æ›´å®¹æ˜“ï¼Œå…¬å¸èƒ½å¤Ÿé€šè¿‡å¼€æºå¹³å°åˆ©ç”¨è´¡çŒ®è€…ç¤¾åŒºï¼Œå¾—åˆ°è§£å†³é—®é¢˜çš„å»ºè®®ï¼Œä»å¹³å°ä¸­å¾—åˆ°æœ€å¤§æ”¶ç›Šã€‚æ­¤å¤–ï¼Œç¤¾åŒºæˆå‘˜è¿˜å¯ä»¥ ç›´æ¥ä¸ºå¼€æºé¡¹ç›®åšè´¡çŒ®ã€‚ ","date":"2021-06-12","objectID":"/four-ways-open-source-gives-you-a-competitive-edge/:4:0","tags":["LCTT","å¼€æº"],"title":"å¼€æºä¸ºä½ å¸¦æ¥ç«äº‰ä¼˜åŠ¿çš„ 4 ç§æ–¹å¼","uri":"/four-ways-open-source-gives-you-a-competitive-edge/"},{"categories":["LCTT"],"content":"å¼€æºå¸¦æ¥è‡ªç”±å¼€æºè½¯ä»¶åœ¨ä¼ä¸šå›¢é˜Ÿä¸­è¶Šæ¥è¶Šå—åˆ°æ¬¢è¿â€”â€”è¿™æ˜¯æœ‰åŸå› çš„ã€‚å®ƒå¸®åŠ©å›¢é˜Ÿçµæ´»åœ°æ„å»ºå®Œç¾çš„å·¥ä½œå·¥å…·ï¼ŒåŒæ—¶ä½¿å›¢é˜Ÿå¯ä»¥ç»´æŠ¤é«˜åº¦å®‰å…¨çš„ç¯å¢ƒã€‚åŒæ—¶ï¼Œå¼€æºå…è®¸å›¢é˜ŸæŒæ§æœªæ¥æ–¹å‘ï¼Œè€Œä¸æ˜¯å±€é™äºä¾›åº”å•†çš„è·¯çº¿å›¾ã€‚å¼€æºè¿˜å¸®åŠ©å…¬å¸æ¥è§¦æ‰åæ¨ªæº¢çš„å·¥ç¨‹å¸ˆå’Œå¼€æºç¤¾åŒºæˆå‘˜ã€‚ via: https://opensource.com/article/21/4/open-source-competitive-advantage ä½œè€…ï¼šJason Blais é€‰é¢˜ï¼šlujun9972 è¯‘è€…ï¼šDCOLIVERSUN æ ¡å¯¹ï¼šwxy æœ¬æ–‡ç”± LCTT åŸåˆ›ç¼–è¯‘ï¼ŒLinuxä¸­å›½ è£èª‰æ¨å‡º ","date":"2021-06-12","objectID":"/four-ways-open-source-gives-you-a-competitive-edge/:5:0","tags":["LCTT","å¼€æº"],"title":"å¼€æºä¸ºä½ å¸¦æ¥ç«äº‰ä¼˜åŠ¿çš„ 4 ç§æ–¹å¼","uri":"/four-ways-open-source-gives-you-a-competitive-edge/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡ä»‹ç»äº†K8sçš„æ§åˆ¶å™¨æ¨¡å¼ä¸å·¥ä½œé€»è¾‘ï¼Œè§£é‡Šäº†ä¸ºä½•å‘½ä»¤å¼APIä¸é€‚ç”¨æ§åˆ¶å™¨æ¨¡å¼çš„åŸå› ","date":"2021-06-11","objectID":"/application-orchestration-and-management/","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"èµ„æºå…ƒä¿¡æ¯","date":"2021-06-11","objectID":"/application-orchestration-and-management/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s èµ„æºå¯¹è±¡K8s çš„èµ„æºå¯¹è±¡ç»„æˆï¼šä¸»è¦åŒ…æ‹¬äº† Specã€Status ä¸¤éƒ¨åˆ†ã€‚å…¶ä¸­ Spec éƒ¨åˆ†ç”¨æ¥æè¿°æœŸæœ›çš„çŠ¶æ€ï¼ŒStatus éƒ¨åˆ†ç”¨æ¥æè¿°è§‚æµ‹åˆ°çš„çŠ¶æ€ã€‚ å…¶å®ï¼ŒK8s è¿˜æœ‰å¦å¤–ä¸€éƒ¨åˆ†ï¼Œå³å…ƒæ•°æ®éƒ¨åˆ†ã€‚è¯¥éƒ¨åˆ†ä¸»è¦åŒ…æ‹¬äº†ç”¨æ¥è¯†åˆ«èµ„æºçš„æ ‡ç­¾ï¼šLabelsï¼Œç”¨æ¥æè¿°èµ„æºçš„æ³¨è§£ï¼šAnnotationsï¼Œç”¨æ¥æè¿°å¤šä¸ªèµ„æºä¹‹é—´ç›¸äº’å…³ç³»çš„ OwnerReferenceã€‚ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:1:1","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"labelsç¬¬ä¸€ä¸ªå…ƒæ•°æ®ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„å…ƒæ•°æ®æ˜¯ï¼šèµ„æºæ ‡ç­¾ã€‚èµ„æºæ ‡ç­¾æ˜¯ä¸€ç§å…·æœ‰æ ‡è¯†å‹çš„ Keyï¼šValue å…ƒæ•°æ®ã€‚ æ ‡ç­¾ä¸»è¦ç”¨æ¥ç­›é€‰èµ„æºå’Œç»„åˆèµ„æºï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼äº SQL æŸ¥è¯¢ selectï¼Œæ¥æ ¹æ® Label æŸ¥è¯¢ç›¸å…³çš„èµ„æºã€‚ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:1:2","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"AnnotationsAnnotations æ˜¯ç³»ç»Ÿæˆ–è€…å·¥å…·ç”¨æ¥å­˜å‚¨èµ„æºçš„éæ ‡å¿—æ€§ä¿¡æ¯ï¼Œå¯ä»¥ç”¨æ¥æ‰©å±•èµ„æºçš„ spec/status çš„æè¿°ã€‚ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:1:3","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Ownereferenceæ‰€è°“æ‰€æœ‰è€…ï¼Œä¸€èˆ¬å°±æ˜¯æŒ‡é›†åˆç±»çš„èµ„æºï¼Œæ¯”å¦‚è¯´ Pod é›†åˆï¼Œå°±æœ‰ replicasetã€statefulsetã€‚ é›†åˆç±»èµ„æºçš„æ§åˆ¶å™¨ä¼šåˆ›å»ºå¯¹åº”çš„å½’å±èµ„æºã€‚æ¯”å¦‚ï¼šreplicaset æ§åˆ¶å™¨åœ¨æ“ä½œä¸­ä¼šåˆ›å»º Podï¼Œè¢«åˆ›å»º Pod çš„ Ownereference å°±æŒ‡å‘äº†åˆ›å»º Pod çš„ replicasetã€‚Ownereference ä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°æŸ¥æ‰¾ä¸€ä¸ªåˆ›å»ºèµ„æºçš„å¯¹è±¡ï¼Œå¦å¤–ï¼Œè¿˜å¯ä»¥ç”¨æ¥å®ç°çº§è”åˆ é™¤çš„æ•ˆæœã€‚ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:1:4","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ§åˆ¶å™¨æ¨¡å¼","date":"2021-06-11","objectID":"/application-orchestration-and-management/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ§åˆ¶å¾ªç¯æ§åˆ¶å‹æ¨¡å¼æœ€æ ¸å¿ƒçš„å°±æ˜¯æ§åˆ¶å¾ªç¯çš„æ¦‚å¿µã€‚åœ¨æ§åˆ¶å¾ªç¯ä¸­åŒ…æ‹¬äº†æ§åˆ¶å™¨ï¼Œè¢«æ§åˆ¶çš„ç³»ç»Ÿï¼Œä»¥åŠèƒ½å¤Ÿè§‚æµ‹ç³»ç»Ÿçš„ä¼ æ„Ÿå™¨ã€‚ Control Operation è¿™äº›ç»„ä»¶éƒ½æ˜¯é€»è¾‘çš„ï¼Œå¤–ç•Œé€šè¿‡ä¿®æ”¹èµ„æº spec æ¥æ§åˆ¶èµ„æºï¼Œæ§åˆ¶å™¨æ¯”è¾ƒèµ„æº spec å’Œ statusï¼Œä»è€Œè®¡ç®—ä¸€ä¸ª diffï¼Œdiff æœ€åä¼šç”¨æ¥å†³å®šå¯¹ç³»ç»Ÿçš„æ§åˆ¶æ“ä½œï¼Œæ§åˆ¶æ“ä½œä¼šä½¿å¾—ç³»ç»Ÿäº§ç”Ÿæ–°çš„è¾“å‡ºï¼Œå¹¶è¢«ä¼ æ„Ÿå™¨ä»¥èµ„æº status å½¢å¼ä¸ŠæŠ¥ï¼Œæ§åˆ¶å™¨çš„å„ä¸ªç»„ä»¶å°†éƒ½ä¼šæ˜¯ç‹¬ç«‹è‡ªä¸»åœ°è¿è¡Œï¼Œä¸æ–­ä½¿ç³»ç»Ÿå‘ spec è¡¨ç¤ºç»ˆæ€è¶‹è¿‘ã€‚ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:2:1","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Sensorå¾ªç¯æ§åˆ¶ä¸­é€»è¾‘çš„ä¼ æ„Ÿå™¨ä¸»è¦ç”± Reflectorã€Informerã€Indexer ä¸‰ä¸ªç»„ä»¶æ„æˆã€‚ Sensor Reflector é€šè¿‡ List å’Œ Watch K8s server æ¥è·å–èµ„æºçš„æ•°æ®ã€‚List ç”¨æ¥åœ¨ Controller é‡å¯ä»¥åŠ Watch ä¸­æ–­çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œç³»ç»Ÿèµ„æºçš„å…¨é‡æ›´æ–°ï¼›è€Œ Watch åˆ™åœ¨å¤šæ¬¡ List ä¹‹é—´è¿›è¡Œå¢é‡çš„èµ„æºæ›´æ–°ï¼›Reflector åœ¨è·å–æ–°çš„èµ„æºæ•°æ®åï¼Œä¼šåœ¨ Delta é˜Ÿåˆ—ä¸­å¡å…¥ä¸€ä¸ªåŒ…æ‹¬èµ„æºå¯¹è±¡ä¿¡æ¯æœ¬èº«ä»¥åŠèµ„æºå¯¹è±¡äº‹ä»¶ç±»å‹çš„ Delta è®°å½•ï¼ŒDelta é˜Ÿåˆ—ä¸­å¯ä»¥ä¿è¯åŒä¸€ä¸ªå¯¹è±¡åœ¨é˜Ÿåˆ—ä¸­ä»…æœ‰ä¸€æ¡è®°å½•ï¼Œä»è€Œé¿å… Reflector é‡æ–° List å’Œ Watch çš„æ—¶å€™äº§ç”Ÿé‡å¤çš„è®°å½•ã€‚ Informer ç»„ä»¶ä¸æ–­ä» Delta é˜Ÿåˆ—ä¸­å¼¹å‡º delta è®°å½•ï¼Œç„¶åæŠŠèµ„æºå¯¹è±¡äº¤ç»™ indexerï¼Œè®© indexer æŠŠèµ„æºè®°å½•åœ¨ä¸€ä¸ªç¼“å­˜ä¸­ï¼Œç¼“å­˜åœ¨é»˜è®¤è®¾ç½®ä¸‹æ˜¯ç”¨èµ„æºçš„å‘½åç©ºé—´æ¥åšç´¢å¼•çš„ï¼Œå¹¶ä¸”å¯ä»¥è¢« Controller Manager æˆ–å¤šä¸ª Controller æ‰€å…±äº«ã€‚ä¹‹åï¼Œå†æŠŠè¿™ä¸ªäº‹ä»¶äº¤ç»™äº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚ æ§åˆ¶å¾ªç¯ä¸­çš„æ§åˆ¶å™¨ç»„ä»¶ä¸»è¦ç”±äº‹ä»¶å¤„ç†å‡½æ•°ä»¥åŠ worker ç»„æˆï¼Œäº‹ä»¶å¤„ç†å‡½æ•°ä¼šç›¸äº’å…³æ³¨èµ„æºçš„æ–°å¢ã€æ›´æ–°ã€åˆ é™¤çš„äº‹ä»¶ï¼Œå¹¶æ ¹æ®æ§åˆ¶å™¨çš„é€»è¾‘å»å†³å®šæ˜¯å¦éœ€è¦å¤„ç†ã€‚å¯¹éœ€è¦å¤„ç†çš„äº‹ä»¶ï¼Œä¼šæŠŠäº‹ä»¶å…³è”èµ„æºçš„å‘½åç©ºé—´ä»¥åŠåå­—å¡å…¥ä¸€ä¸ªå·¥ä½œé˜Ÿåˆ—ä¸­ï¼Œå¹¶ä¸”ç”±åç»­çš„ worker æ± ä¸­çš„ä¸€ä¸ª worker æ¥å¤„ç†ï¼Œå·¥ä½œé˜Ÿåˆ—ä¼šå¯¹å­˜å‚¨çš„å¯¹è±¡è¿›è¡Œå»é‡ï¼Œä»è€Œé¿å…å¤šä¸ª worker å¤„ç†åŒä¸€ä¸ªèµ„æºçš„æƒ…å†µã€‚ worker åœ¨å¤„ç†èµ„æºå¯¹è±¡æ—¶ï¼Œä¸€èˆ¬éœ€è¦ç”¨èµ„æºçš„åå­—æ¥é‡æ–°è·å¾—æœ€æ–°çš„èµ„æºæ•°æ®ï¼Œç”¨æ¥åˆ›å»ºæˆ–æ›´æ–°èµ„æºå¯¹è±¡ï¼Œæˆ–è€…è°ƒç”¨å…¶ä»–çš„å¤–éƒ¨æœåŠ¡ï¼Œworker å¦‚æœå¤„ç†å¤±è´¥çš„æ—¶å€™ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¼šæŠŠèµ„æºçš„åå­—é‡æ–°åŠ å…¥åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­ï¼Œä»è€Œæ–¹ä¾¿ä¹‹åè¿›è¡Œé‡è¯•ã€‚ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:2:2","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ§åˆ¶å¾ªç¯ä¾‹å­-æ‰©å®¹ apiVersion:apps/v1kind:ReplicaSetmetadata:name:rsAnamespace:nsAspec:replicas:3selector:matchLabels:env:prodtemplate:metadata:labels:env:prodspec:containers:- images:registry.cn-hangzhou.aliyuncs.com/acs/nginxname:nginxstatus:replicas:2 æ›´æ–° Reflectorä¼š watch åˆ° ReplicaSet å’Œ Pod ä¸¤ç§èµ„æºçš„å˜æ¢ï¼› å‘ delta é˜Ÿåˆ—ä¸­å¡å…¥ rsA å¯¹è±¡ï¼Œç±»å‹ä¸ºæ›´æ–°ï¼› Informer å–å‡ºè®°å½•ï¼› å°†æ–°çš„ ReplicaSet æ›´æ–°åˆ°ç¼“å­˜ä¸­ï¼Œå¹¶ä¸ Namespace nsA ä½œä¸ºç´¢å¼•ï¼› è°ƒç”¨ Update å›è°ƒå‡½æ•°ï¼ŒReplicaSet æ§åˆ¶å™¨å‘ç° ReplicaSet å‘ç”Ÿå˜åŒ–åæŠŠå­—ç¬¦ä¸² nsA/rsA å­—ç¬¦ä¸²å¡å…¥åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­ï¼› worker ä»å·¥ä½œé˜Ÿåˆ—ä¸­å–åˆ° nsA/rsA è¿™ä¸ªå­—ç¬¦ä¸²çš„ keyï¼› ä»ç¼“å­˜ä¸­å–åˆ°äº†æœ€æ–°çš„ ReplicaSet æ•°æ®ï¼› worker é€šè¿‡æ¯”è¾ƒ ReplicaSet ä¸­ spec å’Œ status é‡Œçš„æ•°å€¼ï¼Œå‘ç°éœ€è¦è¿›è¡Œæ‰©å®¹æ“ä½œï¼Œå› æ­¤åˆ›å»ºä¸€ä¸ª Podï¼Œè¿™ä¸ª Pod ä¸­çš„ Ownereference æŒ‡å‘äº† ReplicaSet rsAï¼› æ‰©å®¹ Reflector Watch åˆ° Pod æ–°å¢äº‹ä»¶ï¼› Reflector åœ¨ Delta é˜Ÿåˆ—ä¸­é¢å¤–åŠ å…¥ Add ç±»å‹çš„ delta è®°å½•ï¼› Informer å–å‡ºè®°å½•ä¼ é€ç»™ Indexerï¼Œè°ƒç”¨ ReplicaSet æ§åˆ¶å™¨çš„ Add å›è°ƒå‡½æ•°ï¼› å°†è®°å½•å­˜å‚¨åœ¨ç¼“å­˜ä¸­ï¼› Add å›è°ƒå‡½æ•°é€šè¿‡æ£€æŸ¥ pod ownerReferences æ‰¾åˆ°äº†å¯¹åº”çš„ ReplicaSetï¼Œå¹¶æŠŠåŒ…æ‹¬ ReplicaSet å‘½åç©ºé—´å’Œå­—ç¬¦ä¸²å¡å…¥åˆ°äº†å·¥ä½œé˜Ÿåˆ—ä¸­ï¼› ReplicaSet çš„ worker åœ¨å¾—åˆ°æ–°å·¥ä½œé¡¹ä¹‹åï¼Œä»ç¼“å­˜ä¸­å–åˆ°äº†æ–°çš„ ReplicaSet è®°å½•ï¼Œå¹¶å¾—åˆ°äº†å…¶æ‰€æœ‰åˆ›å»ºçš„ Podï¼› ReplicaSet æ›´æ–° status ä½¿å¾— spec å’Œ status è¾¾æˆä¸€è‡´ã€‚ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:2:3","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ§åˆ¶å™¨æ¨¡å¼æ€»ç»“","date":"2021-06-11","objectID":"/application-orchestration-and-management/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä¸¤ç§ API è®¾è®¡æ–¹æ³•K8s æ§åˆ¶å™¨æ¨¡å¼ä¾èµ–å£°æ˜å¼ APIï¼Œå¦ä¸€ç§å¸¸è§ API ç±»å‹æ˜¯å‘½ä»¤å¼ APIã€‚ å£°æ˜å¼ APIï¼šåªè¯´ç›®æ ‡å†³å®šï¼Œå…·ä½“æ“ä½œäº¤ç»™ worker å‘½ä»¤å¼ APIï¼šå‘Šè¯‰ worker å…·ä½“æ“ä½œ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å‘½ä»¤å¼ API çš„é—®é¢˜ é”™è¯¯å¤„ç†ï¼šåœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œé”™è¯¯æ˜¯æ— å¤„ä¸åœ¨çš„ã€‚ä¸€æ—¦å‘å‡ºçš„å‘½ä»¤æ²¡æœ‰å“åº”ï¼Œè°ƒç”¨æ–¹åªèƒ½é€šè¿‡åå¤é‡è¯•çš„æ–¹å¼æ¥è¯•å›¾æ¢å¤é”™è¯¯ï¼Œç„¶è€Œç›²ç›®çš„é‡è¯•å¯èƒ½ä¼šå¸¦æ¥æ›´å¤§çš„é—®é¢˜ã€‚ å‘½ä»¤å¼ API åå°å¾€å¾€è¿˜æœ‰ä¸€ä¸ªå·¡æ£€ç³»ç»Ÿï¼Œç”¨æ¥ä¿®æ­£å‘½ä»¤å¤„ç†è¶…æ—¶ã€é‡è¯•ç­‰ä¸€äº›åœºæ™¯é€ æˆæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ å®¹æ˜“åœ¨å¹¶å‘è®¿é—®æ—¶å‡ºç°é—®é¢˜ï¼šå‡å¦‚æœ‰å¤šæ–¹å¹¶å‘çš„å¯¹ä¸€ä¸ªèµ„æºè¯·æ±‚è¿›è¡Œæ“ä½œï¼Œä¸€æ—¦å…¶ä¸­æœ‰æ“ä½œå‡ºç°é”™è¯¯ï¼Œå°±è¦é‡è¯•ã€‚é‚£ä¹ˆå¾ˆéš¾ç¡®è®¤æ˜¯å“ªä¸ªæ“ä½œç”Ÿæ•ˆã€‚å¾ˆå¤šå‘½ä»¤å¼ç³»ç»Ÿå¾€å¾€åœ¨æ“ä½œå‰ä¼šå¯¹ç³»ç»Ÿè¿›è¡ŒåŠ é”ï¼Œä»è€Œä¿è¯æ•´ä¸ªç³»ç»Ÿæœ€åç”Ÿæ•ˆè¡Œä¸ºçš„å¯é¢„è§æ€§ï¼Œä½†æ˜¯åŠ é”è¡Œä¸ºä¼šé™ä½æ•´ä¸ªç³»ç»Ÿçš„æ“ä½œæ‰§è¡Œæ•ˆç‡ã€‚ å£°æ˜å¼ API ç³»ç»Ÿå¤©ç„¶è®°å½•äº†ç³»ç»Ÿç°åœ¨å’Œæœ€ç»ˆçš„çŠ¶æ€ã€‚ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ€»ç»“ K8s æ‰€é‡‡ç”¨çš„æ§åˆ¶å™¨æ¨¡å¼ï¼Œæ˜¯ç”±å£°æ˜å¼ API é©±åŠ¨çš„ã€‚ç¡®åˆ‡æ¥è¯´ï¼Œæ˜¯åŸºäºå¯¹ K8s èµ„æºå¯¹è±¡çš„ä¿®æ”¹æ¥é©±åŠ¨çš„ï¼› K8s èµ„æºä¹‹åï¼Œæ˜¯å…³æ³¨è¯¥èµ„æºçš„æ§åˆ¶å™¨ã€‚è¿™äº›æ§åˆ¶å™¨å°†å¼‚æ­¥çš„æ§åˆ¶ç³»ç»Ÿå‘è®¾ç½®çš„ç»ˆæ€é©±è¿‘ï¼› æ§åˆ¶å™¨æ˜¯è‡ªä¸»è¿è¡Œçš„ï¼Œä½¿å¾—ç³»ç»Ÿçš„è‡ªåŠ¨åŒ–å’Œæ— äººå€¼å®ˆæˆä¸ºå¯èƒ½ï¼› å› ä¸º K8s çš„æ§åˆ¶å™¨å’Œèµ„æºéƒ½æ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ï¼Œå› æ­¤å¯ä»¥æ–¹ä¾¿çš„æ‰©å±•æ§åˆ¶å™¨æ¨¡å¼ã€‚ç‰¹åˆ«æ˜¯å¯¹äºæœ‰çŠ¶æ€åº”ç”¨ï¼Œå¾€å¾€é€šè¿‡è‡ªå®šä¹‰èµ„æºå’Œæ§åˆ¶å™¨çš„æ–¹å¼ï¼Œæ¥è‡ªåŠ¨åŒ–è¿ç»´æ“ä½œã€‚ ","date":"2021-06-11","objectID":"/application-orchestration-and-management/:3:3","tags":["äº‘åŸç”Ÿ","Kubernetes","åº”ç”¨ç¼–æ’"],"title":"åº”ç”¨ç¼–æ’ä¸ç®¡ç†ï¼šæ ¸å¿ƒåŸç†","uri":"/application-orchestration-and-management/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡ä»‹ç»ä¸ºä»€ä¹ˆéœ€è¦Podã€Podçš„å®ç°æœºåˆ¶ä¸è®¾è®¡æ¨¡å¼","date":"2021-05-31","objectID":"/pod-notebook/","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä¸ºä»€ä¹ˆéœ€è¦ Pod","date":"2021-05-31","objectID":"/pod-notebook/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å®¹å™¨çš„åŸºæœ¬æ¦‚å¿µå®¹å™¨çš„æœ¬è´¨å®é™…ä¸Šæ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼Œæ˜¯ä¸€ä¸ªè§†å›¾è¢«éš”ç¦»ï¼Œèµ„æºå—é™çš„è¿›ç¨‹ã€‚ å®¹å™¨é‡Œé¢ PID = 1 çš„è¿›ç¨‹å°±æ˜¯åº”ç”¨æœ¬èº«ï¼Œè¿™æ„å‘³ç€ç®¡ç†è™šæ‹Ÿæœºç­‰äºç®¡ç†åŸºç¡€è®¾æ–½ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯åœ¨ç®¡ç†æœºå™¨ï¼Œä½†ç®¡ç†å®¹å™¨ç­‰äºç›´æ¥ç®¡ç†åº”ç”¨æœ¬èº«ã€‚ ","date":"2021-05-31","objectID":"/pod-notebook/:1:1","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Pod çš„ç±»æ¯”æ¦‚å¿µæˆ‘ä»¬è¯´ K8s å°±æ˜¯äº‘æ—¶ä»£çš„æ“ä½œç³»ç»Ÿï¼Œæˆ‘ä»¬ä¸¾ä¸ªçœŸå®æ“ä½œç³»ç»Ÿçš„ä¾‹å­ã€‚ ä¾‹å¦‚ Helloworld ç¨‹åºï¼Œè¿™ä¸ªç¨‹åºå®é™…ä¸Šæ˜¯ç”±ä¸€ç»„è¿›ç¨‹ç»„æˆçš„ ({apiã€mainã€logã€compute})ï¼Œè¿™äº›è¿›ç¨‹ç­‰åŒäº Linux ä¸­çš„çº¿ç¨‹ã€‚ K8s ç±»æ¯”ä¸ºä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼ŒåŒæ—¶å®¹å™¨ç±»æ¯”ä¸ºè¿›ç¨‹ï¼Œé‚£ä¹ˆ Pod å°±å¯ä»¥ç±»æ¯”ä¸ºè¿›ç¨‹ç»„ã€‚ ","date":"2021-05-31","objectID":"/pod-notebook/:1:2","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"è¿›ç¨‹ç»„æ¦‚å¿µå…ˆæå‡ºä¸€ä¸ªé—®é¢˜ï¼šå‡å¦‚ç”¨å®¹å™¨æŠŠ Helloworld ç¨‹åºè·‘èµ·æ¥ï¼Œä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ æœ€è‡ªç„¶çš„è§£æ³•ï¼Œå¯åŠ¨ä¸€ä¸ª Docker å®¹å™¨ï¼Œé‡Œé¢è¿è¡Œå››ä¸ªè¿›ç¨‹ã€‚è¿™é‡Œä¼šå¼•å‡ºä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªå®¹å™¨é‡Œé¢ PID = 1 çš„è¿›ç¨‹è¯¥æ˜¯è°ï¼Ÿå¦‚æœè¯¥è¿›ç¨‹æ˜¯ main è¿›ç¨‹ï¼Œé‚£ä¹ˆç”±è°å»ç®¡ç†å‰©ä¸‹çš„ä¸‰ä¸ªè¿›ç¨‹ï¼Ÿ é—®é¢˜çš„æ ¸å¿ƒåœ¨äºï¼Œå®¹å™¨è®¾è®¡æœ¬èº«æ˜¯ä¸€ç§â€œå•è¿›ç¨‹â€æ¨¡å‹ï¼Œä¸æ˜¯è¯´å®¹å™¨é‡Œåªèƒ½èµ·ä¸€ä¸ªè¿›ç¨‹ï¼Œç”±äºå®¹å™¨çš„åº”ç”¨ç­‰äºè¿›ç¨‹ï¼Œæ‰€ä»¥åªèƒ½å»ç®¡ç† PID = 1 è¿›ç¨‹ï¼Œå…¶ä»–å†èµ·æ¥çš„è¿›ç¨‹å…¶å®æ˜¯ä¸€ä¸ªæ‰˜ç®¡çŠ¶æ€ã€‚æ‰€ä»¥è¯´æœåŠ¡åº”ç”¨è¿›ç¨‹æœ¬èº«å…·æœ‰â€œè¿›ç¨‹ç®¡ç†â€çš„èƒ½åŠ›ã€‚ æ¯”å¦‚è¯´ Helloworld çš„ç¨‹åºæœ‰ system çš„èƒ½åŠ›ï¼Œæˆ–è€…ç›´æ¥æŠŠå®¹å™¨é‡Œ PID = 1 çš„è¿›ç¨‹ç›´æ¥æ”¹ä¸º systemdï¼Œå¦åˆ™è¿™ä¸ªåº”ç”¨ï¼Œæˆ–è€…è¯´å®¹å™¨æ²¡æœ‰åŠæ³•å»ç®¡ç†å¾ˆå¤šä¸ªè¿›ç¨‹ã€‚å› ä¸º PID = 1 è¿›ç¨‹æ˜¯åº”ç”¨æœ¬èº«ï¼Œå¦‚æœç°åœ¨æŠŠè¿™ä¸ª PID = 1 çš„è¿›ç¨‹ç»™ kill äº†ï¼Œæˆ–è€…å®ƒè‡ªå·±è¿è¡Œè¿‡ç¨‹ä¸­æ­»æ‰äº†ï¼Œé‚£ä¹ˆå‰©ä¸‹ä¸‰ä¸ªè¿›ç¨‹èµ„æºæ— æ³•å›æ”¶ã€‚ åè¿‡æ¥ï¼ŒçœŸçš„æŠŠåº”ç”¨æœ¬èº«æ”¹ä¸º systemdï¼Œæˆ–è€…åœ¨å®¹å™¨é‡Œè¿è¡Œä¸€ä¸ª systemdï¼Œè¿™ä¼šå¯¼è‡´å¦ä¸€ä¸ªé—®é¢˜ï¼šç®¡ç†å®¹å™¨ä¸æ˜¯ç®¡ç†åº”ç”¨æœ¬èº«ï¼Œè€Œæ˜¯ç®¡ç† systemdã€‚å¦‚æœåº”ç”¨é€€å‡ºæˆ–è€… failï¼Œå®¹å™¨æ˜¯æ²¡æœ‰åŠæ³•çŸ¥é“çš„ã€‚ åœ¨ K8s ä¸­ï¼Œå››ä¸ªè¿›ç¨‹å…±åŒç»„æˆçš„åº”ç”¨ Helloworldï¼Œä¼šè¢«å®šä¹‰ä¸ºä¸€ä¸ªæ‹¥æœ‰å››ä¸ªå®¹å™¨çš„ Podï¼Œå››ä¸ªå®¹å™¨å…±äº« Pod å†…èµ„æºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPod æ˜¯ä¸€ä¸ªé€»è¾‘å•ä½ï¼Œæ²¡æœ‰çœŸå®çš„ä¸œè¥¿å¯¹åº” Podã€‚ Pod ","date":"2021-05-31","objectID":"/pod-notebook/:1:3","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä¸ºä»€ä¹ˆ Pod å¿…é¡»æ˜¯åŸå­è°ƒåº¦å•ä½ï¼Ÿå› ä¸ºå­˜åœ¨è°ƒåº¦å¤±è´¥Task co-schedulingï¼Œè°ƒåº¦å¤±è´¥æŒ‡çš„æ˜¯åˆ†é…å®¹å™¨åˆ° Node æ—¶ï¼Œå› ä¸ºä¸çŸ¥é“å…¨å±€åˆ†é…ä¿¡æ¯ï¼Œå¯¼è‡´æœ‰ç´§å¯†åä½œçš„å®¹å™¨ä¸èƒ½è¢«åˆ†é…åˆ°åŒä¸€ä¸ª Nodeã€‚ è°ƒåº¦å¤±è´¥å­˜åœ¨å¦‚ä¸‹è§£å†³åŠæ³•ï¼š Mesos çš„èµ„æºå›¤ç§¯ï¼šå½“æ‰€æœ‰è®¾ç½®äº† Affinity çº¦æŸçš„ä»»åŠ¡éƒ½è¾¾åˆ°æ—¶ï¼Œæ‰å¼€å§‹ç»Ÿä¸€è°ƒåº¦ï¼› Omega ç³»ç»Ÿçš„ä¹è§‚è°ƒåº¦ï¼šä¸ç®¡å†²çªçš„å¼‚å¸¸æƒ…å†µï¼Œå…ˆè°ƒåº¦ï¼ŒåŒæ—¶è®¾ç½®ä¸€ä¸ªå›æ»šæœºåˆ¶ï¼Œå†²çªååˆ©ç”¨å›æ»šè§£å†³é—®é¢˜ï¼› K8s çš„ Podï¼šå°†ç´§å¯†åä½œçš„å®¹å™¨è§†ä¸ºä¸€ä¸ª Podï¼Œä»¥ Pod ä¸ºå•ä½è¿›è¡Œè°ƒåº¦ã€‚ ","date":"2021-05-31","objectID":"/pod-notebook/:1:4","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å†æ¬¡ç†è§£ Podé¦–å…ˆï¼ŒPod é‡Œé¢çš„å®¹å™¨æ˜¯ â€œè¶…äº²å¯†å…³ç³»â€ã€‚ä¸äº²å¯†å…³ç³»ä¸åŒçš„æ˜¯ï¼Œäº²å¯†å…³ç³»æ˜¯å¯ä»¥é€šè¿‡è°ƒåº¦è§£å†³çš„ï¼Œä¾‹å¦‚ä¸¤ä¸ª Pod è¿è¡Œåœ¨åŒä¸€å°å®¿ä¸»æœºä¸Šï¼Œè€Œè¶…äº²å¯†å…³ç³»å¤§è‡´åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š æ–‡ä»¶äº¤æ¢ï¼› éœ€è¦é€šè¿‡ localhost æˆ–è€…æœ¬åœ° socket è¿›è¡Œé€šä¿¡ï¼› éœ€è¦éå¸¸é¢‘ç¹çš„ RPC è°ƒç”¨ï¼› éœ€è¦å…±äº«æŸäº› Linux Namespaceã€‚ ","date":"2021-05-31","objectID":"/pod-notebook/:1:5","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Pod çš„å®ç°æœºåˆ¶Pod è¦æ‰“ç ´å®¹å™¨é—´çš„ Linux Namespace å’Œ cgroups éš”ç¦»ï¼Œå…·ä½“è§£æ³•åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç½‘ç»œå’Œå­˜å‚¨ã€‚ å…±äº«ç½‘ç»œ åœ¨æ¯ä¸ª Pod é‡Œï¼Œé¢å¤–èµ·ä¸€ä¸ª Infra container å°å®¹å™¨æ¥å…±äº«æ•´ä¸ª Pod çš„ Network Namespaceã€‚ Infra container æ˜¯ä¸€ä¸ªéå¸¸å°çš„é•œåƒï¼Œå¤§æ¦‚ 100~200KB å·¦å³ï¼Œæ˜¯ä¸€ä¸ªæ±‡ç¼–è¯­è¨€å†™çš„ã€æ°¸è¿œå¤„äºâ€œæš‚åœâ€çŠ¶æ€çš„å®¹å™¨ã€‚ç”±äºæœ‰äº†è¿™æ ·ä¸€ä¸ª Infra container ä¹‹åï¼Œå…¶ä»–æ‰€æœ‰å®¹å™¨éƒ½ä¼šé€šè¿‡ Join Namespace çš„æ–¹å¼åŠ å…¥åˆ° Infra container çš„ Network Namespace ä¸­ã€‚ æ‰€ä»¥è¯´ä¸€ä¸ª Pod é‡Œé¢çš„æ‰€æœ‰å®¹å™¨ï¼Œå®ƒä»¬çœ‹åˆ°çš„ç½‘ç»œè§†å›¾æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚å³ï¼šå®ƒä»¬çœ‹åˆ°çš„ç½‘ç»œè®¾å¤‡ã€IPåœ°å€ã€MACåœ°å€ç­‰ç­‰ï¼Œè·Ÿç½‘ç»œç›¸å…³çš„ä¿¡æ¯ï¼Œå…¶å®å…¨æ˜¯ä¸€ä»½ï¼Œè¿™ä¸€ä»½éƒ½æ¥è‡ªäº Pod ç¬¬ä¸€æ¬¡åˆ›å»ºçš„è¿™ä¸ª Infra containerã€‚ å…±äº«å­˜å‚¨ æ¯”å¦‚è¯´ç°åœ¨æœ‰ä¸¤ä¸ªå®¹å™¨ï¼Œä¸€ä¸ªæ˜¯ Nginxï¼Œå¦å¤–ä¸€ä¸ªæ˜¯éå¸¸æ™®é€šçš„å®¹å™¨ï¼Œåœ¨ Nginx é‡Œæ”¾ä¸€äº›æ–‡ä»¶ï¼Œè®©æˆ‘èƒ½é€šè¿‡ Nginx è®¿é—®åˆ°ã€‚æ‰€ä»¥å®ƒéœ€è¦å» share è¿™ä¸ªç›®å½•ã€‚share æ–‡ä»¶æˆ–è€…æ˜¯ share ç›®å½•åœ¨ Pod é‡Œé¢æ˜¯éå¸¸ç®€å•çš„ï¼Œå®é™…ä¸Šå°±æ˜¯æŠŠ volume å˜æˆäº† Pod levelã€‚ç„¶åæ‰€æœ‰å®¹å™¨ï¼Œå°±æ˜¯æ‰€æœ‰åŒå±äºä¸€ä¸ª Pod çš„å®¹å™¨ï¼Œä»–ä»¬å…±äº«æ‰€æœ‰çš„ volumeã€‚ ","date":"2021-05-31","objectID":"/pod-notebook/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"è¯¦è§£å®¹å™¨è®¾è®¡æ¨¡å¼","date":"2021-05-31","objectID":"/pod-notebook/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"InitContainerå¯ä»¥åœ¨ yaml é‡Œé¦–å…ˆå®šä¹‰ä¸€ä¸ª Init Containerï¼Œå®Œæˆæ“ä½œåå°±é€€å‡ºã€‚è¿™ä¸ªå®¹å™¨ä¼šæ¯”ç”¨æˆ·å®¹å™¨å…ˆå¯åŠ¨ï¼Œå¹¶ä¸”ä¸¥æ ¼æŒ‰ç…§å®šä¹‰é¡ºåºæ¥ä¾æ¬¡æ‰§è¡Œã€‚ ","date":"2021-05-31","objectID":"/pod-notebook/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å®¹å™¨è®¾è®¡æ¨¡å¼ï¼šSidecarSidecar çš„å«ä¹‰æ˜¯å¯ä»¥å®šä¹‰ä¸€äº›ä¸“é—¨çš„å®¹å™¨ï¼Œæ¥æ‰§è¡Œä¸»ä¸šåŠ¡å®¹å™¨æ‰€éœ€è¦çš„ä¸€äº›è¾…åŠ©å·¥ä½œï¼Œä¾‹å¦‚ï¼š åŸæœ¬éœ€è¦åœ¨å®¹å™¨é‡Œé¢æ‰§è¡Œ SSH éœ€è¦å¹²çš„ä¸€äº›äº‹æƒ…ï¼Œå¯ä»¥å†™è„šæœ¬ã€ä¸€äº›å‰ç½®çš„æ¡ä»¶ï¼Œå…¶å®éƒ½å¯ä»¥é€šè¿‡åƒ Init Container æˆ–è€…å¦å¤–åƒ Sidecar çš„æ–¹å¼å»è§£å†³ï¼› æ—¥å¿—æ”¶é›†ï¼Œæ—¥å¿—æ”¶é›†æœ¬èº«æ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼Œæ˜¯ä¸€ä¸ªå°å®¹å™¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠå®ƒæ‰“åŒ…è¿› Pod é‡Œé¢å»åšè¿™ä¸ªæ”¶é›†å·¥ä½œï¼› Debug åº”ç”¨ï¼Œå®é™…ä¸Šç°åœ¨ Debug æ•´ä¸ªåº”ç”¨éƒ½å¯ä»¥åœ¨åº”ç”¨ Pod é‡Œé¢å†æ¬¡å®šä¹‰ä¸€ä¸ªé¢å¤–çš„å°çš„ Containerï¼Œå®ƒå¯ä»¥å» exec åº”ç”¨ pod çš„ namespaceï¼› æŸ¥çœ‹å…¶ä»–å®¹å™¨çš„å·¥ä½œçŠ¶æ€ã€‚ä¸å†éœ€è¦å» SSH ç™»é™†åˆ°å®¹å™¨é‡Œå»çœ‹ï¼Œåªè¦æŠŠç›‘æ§ç»„ä»¶è£…åˆ°é¢å¤–çš„å°å®¹å™¨é‡Œé¢å°±å¯ä»¥äº†ï¼Œç„¶åæŠŠå®ƒä½œä¸ºä¸€ä¸ª Sidecar å¯åŠ¨èµ·æ¥ï¼Œè·Ÿä¸»ä¸šåŠ¡å®¹å™¨è¿›è¡Œåä½œï¼Œæ‰€ä»¥åŒæ ·ä¸šåŠ¡ç›‘æ§ä¹Ÿéƒ½å¯ä»¥é€šè¿‡ Sidecar æ–¹å¼æ¥å»åšã€‚ è¿™ç§åšæ³•ä¸€ä¸ªéå¸¸æ˜æ˜¾çš„ä¼˜åŠ¿å°±æ˜¯åœ¨äºå…¶å®å°†è¾…åŠ©åŠŸèƒ½ä»ä¸šåŠ¡å®¹å™¨è§£è€¦äº†ï¼Œæ‰€ä»¥æˆ‘å°±èƒ½å¤Ÿç‹¬ç«‹å‘å¸ƒ Sidecar å®¹å™¨ï¼Œå¹¶ä¸”æ›´é‡è¦çš„æ˜¯è¿™ä¸ªèƒ½åŠ›æ˜¯å¯ä»¥é‡ç”¨çš„ï¼Œå³åŒæ ·çš„ä¸€ä¸ªç›‘æ§ Sidecar æˆ–è€…æ—¥å¿— Sidecarã€‚ ","date":"2021-05-31","objectID":"/pod-notebook/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes","Pod","è®¾è®¡æ¨¡å¼"],"title":"Pod æ¦‚å¿µä¸å®¹å™¨è®¾è®¡æ¨¡å¼","uri":"/pod-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æœ¬æ–‡è¯¦ç»†ä»‹ç»äº† K8s çš„æ¦‚å¿µã€æ ¸å¿ƒåŠŸèƒ½ã€æ¶æ„ã€æ ¸å¿ƒæ¦‚å¿µä¸APIï¼Œéå¸¸å…¨é¢çš„ K8s æ•´ç†ç¬”è®°","date":"2021-05-26","objectID":"/kubernetes-notebook/","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä»€ä¹ˆæ˜¯ KubernetesKubernetes æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„å®¹å™¨ç¼–æ’å¹³å°ï¼Œè´Ÿè´£åº”ç”¨çš„éƒ¨ç½²ã€å¼¹æ€§ä»¥åŠç®¡ç†ï¼Œè¿™äº›éƒ½æ˜¯åŸºäºå®¹å™¨çš„ã€‚å¯ä»¥ç®€ç§°ä¸º k8sï¼Œæ˜¯å°†ä¸­é—´ 8 ä¸ªå­—æ¯ â€œuberneteâ€ æ›¿æ¢ä¸º â€œ8â€ è€Œå¯¼è‡´çš„ä¸€ä¸ªç¼©å†™ã€‚ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:1:0","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Kubernetes çš„æ ¸å¿ƒåŠŸèƒ½ æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡ï¼› å®¹å™¨çš„è‡ªåŠ¨è£…ç®±ï¼Œä¹Ÿå°±æ˜¯è°ƒåº¦schedulingï¼ŒæŠŠä¸€ä¸ªå®¹å™¨æ”¾åˆ°ä¸€ä¸ªé›†ç¾¤çš„æŸä¸€ä¸ªæœºå™¨ä¸Šï¼ŒK8s ä¼šè‡ªåŠ¨åšå­˜å‚¨çš„ç¼–æ’ï¼Œè®©å­˜å‚¨çš„ç”Ÿå‘½å‘¨æœŸå’Œå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸèƒ½æœ‰ä¸€ä¸ªè¿æ¥ï¼› K8s ä¼šåšè‡ªåŠ¨åŒ–çš„å®¹å™¨æ¢å¤ã€‚åœ¨ä¸€ä¸ªé›†ç¾¤ä¸­ï¼Œç»å¸¸ä¼šå‡ºç°å®¿ä¸»æœºçš„é—®é¢˜æˆ–è€…è¯´æ˜¯ OS çš„é—®é¢˜ï¼Œå¯¼è‡´å®¹å™¨æœ¬èº«çš„ä¸å¯ç”¨ï¼ŒK8s ä¼šè‡ªåŠ¨æ¢å¤ä¸å¯ç”¨çš„å®¹å™¨ï¼› K8s ä¼šåšåº”ç”¨çš„è‡ªåŠ¨å‘å¸ƒä¸åº”ç”¨çš„å›æ»šï¼Œä»¥åŠä¸åº”ç”¨ç›¸å…³çš„é…ç½®å¯†æ–‡çš„ç®¡ç†ï¼› å¯¹äº Job ç±»å‹ä»»åŠ¡ï¼ŒK8s å¯ä»¥åšæ‰¹é‡æ‰§è¡Œï¼› ä¸ºäº†è®©è¿™ä¸ªé›†ç¾¤ã€è¿™ä¸ªåº”ç”¨æ›´å¯Œæœ‰å¼¹æ€§ï¼ŒK8s ä¹Ÿæ”¯æ’‘æ°´å¹³ä¼¸ç¼©ã€‚ ä¸¾ä¸ªä¾‹å­ è°ƒåº¦ K8s å¯ä»¥æŠŠç”¨æˆ·æäº¤çš„å®¹å™¨æ”¾åˆ° K8s ç®¡ç†çš„é›†ç¾¤çš„æŸä¸€å°èŠ‚ç‚¹ä¸Šå»ã€‚K8s çš„è°ƒåº¦å™¨æ˜¯æ‰§è¡Œè¿™é¡¹å·¥ä½œçš„ç»„ä»¶ï¼Œå®ƒä¼šè§‚å¯Ÿæ­£åœ¨è¢«è°ƒåº¦çš„è¿™ä¸ªå®¹å™¨çš„å¤§å°ã€è§„æ ¼ã€‚ æ ¹æ®å®¹å™¨æ‰€éœ€è¦çš„ CPU å’Œéœ€è¦çš„ memoryï¼Œåœ¨é›†ç¾¤ä¸­æ‰¾ä¸€å°ç›¸å¯¹æ¯”è¾ƒç©ºé—²çš„æœºå™¨æ¥æ”¾ç½®ã€‚ è‡ªåŠ¨ä¿®å¤ K8s æœ‰ä¸€ä¸ªèŠ‚ç‚¹å¥åº·æ£€æŸ¥çš„åŠŸèƒ½ï¼Œä¼šç›‘æµ‹è¿™ä¸ªé›†ç¾¤ä¸­æ‰€æœ‰çš„å®¿ä¸»æœºï¼Œå½“å®¿ä¸»æœºæœ¬èº«å‡ºç°æ•…éšœï¼Œæˆ–è½¯ä»¶å‡ºç°æ•…éšœçš„æ—¶å€™ï¼ŒK8s ä¼šå‘ç°è¿™ä¸ªæƒ…å†µã€‚ ä¸‹é¢ï¼ŒK8s å°†è¿è¡Œåœ¨å¤±è´¥èŠ‚ç‚¹ä¸Šçš„å®¹å™¨è¿›è¡Œè‡ªåŠ¨è¿ç§»ï¼Œè¿ç§»åˆ°ä¸€ä¸ªæ­£åœ¨å¥åº·è¿è¡Œçš„å®¿ä¸»æœºä¸Šï¼Œæ¥å®Œæˆé›†ç¾¤å†…å®¹å™¨çš„ä¸€ä¸ªè‡ªåŠ¨æ¢å¤ã€‚ æ°´å¹³ä¼¸ç¼© K8s æœ‰ä¸šåŠ¡è´Ÿè½½æ£€æŸ¥èƒ½åŠ›ï¼Œä¼šç›‘æµ‹ä¸šåŠ¡ä¸Šæ‰€æ‰¿æ‹…çš„è´Ÿè½½ï¼Œå¦‚æœè¿™ä¸ªä¸šåŠ¡æœ¬èº«çš„ CPU åˆ©ç”¨ç‡è¿‡é«˜ï¼Œæˆ–è€…å“åº”æ—¶é—´è¿‡é•¿ï¼Œå®ƒå¯ä»¥å¯¹è¿™ä¸ªä¸šåŠ¡è¿›è¡Œä¸€æ¬¡æ‰©å®¹ã€‚ æ¯”å¦‚ï¼Œå°†è¿™ä¸ªä¸šåŠ¡åˆ†ä¸ºä¸‰ä»½ï¼Œåˆ†å¸ƒåˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œä»¥æ­¤æ¥æé«˜å“åº”çš„æ—¶é—´ã€‚ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:2:0","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Kubernetes çš„æ¶æ„K8s æ¶æ„æ˜¯ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„äºŒå±‚æ¶æ„å’Œ server-client æ¶æ„ã€‚Master ä½œä¸ºä¸­å¤®çš„ç®¡æ§èŠ‚ç‚¹ï¼Œä¼šå»ä¸ Node è¿›è¡Œä¸€ä¸ªè¿æ¥ã€‚ æ‰€æœ‰ UI çš„ clients å’Œ user ä¾§çš„ç»„ä»¶ï¼Œåªä¼šå’Œ Master è¿›è¡Œè¿æ¥ï¼ŒæŠŠå¸Œæœ›çš„çŠ¶æ€æˆ–è€…æƒ³æ‰§è¡Œçš„å‘½ä»¤ä¸‹å‘ç»™ Masterï¼ŒMaster ä¼šæŠŠè¿™äº›å‘½ä»¤æˆ–çŠ¶æ€ä¸‹å‘ç»™ç›¸åº”çš„èŠ‚ç‚¹ï¼Œæ‰§è¡Œæœ€ç»ˆçš„æ‰§è¡Œã€‚ Kubernetes æ¶æ„ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:3:0","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s çš„æ¶æ„ï¼šMasterK8s çš„ Master åŒ…å«å››ä¸ªä¸»è¦çš„ç»„ä»¶ï¼šAPI Serverã€Controllerã€Scheduler ä»¥åŠ etcdã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Kubernetes Master API Serverï¼š é¡¾åæ€ä¹‰æ˜¯ç”¨æ¥å¤„ç† API æ“ä½œçš„ï¼ŒK8s ä¸­æ‰€æœ‰ç»„ä»¶éƒ½ä¼šå’Œ API Server è¿›è¡Œè¿æ¥ï¼Œç»„ä»¶ä¸ç»„ä»¶ä¹‹é—´ä¸€èˆ¬ä¸è¿›è¡Œç‹¬ç«‹çš„è¿æ¥ï¼Œéƒ½ä¾èµ–äº API Server è¿›è¡Œæ¶ˆæ¯çš„ä¼ é€ï¼› Controllerï¼š æ§åˆ¶å™¨ï¼Œç”¨æ¥å®Œæˆå¯¹é›†ç¾¤çŠ¶æ€çš„ä¸€äº›ç®¡ç†ï¼› Schedulerï¼š è°ƒåº¦å™¨ï¼Œä¾æ®ç”¨æˆ·æäº¤ Container æ‰€éœ€çš„ CPU å’Œ memory è¯·æ±‚å¤§å°ï¼Œæ‰¾åˆ°åˆé€‚çš„èŠ‚ç‚¹è¿›è¡Œæ”¾ç½®ï¼› etcdï¼š åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼ŒAPI Server ä¸­æ‰€éœ€çš„åŸä¿¡æ¯æ”¾ç½®åœ¨ etcd ä¸­ï¼Œetcd æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªé«˜å¯ç”¨ç³»ç»Ÿï¼Œé€šè¿‡ etcd ä¿è¯æ•´ä¸ª K8s çš„ Master ç»„ä»¶çš„é«˜å¯ç”¨æ€§ã€‚ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:3:1","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s çš„æ¶æ„ï¼šNodeK8s çš„ Node æ˜¯çœŸæ­£è¿è¡Œä¸šåŠ¡è´Ÿè½½çš„ï¼Œæ¯ä¸ªä¸šåŠ¡è´Ÿè½½ä¼šä»¥ Pod çš„å½¢å¼è¿è¡Œã€‚ä¸€ä¸ª Pod ä¸­è¿è¡Œçš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ï¼ŒçœŸæ­£å»è¿è¡Œè¿™äº› Pod çš„ç»„ä»¶çš„æ˜¯å«åš kubeletï¼Œä¹Ÿå°±æ˜¯ Node ä¸Šæœ€ä¸ºå…³é”®çš„ç»„ä»¶ï¼Œå®ƒé€šè¿‡ API Server æ¥æ”¶åˆ°æ‰€éœ€è¦ Pod è¿è¡Œçš„çŠ¶æ€ï¼Œç„¶åæäº¤åˆ° Container Runtime ç»„ä»¶ä¸­ã€‚ Kubernetes Node åœ¨ OS ä¸Šå»åˆ›å»ºå®¹å™¨æ‰€éœ€è¦è¿è¡Œçš„ç¯å¢ƒï¼Œæœ€ç»ˆæŠŠå®¹å™¨æˆ–è€… Pod è¿è¡Œèµ·æ¥ï¼Œä¹Ÿéœ€è¦å¯¹å­˜å‚¨å’Œç½‘ç»œè¿›è¡Œç®¡ç†ã€‚K8s å¹¶ä¸ä¼šç›´æ¥è¿›è¡Œç½‘ç»œå­˜å‚¨çš„æ“ä½œï¼Œä»–ä»¬ä¼šé  Storage Plugin æˆ–è€…æ˜¯ç½‘ç»œçš„ Plugin æ¥è¿›è¡Œæ“ä½œã€‚ç”¨æˆ·è‡ªå·±æˆ–è€…äº‘å‚å•†éƒ½ä¼šå»å†™ç›¸åº”çš„ Storage Plugin æˆ–è€… Network Pluginï¼Œå»å®Œæˆå­˜å‚¨æ“ä½œæˆ–ç½‘ç»œæ“ä½œã€‚ åœ¨ K8s è‡ªå·±çš„ç¯å¢ƒä¸­ï¼Œä¹Ÿä¼šæœ‰ K8s çš„ Networkï¼Œå®ƒæ˜¯ä¸ºäº†æä¾› Service network æ¥è¿›è¡Œæ­ç½‘ç»„ç½‘çš„ã€‚çœŸæ­£å®Œæˆ service ç»„ç½‘çš„ç»„ä»¶çš„æ˜¯ Kube-proxyï¼Œå®ƒæ˜¯åˆ©ç”¨äº† iptable çš„èƒ½åŠ›æ¥è¿›è¡Œç»„å»º K8s çš„ Networkï¼Œå°±æ˜¯ cluster networkï¼Œä»¥ä¸Šå°±æ˜¯ Node ä¸Šé¢çš„å››ä¸ªç»„ä»¶ã€‚ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:3:2","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ Component Communication ç”¨æˆ·å¯ä»¥é€šè¿‡ UI æˆ– CLI æäº¤ä¸€ä¸ª Pod ç»™ K8s è¿›è¡Œéƒ¨ç½²ï¼Œè¿™ä¸ª Pod è¯·æ±‚é¦–å…ˆä¼šé€šè¿‡ CLI æˆ–è€… UI æäº¤ç»™ K8s API Serverï¼› API Server ä¼šæŠŠè¿™ä¸ªä¿¡æ¯å†™å…¥åˆ°å®ƒçš„å­˜å‚¨ç³»ç»Ÿ etcdï¼› ä¹‹å Scheduler ä¼šé€šè¿‡ API Server çš„ watch æˆ–è€…å«åš notification æœºåˆ¶å¾—åˆ°è¿™ä¸ªä¿¡æ¯ï¼šæœ‰ä¸€ä¸ª Pod éœ€è¦è¢«è°ƒåº¦ï¼› Scheduler ä¼šæ ¹æ®å†…å­˜çŠ¶æ€è¿›è¡Œä¸€æ¬¡è°ƒåº¦å†³ç­–ï¼Œå®Œæˆè°ƒåº¦åé€šçŸ¥ API Serverï¼› API Server æ”¶åˆ°è¿™æ¬¡æ“ä½œåä¼šæŠŠç»“æœå†æ¬¡å†™åˆ° etcd ä¸­ï¼› API Server ä¼šé€šçŸ¥ç›¸åº”èŠ‚ç‚¹è¿›è¡Œè¿™æ¬¡ Pod çœŸæ­£çš„æ‰§è¡Œå¯åŠ¨ï¼› ç›¸åº”èŠ‚ç‚¹çš„ kubelet å¾—åˆ°é€šçŸ¥ï¼Œè°ƒ Container runtime å»å¯åŠ¨å®¹å™¨å’Œç¯å¢ƒï¼Œè°ƒåº¦ Storage Plugin å»é…ç½®å­˜å‚¨ï¼Œnetwork Plugin å»é…ç½®ç½‘ç»œã€‚ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:3:3","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s çš„æ ¸å¿ƒæ¦‚å¿µä¸ API","date":"2021-05-26","objectID":"/kubernetes-notebook/:4:0","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s çš„æ ¸å¿ƒæ¦‚å¿µï¼šPodPod æ˜¯ K8s çš„ä¸€ä¸ªæœ€å°è°ƒåº¦ä»¥åŠèµ„æºå•å…ƒã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ K8s çš„ Pod API ç”Ÿäº§ä¸€ä¸ª Podï¼Œè®© K8s å¯¹è¿™ä¸ª Pod è¿›è¡Œè°ƒåº¦ï¼Œä¹Ÿå°±æ˜¯æŠŠå®ƒæ”¾åœ¨æŸä¸€ä¸ª K8s ç®¡ç†çš„èŠ‚ç‚¹ä¸Šè¿è¡Œèµ·æ¥ã€‚ä¸€ä¸ª Pod ç®€å•æ¥è¯´æ˜¯å¯¹ä¸€ç»„å®¹å™¨çš„æŠ½è±¡ï¼Œå®ƒé‡Œé¢ä¼šåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚ åœ¨ Pod é‡Œé¢ï¼Œå¯ä»¥å»å®šä¹‰å®¹å™¨æ‰€éœ€è¦è¿è¡Œçš„æ–¹å¼ã€‚æ¯”å¦‚è¯´è¿è¡Œå®¹å™¨çš„ Commandï¼Œä»¥åŠè¿è¡Œå®¹å™¨çš„ç¯å¢ƒå˜é‡ç­‰ç­‰ã€‚Pod è¿™ä¸ªæŠ½è±¡ä¹Ÿç»™è¿™äº›å®¹å™¨æä¾›äº†ä¸€ä¸ªå…±äº«çš„è¿è¡Œç¯å¢ƒï¼Œå®ƒä»¬ä¼šå…±äº«åŒä¸€ä¸ªç½‘ç»œç¯å¢ƒï¼Œè¿™äº›å®¹å™¨å¯ä»¥ç”¨ localhost æ¥è¿›è¡Œç›´æ¥çš„è¿æ¥ã€‚è€Œ Pod ä¸ Pod ä¹‹é—´ï¼Œæ˜¯äº’ç›¸æœ‰ isolation éš”ç¦»çš„ã€‚ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:4:1","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s çš„æ ¸å¿ƒæ¦‚å¿µï¼šVolumeVolume å°±æ˜¯å·çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ç”¨æ¥ç®¡ç† K8s å­˜å‚¨çš„ï¼Œæ˜¯ç”¨æ¥å£°æ˜åœ¨ Pod ä¸­çš„å®¹å™¨å¯ä»¥è®¿é—®æ–‡ä»¶ç›®å½•çš„ï¼Œä¸€ä¸ªå·å¯ä»¥è¢«æŒ‚è½½åœ¨ Pod ä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨çš„æŒ‡å®šè·¯å¾„ä¸‹é¢ã€‚ Kubernetes Conception: Volume è€Œ Volume æœ¬èº«æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œä¸€ä¸ª Volume å¯ä»¥å»æ”¯æŒå¤šç§çš„åç«¯çš„å­˜å‚¨ã€‚æ¯”å¦‚è¯´ K8s çš„ Volume å°±æ”¯æŒäº†å¾ˆå¤šå­˜å‚¨æ’ä»¶ï¼Œå®ƒå¯ä»¥æ”¯æŒæœ¬åœ°çš„å­˜å‚¨ï¼Œå¯ä»¥æ”¯æŒåˆ†å¸ƒå¼çš„å­˜å‚¨ï¼Œæ¯”å¦‚è¯´åƒ cephï¼ŒGlusterFS ï¼›å®ƒä¹Ÿå¯ä»¥æ”¯æŒäº‘å­˜å‚¨ï¼Œæ¯”å¦‚è¯´é˜¿é‡Œäº‘ä¸Šçš„äº‘ç›˜ã€AWS ä¸Šçš„äº‘ç›˜ã€Google ä¸Šçš„äº‘ç›˜ç­‰ç­‰ã€‚ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:4:2","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s çš„æ ¸å¿ƒæ¦‚å¿µï¼šDeploymentDeployment æ˜¯åœ¨ Pod è¿™ä¸ªæŠ½è±¡ä¸Šæ›´ä¸ºä¸Šå±‚çš„ä¸€ä¸ªæŠ½è±¡ï¼Œå®ƒå¯ä»¥å®šä¹‰ä¸€ç»„ Pod çš„å‰¯æœ¬æ•°ç›®ã€ä»¥åŠè¿™ä¸ª Pod çš„ç‰ˆæœ¬ã€‚ä¸€èˆ¬å¤§å®¶ç”¨ Deployment è¿™ä¸ªæŠ½è±¡æ¥åšåº”ç”¨çš„çœŸæ­£çš„ç®¡ç†ï¼Œè€Œ Pod æ˜¯ç»„æˆ Deployment æœ€å°çš„å•å…ƒã€‚ Kubernetes Conception: Deployment Kubernetes æ˜¯é€šè¿‡ Controllerï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšæ‰æåˆ°çš„æ§åˆ¶å™¨å»ç»´æŠ¤ Deployment ä¸­ Pod çš„æ•°ç›®ï¼Œå®ƒä¹Ÿä¼šå»å¸®åŠ© Deployment è‡ªåŠ¨æ¢å¤å¤±è´¥çš„ Podã€‚ æ¯”å¦‚è¯´æˆ‘å¯ä»¥å®šä¹‰ä¸€ä¸ª Deploymentï¼Œè¿™ä¸ª Deployment é‡Œé¢éœ€è¦ä¸¤ä¸ª Podï¼Œå½“ä¸€ä¸ª Pod å¤±è´¥çš„æ—¶å€™ï¼Œæ§åˆ¶å™¨å°±ä¼šç›‘æµ‹åˆ°ï¼Œå®ƒé‡æ–°æŠŠ Deployment ä¸­çš„ Pod æ•°ç›®ä»ä¸€ä¸ªæ¢å¤åˆ°ä¸¤ä¸ªï¼Œé€šè¿‡å†å»æ–°ç”Ÿæˆä¸€ä¸ª Podã€‚é€šè¿‡æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå¸®åŠ©å®Œæˆå‘å¸ƒçš„ç­–ç•¥ã€‚æ¯”å¦‚è¯´è¿›è¡Œæ»šåŠ¨å‡çº§ï¼Œè¿›è¡Œé‡æ–°ç”Ÿæˆçš„å‡çº§ï¼Œæˆ–è€…è¿›è¡Œç‰ˆæœ¬çš„å›æ»šã€‚ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:4:3","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s çš„æ ¸å¿ƒæ¦‚å¿µï¼šServiceService æä¾›äº†ä¸€ä¸ªæˆ–è€…å¤šä¸ª Pod å®ä¾‹çš„ç¨³å®šè®¿é—®åœ°å€ã€‚ æ¯”å¦‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼šä¸€ä¸ª Deployment å¯èƒ½æœ‰ä¸¤ä¸ªç”šè‡³æ›´å¤šä¸ªå®Œå…¨ç›¸åŒçš„ Podã€‚å¯¹äºä¸€ä¸ªå¤–éƒ¨çš„ç”¨æˆ·æ¥è®²ï¼Œè®¿é—®å“ªä¸ª Pod å…¶å®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å®ƒå¸Œæœ›åšä¸€æ¬¡è´Ÿè½½å‡è¡¡ï¼Œåœ¨åšè´Ÿè½½å‡è¡¡çš„åŒæ—¶ï¼Œæˆ‘åªæƒ³è®¿é—®æŸä¸€ä¸ªå›ºå®šçš„ VIPï¼Œä¹Ÿå°±æ˜¯ Virtual IP åœ°å€ï¼Œè€Œä¸å¸Œæœ›å¾—çŸ¥æ¯ä¸€ä¸ªå…·ä½“çš„ Pod çš„ IP åœ°å€ã€‚ æˆ‘ä»¬åˆšæ‰æåˆ°ï¼Œè¿™ä¸ª pod æœ¬èº«å¯èƒ½ terminal goï¼ˆç»ˆæ­¢ï¼‰ï¼Œå¦‚æœä¸€ä¸ª Pod å¤±è´¥äº†ï¼Œå¯èƒ½ä¼šæ¢æˆå¦å¤–ä¸€ä¸ªæ–°çš„ã€‚ å¯¹ä¸€ä¸ªå¤–éƒ¨ç”¨æˆ·æ¥è®²ï¼Œæä¾›äº†å¤šä¸ªå…·ä½“çš„ Pod åœ°å€ï¼Œè¿™ä¸ªç”¨æˆ·è¦ä¸åœåœ°å»æ›´æ–° Pod åœ°å€ï¼Œå½“è¿™ä¸ª Pod å†å¤±è´¥é‡å¯ä¹‹åï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªæŠ½è±¡ï¼ŒæŠŠæ‰€æœ‰ Pod çš„è®¿é—®èƒ½åŠ›æŠ½è±¡æˆä¸€ä¸ªç¬¬ä¸‰æ–¹çš„ä¸€ä¸ª IP åœ°å€ï¼Œå®ç°è¿™ä¸ªçš„ K8s çš„æŠ½è±¡å°±å« Serviceã€‚ å®ç° Service æœ‰å¤šç§æ–¹å¼ï¼ŒK8s æ”¯æŒ Cluster IPï¼Œä¸Šé¢æˆ‘ä»¬è®²è¿‡çš„ kuber-proxy çš„ç»„ç½‘ï¼Œå®ƒä¹Ÿæ”¯æŒ nodePortã€ LoadBalancer ç­‰å…¶ä»–çš„ä¸€äº›è®¿é—®çš„èƒ½åŠ›ã€‚ Kubernetes Conception: Service ","date":"2021-05-26","objectID":"/kubernetes-notebook/:4:4","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s çš„æ ¸å¿ƒæ¦‚å¿µï¼šNamespaceNamespace æ˜¯ç”¨æ¥åšä¸€ä¸ªé›†ç¾¤å†…éƒ¨çš„é€»è¾‘éš”ç¦»çš„ï¼Œå®ƒåŒ…æ‹¬é‰´æƒã€èµ„æºç®¡ç†ç­‰ã€‚K8s çš„æ¯ä¸ªèµ„æºï¼Œæ¯”å¦‚åˆšæ‰è®²çš„ Podã€Deploymentã€Service éƒ½å±äºä¸€ä¸ª Namespaceï¼ŒåŒä¸€ä¸ª Namespace ä¸­çš„èµ„æºéœ€è¦å‘½åçš„å”¯ä¸€æ€§ï¼Œä¸åŒçš„ Namespace ä¸­çš„èµ„æºå¯ä»¥é‡åã€‚ Kubernetes Conception: Namespace ","date":"2021-05-26","objectID":"/kubernetes-notebook/:4:5","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"K8s çš„ APIä» high-level ä¸Šçœ‹ï¼ŒK8s API æ˜¯ç”± HTTP+JSON ç»„æˆçš„ï¼šç”¨æˆ·è®¿é—®çš„æ–¹å¼æ˜¯ HTTPï¼Œè®¿é—®çš„ API ä¸­ content çš„å†…å®¹æ˜¯ JSON æ ¼å¼çš„ã€‚ K8s çš„ kubectl ä¹Ÿå°±æ˜¯ command toolï¼ŒKubernetes UIï¼Œæˆ–è€…æœ‰æ—¶å€™ç”¨ curlï¼Œç›´æ¥ä¸ K8s è¿›è¡Œæ²Ÿé€šï¼Œéƒ½æ˜¯ä½¿ç”¨ HTTP + JSON è¿™ç§å½¢å¼ã€‚ Kubernetes API å¦‚å›¾æ‰€ç¤ºï¼Œå¯¹äºè¿™ä¸ª Pod ç±»å‹çš„èµ„æºï¼Œå®ƒçš„ HTTP è®¿é—®è·¯å¾„ï¼Œå°±æ˜¯ APIï¼Œç„¶åæ˜¯ apiVersion: V1ï¼Œä¹‹åæ˜¯ç›¸åº”çš„ Namespaceï¼Œä»¥åŠ Pods èµ„æºï¼Œæœ€ç»ˆæ˜¯ Podnameã€‚ å¦‚æœæˆ‘ä»¬å»æäº¤ä¸€ä¸ª Podï¼Œæˆ–è€… get ä¸€ä¸ª Pod çš„æ—¶å€™ï¼Œå®ƒçš„ content å†…å®¹éƒ½æ˜¯ç”¨ JSON æˆ–è€…æ˜¯ YAML è¡¨è¾¾çš„ã€‚ä¸Šå›¾ä¸­å³ä¾§æ˜¯ yaml çš„ä¾‹å­ï¼Œåœ¨è¿™ä¸ª yaml file ä¸­ï¼Œå¯¹ Pod èµ„æºçš„æè¿°ä¹Ÿåˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ã€‚ ç¬¬ä¸€ä¸ªéƒ¨åˆ†ï¼Œä¸€èˆ¬æ¥è®²ä¼šæ˜¯ API çš„ versionã€‚æ¯”å¦‚åœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ V1ï¼Œå®ƒä¹Ÿä¼šæè¿°æˆ‘åœ¨æ“ä½œå“ªä¸ªèµ„æºï¼›æ¯”å¦‚è¯´æˆ‘çš„ kind å¦‚æœæ˜¯ podï¼Œåœ¨ Metadata ä¸­ï¼Œå°±å†™ä¸Šè¿™ä¸ª Pod çš„åå­—ï¼›æ¯”å¦‚è¯´ nginxï¼Œæˆ‘ä»¬ä¹Ÿä¼šç»™å®ƒæ‰“ä¸€äº› labelï¼Œæˆ‘ä»¬ç­‰ä¸‹ä¼šè®²åˆ° label çš„æ¦‚å¿µã€‚åœ¨ Metadata ä¸­ï¼Œæœ‰æ—¶å€™ä¹Ÿä¼šå»å†™ annotationï¼Œä¹Ÿå°±æ˜¯å¯¹èµ„æºçš„é¢å¤–çš„ä¸€äº›ç”¨æˆ·å±‚æ¬¡çš„æè¿°ã€‚ æ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªéƒ¨åˆ†å«åš Specï¼ŒSpec ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸Œæœ› Pod è¾¾åˆ°çš„ä¸€ä¸ªé¢„æœŸçš„çŠ¶æ€ã€‚æ¯”å¦‚è¯´å®ƒå†…éƒ¨éœ€è¦æœ‰å“ªäº› container è¢«è¿è¡Œï¼›æ¯”å¦‚è¯´è¿™é‡Œé¢æœ‰ä¸€ä¸ª nginx çš„ containerï¼Œå®ƒçš„ image æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæš´éœ²çš„ port æ˜¯ä»€ä¹ˆï¼Ÿ å½“æˆ‘ä»¬ä» Kubernetes API ä¸­å»è·å–è¿™ä¸ªèµ„æºçš„æ—¶å€™ï¼Œä¸€èˆ¬æ¥è®²åœ¨ Spec ä¸‹é¢ä¼šæœ‰ä¸€ä¸ªé¡¹ç›®å« statusï¼Œå®ƒè¡¨è¾¾äº†è¿™ä¸ªèµ„æºå½“å‰çš„çŠ¶æ€ï¼›æ¯”å¦‚è¯´ä¸€ä¸ª Pod çš„çŠ¶æ€å¯èƒ½æ˜¯æ­£åœ¨è¢«è°ƒåº¦ã€æˆ–è€…æ˜¯å·²ç» runningã€æˆ–è€…æ˜¯å·²ç»è¢« terminatesï¼Œå°±æ˜¯è¢«æ‰§è¡Œå®Œæ¯•äº†ã€‚ åˆšåˆšåœ¨ API ä¹‹ä¸­ï¼Œæˆ‘ä»¬è®²äº†ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„ metadata å«åšâ€œlabelâ€ï¼Œè¿™ä¸ª label å¯ä»¥æ˜¯ä¸€ç»„ KeyValuePairã€‚ è¿™äº› label æ˜¯å¯ä»¥è¢« selectorï¼Œä¹Ÿå°±æ˜¯é€‰æ‹©å™¨æ‰€æŸ¥è¯¢çš„ã€‚è¿™ä¸ªèƒ½åŠ›å®é™…ä¸Šè·Ÿæˆ‘ä»¬çš„ sql ç±»å‹çš„ select è¯­å¥æ˜¯éå¸¸ç›¸ä¼¼çš„ã€‚ é€šè¿‡ labelï¼Œk8s çš„ API å±‚å°±å¯ä»¥å¯¹è¿™äº›èµ„æºè¿›è¡Œä¸€ä¸ªç­›é€‰ï¼Œé‚£è¿™äº›ç­›é€‰ä¹Ÿæ˜¯ kubernetes å¯¹èµ„æºçš„é›†åˆæ‰€è¡¨è¾¾é»˜è®¤çš„ä¸€ç§æ–¹å¼ã€‚ ","date":"2021-05-26","objectID":"/kubernetes-notebook/:4:6","tags":["äº‘åŸç”Ÿ","Kubernetes"],"title":"Kubernetes æ ¸å¿ƒæ¦‚å¿µ","uri":"/kubernetes-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä»€ä¹ˆæ˜¯å®¹å™¨ä¸é•œåƒï¼Ÿå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä½•ï¼Ÿå®¹å™¨ä¸è™šæ‹Ÿæœºçš„åŒºåˆ«ï¼Ÿ","date":"2021-05-11","objectID":"/docker-notebook/","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å®¹å™¨ä¸é•œåƒ","date":"2021-05-11","objectID":"/docker-notebook/:1:0","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä»€ä¹ˆæ˜¯å®¹å™¨ï¼Ÿåœ¨ä»‹ç»å®¹å™¨çš„å…·ä½“æ¦‚å¿µä¹‹å‰ï¼Œå…ˆç®€å•å›é¡¾ä¸€ä¸‹æ“ä½œç³»ç»Ÿæ˜¯å¦‚ä½•ç®¡ç†è¿›ç¨‹çš„ã€‚ æ“ä½œç³»ç»Ÿä¸å®¹å™¨å¯¹æ¯” é¦–å…ˆï¼Œå½“æˆ‘ä»¬ç™»é™†åˆ°æ“ä½œç³»ç»Ÿä¹‹åï¼Œå¯ä»¥é€šè¿‡ ps ç­‰æ“ä½œçœ‹åˆ°å„å¼å„æ ·çš„è¿›ç¨‹ï¼Œè¿™äº›è¿›ç¨‹åŒ…æ‹¬ç³»ç»Ÿè‡ªå¸¦çš„æœåŠ¡å’Œç”¨æˆ·çš„åº”ç”¨è¿›ç¨‹ã€‚é‚£ä¹ˆï¼Œè¿™äº›è¿›ç¨‹éƒ½æœ‰ä»€ä¹ˆæ ·çš„ç‰¹ç‚¹ï¼Ÿ è¿™äº›è¿›ç¨‹å¯ä»¥ç›¸äº’çœ‹åˆ°ã€ç›¸äº’é€šä¿¡ï¼› å®ƒä»¬ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥å¯¹åŒä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œï¼› è¿™äº›è¿›ç¨‹ä¼šä½¿ç”¨ç›¸åŒçš„ç³»ç»Ÿèµ„æºã€‚ è¿™æ ·çš„ä¸‰ä¸ªç‰¹ç‚¹ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ å› ä¸ºè¿™äº›è¿›ç¨‹ç›¸äº’çœ‹åˆ°å¹¶ä¸”è¿›è¡Œé€šä¿¡ï¼Œé«˜çº§æƒé™çš„è¿›ç¨‹å¯ä»¥æ”»å‡»å…¶ä»–è¿›ç¨‹ï¼› å› ä¸ºå®ƒä»¬ä½¿ç”¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå› æ­¤ä¼šå¸¦æ¥ä¸¤ä¸ªé—®é¢˜ï¼šè¿™äº›è¿›ç¨‹å¯ä»¥å¯¹äºå·²æœ‰çš„æ•°æ®è¿›è¡Œå¢åˆ æ”¹æŸ¥ï¼Œå…·æœ‰é«˜çº§æƒé™çš„è¿›ç¨‹å¯èƒ½ä¼šå°†å…¶ä»–è¿›ç¨‹çš„æ•°æ®åˆ é™¤æ‰ï¼Œç ´åæ‰å…¶ä»–è¿›ç¨‹çš„æ­£å¸¸è¿è¡Œï¼›æ­¤å¤–ï¼Œè¿›ç¨‹ä¸è¿›ç¨‹ä¹‹é—´çš„ä¾èµ–å¯èƒ½ä¼šå­˜åœ¨å†²çªï¼Œå¦‚æ­¤ä¸€æ¥å°±ä¼šç»™è¿ç»´å¸¦æ¥å¾ˆå¤§çš„å‹åŠ›ï¼› å› ä¸ºè¿™äº›è¿›ç¨‹ä½¿ç”¨åŒä¸€ä¸ªå®¿ä¸»æœºçš„èµ„æºï¼Œåº”ç”¨ä¹‹é—´å¯èƒ½ä¼šå­˜åœ¨èµ„æºæŠ¢å çš„é—®é¢˜ï¼Œå½“ä¸€ä¸ªåº”ç”¨éœ€è¦æ¶ˆè€—å¤§é‡ CPU å’Œå†…å­˜èµ„æºçš„æ—¶å€™ï¼Œå°±å¯èƒ½ç ´åå…¶ä»–åº”ç”¨çš„è¿è¡Œï¼Œå¯¼è‡´å…¶ä»–åº”ç”¨æ— æ³•æ­£å¸¸åœ°æä¾›æœåŠ¡ã€‚ é’ˆå¯¹ä¸Šè¿°çš„ä¸‰ä¸ªé—®é¢˜ï¼Œå¦‚ä½•ä¸ºè¿›ç¨‹æä¾›ä¸€ä¸ªç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒå‘¢ï¼Ÿ é’ˆå¯¹ä¸åŒè¿›ç¨‹ä½¿ç”¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿæ‰€é€ æˆçš„é—®é¢˜è€Œè¨€ï¼ŒLinux å’Œ Unix æ“ä½œç³»ç»Ÿå¯ä»¥é€šè¿‡ chroot ç³»ç»Ÿè°ƒç”¨å°†å­ç›®å½•å˜æˆæ ¹ç›®å½•ï¼Œè¾¾åˆ°è§†å›¾çº§åˆ«çš„éš”ç¦»ï¼›è¿›ç¨‹åœ¨ chroot çš„å¸®åŠ©ä¸‹å¯ä»¥å…·æœ‰ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¯¹äºè¿™æ ·çš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œå¢åˆ æ”¹æŸ¥ä¸ä¼šå½±å“åˆ°å…¶ä»–è¿›ç¨‹ï¼› å› ä¸ºè¿›ç¨‹ä¹‹é—´ç›¸äº’å¯è§å¹¶ä¸”å¯ä»¥ç›¸äº’é€šä¿¡ï¼Œä½¿ç”¨ Namespace æŠ€æœ¯æ¥å®ç°è¿›ç¨‹åœ¨èµ„æºçš„è§†å›¾ä¸Šè¿›è¡Œéš”ç¦»ã€‚åœ¨ chroot å’Œ Namespace çš„å¸®åŠ©ä¸‹ï¼Œè¿›ç¨‹å°±èƒ½å¤Ÿè¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„ç¯å¢ƒä¸‹äº†ï¼› åœ¨ç‹¬ç«‹çš„ç¯å¢ƒä¸‹ï¼Œè¿›ç¨‹æ‰€ä½¿ç”¨çš„è¿˜æ˜¯åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„èµ„æºï¼Œä¸€äº›è¿›ç¨‹å¯èƒ½ä¼šä¾µèš€æ‰æ•´ä¸ªç³»ç»Ÿçš„èµ„æºã€‚ä¸ºäº†å‡å°‘è¿›ç¨‹å½¼æ­¤ä¹‹é—´çš„å½±å“ï¼Œå¯ä»¥é€šè¿‡ Cgroup æ¥é™åˆ¶å…¶èµ„æºä½¿ç”¨ç‡ï¼Œè®¾ç½®å…¶èƒ½å¤Ÿä½¿ç”¨çš„ CPU ä»¥åŠå†…å­˜é‡ã€‚ é‚£ä¹ˆï¼Œåº”è¯¥å¦‚ä½•å®šä¹‰è¿™æ ·çš„è¿›ç¨‹é›†åˆå‘¢ï¼Ÿ å…¶å®ï¼Œå®¹å™¨å°±æ˜¯ä¸€ä¸ªè§†å›¾éš”ç¦»ã€èµ„æºå¯é™åˆ¶ã€ç‹¬ç«‹æ–‡ä»¶ç³»ç»Ÿçš„è¿›ç¨‹é›†åˆã€‚æ‰€è°“â€œè§†å›¾éš”ç¦»â€å°±æ˜¯èƒ½å¤Ÿçœ‹åˆ°éƒ¨åˆ†è¿›ç¨‹ä»¥åŠå…·æœ‰ç‹¬ç«‹çš„ä¸»æœºåç­‰ï¼›æ§åˆ¶èµ„æºä½¿ç”¨ç‡åˆ™æ˜¯å¯ä»¥å¯¹äºå†…å­˜å¤§å°ä»¥åŠ CPU ä½¿ç”¨ä¸ªæ•°ç­‰è¿›è¡Œé™åˆ¶ã€‚å®¹å™¨å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹é›†åˆï¼Œå®ƒå°†ç³»ç»Ÿçš„å…¶ä»–èµ„æºéš”ç¦»å¼€æ¥ï¼Œå…·æœ‰è‡ªå·±ç‹¬ç«‹çš„èµ„æºè§†å›¾ã€‚ å®¹å™¨å…·æœ‰ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯ç³»ç»Ÿçš„èµ„æºï¼Œæ‰€ä»¥åœ¨ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿå†…ä¸éœ€è¦å…·å¤‡å†…æ ¸ç›¸å…³çš„ä»£ç æˆ–å·¥å…·ï¼Œæˆ‘ä»¬åªéœ€è¦æä¾›å®¹å™¨æ‰€éœ€çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ä»¥åŠä¾èµ–å³å¯ã€‚åªè¦å®¹å™¨è¿è¡Œæ—¶æ‰€éœ€çš„æ–‡ä»¶é›†åˆéƒ½èƒ½å¤Ÿå…·å¤‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¹å™¨å°±èƒ½å¤Ÿè¿è¡Œèµ·æ¥ã€‚ ","date":"2021-05-11","objectID":"/docker-notebook/:1:1","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ä»€ä¹ˆæ˜¯é•œåƒï¼Ÿç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å°†è¿™äº›å®¹å™¨è¿è¡Œæ—¶æ‰€éœ€è¦çš„æ‰€æœ‰æ–‡ä»¶é›†åˆç§°ä¹‹ä¸ºå®¹å™¨é•œåƒã€‚ é‚£ä¹ˆï¼Œä¸€èˆ¬é€šè¿‡ä»€ä¹ˆæ–¹å¼æ¥æ„å»ºé•œåƒçš„å‘¢ï¼Ÿé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé‡‡ç”¨ Dockerfile æ¥æ„å»ºé•œåƒï¼Œè¿™æ˜¯å› ä¸º Dockerfile æä¾›äº†éå¸¸ä¾¿åˆ©çš„è¯­æ³•ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¾ˆå¥½åœ°æè¿°æ„å»ºçš„æ¯ä¸ªæ­¥éª¤ã€‚å½“ç„¶ï¼Œæ¯ä¸ªæ„å»ºæ­¥éª¤éƒ½ä¼šå¯¹å·²æœ‰çš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ“ä½œï¼Œè¿™æ ·å°±ä¼šå¸¦æ¥æ–‡ä»¶ç³»ç»Ÿå†…å®¹çš„å˜åŒ–ï¼Œæˆ‘ä»¬å°†è¿™äº›å˜åŒ–ç§°ä¹‹ä¸º changesetã€‚å½“æˆ‘ä»¬æŠŠæ„å»ºæ­¥éª¤æ‰€äº§ç”Ÿçš„å˜åŒ–ä¾æ¬¡ä½œç”¨åˆ°ä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ä¸Šï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„é•œåƒã€‚ changeset åˆ†å±‚ç¤ºæ„ changeset çš„åˆ†å±‚ä»¥åŠå¤ç”¨ç‰¹ç‚¹èƒ½å¤Ÿå¸¦æ¥å‡ ç‚¹ä¼˜åŠ¿ï¼š æé«˜åˆ†å‘æ•ˆç‡ï¼Œç®€å•è¯•æƒ³ä¸€ä¸‹ï¼Œå¯¹äºå¤§é•œåƒè€Œè¨€ï¼Œå¦‚æœå°†å…¶æ‹†åˆ†æˆå„ä¸ªå°å—å°±èƒ½å¤Ÿæé«˜é•œåƒçš„åˆ†å‘æ•ˆç‡ï¼Œè¿™æ˜¯å› ä¸ºé•œåƒæ‹†åˆ†ä¹‹åå°±å¯ä»¥å¹¶è¡Œä¸‹è½½ã€‚ å› ä¸ºæ•°æ®æ˜¯ç›¸äº’å…±äº«çš„ï¼Œä¹Ÿå°±æ„å‘³ç€å½“æœ¬åœ°å­˜å‚¨ä¸ŠåŒ…å«äº†ä¸€äº›æ•°æ®çš„æ—¶å€™ï¼Œåªéœ€è¦ä¸‹è½½æœ¬åœ°æ²¡æœ‰çš„æ•°æ®å³å¯ã€‚ å› ä¸ºé•œåƒæ•°æ®æ˜¯å…±äº«çš„ï¼Œå› æ­¤å¯ä»¥èŠ‚çº¦å¤§é‡çš„ç£ç›˜ç©ºé—´ï¼Œç®€å•è®¾æƒ³ä¸€ä¸‹ï¼Œå½“æœ¬åœ°å­˜å‚¨å…·æœ‰äº† alpine é•œåƒå’Œ golang é•œåƒï¼Œåœ¨æ²¡æœ‰å¤ç”¨èƒ½åŠ›ä¹‹å‰ï¼Œalpine é•œåƒå…·æœ‰ 5M å¤§å°ï¼ŒGolang é•œåƒæœ‰ 300M å¤§å°ï¼Œå› æ­¤å°±ä¼šå ç”¨ 305M ç©ºé—´ï¼›è€Œå½“å…·æœ‰å¤ç”¨èƒ½åŠ›ä¹‹åï¼Œåªéœ€è¦ 300 M ç©ºé—´å³å¯ï¼Œè¿™æ˜¯å› ä¸º Golang é•œåƒæ˜¯åŸºäº alpine é•œåƒæ„å»ºçš„ã€‚ ","date":"2021-05-11","objectID":"/docker-notebook/:1:2","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å¦‚ä½•æ„å»ºé•œåƒï¼Ÿå¦‚ä¸‹æ‰€ç¤ºçš„ Dockerfile é€‚ç”¨äºæè¿°å¦‚ä½•æ„å»º Golang åº”ç”¨çš„ã€‚ # base on golang:1.12-alpine imageFROMgolang:1.12-alpine# setting current working dir (PWD -\u003e /go/src/app)WORKDIR/go/src/app# copy local files into /go/src/appCOPY ..# get all the dependenciesRUN go get -d -v ./...# build the application and install itRUN go install -v ./...# by default, run the appCMD[\"app\"] å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼š FROM è¡Œè¡¨ç¤ºä»¥ä¸‹çš„æ„å»ºæ­¥éª¤åŸºäºä»€ä¹ˆé•œåƒè¿›è¡Œæ„å»ºï¼Œæ­£å¦‚å‰è¿°ï¼Œé•œåƒæ˜¯å¯ä»¥å¤ç”¨çš„ï¼› WORKDIR è¡Œè¡¨ç¤ºä¼šæŠŠæ¥ä¸‹æ¥çš„æ„å»ºæ­¥éª¤éƒ½åœ¨å“ªä¸€ä¸ªç›¸åº”çš„å…·ä½“ç›®å½•ä¸‹è¿›è¡Œï¼Œå…¶èµ·åˆ°çš„ä½œç”¨ç±»ä¼¼äº shell é‡Œé¢çš„ cdï¼› COPY è¡Œè¡¨ç¤ºçš„æ˜¯å¯ä»¥å°†å®¿ä¸»æœºä¸Šçš„æ–‡ä»¶æ‹·è´åˆ°å®¹å™¨é•œåƒå†…ï¼› RUN è¡Œè¡¨ç¤ºåœ¨å…·ä½“çš„æ–‡ä»¶ç³»ç»Ÿå†…æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œã€‚å½“æˆ‘ä»¬è¿è¡Œå®Œæ¯•åå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªåº”ç”¨äº†ï¼› CMD è¡Œè¡¨ç¤ºä½¿ç”¨é•œåƒæ—¶çš„é»˜è®¤ç¨‹åºåå­—ã€‚ å½“æœ‰äº† Dockerfile ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡ docker build å‘½ä»¤æ„å»ºå‡ºæ‰€éœ€è¦çš„åº”ç”¨ã€‚æ„å»ºå‡ºçš„ç»“æœå­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé•œåƒæ„å»ºä¼šåœ¨æ‰“åŒ…æœºæˆ–è€…å…¶ä»–çš„éš”ç¦»ç¯å¢ƒä¸‹å®Œæˆã€‚ ","date":"2021-05-11","objectID":"/docker-notebook/:1:3","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å¦‚ä½•è¿è¡Œå®¹å™¨ å®¹å™¨è¿è¡Œè¿‡ç¨‹ è¿è¡Œä¸€ä¸ªå®¹å™¨ä¸€èˆ¬æƒ…å†µä¸‹åˆ†ä¸ºä¸‰æ­¥ï¼š ç¬¬ä¸€æ­¥ï¼šä»é•œåƒä»“åº“ä¸­å°†ç›¸åº”çš„é•œåƒä¸‹è½½ä¸‹æ¥ï¼› ç¬¬äºŒæ­¥ï¼šå½“é•œåƒä¸‹è½½å®Œæˆä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡ docker images æ¥æŸ¥çœ‹æœ¬åœ°é•œåƒï¼› ç¬¬ä¸‰æ­¥ï¼šå½“é€‰ä¸­é•œåƒä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡ docker run æ¥è¿è¡Œè¿™ä¸ªé•œåƒå¾—åˆ°æƒ³è¦çš„å®¹å™¨ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡å¤šæ¬¡è¿è¡Œå¾—åˆ°å¤šä¸ªå®¹å™¨ã€‚ä¸€ä¸ªé•œåƒå°±ç›¸å½“äºæ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œä¸€ä¸ªå®¹å™¨å°±åƒæ˜¯ä¸€ä¸ªå…·ä½“çš„è¿è¡Œå®ä¾‹ï¼Œå› æ­¤é•œåƒå°±å…·æœ‰äº†ä¸€æ¬¡æ„å»ºã€åˆ°å¤„è¿è¡Œçš„ç‰¹ç‚¹ã€‚ ","date":"2021-05-11","objectID":"/docker-notebook/:1:4","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå®¹å™¨æ˜¯ä¸€ç»„å…·æœ‰éš”ç¦»ç‰¹æ€§çš„è¿›ç¨‹é›†åˆï¼Œåœ¨ä½¿ç”¨ docker run çš„æ—¶å€™ä¼šé€‰æ‹©ä¸€ä¸ªé•œåƒæ¥æä¾›ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿå¹¶æŒ‡å®šç›¸åº”çš„è¿è¡Œç¨‹åºã€‚è¿™é‡ŒæŒ‡å®šçš„è¿è¡Œç¨‹åºç§°ä¹‹ä¸º initial è¿›ç¨‹ï¼Œè¿™ä¸ª initial è¿›ç¨‹å¯åŠ¨çš„æ—¶å€™ï¼Œå®¹å™¨ä¹Ÿä¼šéšä¹‹å¯åŠ¨ï¼Œå½“ initial è¿›ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œå®¹å™¨ä¹Ÿä¼šéšä¹‹é€€å‡ºã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå’Œ initial è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸€è‡´çš„ã€‚å½“ç„¶ï¼Œå› ä¸ºå®¹å™¨å†…ä¸åªæœ‰è¿™æ ·çš„ä¸€ä¸ª initial è¿›ç¨‹ï¼Œinitial è¿›ç¨‹æœ¬èº«ä¹Ÿå¯ä»¥äº§ç”Ÿå…¶ä»–çš„å­è¿›ç¨‹æˆ–è€…é€šè¿‡ docker exec äº§ç”Ÿå‡ºæ¥çš„è¿ç»´æ“ä½œï¼Œä¹Ÿå±äº initial è¿›ç¨‹ç®¡ç†çš„èŒƒå›´å†…ã€‚å½“ initial è¿›ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œæ‰€æœ‰çš„å­è¿›ç¨‹ä¹Ÿä¼šéšä¹‹é€€å‡ºï¼Œè¿™æ ·ä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢èµ„æºçš„æ³„æ¼ã€‚ ä½†æ˜¯è¿™æ ·çš„åšæ³•ä¹Ÿä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œé¦–å…ˆåº”ç”¨é‡Œé¢çš„ç¨‹åºå¾€å¾€æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå…¶å¯èƒ½ä¼šäº§ç”Ÿä¸€äº›é‡è¦çš„æ•°æ®ï¼Œå½“ä¸€ä¸ªå®¹å™¨é€€å‡ºè¢«åˆ é™¤ä¹‹åï¼Œæ•°æ®ä¹Ÿå°±ä¼šä¸¢å¤±äº†ï¼Œè¿™å¯¹äºåº”ç”¨æ–¹è€Œè¨€æ˜¯ä¸èƒ½æ¥å—çš„ï¼Œæ‰€ä»¥éœ€è¦å°†å®¹å™¨æ‰€äº§ç”Ÿå‡ºæ¥çš„é‡è¦æ•°æ®æŒä¹…åŒ–ä¸‹æ¥ã€‚å®¹å™¨èƒ½å¤Ÿç›´æ¥å°†æ•°æ®æŒä¹…åŒ–åˆ°æŒ‡å®šçš„ç›®å½•ä¸Šï¼Œè¿™ä¸ªç›®å½•å°±ç§°ä¹‹ä¸ºæ•°æ®å·ã€‚ æ•°æ®å·æœ‰ä¸€äº›ç‰¹ç‚¹ï¼Œå…¶ä¸­éå¸¸æ˜æ˜¾çš„å°±æ˜¯æ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç‹¬ç«‹äºå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®¹å™¨çš„åˆ›å»ºã€è¿è¡Œã€åœæ­¢ã€åˆ é™¤ç­‰æ“ä½œéƒ½å’Œæ•°æ®å·æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç›®å½•ï¼Œæ˜¯ç”¨äºå¸®åŠ©å®¹å™¨è¿›è¡ŒæŒä¹…åŒ–çš„ã€‚ç®€å•è€Œè¨€ï¼Œæˆ‘ä»¬ä¼šå°†æ•°æ®å·æŒ‚è½½åˆ°å®¹å™¨å†…ï¼Œè¿™æ ·ä¸€æ¥å®¹å™¨å°±èƒ½å¤Ÿå°†æ•°æ®å†™å…¥åˆ°ç›¸åº”çš„ç›®å½•é‡Œé¢äº†ï¼Œè€Œä¸”å®¹å™¨çš„é€€å‡ºå¹¶ä¸ä¼šå¯¼è‡´æ•°æ®çš„ä¸¢å¤±ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œæ•°æ®å·ç®¡ç†ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š ç¬¬ä¸€ç§æ˜¯é€šè¿‡ bind çš„æ–¹å¼ï¼Œç›´æ¥å°†å®¿ä¸»æœºçš„ç›®å½•ç›´æ¥æŒ‚è½½åˆ°å®¹å™¨å†…ï¼›è¿™ç§æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯ä¼šå¸¦æ¥è¿ç»´æˆæœ¬ï¼Œå› ä¸ºå…¶ä¾èµ–äºå®¿ä¸»æœºçš„ç›®å½•ï¼Œéœ€è¦å¯¹äºæ‰€æœ‰çš„å®¿ä¸»æœºè¿›è¡Œç»Ÿä¸€ç®¡ç†ã€‚ ç¬¬äºŒç§æ˜¯å°†ç›®å½•ç®¡ç†äº¤ç»™è¿è¡Œå¼•æ“ã€‚ # bind host dir into container docker run -v /tmp:/tmp busybox:1.25 sh -c \"data \u003e /tmp/demo.log\" # check result cat /tmp/demo.log # let it handled by docker container engine docker create volume demo # demo is volume name docker run -v demo:/tmp busybox:1.25 sh -c \"date \u003e /tmp/demo.log\" # check result docker run -v demo:/tmp busybox:1.25 sh -c \"cat /tmp/demo.log\" ","date":"2021-05-11","objectID":"/docker-notebook/:2:0","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å®¹å™¨é¡¹ç›®æ¶æ„ï¼šmoby å®¹å™¨å¼•æ“æ¶æ„moby æ˜¯ç›®å‰æœ€æµè¡Œçš„å®¹å™¨ç®¡ç†å¼•æ“ï¼Œmoby daemon ä¼šå¯¹ä¸Šæä¾›æœ‰å…³äºå®¹å™¨ã€é•œåƒã€ç½‘ç»œä»¥åŠ Volumeçš„ç®¡ç†ã€‚moby daemon æ‰€ä¾èµ–çš„æœ€é‡è¦çš„ç»„ä»¶å°±æ˜¯ containerdï¼Œcontainerd æ˜¯ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶ç®¡ç†å¼•æ“ï¼Œå…¶ç‹¬ç«‹äº moby daemon ï¼Œå¯ä»¥å¯¹ä¸Šæä¾›å®¹å™¨ã€é•œåƒçš„ç›¸å…³ç®¡ç†ã€‚ moby å¼•æ“ containerd åº•å±‚æœ‰ containerd shim æ¨¡å—ï¼Œå…¶ç±»ä¼¼äºä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œè¿™æ ·è®¾è®¡çš„åŸå› æœ‰å‡ ç‚¹ï¼š é¦–å…ˆï¼Œcontainerd éœ€è¦ç®¡ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸï¼Œè€Œå®¹å™¨å¯èƒ½æ˜¯ç”±ä¸åŒçš„å®¹å™¨è¿è¡Œæ—¶æ‰€åˆ›å»ºå‡ºæ¥çš„ï¼Œå› æ­¤éœ€è¦æä¾›ä¸€ä¸ªçµæ´»çš„æ’ä»¶åŒ–ç®¡ç†ã€‚è€Œ shim å°±æ˜¯é’ˆå¯¹äºä¸åŒçš„å®¹å™¨è¿è¡Œæ—¶æ‰€å¼€å‘çš„ï¼Œè¿™æ ·å°±èƒ½å¤Ÿä» containerd ä¸­è„±ç¦»å‡ºæ¥ï¼Œé€šè¿‡æ’ä»¶çš„å½¢å¼è¿›è¡Œç®¡ç†ã€‚ å…¶æ¬¡ï¼Œå› ä¸º shim æ’ä»¶åŒ–çš„å®ç°ï¼Œä½¿å…¶èƒ½å¤Ÿè¢« containerd åŠ¨æ€æ¥ç®¡ã€‚å¦‚æœä¸å…·å¤‡è¿™æ ·çš„èƒ½åŠ›ï¼Œå½“ moby daemon æˆ–è€… containerd daemon æ„å¤–é€€å‡ºçš„æ—¶å€™ï¼Œå®¹å™¨å°±æ²¡äººç®¡ç†äº†ï¼Œé‚£ä¹ˆå®ƒä¹Ÿä¼šéšä¹‹æ¶ˆå¤±ã€é€€å‡ºï¼Œè¿™æ ·å°±ä¼šå½±å“åˆ°åº”ç”¨çš„è¿è¡Œã€‚ æœ€åï¼Œå› ä¸ºéšæ—¶å¯èƒ½ä¼šå¯¹ moby æˆ–è€… containerd è¿›è¡Œå‡çº§ï¼Œå¦‚æœä¸æä¾› shim æœºåˆ¶ï¼Œé‚£ä¹ˆå°±æ— æ³•åšåˆ°åŸåœ°å‡çº§ï¼Œä¹Ÿæ— æ³•åšåˆ°ä¸å½±å“ä¸šåŠ¡çš„å‡çº§ï¼Œå› æ­¤ containerd shim éå¸¸é‡è¦ï¼Œå®ƒå®ç°äº†åŠ¨æ€æ¥ç®¡çš„èƒ½åŠ›ã€‚ ","date":"2021-05-11","objectID":"/docker-notebook/:3:0","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å®¹å™¨ VS VM å®¹å™¨ä¸è™šæ‹Ÿæœºå¯¹æ¯”ç¤ºæ„ å®¹å™¨ VM è¿›ç¨‹çº§çš„éš”ç¦»æ•ˆæœæ¯” VM è¦å·® å› ä¸ºæ¯ä¸ª Guest OS éƒ½æœ‰ç‹¬ç«‹çš„å†…æ ¸ï¼Œæ‰€ä»¥ VM æä¾›ä¸€ä¸ªæ›´å¥½çš„éš”ç¦»æ•ˆæœ æ‰€éœ€ç£ç›˜ç©ºé—´å° æ‰€éœ€ç£ç›˜ç©ºé—´å¤§ å“åº”æ—¶é—´å¿«ï¼Œå› ä¸ºæ–‡ä»¶éš”ç¦»éƒ½æ˜¯è¿›ç¨‹çº§åˆ«çš„ å“åº”æ—¶é—´æ…¢ï¼Œå› ä¸ºä¸€éƒ¨åˆ†è®¡ç®—èµ„æºäº¤ç»™è™šæ‹ŸåŒ– ","date":"2021-05-11","objectID":"/docker-notebook/:4:0","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ€»ç»“ å®¹å™¨æ˜¯ä¸€ä¸ªè¿›ç¨‹é›†åˆï¼Œå…·æœ‰è‡ªå·±ç‹¬ç‰¹çš„è§†å›¾è§†è§’ï¼› é•œåƒæ˜¯å®¹å™¨æ‰€éœ€è¦çš„æ‰€æœ‰æ–‡ä»¶é›†åˆï¼Œå…¶å…·å¤‡ä¸€æ¬¡æ„å»ºã€åˆ°å¤„è¿è¡Œçš„ç‰¹ç‚¹ï¼› å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå’Œ initial è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸€æ ·çš„ï¼› å®¹å™¨å’Œ VM ç›¸æ¯”ï¼Œå„æœ‰ä¼˜åŠ£ï¼Œå®¹å™¨æŠ€æœ¯åœ¨å‘ç€å¼ºéš”ç¦»æ–¹å‘å‘å±•ã€‚ ","date":"2021-05-11","objectID":"/docker-notebook/:5:0","tags":["Docker","Image","äº‘åŸç”Ÿ"],"title":"å®¹å™¨åŸºæœ¬æ¦‚å¿µ","uri":"/docker-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å­¦å¥½ Yaml è¯­æ³•ï¼Œæ‰“å¥½ K8s åŸºç¡€","date":"2021-05-08","objectID":"/yaml-notebook/","tags":["Yaml","äº‘åŸç”Ÿ","Kubernetes"],"title":"æœ€å…¨ Yaml è¯­æ³•è¯¦è§£","uri":"/yaml-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"ç®€å•è¯´æ˜Yaml æ˜¯ä¸€ä¸ªå¯è¯»æ€§é«˜ï¼Œç”¨æ¥è¡¨è¾¾æ•°æ®åºåˆ—çš„æ ¼å¼ã€‚Yaml çš„æ„æ€æ˜¯ï¼šä»æ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ï¼Œå¼ºè°ƒè¿™ç§è¯­è¨€ä»¥æ•°æ®åšä¸ºä¸­å¿ƒï¼Œè€Œä¸æ˜¯ä»¥æ ‡è®°è¯­è¨€ä¸ºé‡ç‚¹ ","date":"2021-05-08","objectID":"/yaml-notebook/:1:0","tags":["Yaml","äº‘åŸç”Ÿ","Kubernetes"],"title":"æœ€å…¨ Yaml è¯­æ³•è¯¦è§£","uri":"/yaml-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"åŸºæœ¬è¯­æ³• ç¼©è¿›æ—¶ä¸å…è®¸ä½¿ç”¨ Tab é”®ï¼Œåªå…è®¸ä½¿ç”¨ç©ºæ ¼ ç¼©è¿›çš„ç©ºæ ¼æ•°ç›®ä¸é‡è¦ï¼Œåªè¦ç›¸åŒå±‚çº§çš„å…ƒç´ å·¦ä¾§å¯¹é½å³å¯ æ ‡è¯†æ³¨é‡Šï¼Œä»è¿™ä¸ªå­—ç¬¦ä¸€ç›´åˆ°è¡Œå°¾ï¼Œéƒ½ä¼šè¢«è§£é‡Šå™¨å¿½ç•¥ ","date":"2021-05-08","objectID":"/yaml-notebook/:2:0","tags":["Yaml","äº‘åŸç”Ÿ","Kubernetes"],"title":"æœ€å…¨ Yaml è¯­æ³•è¯¦è§£","uri":"/yaml-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"Yaml æ”¯æŒçš„æ•°æ®ç»“æ„ å¯¹è±¡ï¼šé”®å€¼å¯¹çš„é›†åˆï¼Œåˆç§°ä¸ºæ˜ å°„mappingæ˜ å°„mapping/ å“ˆå¸Œhashå“ˆå¸Œhash/ å­—å…¸dictionaryå­—å…¸dictionary æ•°ç»„ï¼šä¸€ç»„æŒ‰æ¬¡åºæ’åˆ—çš„å€¼ï¼Œåˆç§°ä¸ºåºåˆ—sequenceåºåˆ—sequence/ åˆ—è¡¨liståˆ—è¡¨list çº¯é‡scalarsçº¯é‡scalarsï¼šå•ä¸ªçš„ã€ä¸å¯å†åˆ†çš„å€¼ ","date":"2021-05-08","objectID":"/yaml-notebook/:3:0","tags":["Yaml","äº‘åŸç”Ÿ","Kubernetes"],"title":"æœ€å…¨ Yaml è¯­æ³•è¯¦è§£","uri":"/yaml-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å¯¹è±¡ç±»å‹ï¼šå¯¹è±¡çš„ä¸€ç»„é”®å€¼å¯¹ï¼Œä½¿ç”¨å†’å·ç»“æ„è¡¨ç¤º name:Oliverage:24 Yaml ä¹Ÿå…è®¸å¦ä¸€ç§å†™æ³•ï¼Œå°†æ‰€æœ‰é”®å€¼å¯¹å†™æˆä¸€ä¸ªè¡Œå†…å¯¹è±¡ hash:{name: Oliver, age:24} Yaml å…è®¸å­˜åœ¨å±‚çº§é”®å€¼å¯¹ major:name:computername:law ","date":"2021-05-08","objectID":"/yaml-notebook/:3:1","tags":["Yaml","äº‘åŸç”Ÿ","Kubernetes"],"title":"æœ€å…¨ Yaml è¯­æ³•è¯¦è§£","uri":"/yaml-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"æ•°ç»„ç±»å‹ï¼šä¸€ç»„è¿è¯çº¿å¼€å¤´çš„è¡Œï¼Œæ„æˆä¸€ä¸ªæ•°ç»„ Sport:- Swim- Run æ•°ç»„ä¹Ÿå¯ä»¥é‡‡ç”¨è¡Œå†…è¡¨ç¤ºæ³• Sport:[Swim, Run] æ•°ç»„çš„ä¸€ä¸ªç›¸å¯¹å¤æ‚çš„å®ç°æ–¹å¼ products:-id:1name:eggprice:8-id:2name:meatprice:33 ","date":"2021-05-08","objectID":"/yaml-notebook/:3:2","tags":["Yaml","äº‘åŸç”Ÿ","Kubernetes"],"title":"æœ€å…¨ Yaml è¯­æ³•è¯¦è§£","uri":"/yaml-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å¤åˆç»“æ„ï¼šå¯¹è±¡å’Œæ•°ç»„å¯ä»¥ç»“åˆä½¿ç”¨ï¼Œå½¢æˆå¤åˆç»“æ„ sport:- swim- run- basketballcity:haidian:beijing.haidianjinan:shandong.jinanhefei:anhui.hefei ","date":"2021-05-08","objectID":"/yaml-notebook/:3:3","tags":["Yaml","äº‘åŸç”Ÿ","Kubernetes"],"title":"æœ€å…¨ Yaml è¯­æ³•è¯¦è§£","uri":"/yaml-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"çº¯é‡ï¼šçº¯é‡æ˜¯æœ€åŸºæœ¬çš„ã€ä¸å¯å†åˆ†çš„å€¼ å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€æ•´æ•°ã€æµ®ç‚¹æ•°ã€Null æ—¶é—´ã€æ—¥æœŸ æ•°å€¼ æ•°å€¼ç›´æ¥ä»¥å­—é¢é‡çš„å½¢å¼è¡¨ç¤º number:12.30 å¸ƒå°”å€¼ å¸ƒå°”å€¼ç”¨ true å’Œ false è¡¨ç¤º isSet:true Null null ç”¨ï½è¡¨ç¤º parent:~ æ—¶é—´ æ—¶é—´é‡‡ç”¨ ISO8601 æ ¼å¼ iso8601:2001-12-14t21:59:43.10-05:00 æ—¥æœŸ æ—¥æœŸé‡‡ç”¨ ISO8601 æ ¼å¼çš„å¹´ã€æœˆã€æ—¥è¡¨ç¤º date:1976-07-31 ç±»å‹è½¬æ¢ Yaml å…è®¸ä½¿ç”¨ä¸¤ä¸ªæ„Ÿå¹å·ï¼Œå¼ºåˆ¶è½¬æ¢æ•°æ®ç±»å‹ e:!!str123f:!!strtrue å­—ç¬¦ä¸² å­—ç¬¦ä¸²é»˜è®¤ä¸ä½¿ç”¨å¼•å·è¡¨ç¤º str:æˆ‘æ˜¯å­—ç¬¦ä¸² å¦‚æœå­—ç¬¦ä¸²ä¹‹ä¸­åŒ…å«ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦æ”¾åœ¨å¼•å·ä¸­ str:'å†…å®¹ï¼š å­—ç¬¦ä¸²' å•å¼•å·ä¹‹ä¸­å¦‚æœè¿˜æœ‰å•å¼•å·ï¼Œå¿…é¡»è¿ç»­ä½¿ç”¨ä¸¤ä¸ªå•å¼•å·è½¬ä¹‰ str:'laborâ€™â€˜s day' å­—ç¬¦ä¸²å¯ä»¥å†™æˆå¤šè¡Œï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªå•ç©ºæ ¼ç¼©è¿›ï¼Œæ¢è¡Œç¬¦ä¼šè¢«è½¬ä¸ºç©ºæ ¼ str:æˆ‘æ˜¯ä¸€æ®µå¤šè¡Œå­—ç¬¦ä¸² å¤šè¡Œå­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨ | ä¿ç•™æ¢è¡Œç¬¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ \u003e æŠ˜å æ¢è¡Œ this:|Foo Barthat:\u003eFoo Bar + è¡¨ç¤ºä¿ç•™æ–‡å­—å—æœ«å°¾çš„æ¢è¡Œï¼Œ- è¡¨ç¤ºåˆ é™¤å­—ç¬¦ä¸²æœ«å°¾çš„æ¢è¡Œ s1:|Foos2:|+Foos3:|-Foo ","date":"2021-05-08","objectID":"/yaml-notebook/:3:4","tags":["Yaml","äº‘åŸç”Ÿ","Kubernetes"],"title":"æœ€å…¨ Yaml è¯­æ³•è¯¦è§£","uri":"/yaml-notebook/"},{"categories":["äº‘åŸç”Ÿ"],"content":"å¼•ç”¨\u0026 é”šç‚¹å’Œ * åˆ«åï¼Œå¯ä»¥ç”¨æ¥å¼•ç”¨: defaults:\u0026defaultsadapter:postgreshost:localhostdevelopment:database:myapp_development\u003c\u003c:*defaultstest:database:myapp_test\u003c\u003c:*defaults ç›¸å½“äº defaults:adapter:postgreshost:localhostdevelopment:database:myapp_developmentadapter:postgreshost:localhosttest:database:myapp_testadapter:postgreshost:localhost \u0026 ç”¨æ¥å»ºç«‹é”šç‚¹ï¼ˆdefaultsï¼‰ï¼ŒÂ« è¡¨ç¤ºåˆå¹¶åˆ°å½“å‰æ•°æ®ï¼Œ* ç”¨æ¥å¼•ç”¨é”šç‚¹ã€‚ ","date":"2021-05-08","objectID":"/yaml-notebook/:4:0","tags":["Yaml","äº‘åŸç”Ÿ","Kubernetes"],"title":"æœ€å…¨ Yaml è¯­æ³•è¯¦è§£","uri":"/yaml-notebook/"},{"categories":["LCTT"],"content":"Git æä¾›äº†å‡ ç§æ–¹å¼å¯ä»¥å¸®ä½ å¿«é€ŸæŸ¥çœ‹æäº¤ä¸­å“ªäº›æ–‡ä»¶è¢«æ”¹å˜ã€‚","date":"2021-04-24","objectID":"/git-whatchanged/","tags":["LCTT","Git"],"title":"æŸ¥çœ‹ Git æäº¤ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–","uri":"/git-whatchanged/"},{"categories":["LCTT"],"content":"å¦‚æœä½ æ¯å¤©ä½¿ç”¨ Gitï¼Œåº”è¯¥ä¼šæäº¤ä¸å°‘æ”¹åŠ¨ã€‚å¦‚æœä½ æ¯å¤©å’Œå…¶ä»–äººåœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ Gitï¼Œå‡è®¾ æ¯ä¸ªäºº æ¯å¤©çš„æäº¤éƒ½æ˜¯å®‰å…¨çš„ï¼Œä½ ä¼šæ„è¯†åˆ° Git æ—¥å¿—ä¼šå˜å¾—å¤šä¹ˆæ··ä¹±ï¼Œä¼¼ä¹æ°¸æ’åœ°æ»šåŠ¨ç€å˜åŒ–ï¼Œå´æ²¡æœ‰ä»»ä½•è¿¹è±¡è¡¨æ˜ä¿®æ”¹äº†ä»€ä¹ˆã€‚ é‚£ä¹ˆï¼Œä½ è¯¥æ€æ ·æŸ¥çœ‹æŒ‡å®šæäº¤ä¸­æ–‡ä»¶å‘ç”Ÿå“ªäº›å˜åŒ–ï¼Ÿè¿™æ¯”ä½ æƒ³çš„å®¹æ˜“ã€‚ ","date":"2021-04-24","objectID":"/git-whatchanged/:0:0","tags":["LCTT","Git"],"title":"æŸ¥çœ‹ Git æäº¤ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–","uri":"/git-whatchanged/"},{"categories":["LCTT"],"content":"æŸ¥çœ‹æäº¤ä¸­æ–‡ä»¶å‘ç”Ÿçš„å˜åŒ–è¦æƒ³çŸ¥é“æŒ‡å®šæäº¤ä¸­å“ªäº›æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥ä½¿ç”¨ git log --raw å‘½ä»¤ã€‚è¿™æ˜¯å‘ç°ä¸€ä¸ªæäº¤å½±å“äº†å“ªäº›æ–‡ä»¶çš„æœ€å¿«é€Ÿã€æœ€æ–¹ä¾¿çš„æ–¹æ³•ã€‚git log å‘½ä»¤ä¸€èˆ¬éƒ½æ²¡æœ‰è¢«å……åˆ†åˆ©ç”¨ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒæœ‰å¤ªå¤šçš„æ ¼å¼åŒ–é€‰é¡¹ï¼Œè®¸å¤šç”¨æˆ·åœ¨é¢å¯¹å¾ˆå¤šé€‰æ‹©ä»¥åŠåœ¨ä¸€äº›æƒ…å†µä¸‹ä¸æ˜æ‰€ä»¥çš„æ–‡æ¡£æ—¶ï¼Œä¼šæœ›è€Œå´æ­¥ã€‚ ç„¶è€Œï¼ŒGit çš„æ—¥å¿—æœºåˆ¶éå¸¸çµæ´»ï¼Œ--raw é€‰é¡¹æä¾›äº†å½“å‰åˆ†æ”¯ä¸­çš„æäº¤æ—¥å¿—ï¼Œä»¥åŠæ›´æ”¹çš„æ–‡ä»¶åˆ—è¡¨ã€‚ ä»¥ä¸‹æ˜¯æ ‡å‡†çš„ git log è¾“å‡ºï¼š $ git log commit fbbbe083aed75b24f2c77b1825ecab10def0953c (HEAD -\u003e dev, origin/dev) Author: tux \u003ctux@example.com\u003e Date: Sun Nov 5 21:40:37 2020 +1300 exit immediately from failed download commit 094f9948cd995acfc331a6965032ea0d38e01f03 (origin/master, master) Author: Tux \u003ctux@example.com\u003e Date: Fri Aug 5 02:05:19 2020 +1200 export makeopts from etc/example.conf commit 76b7b46dc53ec13316abb49cc7b37914215acd47 Author: Tux \u003ctux@example.com\u003e Date: Sun Jul 31 21:45:24 2020 +1200 fix typo in help message å³ä½¿ä½œè€…åœ¨æäº¤æ¶ˆæ¯ä¸­æŒ‡å®šäº†å“ªäº›æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œæ—¥å¿—ä¹Ÿç›¸å½“ç®€æ´ã€‚ ä»¥ä¸‹æ˜¯ git log --raw è¾“å‡ºï¼š $ git log --raw commit fbbbe083aed75b24f2c77b1825ecab10def0953c (HEAD -\u003e dev, origin/dev) Author: tux \u003ctux@example.com\u003e Date: Sun Nov 5 21:40:37 2020 +1300 exit immediately from failed download :100755 100755 cbcf1f3 4cac92f M src/example.lua commit 094f9948cd995acfc331a6965032ea0d38e01f03 (origin/master, master) Author: Tux \u003ctux@example.com\u003e Date: Fri Aug 5 02:05:19 2020 +1200 export makeopts from etc/example.conf :100755 100755 4c815c0 cbcf1f3 M src/example.lua :100755 100755 71653e1 8f5d5a6 M src/example.spec :100644 100644 9d21a6f e33caba R100 etc/example.conf etc/example.conf-default commit 76b7b46dc53ec13316abb49cc7b37914215acd47 Author: Tux \u003ctux@example.com\u003e Date: Sun Jul 31 21:45:24 2020 +1200 fix typo in help message :100755 100755 e253aaf 4c815c0 M src/example.lua è¿™ä¼šå‡†ç¡®å‘Šè¯‰ä½ å“ªä¸ªæ–‡ä»¶è¢«æ·»åŠ åˆ°æäº¤ä¸­ï¼Œå“ªäº›æ–‡ä»¶å‘ç”Ÿæ”¹å˜ï¼ˆA æ˜¯æ·»åŠ ï¼ŒM æ˜¯ä¿®æ”¹ï¼ŒR æ˜¯é‡å‘½åï¼ŒD æ˜¯åˆ é™¤ï¼‰ã€‚ ","date":"2021-04-24","objectID":"/git-whatchanged/:1:0","tags":["LCTT","Git"],"title":"æŸ¥çœ‹ Git æäº¤ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–","uri":"/git-whatchanged/"},{"categories":["LCTT"],"content":"Git whatchangedgit whatchanged å‘½ä»¤æ˜¯ä¸€ä¸ªé—ç•™å‘½ä»¤ï¼Œå®ƒçš„å‰èº«æ˜¯æ—¥å¿—åŠŸèƒ½ã€‚æ–‡æ¡£è¯´ç”¨æˆ·ä¸åº”è¯¥ç”¨è¯¥å‘½ä»¤æ›¿ä»£ git log --rawï¼Œå¹¶ä¸”æš—ç¤ºå®ƒå®è´¨ä¸Šå·²ç»è¢«åºŸå¼ƒäº†ã€‚ä¸è¿‡ï¼Œæˆ‘è¿˜æ˜¯è§‰å¾—å®ƒæ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æ·å¾„ï¼Œå¯ä»¥å¾—åˆ°åŒæ ·çš„è¾“å‡ºç»“æœï¼ˆå°½ç®¡åˆå¹¶æäº¤çš„å†…å®¹ä¸åŒ…æ‹¬åœ¨å†…ï¼‰ï¼Œå¦‚æœå®ƒè¢«åˆ é™¤çš„è¯ï¼Œæˆ‘æ‰“ç®—ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªåˆ«åã€‚å¦‚æœä½ åªæƒ³æŸ¥çœ‹å·²æ›´æ”¹çš„æ–‡ä»¶ï¼Œä¸æƒ³åœ¨æ—¥å¿—ä¸­çœ‹åˆ°åˆå¹¶æäº¤ï¼Œå¯ä»¥å°è¯• git whatchanged ä½œä¸ºç®€å•çš„åŠ©è®°ç¬¦ã€‚ ","date":"2021-04-24","objectID":"/git-whatchanged/:2:0","tags":["LCTT","Git"],"title":"æŸ¥çœ‹ Git æäº¤ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–","uri":"/git-whatchanged/"},{"categories":["LCTT"],"content":"æŸ¥çœ‹å˜åŒ–ä½ ä¸ä»…å¯ä»¥çœ‹åˆ°å“ªäº›æ–‡ä»¶å‘ç”Ÿæ›´æ”¹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ git log æ˜¾ç¤ºæ–‡ä»¶ä¸­å‘ç”Ÿäº†å“ªäº›å˜åŒ–ã€‚ä½ çš„ Git æ—¥å¿—å¯ä»¥ç”Ÿæˆä¸€ä¸ªå†…è”å·®å¼‚ï¼Œç”¨ --patch é€‰é¡¹å¯ä»¥é€è¡Œæ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶çš„æ‰€æœ‰æ›´æ”¹ï¼š commit 62a2daf8411eccbec0af69e4736a0fcf0a469ab1 (HEAD -\u003e master) Author: Tux \u003cTux@example.com\u003e Date: Wed Mar 10 06:46:58 2021 +1300 commit diff --git a/hello.txt b/hello.txt index 65a56c3..36a0a7d 100644 --- a/hello.txt +++ b/hello.txt @@ -1,2 +1,2 @@ Hello -world +opensource.com åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œâ€œworldâ€ è¿™è¡Œå­—ä» hello.txt ä¸­åˆ æ‰ï¼Œâ€œopensource.comâ€ è¿™è¡Œå­—åˆ™æ·»åŠ è¿›å»ã€‚ å¦‚æœä½ éœ€è¦åœ¨å…¶ä»–åœ°æ–¹æ‰‹åŠ¨è¿›è¡Œç›¸åŒçš„ä¿®æ”¹ï¼Œè¿™äº›è¡¥ä¸patchå¯ä»¥ä¸å¸¸è§çš„ Unix å‘½ä»¤ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚ diff ä¸ patchã€‚è¡¥ä¸ä¹Ÿæ˜¯ä¸€ä¸ªå¥½æ–¹æ³•ï¼Œå¯ä»¥æ€»ç»“æŒ‡å®šæäº¤ä¸­å¼•å…¥æ–°ä¿¡æ¯çš„é‡è¦éƒ¨åˆ†å†…å®¹ã€‚å½“ä½ åœ¨å†²åˆºé˜¶æ®µå¼•å…¥ä¸€ä¸ª bug æ—¶ï¼Œä½ ä¼šå‘ç°è¿™é‡Œçš„å†…å®¹å°±æ˜¯éå¸¸æœ‰ä»·å€¼çš„æ¦‚è¿°ã€‚ä¸ºäº†æ›´å¿«åœ°æ‰¾åˆ°é”™è¯¯çš„åŸå› ï¼Œä½ å¯ä»¥å¿½ç•¥æ–‡ä»¶ä¸­æ²¡æœ‰æ›´æ”¹çš„éƒ¨åˆ†ï¼Œåªæ£€æŸ¥æ–°ä»£ç ã€‚ ","date":"2021-04-24","objectID":"/git-whatchanged/:3:0","tags":["LCTT","Git"],"title":"æŸ¥çœ‹ Git æäº¤ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–","uri":"/git-whatchanged/"},{"categories":["LCTT"],"content":"ç”¨ç®€å•å‘½ä»¤å¾—åˆ°å¤æ‚çš„ç»“æœä½ ä¸å¿…ç†è§£å¼•ç”¨ã€åˆ†æ”¯å’Œæäº¤å“ˆå¸Œï¼Œå°±å¯ä»¥æŸ¥çœ‹æäº¤ä¸­æ›´æ”¹äº†å“ªäº›æ–‡ä»¶ã€‚ä½ çš„ Git æ—¥å¿—æ—¨åœ¨å‘ä½ æŠ¥å‘Š Git çš„æ´»åŠ¨ï¼Œå¦‚æœä½ æƒ³ä»¥ç‰¹å®šæ–¹å¼æ ¼å¼åŒ–å®ƒæˆ–è€…æå–ç‰¹å®šçš„ä¿¡æ¯ï¼Œé€šå¸¸éœ€è¦è´¹åŠ›åœ°æµè§ˆè®¸å¤šæ–‡æ¡£æ¥ç»„åˆå‡ºæ­£ç¡®çš„å‘½ä»¤ã€‚å¹¸è¿çš„æ˜¯ï¼Œå…³äº Git å†å²è®°å½•æœ€å¸¸ç”¨çš„è¯·æ±‚ä¹‹ä¸€åªéœ€è¦ä¸€ä¸¤ä¸ªé€‰é¡¹ï¼š--raw ä¸ --patchã€‚å¦‚æœä½ ä¸è®°å¾— --rawï¼Œå°±æƒ³æƒ³â€œGitï¼Œä»€ä¹ˆæ”¹å˜äº†ï¼Ÿâ€ï¼Œç„¶åè¾“å…¥ git whatchangedã€‚ via: https://opensource.com/article/21/4/git-whatchanged ä½œè€…ï¼šSeth Kenlon é€‰é¢˜ï¼šlujun9972 è¯‘è€…ï¼šDCOLIVERSUN æ ¡å¯¹ï¼šwxy æœ¬æ–‡ç”± LCTT åŸåˆ›ç¼–è¯‘ï¼ŒLinuxä¸­å›½ è£èª‰æ¨å‡º ","date":"2021-04-24","objectID":"/git-whatchanged/:4:0","tags":["LCTT","Git"],"title":"æŸ¥çœ‹ Git æäº¤ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–","uri":"/git-whatchanged/"},{"categories":["LCTT"],"content":"ä¸€æ¬¾ç®€æ´ã€å¥½ç”¨çš„ Feed é˜…è¯»å™¨ï¼Œè®©ä½ åŠæ—¶è·Ÿè¿›æƒ³çœ‹çš„å†…å®¹","date":"2021-04-13","objectID":"/newsflash/","tags":["LCTT","RSS","Feed"],"title":"NewsFlash: ä¸€æ¬¾æ”¯æŒ Feedly çš„ç°ä»£å¼€æº Feed é˜…è¯»å™¨","uri":"/newsflash/"},{"categories":["LCTT"],"content":" æœ‰äº›äººå¯èƒ½è®¤ä¸º RSS é˜…è¯»å™¨å·²ç»ä¸å†ï¼Œä½†å®ƒä»¬ä»ç„¶åšæŒåœ¨è¿™é‡Œï¼Œç‰¹åˆ«æ˜¯å½“ä½ ä¸æƒ³è®©å¤§ç§‘æŠ€ç®—æ³•æ¥å†³å®šä½ åº”è¯¥é˜…è¯»ä»€ä¹ˆçš„æ—¶å€™ã€‚Feed é˜…è¯»å™¨å¯ä»¥å¸®ä½ è‡ªåŠ©é€‰æ‹©é˜…è¯»æ¥æºã€‚ æˆ‘æœ€è¿‘é‡åˆ°ä¸€ä¸ªå¾ˆæ£’çš„ RSS é˜…è¯»å™¨ NewsFlashã€‚å®ƒæ”¯æŒé€šè¿‡åŸºäºç½‘é¡µçš„ Feed é˜…è¯»å™¨å¢åŠ  feedï¼Œä¾‹å¦‚ Feedly å’Œ NewsBlurã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å®‰æ…°ï¼Œå› ä¸ºå¦‚æœä½ å·²ç»ä½¿ç”¨è¿™ç§æœåŠ¡ï¼Œå°±ä¸å¿…äººå·¥å¯¼å…¥ feedï¼Œè¿™èŠ‚çœäº†ä½ çš„å·¥ä½œã€‚ NewsFlash æ°å¥½æ˜¯ FeedReadeer çš„ç²¾ç¥ç»§æ‰¿è€…ï¼ŒåŸæ¥çš„ FeedReader å¼€å‘äººå‘˜ä¹Ÿå‚ä¸å…¶ä¸­ã€‚ å¦‚æœä½ æ­£åœ¨æ‰¾é€‚ç”¨çš„ RSS é˜…è¯»å™¨ï¼Œæˆ‘ä»¬æ•´ç†äº† Linux Feed é˜…è¯»å™¨ åˆ—è¡¨ä¾›æ‚¨å‚è€ƒã€‚ ","date":"2021-04-13","objectID":"/newsflash/:0:0","tags":["LCTT","RSS","Feed"],"title":"NewsFlash: ä¸€æ¬¾æ”¯æŒ Feedly çš„ç°ä»£å¼€æº Feed é˜…è¯»å™¨","uri":"/newsflash/"},{"categories":["LCTT"],"content":"NewsFlash: ä¸€æ¬¾è¡¥å……ç½‘é¡µ RSS é˜…è¯»å™¨è´¦æˆ·çš„ Feed é˜…è¯»å™¨ è¯·æ³¨æ„ï¼ŒNewsFlash å¹¶ä¸åªæ˜¯é’ˆå¯¹åŸºäºç½‘é¡µçš„ RSS feed è´¦æˆ·é‡èº«å®šåšçš„ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨æœ¬åœ° RSS feedï¼Œè€Œä¸å¿…åœ¨å¤šè®¾å¤‡é—´åŒæ­¥ã€‚ ä¸è¿‡ï¼Œå¦‚æœä½ åœ¨ç”¨æ˜¯ä»»ä½•ä¸€æ¬¾æ”¯æŒçš„åŸºäºç½‘é¡µçš„ feed é˜…è¯»å™¨ï¼Œé‚£ä¹ˆ NewsFlash ç‰¹åˆ«æœ‰ç”¨ã€‚ è¿™é‡Œï¼Œæˆ‘å°†é‡ç‚¹ä»‹ç» NewsFlash æä¾›çš„ä¸€äº›åŠŸèƒ½ã€‚ ","date":"2021-04-13","objectID":"/newsflash/:1:0","tags":["LCTT","RSS","Feed"],"title":"NewsFlash: ä¸€æ¬¾æ”¯æŒ Feedly çš„ç°ä»£å¼€æº Feed é˜…è¯»å™¨","uri":"/newsflash/"},{"categories":["LCTT"],"content":"NewsFlash åŠŸèƒ½ æ”¯æŒæ¡Œé¢é€šçŸ¥ å¿«é€Ÿæœç´¢ã€è¿‡æ»¤ æ”¯æŒæ ‡ç­¾ ä¾¿æ·ã€å¯é‡å®šä¹‰çš„é”®ç›˜å¿«æ·é”® æœ¬åœ° feed OPML æ–‡ä»¶å¯¼å…¥/å¯¼å‡º æ— éœ€æ³¨å†Œå³å¯åœ¨ Feedly åº“ä¸­è½»æ¾æ‰¾åˆ°ä¸åŒ RSS Feed æ”¯æŒè‡ªå®šä¹‰å­—ä½“ æ”¯æŒå¤šä¸»é¢˜ï¼ˆåŒ…æ‹¬æ·±è‰²ä¸»é¢˜ï¼‰ å¯åŠ¨/ç¦æ­¢ç¼©ç•¥å›¾ ç»†ç²’åº¦è°ƒæ•´å®šæœŸåŒæ­¥é—´éš”æ—¶é—´ æ”¯æŒåŸºäºç½‘é¡µçš„ Feed è´¦æˆ·ï¼Œä¾‹å¦‚ Feedlyã€Feverã€NewsBlurã€feedbinã€Miniflux é™¤ä¸Šè¿°åŠŸèƒ½å¤–ï¼Œå½“ä½ è°ƒæ•´çª—å£å¤§å°æ—¶ï¼Œè¿˜å¯ä»¥æ‰“å¼€é˜…è¯»å™¨è§†å›¾ï¼Œè¿™æ˜¯ä¸€ä¸ªç»†è…»çš„è¡¥å……åŠŸèƒ½ã€‚ è´¦æˆ·é‡æ–°è®¾ç½®ä¹Ÿå¾ˆå®¹æ˜“ï¼Œè¿™å°†åˆ é™¤æ‰€æœ‰æœ¬åœ°æ•°æ®ã€‚æ˜¯çš„ï¼Œä½ å¯ä»¥æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜å¹¶è®¾ç½®åˆ°æœŸæ—¶é—´ï¼Œå¹¶ä¸ºä½ å…³æ³¨çš„æ‰€æœ‰ feed è®¾ç½®ä¸€ä¸ªç”¨æˆ·æ•°æ®å­˜åœ¨æœ¬åœ°çš„åˆ°æœŸæ—¶é—´ã€‚ ","date":"2021-04-13","objectID":"/newsflash/:2:0","tags":["LCTT","RSS","Feed"],"title":"NewsFlash: ä¸€æ¬¾æ”¯æŒ Feedly çš„ç°ä»£å¼€æº Feed é˜…è¯»å™¨","uri":"/newsflash/"},{"categories":["LCTT"],"content":"åœ¨ Linux ä¸Šå®‰è£… NewsFlashä½ æ— æ³•æ‰¾åˆ°é€‚ç”¨äºå„ç§ Linux å‘è¡Œç‰ˆçš„å®˜æ–¹è½¯ä»¶åŒ…ï¼Œåªæœ‰ Flatpakã€‚ å¯¹äº Arch ç”¨æˆ·ï¼Œå¯ä»¥ä» AUR ä¸‹è½½ã€‚ å¹¸è¿çš„æ˜¯ï¼ŒFlatpak è½¯ä»¶åŒ…å¯ä»¥è®©ä½ è½»æ¾åœ¨ Linux å‘è¡Œç‰ˆä¸Šå®‰è£… NewsFlashã€‚å…·ä½“è¯·å‚é˜…æˆ‘ä»¬çš„ Flatpak æŒ‡å—ã€‚ ä½ å¯ä»¥å‚è€ƒ NewsFlash çš„ GitLab é¡µé¢ å»è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ã€‚ ","date":"2021-04-13","objectID":"/newsflash/:3:0","tags":["LCTT","RSS","Feed"],"title":"NewsFlash: ä¸€æ¬¾æ”¯æŒ Feedly çš„ç°ä»£å¼€æº Feed é˜…è¯»å™¨","uri":"/newsflash/"},{"categories":["LCTT"],"content":"ç»“æŸè¯­æˆ‘ç°åœ¨ç”¨ NewsFlash ä½œä¸ºæ¡Œé¢æœ¬åœ°è§£å†³æ–¹æ¡ˆï¼Œä¸ç”¨åŸºäºç½‘é¡µçš„æœåŠ¡ã€‚ä½ å¯ä»¥é€šè¿‡ç›´æ¥å¯¼å‡º OPML æ–‡ä»¶åœ¨ç§»åŠ¨ feed åº”ç”¨ä¸Šå¾—åˆ°ç›¸åŒçš„ feedã€‚è¿™å·²ç»è¢«æˆ‘éªŒè¯è¿‡äº†ã€‚ ç”¨æˆ·ç•Œé¢æ˜“äºä½¿ç”¨ï¼Œä¹Ÿæä¾›äº†æ•°ä¸€æ•°äºŒçš„æ–°ç‰ˆ UXã€‚è™½ç„¶è¿™ä¸ª RSS é˜…è¯»å™¨çœ‹ä¼¼ç®€å•ï¼Œä½†æä¾›äº†ä½ å¯ä»¥æ‰¾åˆ°çš„æ‰€æœ‰é‡è¦åŠŸèƒ½ã€‚ ä½ æ€ä¹ˆçœ‹ NewsFlashï¼Ÿä½ å–œæ¬¢ç”¨å…¶ä»–ç±»ä¼¼äº§å“å—ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºä¸­åˆ†äº«ä½ çš„æƒ³æ³•ã€‚ via: https://itsfoss.com/newsflash-feedreader/ ä½œè€…ï¼šAnkush Das é€‰é¢˜ï¼šlujun9972 è¯‘è€…ï¼šDCOLIVERSUN æ ¡å¯¹ï¼šwxy æœ¬æ–‡ç”± LCTT åŸåˆ›ç¼–è¯‘ï¼ŒLinuxä¸­å›½ è£èª‰æ¨å‡º ","date":"2021-04-13","objectID":"/newsflash/:4:0","tags":["LCTT","RSS","Feed"],"title":"NewsFlash: ä¸€æ¬¾æ”¯æŒ Feedly çš„ç°ä»£å¼€æº Feed é˜…è¯»å™¨","uri":"/newsflash/"},{"categories":["LCTT"],"content":"æ²¡æœ‰æäº¤åŸå§‹ Dockerfile çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡é€†å‘å·¥ç¨‹æŸ¥çœ‹é•œåƒæ„å»ºè¿‡ç¨‹ã€‚","date":"2021-04-05","objectID":"/reverse-engineering-a-docker-image/","tags":["LCTT","Docker","é€†å‘å·¥ç¨‹"],"title":"ä¸€æ¬¡ Docker é•œåƒçš„é€†å‘å·¥ç¨‹","uri":"/reverse-engineering-a-docker-image/"},{"categories":["LCTT"],"content":"è¿™è¦ä»ä¸€æ¬¡å’¨è¯¢çš„å¤±è¯¯è¯´èµ·ï¼šæ”¿åºœç»„ç»‡ A è®©æ”¿åºœç»„ç»‡ B å¼€å‘ä¸€ä¸ª Web åº”ç”¨ç¨‹åºã€‚æ”¿åºœæœºæ„ B æŠŠéƒ¨åˆ†å·¥ä½œå¤–åŒ…ç»™æŸä¸ªäººã€‚åæ¥ï¼Œé¡¹ç›®çš„æ‰˜ç®¡å’Œç»´æŠ¤è¢«å¤–åŒ…ç»™ä¸€å®¶ç§äººå…¬å¸ Cã€‚C å…¬å¸å‘ç°ï¼Œä¹‹å‰å¤–åŒ…çš„äººï¼ˆå·²ç»ç¦»å¼€å¾ˆä¹…äº†ï¼‰æ„å»ºäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ Docker é•œåƒï¼Œå¹¶å°†å…¶æˆä¸ºç³»ç»Ÿæ„å»ºçš„ä¾èµ–é¡¹ï¼Œä½†è¿™ä¸ªäººæ²¡æœ‰æäº¤åŸå§‹çš„ Dockerfileã€‚C å…¬å¸æœ‰åˆåŒä¹‰åŠ¡ç®¡ç†è¿™ä¸ª Docker é•œåƒï¼Œå¯æ˜¯ä»–ä»¬ä»–ä»¬æ²¡æœ‰æºä»£ç ã€‚C å…¬å¸å¶å°”å«æˆ‘è¿›å»åšå„ç§å·¥ä½œï¼Œæ‰€ä»¥å¤„ç†ä¸€äº›å…³äºè¿™ä¸ªç¥ç§˜ Docker é•œåƒçš„äº‹æƒ…å°±æˆäº†æˆ‘çš„å·¥ä½œã€‚ å¹¸è¿çš„æ˜¯ï¼ŒDocker é•œåƒçš„æ ¼å¼æ¯”æƒ³è±¡çš„é€æ˜å¤šäº†ã€‚è™½ç„¶è¿˜éœ€è¦åšä¸€äº›ä¾¦æŸ¥å·¥ä½œï¼Œä½†åªè¦è§£å‰–ä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œå°±èƒ½å‘ç°å¾ˆå¤šä¸œè¥¿ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª Prettier ä»£ç æ ¼å¼åŒ– çš„é•œåƒå¯ä¾›å¿«é€Ÿæµè§ˆã€‚ é¦–å…ˆï¼Œè®© Docker å®ˆæŠ¤è¿›ç¨‹daemonæ‹‰å–é•œåƒï¼Œç„¶åå°†é•œåƒæå–åˆ°æ–‡ä»¶ä¸­ï¼š docker pull tmknom/prettier:2.0.5 docker save tmknom/prettier:2.0.5 \u003e prettier.tar æ˜¯çš„ï¼Œè¯¥æ–‡ä»¶åªæ˜¯ä¸€ä¸ªå…¸å‹ tarball æ ¼å¼çš„å½’æ¡£æ–‡ä»¶ï¼š $ tar xvf prettier.tar 6c37da2ee7de579a0bf5495df32ba3e7807b0a42e2a02779206d165f55f1ba70/ 6c37da2ee7de579a0bf5495df32ba3e7807b0a42e2a02779206d165f55f1ba70/VERSION 6c37da2ee7de579a0bf5495df32ba3e7807b0a42e2a02779206d165f55f1ba70/json 6c37da2ee7de579a0bf5495df32ba3e7807b0a42e2a02779206d165f55f1ba70/layer.tar 88f38be28f05f38dba94ce0c1328ebe2b963b65848ab96594f8172a9c3b0f25b.json a9cc4ace48cd792ef888ade20810f82f6c24aaf2436f30337a2a712cd054dc97/ a9cc4ace48cd792ef888ade20810f82f6c24aaf2436f30337a2a712cd054dc97/VERSION a9cc4ace48cd792ef888ade20810f82f6c24aaf2436f30337a2a712cd054dc97/json a9cc4ace48cd792ef888ade20810f82f6c24aaf2436f30337a2a712cd054dc97/layer.tar d4f612de5397f1fc91272cfbad245b89eac8fa4ad9f0fc10a40ffbb54a356cb4/ d4f612de5397f1fc91272cfbad245b89eac8fa4ad9f0fc10a40ffbb54a356cb4/VERSION d4f612de5397f1fc91272cfbad245b89eac8fa4ad9f0fc10a40ffbb54a356cb4/json d4f612de5397f1fc91272cfbad245b89eac8fa4ad9f0fc10a40ffbb54a356cb4/layer.tar manifest.json repositories å¦‚ä½ æ‰€è§ï¼ŒDocker åœ¨å‘½åæ—¶ç»å¸¸ä½¿ç”¨å“ˆå¸Œhashã€‚æˆ‘ä»¬çœ‹çœ‹ manifest.jsonã€‚å®ƒæ˜¯ä»¥éš¾ä»¥é˜…è¯»çš„å‹ç¼© JSON å†™çš„ï¼Œä¸è¿‡ JSON ç‘å£«å†›åˆ€ jq å¯ä»¥å¾ˆå¥½åœ°æ‰“å° JSONï¼š $ jq . manifest.json [ { \"Config\": \"88f38be28f05f38dba94ce0c1328ebe2b963b65848ab96594f8172a9c3b0f25b.json\", \"RepoTags\": [ \"tmknom/prettier:2.0.5\" ], \"Layers\": [ \"a9cc4ace48cd792ef888ade20810f82f6c24aaf2436f30337a2a712cd054dc97/layer.tar\", \"d4f612de5397f1fc91272cfbad245b89eac8fa4ad9f0fc10a40ffbb54a356cb4/layer.tar\", \"6c37da2ee7de579a0bf5495df32ba3e7807b0a42e2a02779206d165f55f1ba70/layer.tar\" ] } ] è¯·æ³¨æ„ï¼Œè¿™ä¸‰ä¸ªå±‚Layerå¯¹åº”ä¸‰ä¸ªä»¥å“ˆå¸Œå‘½åçš„ç›®å½•ã€‚æˆ‘ä»¬ä»¥åå†çœ‹ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ Config é”®æŒ‡å‘çš„ JSON æ–‡ä»¶ã€‚å®ƒæœ‰ç‚¹é•¿ï¼Œæ‰€ä»¥æˆ‘åªåœ¨è¿™é‡Œè½¬å‚¨ç¬¬ä¸€éƒ¨åˆ†ï¼š $ jq . 88f38be28f05f38dba94ce0c1328ebe2b963b65848ab96594f8172a9c3b0f25b.json | head -n 20 { \"architecture\": \"amd64\", \"config\": { \"Hostname\": \"\", \"Domainname\": \"\", \"User\": \"\", \"AttachStdin\": false, \"AttachStdout\": false, \"AttachStderr\": false, \"Tty\": false, \"OpenStdin\": false, \"StdinOnce\": false, \"Env\": [ \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" ], \"Cmd\": [ \"--help\" ], \"ArgsEscaped\": true, \"Image\": \"sha256:93e72874b338c1e0734025e1d8ebe259d4f16265dc2840f88c4c754e1c01ba0a\", æœ€é‡è¦çš„æ˜¯ history åˆ—è¡¨ï¼Œå®ƒåˆ—å‡ºäº†é•œåƒä¸­çš„æ¯ä¸€å±‚ã€‚Docker é•œåƒç”±è¿™äº›å±‚å †å è€Œæˆã€‚Dockerfile ä¸­å‡ ä¹æ¯æ¡å‘½ä»¤éƒ½ä¼šå˜æˆä¸€ä¸ªå±‚ï¼Œæè¿°è¯¥å‘½ä»¤å¯¹é•œåƒæ‰€åšçš„æ›´æ”¹ã€‚å¦‚æœä½ æ‰§è¡Œ RUN script.sh å‘½ä»¤åˆ›å»ºäº† really_big_fileï¼Œç„¶åç”¨ RUN rm really_big_file å‘½ä»¤åˆ é™¤æ–‡ä»¶ï¼ŒDocker é•œåƒå®é™…ç”Ÿæˆä¸¤å±‚ï¼šä¸€ä¸ªåŒ…å« really_big_fileï¼Œä¸€ä¸ªåŒ…å« .wh.really_big_file è®°å½•æ¥åˆ é™¤å®ƒã€‚æ•´ä¸ªé•œåƒæ–‡ä»¶å¤§å°ä¸å˜ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ ä¼šç»å¸¸çœ‹åˆ°åƒ RUN script.sh \u0026\u0026 rm really_big_file è¿™æ ·çš„ Dockerfile å‘½ä»¤é“¾æ¥åœ¨ä¸€èµ·â€”â€”å®ƒä¿éšœæ‰€æœ‰æ›´æ”¹éƒ½åˆå¹¶åˆ°ä¸€å±‚ä¸­ã€‚ ä»¥ä¸‹æ˜¯è¯¥ Docker é•œåƒä¸­è®°å½•çš„æ‰€æœ‰å±‚ã€‚æ³¨æ„ï¼Œå¤§å¤šæ•°å±‚ä¸æ”¹å˜æ–‡ä»¶ç³»ç»Ÿé•œåƒï¼Œå¹¶ä¸” empty_layer æ ‡è®°ä¸º trueã€‚ä»¥ä¸‹åªæœ‰ä¸‰ä¸ªå±‚æ˜¯éç©ºçš„ï¼Œä¸æˆ‘ä»¬ä¹‹å‰æè¿°çš„ç›¸ç¬¦ã€‚ $ jq .history 88f38be28f05f38dba94ce0c1328ebe2b963b65848ab96594f8172a9c3b0f25b.json [ { \"created\": \"2020-04-24T01:05:03.608058404Z\", \"created_by\": \"/bin/sh -c #(nop) ADD file:b91adb67b670d3a6ff9463e48b7def903ed516be66fc4282d22c53e41512be49 in / \" }, { \"created\": \"2020-04-24T01:05:03.92860976Z\", \"created_by\": \"/bin/sh -c #(nop) CMD [\\\"/bin/sh\\\"]\", \"empty_layer\": true }, { \"created\": \"2020-04-29T06:34:06.617130538Z\", \"created_by\": \"/bin/sh -c #(nop) ARG BUILD_DATE\", \"empty_layer\": true }, { \"created\": \"2020-04-29T06:34:07.020521808Z\", \"created_by\": \"/bin/sh -c #(nop) ARG VCS_REF\", \"empty_layer\": true }, { \"created\": \"2020-04-29T06:34:07.36915054Z\", \"created_by\": \"/bin/sh -c #(nop) ARG VERSION\", \"empty_layer\": true }, { \"created\": \"2020-04-29T06:34:07.708820086Z\", \"created_by\": \"/bin/sh -c #(nop) ARG REPO_NAME\", \"empty_layer\": true }, { \"created\": \"2020-04-29T06:34:08.06429638Z\", \"created_by\": \"/bin/sh -c #(nop) LABEL org.label-schema.vendor=tmknom org.label-schema.name=tmknom/prettier org.label-schema.description=Pre","date":"2021-04-05","objectID":"/reverse-engineering-a-docker-image/:0:0","tags":["LCTT","Docker","é€†å‘å·¥ç¨‹"],"title":"ä¸€æ¬¡ Docker é•œåƒçš„é€†å‘å·¥ç¨‹","uri":"/reverse-engineering-a-docker-image/"},{"categories":["LCTT"],"content":"å­—å…¸æ•°æ®ç»“æ„å¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿè®¿é—®ä¿¡æ¯ã€‚","date":"2021-04-01","objectID":"/learn-python-dictionary-with-jupyter/","tags":["LCTT","Jupyter","Python","æ•°æ®ç»“æ„"],"title":"ç”¨ Jupyter å­¦ä¹  Python å­—å…¸","uri":"/learn-python-dictionary-with-jupyter/"},{"categories":["LCTT"],"content":"å­—å…¸æ˜¯ Python ç¼–ç¨‹è¯­è¨€ä½¿ç”¨çš„æ•°æ®ç»“æ„ã€‚ä¸€ä¸ª Python å­—å…¸ç”±å¤šä¸ªé”®å€¼å¯¹ç»„æˆï¼›æ¯ä¸ªé”®å€¼å¯¹å°†é”®æ˜ å°„åˆ°å…¶å…³è”çš„å€¼ä¸Šã€‚ ä¾‹å¦‚ä½ æ˜¯ä¸€åè€å¸ˆï¼Œæƒ³æŠŠå­¦ç”Ÿå§“åä¸æˆç»©å¯¹åº”èµ·æ¥ã€‚ä½ å¯ä»¥ä½¿ç”¨ Python å­—å…¸ï¼Œå°†å­¦ç”Ÿå§“åæ˜ å°„åˆ°ä»–ä»¬å…³è”çš„æˆç»©ä¸Šã€‚æ­¤æ—¶ï¼Œé”®å€¼å¯¹ä¸­é”®æ˜¯å§“åï¼Œå€¼æ˜¯å¯¹åº”çš„æˆç»©ã€‚ å¦‚æœä½ æƒ³çŸ¥é“æŸä¸ªå­¦ç”Ÿçš„è€ƒè¯•æˆç»©ï¼Œä½ å¯ä»¥ä»å­—å…¸ä¸­è®¿é—®ã€‚è¿™ç§å¿«æ·æŸ¥è¯¢æ–¹å¼å¯ä»¥ä¸ºä½ èŠ‚çœè§£ææ•´ä¸ªåˆ—è¡¨æ‰¾åˆ°å­¦ç”Ÿæˆç»©çš„æ—¶é—´ã€‚ æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•é€šè¿‡é”®è®¿é—®å¯¹åº”çš„å­—å…¸å€¼ã€‚å­¦ä¹ å‰ï¼Œè¯·ç¡®ä¿ä½ å·²ç»å®‰è£…äº† Anaconda åŒ…ç®¡ç†å™¨ å’Œ Jupyter ç¬”è®°æœ¬ã€‚ ","date":"2021-04-01","objectID":"/learn-python-dictionary-with-jupyter/:0:0","tags":["LCTT","Jupyter","Python","æ•°æ®ç»“æ„"],"title":"ç”¨ Jupyter å­¦ä¹  Python å­—å…¸","uri":"/learn-python-dictionary-with-jupyter/"},{"categories":["LCTT"],"content":"1ã€åœ¨ Jupyter ä¸­æ‰“å¼€ä¸€ä¸ªæ–°çš„ç¬”è®°æœ¬é¦–å…ˆåœ¨ Web æµè§ˆå™¨ä¸­æ‰“å¼€å¹¶è¿è¡Œ Jupyterã€‚ç„¶åï¼Œ è½¬åˆ°å·¦ä¸Šè§’çš„ â€œFileâ€ã€‚ é€‰æ‹© â€œNew Notebookâ€ï¼Œç‚¹å‡» â€œPython 3â€ã€‚ Create Jupyter notebook å¼€å§‹æ—¶ï¼Œæ–°å»ºçš„ç¬”è®°æœ¬æ˜¯æ— æ ‡é¢˜çš„ï¼Œä½ å¯ä»¥å°†å…¶é‡å‘½åä¸ºä»»ä½•åç§°ã€‚æˆ‘ä¸ºæˆ‘çš„ç¬”è®°æœ¬å–åä¸º â€œOpenSource.com Data Dictionary Tutorialâ€ã€‚ ç¬”è®°æœ¬ä¸­æ ‡æœ‰è¡Œå·çš„ä½ç½®å°±æ˜¯ä½ å†™ä»£ç çš„åŒºåŸŸï¼Œä¹Ÿæ˜¯ä½ è¾“å…¥çš„ä½ç½®ã€‚ åœ¨ macOS ä¸Šï¼Œå¯ä»¥åŒæ—¶æŒ‰ Shift + Return é”®å¾—åˆ°è¾“å‡ºã€‚åœ¨åˆ›å»ºæ–°çš„ä»£ç åŒºåŸŸå‰ï¼Œè¯·ç¡®ä¿å®Œæˆä¸Šè¿°åŠ¨ä½œï¼›å¦åˆ™ï¼Œä½ å†™çš„ä»»ä½•é™„åŠ ä»£ç å¯èƒ½æ— æ³•è¿è¡Œã€‚ ","date":"2021-04-01","objectID":"/learn-python-dictionary-with-jupyter/:1:0","tags":["LCTT","Jupyter","Python","æ•°æ®ç»“æ„"],"title":"ç”¨ Jupyter å­¦ä¹  Python å­—å…¸","uri":"/learn-python-dictionary-with-jupyter/"},{"categories":["LCTT"],"content":"2ã€æ–°å»ºä¸€ä¸ªé”®å€¼å¯¹åœ¨å­—å…¸ä¸­è¾“å…¥ä½ å¸Œæœ›è®¿é—®çš„é”®ä¸å€¼ã€‚è¾“å…¥å‰ï¼Œä½ éœ€è¦åœ¨å­—å…¸ä¸Šä¸‹æ–‡ä¸­å®šä¹‰å®ƒä»¬çš„å«ä¹‰ï¼š empty_dictionary = {} grades = { \"Kelsey\": 87, \"Finley\": 92 } one_line = {a: 1, b: 2} Code for defining key-value pairs in the dictionary è¿™æ®µä»£ç è®©å­—å…¸å°†ç‰¹å®šé”®ä¸å…¶å„è‡ªçš„å€¼å…³è”èµ·æ¥ã€‚å­—å…¸æŒ‰åç§°å­˜å‚¨æ•°æ®ï¼Œä»è€Œå¯ä»¥æ›´å¿«åœ°æŸ¥è¯¢ã€‚ ","date":"2021-04-01","objectID":"/learn-python-dictionary-with-jupyter/:2:0","tags":["LCTT","Jupyter","Python","æ•°æ®ç»“æ„"],"title":"ç”¨ Jupyter å­¦ä¹  Python å­—å…¸","uri":"/learn-python-dictionary-with-jupyter/"},{"categories":["LCTT"],"content":"3ã€é€šè¿‡é”®è®¿é—®å­—å…¸å€¼ç°åœ¨ä½ æƒ³æŸ¥è¯¢æŒ‡å®šçš„å­—å…¸å€¼ï¼›åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå­—å…¸å€¼æŒ‡ç‰¹å®šå­¦ç”Ÿçš„æˆç»©ã€‚é¦–å…ˆï¼Œç‚¹å‡» â€œInsertâ€ åé€‰æ‹© â€œInsert Cell Belowâ€ã€‚ Inserting a new cell in Jupyter åœ¨æ–°å•å…ƒæ ¼ä¸­ï¼Œå®šä¹‰å­—å…¸ä¸­çš„é”®ä¸å€¼ã€‚ ç„¶åï¼Œå‘Šè¯‰å­—å…¸æ‰“å°è¯¥å€¼çš„é”®ï¼Œæ‰¾åˆ°éœ€è¦çš„å€¼ã€‚ä¾‹å¦‚ï¼ŒæŸ¥è¯¢åä¸º Kelsey çš„å­¦ç”Ÿçš„æˆç»©ï¼š # è®¿é—®å­—å…¸ä¸­çš„æ•°æ® grades = { \"Kelsey\": 87, \"Finley\": 92 } print(grades[\"Kelsey\"]) 87 Code to look for a specific value å½“ä½ æŸ¥è¯¢ Kelsey çš„æˆç»©ï¼ˆä¹Ÿå°±æ˜¯ä½ æƒ³è¦æŸ¥è¯¢çš„å€¼ï¼‰æ—¶ï¼Œå¦‚æœä½ ç”¨çš„æ˜¯ macOSï¼Œåªéœ€è¦åŒæ—¶æŒ‰ Shift+Return é”®ã€‚ ä½ ä¼šåœ¨å•å…ƒæ ¼ä¸‹æ–¹çœ‹åˆ° Kelsey çš„æˆç»©ã€‚ ","date":"2021-04-01","objectID":"/learn-python-dictionary-with-jupyter/:3:0","tags":["LCTT","Jupyter","Python","æ•°æ®ç»“æ„"],"title":"ç”¨ Jupyter å­¦ä¹  Python å­—å…¸","uri":"/learn-python-dictionary-with-jupyter/"},{"categories":["LCTT"],"content":"4ã€æ›´æ–°å·²æœ‰çš„é”®å½“æŠŠä¸€ä½å­¦ç”Ÿçš„é”™è¯¯æˆç»©æ·»åŠ åˆ°å­—å…¸æ—¶ï¼Œä½ ä¼šæ€ä¹ˆåŠï¼Ÿå¯ä»¥é€šè¿‡æ›´æ–°å­—å…¸ã€å­˜å‚¨æ–°å€¼æ¥ä¿®æ­£è¿™ç±»é”™è¯¯ã€‚ é¦–å…ˆï¼Œé€‰æ‹©ä½ æƒ³æ›´æ–°çš„é‚£ä¸ªé”®ã€‚åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå‡è®¾ä½ é”™è¯¯åœ°è¾“å…¥äº† Finley çš„æˆç»©ï¼Œé‚£ä¹ˆ Finley å°±æ˜¯ä½ éœ€è¦æ›´æ–°çš„é”®ã€‚ ä¸ºäº†æ›´æ–° Finley çš„æˆç»©ï¼Œä½ éœ€è¦åœ¨ä¸‹æ–¹æ’å…¥æ–°çš„å•å…ƒæ ¼ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„é”®å€¼å¯¹ã€‚åŒæ—¶æŒ‰ Shift+Return é”®æ‰“å°å­—å…¸å…¨éƒ¨ä¿¡æ¯ï¼š grades[\"Finley\"] = 90 print(grades) {'Kelsey': 87; \"Finley\": 90} Code for updating a key å•å…ƒæ ¼ä¸‹æ–¹è¾“å‡ºå¸¦æœ‰ Finley æ›´æ–°æˆç»©çš„å­—å…¸ã€‚ ","date":"2021-04-01","objectID":"/learn-python-dictionary-with-jupyter/:4:0","tags":["LCTT","Jupyter","Python","æ•°æ®ç»“æ„"],"title":"ç”¨ Jupyter å­¦ä¹  Python å­—å…¸","uri":"/learn-python-dictionary-with-jupyter/"},{"categories":["LCTT"],"content":"5ã€æ·»åŠ æ–°é”®å‡è®¾ä½ å¾—åˆ°ä¸€ä½æ–°å­¦ç”Ÿçš„è€ƒè¯•æˆç»©ã€‚ä½ å¯ä»¥ç”¨æ–°é”®å€¼å¯¹å°†é‚£åå­¦ç”Ÿçš„å§“åä¸æˆç»©è¡¥å……åˆ°å­—å…¸ä¸­ã€‚ æ’å…¥æ–°çš„å•å…ƒæ ¼ï¼Œä»¥é”®å€¼å¯¹å½¢å¼æ·»åŠ æ–°å­¦ç”Ÿçš„å§“åä¸æˆç»©ã€‚å½“ä½ å®Œæˆè¿™äº›åï¼ŒåŒæ—¶æŒ‰ Shift+Return é”®æ‰“å°å­—å…¸å…¨éƒ¨ä¿¡æ¯ï¼š grades[\"Alex\"] = 88 print(grades) {'Kelsey': 87, 'Finley': 90, 'Alex': 88} Add a new key æ‰€æœ‰çš„é”®å€¼å¯¹è¾“å‡ºåœ¨å•å…ƒæ ¼ä¸‹æ–¹ã€‚ ","date":"2021-04-01","objectID":"/learn-python-dictionary-with-jupyter/:5:0","tags":["LCTT","Jupyter","Python","æ•°æ®ç»“æ„"],"title":"ç”¨ Jupyter å­¦ä¹  Python å­—å…¸","uri":"/learn-python-dictionary-with-jupyter/"},{"categories":["LCTT"],"content":"ä½¿ç”¨å­—å…¸è¯·è®°ä½ï¼Œé”®ä¸å€¼å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹ï¼Œä½†å®ƒä»¬å¾ˆå°‘æ˜¯æ‰©å±•æ•°æ®ç±»å‹non-primitive typesã€‚æ­¤å¤–ï¼Œå­—å…¸ä¸èƒ½ä»¥æŒ‡å®šçš„é¡ºåºå­˜å‚¨ã€ç»„ç»‡é‡Œé¢çš„æ•°æ®ã€‚å¦‚æœä½ æƒ³è¦æ•°æ®æœ‰åºï¼Œæœ€å¥½ä½¿ç”¨ Python åˆ—è¡¨ï¼Œè€Œéå­—å…¸ã€‚ å¦‚æœä½ è€ƒè™‘ä½¿ç”¨å­—å…¸ï¼Œé¦–å…ˆè¦ç¡®è®¤ä½ çš„æ•°æ®ç»“æ„æ˜¯å¦æ˜¯åˆé€‚çš„ï¼Œä¾‹å¦‚åƒç”µè¯ç°¿çš„ç»“æ„ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ—è¡¨ã€å…ƒç»„ã€æ ‘æˆ–è€…å…¶ä»–æ•°æ®ç»“æ„å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ via: https://opensource.com/article/21/3/dictionary-values-python ä½œè€…ï¼šLauren Maffeo é€‰é¢˜ï¼šlujun9972 è¯‘è€…ï¼šDCOLIVERSUN æ ¡å¯¹ï¼šwxy æœ¬æ–‡ç”± LCTT åŸåˆ›ç¼–è¯‘ï¼ŒLinuxä¸­å›½ è£èª‰æ¨å‡º ","date":"2021-04-01","objectID":"/learn-python-dictionary-with-jupyter/:6:0","tags":["LCTT","Jupyter","Python","æ•°æ®ç»“æ„"],"title":"ç”¨ Jupyter å­¦ä¹  Python å­—å…¸","uri":"/learn-python-dictionary-with-jupyter/"},{"categories":null,"content":" å„ä½çœ‹å®˜ï¼Œå¦‚æœæœ¬ç«™å†…å®¹å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œæ¬¢è¿èµåŠ©æˆ‘ä¸€æ¯å’–å•¡â˜•ï¸ æ¯•ç«Ÿï¼Œæ¥éƒ½æ¥äº† ğŸ˜ æ”¯ä»˜å® å¾®ä¿¡æ”¯ä»˜ ","date":"2021-03-31","objectID":"/donate/:0:0","tags":null,"title":"Donate","uri":"/donate/"},{"categories":["LCTT"],"content":"å¼€å¯æŠ€æœ¯ç¿»è¯‘é“è·¯","date":"2021-03-31","objectID":"/lctt-foreword/","tags":["LCTT","å¼€æº"],"title":"LCTTé¡¹ç›®åºè¨€","uri":"/lctt-foreword/"},{"categories":["LCTT"],"content":"ä»€ä¹ˆæ˜¯LCTTLCTT æ˜¯ â€œLinuxä¸­å›½â€ çš„ç¿»è¯‘ç»„ï¼Œè´Ÿè´£ä»å›½å¤–ä¼˜ç§€åª’ä½“ç¿»è¯‘ Linux ç›¸å…³çš„æŠ€æœ¯ã€èµ„è®¯ã€æ‚æ–‡ç­‰å†…å®¹ã€‚ ","date":"2021-03-31","objectID":"/lctt-foreword/:1:0","tags":["LCTT","å¼€æº"],"title":"LCTTé¡¹ç›®åºè¨€","uri":"/lctt-foreword/"},{"categories":["LCTT"],"content":"åŠ å…¥ LCTT çš„åˆè¡·å‰ä¸ä¹…æˆ‘å‚ä¸äº†ã€ŠOn Java 8ã€‹çš„ç¿»è¯‘å·¥ä½œã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘éœ€è¦æŸ¥è¯¢å¾ˆå¤šä¸“ä¸šåè¯çš„ç¿»è¯‘ï¼Œå¾€å¾€çº ç»“å¥å­ä¸­ä¸ªåˆ«å•è¯æ€ä¹ˆç¿»è¯‘æ¯”è¾ƒå¥½ã€‚è™½ç„¶æœ‰ç—›è‹¦ï¼Œä½†ä¹Ÿä¸ºæˆ‘å¸¦æ¥æ¬¢ä¹ã€‚æˆ‘çƒ­è¡·äºæ£æ‘©ä½œè€…çš„è¡¨è¾¾æ„å›¾ï¼Œå¸¸å¸¸æƒ³ä»–æ˜¯åœ¨æ€æ ·çš„æŠ€æœ¯å‚¨å¤‡ä¸‹å†™å‡ºè¿™æœ¬ä¹¦ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œåœ¨ç¿»è¯‘è¿‡ç¨‹ä¸­æˆ‘å¯¹ Java æœ‰äº†æ–°çš„è®¤è¯†ï¼Œè€Œè¿™äº›è®¤è¯†ä¹Ÿæ˜¯æˆ‘ä¹‹å‰çœ‹ä¸­æ–‡æ–‡çŒ®æ—¶ç–‘æƒ‘çš„ç‚¹ã€‚ ä¸éš¾çœ‹å‡ºï¼Œè¿™æ¬¡ç¿»è¯‘å·¥ä½œä¸ºæˆ‘å¸¦æ¥äº†æŠ€æœ¯ä¸Šçš„æˆé•¿ï¼Œä¹Ÿè®©æˆ‘çœ‹åˆ°ä¸ªäººçš„èƒ½åŠ›ä¸è¶³ã€‚è¯»ç ”æœŸé—´ï¼Œå¯¼å¸ˆè®©æˆ‘é˜…è¯»åŸå§‹æ–‡çŒ®ï¼Œé¿å…å—åˆ°ç¿»è¯‘è½¯ä»¶ã€è¯‘è€…çš„å¹²æ‰°ï¼Œç›´æ¥å­¦ä¹ ä½œè€…è¡¨è¾¾çš„å†…å®¹ã€‚æˆ‘æƒ³ï¼Œåœ¨æœªæ¥çš„å·¥ä½œä¸­ï¼Œæˆ‘çš„é˜…è¯»ä¾§é‡ç‚¹ä¹Ÿåº”è¯¥å€¾å‘äºåŸå§‹æ–‡çŒ®ã€‚äºæ˜¯ï¼Œæˆ‘å¼€å§‹æŸ¥æ‰¾å›½å†…æœ‰æ²¡æœ‰ä¼˜ç§€çš„å›½å¤–æ–‡çŒ®é˜…è¯»ã€å­¦ä¹ çš„ç¤¾åŒºï¼ŒLCTT å°±æ˜¯è¿™ä¸ªæ—¶å€™æ˜ å…¥æˆ‘çš„çœ¼å¸˜ã€‚ LCTT ç¤¾åŒºä¸­çš„æ–‡ç« ç”±ä¸“ä¸šçš„é€‰é¢˜äººå‘˜é€‰æ‹©ï¼Œä¸€èˆ¬ä¸ºæŠ€æœ¯è®¿è°ˆã€åšå®¢ç­‰ã€‚åæœŸç”±è¯‘è€…ç¿»è¯‘ã€æ ¡å¯¹äººå‘˜å®¡æ ¸åå†å‘å¸ƒåˆ° Linuxä¸­å›½ç¤¾åŒºã€‚æˆ‘ä½œä¸ºè¯‘è€…å‚ä¸ç¤¾åŒºå·¥ä½œï¼Œé€‰æ‹©è‡ªå·±æ„Ÿå…´è¶£çš„æ–‡ç« ï¼Œç¿»è¯‘åæäº¤ç»™ç¤¾åŒºã€‚æˆ‘çš„å·¥ä½œè®©æˆ‘è§è¯†åˆ°å›½å¤–ä¼˜ç§€çš„æŠ€æœ¯æ–‡ç« ï¼Œå®ƒä»¬ä»‹ç»äº†å®ç”¨çš„ä»£ç å·¥å…·ã€ç¿”å®çš„æŠ€æœ¯æ€»ç»“ã€å®Œæ•´çš„è°ƒè¯•è¿‡ç¨‹ï¼Œè¿™äº›éƒ½å¯ä»¥æ‹“å®½æˆ‘çš„æŠ€æœ¯è§†é‡ï¼Œæå‡æˆ‘çš„æŠ€æœ¯å®åŠ›ã€‚åŒæ—¶ï¼Œæˆ‘ä¹Ÿå¸Œæœ›æˆ‘çš„å·¥ä½œèƒ½ä¸ºå›½å†…çš„å¼€å‘è€…æä¾›ä¸€äº›å¸®åŠ©ï¼Œè®©å¤§å®¶åœ¨æŠ€æœ¯åˆ†äº«ä¸­å…±åŒè¿›æ­¥ã€‚ ","date":"2021-03-31","objectID":"/lctt-foreword/:2:0","tags":["LCTT","å¼€æº"],"title":"LCTTé¡¹ç›®åºè¨€","uri":"/lctt-foreword/"},{"categories":["LCTT"],"content":"æˆ‘çš„å·¥ä½œå±•ç¤ºæ¬¢è¿å¤§å®¶è®¿é—®æˆ‘çš„ LCTT ä¸»é¡µ ğŸ‘‰ Qian.Sun æˆ‘è´Ÿè´£çš„æ‰€æœ‰æ–‡ç« å‡åœ¨ä¸»é¡µä¸­åˆ—å‡º ","date":"2021-03-31","objectID":"/lctt-foreword/:3:0","tags":["LCTT","å¼€æº"],"title":"LCTTé¡¹ç›®åºè¨€","uri":"/lctt-foreword/"},{"categories":["LCTT"],"content":"ç‰¹åˆ«è¯´æ˜ æœ¬åšå®¢ä¸­ LCTT ä¸“æ ä»…è½¬è½½æœ¬äººç¿»è¯‘çš„æ–‡ç« ï¼› ç¿»è¯‘å·¥ä½œå’Œè¯‘æ–‡å‘è¡¨ä»…ç”¨äºå­¦ä¹ å’Œäº¤æµç›®çš„ï¼› ç¿»è¯‘å·¥ä½œéµç…§ CC-BY-NC-SA åè®®è§„å®šï¼Œå¦‚æœæˆ‘çš„å·¥ä½œæœ‰ä¾µçŠ¯åˆ°æ‚¨çš„æƒç›Šï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ï¼› è½¬è½½æ•¬è¯·åœ¨æ­£æ–‡ä¸­æ ‡æ³¨å¹¶ä¿ç•™åŸæ–‡/è¯‘æ–‡é“¾æ¥å’Œä½œè€…/è¯‘è€…ç­‰ä¿¡æ¯ï¼› LCTT ä¸“æ å†…æ‰€æœ‰è¯‘æ–‡ç”± LCTT åŸåˆ›ç¿»è¯‘ï¼ŒLinux ä¸­å›½é¦–å‘ã€‚ ","date":"2021-03-31","objectID":"/lctt-foreword/:4:0","tags":["LCTT","å¼€æº"],"title":"LCTTé¡¹ç›®åºè¨€","uri":"/lctt-foreword/"},{"categories":null,"content":"æˆ‘æ˜¯è°å¤§å®¶å¥½ï¼ğŸ‘ æˆ‘æ˜¯Qian Sunã€‚å¦‚ä»Šå±…ä½åœ¨åŒ—äº¬ã€‚ ç°åœ¨åœ¨é˜¿é‡Œäº‘ä»äº‹æ•°æ®åº“å¼€å‘å·¥ä½œã€‚ ç ”ç©¶ç”Ÿå°±è¯»äºä¸­å›½ç§‘å­¦é™¢è®¡ç®—æŠ€æœ¯ç ”ç©¶æ‰€ï¼Œè·å¾—äº†ç¡•å£«å­¦ä½ã€‚æœ¬ç§‘å°±è¯»å¤§è¿æµ·äº‹å¤§å­¦ï¼Œè·å¾—äº†å·¥å­¦å­¦å£«å­¦ä½ã€‚ ","date":"2021-03-30","objectID":"/about/:0:1","tags":null,"title":"About me","uri":"/about/"},{"categories":null,"content":"åšå®¢ä¼šæœ‰å“ªäº›å†…å®¹åšå®¢ä¸­ä¼šåˆ†äº«æˆ‘å¯¹è®¡ç®—æœºæŠ€æœ¯çš„æ•´ç†ä¸è§è§£ã€æˆ‘åœ¨èŒåœºä¸­çš„æˆé•¿ä¸æ„Ÿæ‚Ÿã€‚ è¿˜ä¼šæœ‰æˆ‘å¯¹å‰æ²¿è®ºæ–‡çš„è§£è¯»ã€å¯¹å¤§å‹å·¥ç¨‹çš„æºç å‰–æã€‚ ","date":"2021-03-30","objectID":"/about/:0:2","tags":null,"title":"About me","uri":"/about/"},{"categories":null,"content":"æ²Ÿé€šäº¤æµæœ€é‡è¦æˆ‘ååˆ†æœŸå¾…ä½ çš„åé¦ˆï¼:) å¦‚æœä½ ä¸è®¤åŒæˆ‘åšå®¢ä¸­çš„å†…å®¹ï¼Œä¸€å®šè¦è”ç³»æˆ‘ï¼è®©æˆ‘ä»¬åœ¨æ²Ÿé€šä¸­å…±åŒæˆé•¿è¿›æ­¥ï¼ å¯ä»¥é€šè¿‡é¦–é¡µä¸­å±•ç¤ºçš„ä»»ä½•æ¸ é“è”ç³»åˆ°æˆ‘â˜ï¸ ","date":"2021-03-30","objectID":"/about/:0:3","tags":null,"title":"About me","uri":"/about/"},{"categories":null,"content":"æˆ‘çš„åˆ†äº«æˆ‘ä¼šåˆ—å‡ºæˆ‘æœ€è¿‘çš„åæ¬¡åˆ†äº«(å¯èƒ½ä¹Ÿæ²¡æœ‰åæ¬¡ğŸ˜…) æ ‡é¢˜ æ´»åŠ¨ åœ°ç‚¹ æ—¶é—´ é“¾æ¥ è½»æ¾è¿›å¤§å‚çš„ç®€å•æ–¹æ³• æˆ‘æŠŠç»éªŒç•™ä¸‹æ¥ ä¸­ç§‘é™¢è®¡ç®—æ‰€ 2021.2.27 Slide ","date":"2021-03-30","objectID":"/about/:0:4","tags":null,"title":"About me","uri":"/about/"},{"categories":null,"content":"æ¨èçš„åšå®¢æˆ‘ä¼šåˆ—å‡ºä¼˜ç§€çš„æŠ€æœ¯åšå®¢ğŸ“ï¼Œè¿™äº›åšä¸»éƒ½æ˜¯æˆ‘å­¦ä¹ çš„æ¦œæ ·ã€‚ä»–ä»¬çš„æŠ€æœ¯å®åŠ›ä¸å·¥ä½œå±¥å†ååˆ†ç²¾å½©ã€‚ Cizixs ice1000 io-meter ","date":"2021-03-30","objectID":"/about/:0:5","tags":null,"title":"About me","uri":"/about/"},{"categories":null,"content":"ç®€å†æˆ‘ä¼šä¸å®šæœŸæ›´æ–°æˆ‘çš„ç®€å†ï¼Œå¤§å®¶å¯ä»¥å…³æ³¨æˆ‘çš„é¢†è‹±: Qian Sun ","date":"2021-03-30","objectID":"/about/:0:6","tags":null,"title":"About me","uri":"/about/"},{"categories":["Java"],"content":"æœ¬æ–‡ä»‹ç»äº† Java çº¿ç¨‹æ± ä¸­æ‰€æœ‰å‚æ•°é…ç½®é¡¹ä¸è¦æ±‚ï¼Œé’ˆå¯¹ä¸åŒä¸šåŠ¡åœºæ™¯æä¾›å¯¹åº”çš„é…ç½®å»ºè®®","date":"2021-03-30","objectID":"/java-concurrency-3/","tags":["Java","å¹¶å‘"],"title":"é…ç½® Java çº¿ç¨‹æ± ","uri":"/java-concurrency-3/"},{"categories":["Java"],"content":"é…ç½®çº¿ç¨‹æ± å¤§å°çº¿ç¨‹æ± çš„ç†æƒ³å¤§å°å–å†³äºè¢«æäº¤ä»»åŠ¡çš„ç±»å‹ä»¥åŠæ‰€éƒ¨ç½²ç³»ç»Ÿçš„ç‰¹æ€§ã€‚åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œé€šå¸¸ä¸ä¼šå›ºå®šçº¿ç¨‹æ± å¤§å°ï¼Œåº”è¯¥é€šè¿‡æŸç§é…ç½®æœºåˆ¶æ¥æä¾›ï¼Œæˆ–è€…æ ¹æ® Runtime.availableProcessors æ¥åŠ¨æ€è®¡ç®—ã€‚ åœ¨é…ç½®çº¿ç¨‹æ± å¤§å°æ—¶ï¼Œåº”è¯¥é¿å…â€œè¿‡å¤§â€å’Œâ€œè¿‡å°â€è¿™ä¸¤ç§æç«¯æƒ…å†µã€‚å¦‚æœçº¿ç¨‹æ± è¿‡å¤§ï¼Œé‚£ä¹ˆå¤§é‡çš„çº¿ç¨‹å°†åœ¨ç›¸å¯¹å¾ˆå°‘çš„ CPU å’Œå†…å­˜èµ„æºä¸Šå‘ç”Ÿç«äº‰ï¼Œä¸ä»…æ¶ˆè€—æ›´é«˜çš„å†…å­˜ï¼Œè€Œä¸”è¿˜å¯èƒ½è€—å°½èµ„æºã€‚å¦‚æœçº¿ç¨‹æ± è¿‡å°ï¼Œå°†å¯¼è‡´è®¸å¤šç©ºé—²å¤„ç†å™¨æ— æ³•æ‰§è¡Œå·¥ä½œï¼Œä»è€Œé™ä½ååç‡ã€‚ å¯¹äºè®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡ï¼Œåœ¨æ‹¥æœ‰ $N_{cpu}$ ä¸ªå¤„ç†å™¨ç³»ç»Ÿä¸Šï¼Œå½“çº¿ç¨‹æ± çš„å¤§å°ä¸º $N_{cpu}+1$ æ—¶ï¼Œé€šå¸¸èƒ½å®ç°æœ€ä¼˜çš„åˆ©ç”¨ç‡ã€‚ å¯¹äºåŒ…å« I/O æ“ä½œæˆ–è€…å…¶ä»–é˜»å¡æ“ä½œçš„ä»»åŠ¡ï¼Œç”±äºçº¿ç¨‹å¹¶ä¸ä¼šä¸€ç›´æ‰§è¡Œï¼Œå› æ­¤çº¿ç¨‹æ± çš„è§„æ¨¡åº”è¯¥æ›´å¤§ã€‚è¦æ­£ç¡®è®¾ç½®çº¿ç¨‹æ± å¤§å°ï¼Œä½ å¿…é¡»ä¼°ç®—å‡ºä»»åŠ¡çš„ç­‰å¾…æ—¶é—´ä¸è®¡ç®—æ—¶é—´çš„æ¯”å€¼ã€‚è¿™ç§ä¼°ç®—ä¸éœ€è¦å¾ˆç²¾ç¡®ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ä¸€äº›åˆ†ææˆ–ç›‘æ§å·¥å…·æ¥è·å¾—ã€‚ è¦ä½¿å¤„ç†å™¨è¾¾åˆ°æœŸæœ›çš„ä½¿ç”¨ç‡ï¼Œçº¿ç¨‹æ± çš„æœ€ä¼˜å¤§å°ç­‰äºï¼š $$N_{threads}=N_{cpu}\\times U_{cpu}\\times \\left( 1+\\frac{W}{C} \\right)$$ å¼ä¸­ï¼Œ$N_{cpu}$ ä»£è¡¨ CPU çš„æ•°é‡ï¼Œ$U_{cpu}$ ä»£è¡¨ CPU ç›®æ ‡åˆ©ç”¨ç‡ï¼Œ$U_{cpu}\\in [0,1]$ï¼Œ$\\frac{W}{C}$ ä»£è¡¨ç­‰å¾…æ—¶é—´ä¸è®¡ç®—æ—¶é—´çš„æ¯”å€¼ã€‚ å¯ä»¥é€šè¿‡ Runtime æ¥è·å¾— CPU çš„æ•°ç›®ï¼š int N_CPUS = Runtime.getRuntime().availableProcessors(); CPU å‘¨æœŸå¹¶ä¸æ˜¯å”¯ä¸€å½±å“çº¿ç¨‹æ± å¤§å°çš„èµ„æºï¼Œè¿˜åŒ…æ‹¬å†…å­˜ã€æ–‡ä»¶å¥æŸ„ã€å¥—æ¥å­—å¥æŸ„å’Œæ•°æ®åº“è¿æ¥ç­‰ã€‚è®¡ç®—è¿™äº›èµ„æºå¯¹çº¿ç¨‹æ± çš„çº¦æŸæ¡ä»¶æ˜¯æ›´å®¹æ˜“çš„ï¼š è®¡ç®—æ¯ä¸ªä»»åŠ¡å¯¹è¯¥èµ„æºçš„éœ€æ±‚é‡ï¼› ç”¨è¯¥èµ„æºçš„å¯ç”¨æ€»é‡é™¤ä»¥æ¯ä¸ªä»»åŠ¡çš„éœ€æ±‚é‡ï¼Œæ‰€å¾—ç»“æœå°±æ˜¯çº¿ç¨‹æ± å¤§å°ä¸Šé™ã€‚ ","date":"2021-03-30","objectID":"/java-concurrency-3/:1:0","tags":["Java","å¹¶å‘"],"title":"é…ç½® Java çº¿ç¨‹æ± ","uri":"/java-concurrency-3/"},{"categories":["Java"],"content":"é…ç½® ThreadPoolExecutor public ThreadPoolExecutor (int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue\u003cRunnable\u003e workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler) { ... } ","date":"2021-03-30","objectID":"/java-concurrency-3/:2:0","tags":["Java","å¹¶å‘"],"title":"é…ç½® Java çº¿ç¨‹æ± ","uri":"/java-concurrency-3/"},{"categories":["Java"],"content":"çº¿ç¨‹çš„åˆ›å»ºä¸é”€æ¯ä»¥ä¸‹ä¸‰ä¸ªå‚æ•°ä¸»è¦è´Ÿè´£çº¿ç¨‹çš„åˆ›å»ºä¸é”€æ¯ï¼š corePoolSizeï¼Œçº¿ç¨‹æ± åŸºæœ¬å¤§å°ï¼Œå³åœ¨æ²¡æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶çº¿ç¨‹æ± çš„å¤§å°ï¼Œå¹¶ä¸”åªæœ‰åœ¨å·¥ä½œé˜Ÿåˆ—æ»¡äº†çš„æƒ…å†µä¸‹æ‰ä¼šåˆ›å»ºè¶…å‡ºè¿™ä¸ªæ•°é‡çš„çº¿ç¨‹ã€‚ maximumPoolSizeï¼Œçº¿ç¨‹æ± æœ€å¤§å¤§å°ï¼Œè¡¨ç¤ºå¯åŒæ—¶æ´»åŠ¨çš„çº¿ç¨‹æ•°é‡çš„ä¸Šé™ã€‚ keepAliveTimeï¼Œçº¿ç¨‹æ± å­˜æ´»æ—¶é—´ã€‚å¦‚æœæŸä¸ªçº¿ç¨‹çš„ç©ºé—²æ—¶é—´è¶…è¿‡äº†å­˜æ´»æ—¶é—´ï¼Œé‚£ä¹ˆå°†è¢«æ ‡è®°ä¸ºå¯å›æ”¶çš„ã€‚ çº¿ç¨‹æ± çš„åŸºæœ¬å¤§å°ã€æœ€å¤§å¤§å°å’Œå­˜å‚¨æ—¶é—´ç­‰å› ç´ å…±åŒè´Ÿè´£çº¿ç¨‹çš„åˆ›å»ºä¸é”€æ¯ã€‚å½“çº¿ç¨‹æ± çš„å½“å‰å¤§å°è¶…è¿‡äº†åŸºæœ¬å¤§å°æ—¶ï¼Œè¢«æ ‡è®°ä¸ºå¯å›æ”¶çš„çº¿ç¨‹å°†è¢«ç»ˆæ­¢ã€‚é€šè¿‡è°ƒèŠ‚åŸºæœ¬å¤§å°å’Œå­˜æ´»æ—¶é—´ï¼Œå¯ä»¥å¸®åŠ©çº¿ç¨‹æ± å›æ”¶ç©ºé—²çº¿ç¨‹å æœ‰çš„èµ„æºï¼Œä»è€Œä½¿å¾—è¿™äº›èµ„æºå¯ä»¥ç”¨äºæ‰§è¡Œå…¶ä»–å·¥ä½œã€‚ ","date":"2021-03-30","objectID":"/java-concurrency-3/:2:1","tags":["Java","å¹¶å‘"],"title":"é…ç½® Java çº¿ç¨‹æ± ","uri":"/java-concurrency-3/"},{"categories":["Java"],"content":"ç®¡ç†é˜Ÿåˆ—ä»»åŠ¡ThreadPoolExecutor å…è®¸æä¾›ä¸€ä¸ª BlockingQueue æ¥ä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚åŸºæœ¬çš„ä»»åŠ¡æ’é˜Ÿæ–¹æ³•æœ‰ 3 ç§ï¼šæ— ç•Œé˜Ÿåˆ—ã€æœ‰ç•Œé˜Ÿåˆ—å’ŒåŒæ­¥ç§»äº¤ï¼ˆSynchronous Handoffï¼‰ã€‚ ArrayBlockingQueueï¼šä¸€ä¸ªåŸºäºæ•°ç»„ç»“æ„çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼ŒæŒ‰ç…§ FIFO åŸåˆ™å¯¹ä»»åŠ¡è¿›è¡Œæ’åºï¼› LinkedBlockingQueueï¼šä¸€ä¸ªåŸºäºé“¾è¡¨ç»“æ„çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼ŒæŒ‰ç…§ FIFO åŸåˆ™æ’åºä»»åŠ¡ï¼Œååé‡é€šå¸¸è¦é«˜äº ArrayBlockingQueueã€‚ SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„çº¿ç¨‹é—´åŒæ­¥ç§»äº¤ï¼Œè¦å°†ä¸€ä¸ªå…ƒç´ æ”¾å…¥ SynchronousQueue ä¸­ï¼Œå¿…é¡»æœ‰å¦ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ç­‰å¾…æ¥å—è¿™ä¸ªå…ƒç´ ã€‚å¦‚æœæ²¡æœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾…ï¼Œå¹¶ä¸”çº¿ç¨‹æ± çš„å½“å‰å¤§å°å°äºæœ€å¤§å€¼ï¼Œé‚£ä¹ˆ ThreadPoolExecutor å°†åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œå¦åˆ™æ ¹æ®é¥±å’Œç­–ç•¥ï¼Œè¿™ä¸ªä»»åŠ¡è¢«æ‹’ç»ã€‚ PriorityBlockingQueueï¼šä¸€ä¸ªå…·æœ‰ä¼˜å…ˆçº§çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œè¿™ä¸ªé˜Ÿåˆ—æ ¹æ®ä¼˜å…ˆçº§æ¥å®‰æ’ä»»åŠ¡ï¼Œä»»åŠ¡çš„ä¼˜å…ˆçº§æ˜¯é€šè¿‡è‡ªç„¶é¡ºåºæˆ– Comparator æ¥å®šä¹‰çš„ã€‚ ","date":"2021-03-30","objectID":"/java-concurrency-3/:2:2","tags":["Java","å¹¶å‘"],"title":"é…ç½® Java çº¿ç¨‹æ± ","uri":"/java-concurrency-3/"},{"categories":["Java"],"content":"é¥±å’Œç­–ç•¥å½“æœ‰ç•Œé˜Ÿåˆ—è¢«å¡«æ»¡åï¼Œé¥±å’Œç­–ç•¥å¼€å§‹å‘æŒ¥ä½œç”¨ã€‚ThreadPoolExecutor çš„é¥±å’Œç­–ç•¥å¯ä»¥é€šè¿‡è°ƒç”¨ setRejectedExecutionHandler æ¥ä¿®æ”¹ã€‚JDK æä¾›äº†å‡ ç§ä¸åŒçš„å®ç°ï¼Œæ¯ç§å®ç°åŒ…å«ä¸åŒçš„é¥±å’Œç­–ç•¥ï¼š ThreadPoolExecutor.AbortPolicyï¼šä¸­æ­¢ç­–ç•¥æ˜¯é»˜è®¤çš„é¥±å’Œç­–ç•¥ï¼Œè¯¥ç­–ç•¥å°†åœ¨çº¿ç¨‹æ± æ•°é‡ç­‰äºæœ€å¤§çº¿ç¨‹æ•°æ—¶ï¼ŒæŠ›å‡ºæœªæ£€æŸ¥çš„ RejectedExecutionExceptionã€‚æ¶‰åŠåˆ°çš„ä»»åŠ¡å°†ä¸ä¼šæ‰§è¡Œã€‚è°ƒç”¨è€…å¯ä»¥æ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œç„¶åæ ¹æ®éœ€æ±‚ç¼–å†™è‡ªå·±çš„å¤„ç†ä»£ç ã€‚ ThreadPoolExecutor.CallerRunsPolicyï¼šæ—¢ä¸ä¼šæŠ›å¼ƒä»»åŠ¡ï¼Œä¹Ÿä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯å°†æŸäº›ä»»åŠ¡å›é€€åˆ°è°ƒç”¨è€…ï¼Œä»è€Œé™ä½æ–°ä»»åŠ¡çš„æµé‡ã€‚å®ƒä¸ä¼šåœ¨çº¿ç¨‹æ± çš„æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œæ–°æäº¤çš„ä»»åŠ¡ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªè°ƒç”¨äº† execute çš„çº¿ç¨‹ä¸­æ‰§è¡Œè¯¥ä»»åŠ¡ã€‚ ThreadPoolExecutor.DiscardPolicyï¼šè¯¥ç­–ç•¥åœ¨çº¿ç¨‹æ± ä¸­æ•°é‡ç­‰äºæœ€å¤§çº¿ç¨‹æ•°æ—¶ï¼Œä¼šæ‚„æ‚„ä¸¢å¼ƒä¸èƒ½æ‰§è¡Œçš„æ–°å¢ä»»åŠ¡ï¼Œä¸æŠ¥ä»»ä½•å¼‚å¸¸ï¼› ThreadPoolExecutor.DiscardOldestPolicyï¼šè¯¥ç­–ç•¥åœ¨çº¿ç¨‹æ± ä¸­æ•°é‡ç­‰äºæœ€å¤§çº¿ç¨‹æ•°æ—¶ï¼Œä¼šæŠ›å¼ƒçº¿ç¨‹æ± ä¸­å·¥ä½œé˜Ÿåˆ—å¤´éƒ¨çš„ä»»åŠ¡ï¼ˆå³ç­‰å¾…æ—¶é—´æœ€ä¹…çš„ä»»åŠ¡ï¼‰ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚ ","date":"2021-03-30","objectID":"/java-concurrency-3/:2:3","tags":["Java","å¹¶å‘"],"title":"é…ç½® Java çº¿ç¨‹æ± ","uri":"/java-concurrency-3/"},{"categories":["Java"],"content":"çº¿ç¨‹å·¥å‚æ¯å½“çº¿ç¨‹æ± éœ€è¦åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œéƒ½æ˜¯é€šè¿‡çº¿ç¨‹å·¥å‚æ–¹æ³•æ¥å®Œæˆçš„ã€‚é»˜è®¤çš„çº¿ç¨‹å·¥å‚æ–¹æ³•å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ã€éå®ˆæŠ¤çš„çº¿ç¨‹ï¼Œå¹¶ä¸”ä¸åŒ…å«ç‰¹æ®Šçš„é…ç½®ä¿¡æ¯ã€‚é€šè¿‡æŒ‡å®šä¸€ä¸ªçº¿ç¨‹å·¥å‚æ–¹æ³•ï¼Œå¯ä»¥å®šåˆ¶çº¿ç¨‹æ± çš„é…ç½®ä¿¡æ¯ã€‚ å®šåˆ¶çº¿ç¨‹æ± é…ç½®ä¿¡æ¯åœ¨æŸäº›åœºæ™¯ä¸‹æœ‰éœ€æ±‚ï¼Œä¾‹å¦‚å¸Œæœ›ä¸ºçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æŒ‡å®šä¸€ä¸ª UncaughtExecptionHandlerï¼Œæˆ–è€…å®ä¾‹åŒ–ä¸€ä¸ªå®šåˆ¶çš„ Thread ç±»ç”¨äºæ‰§è¡Œè°ƒè¯•ä¿¡æ¯çš„è®°å½•ã€‚ ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†è‡ªå®šä¹‰çº¿ç¨‹å·¥å‚ä¸ºæ¯ä¸ªåˆ›å»ºçš„çº¿ç¨‹æ± è®¾ç½®æ›´æœ‰æ„ä¹‰çš„åå­—ï¼Œåœ¨ Debug å’Œå®šä½é—®é¢˜æ—¶éå¸¸æœ‰å¸®åŠ©ã€‚ public class MyThreadFactory implements ThreadFactory { private final String poolName; public MyThreadFactory(String poolName) { this.poolName = poolName; } public Thread newThread(Runnable runnable) { return new MyAppThread(runnable, poolName); } } ","date":"2021-03-30","objectID":"/java-concurrency-3/:2:4","tags":["Java","å¹¶å‘"],"title":"é…ç½® Java çº¿ç¨‹æ± ","uri":"/java-concurrency-3/"},{"categories":["Java"],"content":"Executoræ¡†æ¶çš„æ‰§è¡Œç­–ç•¥å¯¹çº¿ç¨‹æ± æ€§èƒ½é€ æˆçš„å½±å“éšç€ä¸šåŠ¡åœºæ™¯ä¸åŒè€Œå˜åŒ–ï¼Œæœ¬æ–‡ä»‹ç»äº†å››ç±»ä»»åŠ¡å¯¹æ‰§è¡Œç­–ç•¥ã€çº¿ç¨‹æ± æ€§èƒ½çš„å½±å“","date":"2021-03-19","objectID":"/java-concurrency-2/","tags":["Java","å¹¶å‘"],"title":"ä»»åŠ¡æ‰§è¡Œç­–ç•¥ä¸çº¿ç¨‹æ± æ€§èƒ½","uri":"/java-concurrency-2/"},{"categories":["Java"],"content":" ThreadPool Executoræ¡†æ¶çš„æ‰§è¡Œç­–ç•¥å¯ä»¥å°†ä»»åŠ¡çš„æäº¤ä¸æ‰§è¡Œè§£è€¦å¼€æ¥ï¼Œä¸ºä»»åŠ¡çš„åˆ¶å®šã€æ‰§è¡Œæä¾›äº†ç›¸å½“å¤§çš„çµæ´»æ€§ã€‚ä½†å¹¶éæ‰€æœ‰çš„ä»»åŠ¡éƒ½é€‚ç”¨äºExecutoræ¡†æ¶æ‰§è¡Œç­–ç•¥ï¼Œæœ‰äº›ä»»åŠ¡éœ€è¦æ˜ç¡®çš„æŒ‡å®šæ‰§è¡Œç­–ç•¥ã€‚ ä¾èµ–æ€§ä»»åŠ¡ã€‚ä¾èµ–æ€§ä»»åŠ¡æ³¨é‡ä»»åŠ¡ä¹‹é—´çš„æ‰§è¡Œé¡ºåºã€‚å¦‚æœçº¿ç¨‹æ± æ‰§è¡Œä¾èµ–æ€§ä»»åŠ¡ï¼Œéœ€è¦éšå«ä¸ºæ‰§è¡Œç­–ç•¥å¸¦æ¥çº¦æŸï¼Œé¿å…äº§ç”Ÿæ´»è·ƒæ€§é—®é¢˜ã€‚ ä½¿ç”¨çº¿ç¨‹å°é—­æœºåˆ¶çš„ä»»åŠ¡ã€‚ä»»åŠ¡è¦æ±‚ Executor æ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚æœå°† Executor ä»å•çº¿ç¨‹ç¯å¢ƒæ”¹ä¸ºçº¿ç¨‹æ± ç¯å¢ƒï¼Œå°†ä¼šå¤±å»çº¿ç¨‹å®‰å…¨æ€§ã€‚ å¯¹å“åº”æ—¶é—´æ•æ„Ÿçš„ä»»åŠ¡ã€‚è¿™ç±»ä»»åŠ¡éœ€è¦åŠæ—¶å“åº”ã€‚å¦‚æœå°†ä¸€ä¸ªè¿è¡Œæ—¶é—´è¾ƒé•¿çš„ä»»åŠ¡æäº¤åˆ°å•çº¿ç¨‹çš„ Executor ä¸­ï¼Œæˆ–è€…å°†å¤šä¸ªè¿è¡Œæ—¶é—´è¾ƒé•¿çš„ä»»åŠ¡æäº¤åˆ°ä¸€ä¸ªåªåŒ…å«å°‘é‡çº¿ç¨‹çš„çº¿ç¨‹æ± ä¸­ï¼Œé‚£ä¹ˆå°†é™ä½è¯¥ Executor ç®¡ç†çš„æœåŠ¡çš„å“åº”æ€§ã€‚ ä½¿ç”¨ThreadLocalä»»åŠ¡ã€‚ThreadLocal ä½¿æ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰æŸä¸ªå˜é‡çš„ä¸€ä¸ªç§æœ‰â€œç‰ˆæœ¬â€ã€‚åªè¦æ¡ä»¶å…è®¸ï¼ŒExecutor å¯ä»¥è‡ªç”±åœ°é‡ç”¨è¿™äº›çº¿ç¨‹ã€‚åªæœ‰å½“çº¿ç¨‹æœ¬åœ°å€¼çš„ç”Ÿå‘½å‘¨æœŸå—é™äºä»»åŠ¡ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œåœ¨çº¿ç¨‹æ± çš„çº¿ç¨‹ä¸­ä½¿ç”¨ ThreadLocal æ‰æœ‰æ„ä¹‰ï¼Œè€Œåœ¨çº¿ç¨‹æ± çš„çº¿ç¨‹ä¸­ä¸åº”è¯¥ä½¿ç”¨ ThreadLocal åœ¨ä»»åŠ¡ä¹‹é—´ä¼ é€’å€¼ã€‚ åªæœ‰å½“ä»»åŠ¡éƒ½æ˜¯åŒç±»å‹ä¸”ç›¸äº’ç‹¬ç«‹æ—¶ï¼Œçº¿ç¨‹æ± çš„æ€§èƒ½æ‰èƒ½è¾¾åˆ°æœ€ä½³ã€‚ ","date":"2021-03-19","objectID":"/java-concurrency-2/:0:0","tags":["Java","å¹¶å‘"],"title":"ä»»åŠ¡æ‰§è¡Œç­–ç•¥ä¸çº¿ç¨‹æ± æ€§èƒ½","uri":"/java-concurrency-2/"},{"categories":["Java"],"content":"çº¿ç¨‹é¥¥é¥¿æ­»é”ä¾èµ–æ€§ä»»åŠ¡å¯èƒ½é€ æˆçº¿ç¨‹æ± æ­»é”ã€‚çº¿ç¨‹æ± ä¸­å¦‚æœæ‰€æœ‰æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹éƒ½å› ç­‰å¾…å…¶ä»–ä»å¤„äºå·¥ä½œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è€Œé˜»å¡ï¼Œå°±ä¼šå¼•å‘çº¿ç¨‹é¥¥é¥¿æ­»é”Thread Starvation Deadlockã€‚ ","date":"2021-03-19","objectID":"/java-concurrency-2/:1:0","tags":["Java","å¹¶å‘"],"title":"ä»»åŠ¡æ‰§è¡Œç­–ç•¥ä¸çº¿ç¨‹æ± æ€§èƒ½","uri":"/java-concurrency-2/"},{"categories":["Java"],"content":"è¿è¡Œæ—¶é—´è¾ƒé•¿çš„ä»»åŠ¡å¦‚æœä»»åŠ¡é˜»å¡çš„æ—¶é—´è¿‡é•¿ï¼Œçº¿ç¨‹æ± çš„å“åº”æ€§ä¹Ÿä¼šå˜å¾—ç³Ÿç³•ã€‚æ­¤å¤–ï¼Œè¿è¡Œæ—¶é—´è¾ƒé•¿çš„ä»»åŠ¡ä¹Ÿä¼šå¢åŠ çŸ­ä»»åŠ¡çš„æœåŠ¡æ—¶é—´ã€‚ æœ‰ä¸€é¡¹æŠ€æœ¯å¯ä»¥ç¼“è§£æ‰§è¡Œæ—¶é—´è¾ƒé•¿ä»»åŠ¡é€ æˆçš„å½±å“ï¼Œå³é™å®šä»»åŠ¡ç­‰å¾…èµ„æºçš„æ—¶é—´ã€‚åœ¨å¹³å°ç±»åº“çš„å¤§å¤šæ•°å¯é˜»å¡æ–¹æ³•ä¸­ï¼Œéƒ½åŒæ—¶å®šä¹‰äº†é™æ—¶ç‰ˆæœ¬å’Œæ— é™æ—¶ç‰ˆæœ¬ï¼Œä¾‹å¦‚ Thread.joinã€BlockingQueue.putã€CountDownLatch.await ä»¥åŠ Selector.select ç­‰ã€‚å¦‚æœç­‰å¾…è¶…æ—¶ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠä»»åŠ¡æ ‡è¯†ä¸ºå¤±è´¥ï¼Œç„¶åä¸­æ­¢ä»»åŠ¡æˆ–é‡æ–°è¿”å›é˜Ÿåˆ—ä»¥ä¾¿éšåæ‰§è¡Œã€‚ ","date":"2021-03-19","objectID":"/java-concurrency-2/:2:0","tags":["Java","å¹¶å‘"],"title":"ä»»åŠ¡æ‰§è¡Œç­–ç•¥ä¸çº¿ç¨‹æ± æ€§èƒ½","uri":"/java-concurrency-2/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"é¿å…ç§Ÿæˆ¿è¸©å‘","date":"2021-03-15","objectID":"/house-renting/","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"æ¯•ä¸šå­£æ€»ä¼šä¸ºæˆ‘ä»¬å¸¦æ¥å„ç§æ„Ÿå—ï¼Œæ—¢æœ‰æ­¥å…¥æ–°ç¯å¢ƒçš„å…´å¥‹ï¼Œä¹Ÿæœ‰ä¸ºç”Ÿæ´»çäº‹æ“å¿ƒçš„çƒ¦å¿§ã€‚åœ¨ç”Ÿæ´»çäº‹ä¸­ï¼Œä½æˆ¿é—®é¢˜æ°¸è¿œæ˜¯å¤§å®¶æœ€å…³æ³¨çš„ç‚¹ã€‚å¤§å®¶å¸Œæœ›åœ¨æœ‰æ‰€å±…çš„åŸºç¡€ä¸Šï¼Œäº«å—æ´å‡€ã€æ˜äº®ã€å®½æ•çš„å±…ä½ç©ºé—´ã€‚ æœ¬æ–‡æ˜¯æˆ‘å°†ç§Ÿæˆ¿ç»éªŒåŠ ä»¥æ•´ç†ã€æŠ½è±¡å¾—å‡ºçš„ç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼Œæ¬¢è¿å¤§å®¶è¡¥å……ã€‚å¦‚æœæ‚¨çš„è¡¥å……è¢«æœ¬æ–‡é‡‡çº³ï¼Œæˆ‘ä¼šåœ¨ä¸‹æ–¹åˆ—å‡ºæ‚¨çš„åå­—è¡¨ç¤ºæ‚¨å¯¹æœ¬æ–‡çš„è´¡çŒ®ğŸ‘‡ æ³¨æ„ æ„Ÿè°¢ä»¥ä¸‹åŒå­¦ä¸ºæœ¬æ–‡çš„è´¡çŒ®ï¼š Qian Sun å¼ å…µ Changhao Liu Rain ","date":"2021-03-15","objectID":"/house-renting/:0:0","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"æˆ¿æºä¿¡æ¯æ€»ä½“æ¥è¯´ï¼Œæˆ¿æºä¿¡æ¯æ¥æºåˆ†ä¸ºä¸¤ç±»ï¼šæˆ¿ä¸œç›´ç§Ÿä¸ä¸­ä»‹ä»‹ç»ã€‚ ","date":"2021-03-15","objectID":"/house-renting/:1:0","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"æˆ¿ä¸œç›´ç§Ÿæˆ¿ä¸œå¯ä»¥å°†è‡ªå·±çš„å‡ºç§Ÿä¿¡æ¯æŒ‚åœ¨ç½‘ä¸Šï¼Œä¾‹å¦‚é«˜æ ¡è®ºå›ã€è±†ç“£ã€é—²é±¼ç­‰ï¼Œç§Ÿå®¢ä¹Ÿå¯ä»¥ç›´æ¥å»å°åŒºã€å°åŒºç‰©ä¸šå»æ‰“å¬æ­¤ç±»ä¿¡æ¯ã€‚æˆ¿ä¸œç›´ç§Ÿå¯ä»¥çœå»ä¸­ä»‹è´¹çš„è´Ÿæ‹…ï¼Œåœ¨ç§Ÿé‡‘ä¸Šå¯èƒ½ä¹Ÿæœ‰ä¼˜æƒ ã€‚ä¸è¿‡éœ€è¦å¤§å®¶æ“¦äº®çœ¼ç›ï¼Œæ˜è¾¨å‡ºç§Ÿæˆ¿æ˜¯å¦ä¸ºä¸šä¸»æ‰€æœ‰ï¼Œæ£€æŸ¥æˆ¿ä¸­çš„æ°´ç”µã€å®¶å±…æƒ…å†µï¼Œä¸æˆ¿ä¸œåå•†ä¸€ç³»åˆ—ä½¿ç”¨ã€ç»´ä¿®æ³¨æ„äº‹é¡¹ã€‚ ç½‘ä¸Šçš„ç›´ç§Ÿä¿¡æ¯å­˜åœ¨ä¸­ä»‹é’“é±¼çš„å¯èƒ½æ€§ï¼Œéœ€è‡ªè¡Œåˆ¤æ–­å¯¹æ–¹èº«ä»½ã€‚ ","date":"2021-03-15","objectID":"/house-renting/:1:1","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"ä¸­ä»‹ä»‹ç»æˆ¿ä¸œç›´æ¥å§”æ‰˜ä¸­ä»‹åŠç†æˆ¿å±‹å‡ºç§Ÿï¼Œç§Ÿå®¢å¯ä»¥å°†è‡ªå·±çš„éœ€æ±‚æ˜ç¡®å‘Šè¯‰ä¸­ä»‹ï¼Œä¸­ä»‹ä¸ºä½ æ¨èåˆé€‚çš„æˆ¿å­ã€‚è¿™ç±»æ–¹å¼æ¯”è¾ƒçœäº‹ï¼Œä¸­ä»‹å¯ä»¥å¸®ä½ è¿‡æ»¤ä¸åˆé€‚çš„ä¿¡æ¯ï¼Œæ›¿ä½ ä¸ä¸šä¸»åå•†ä½¿ç”¨ã€ç»´ä¿®æ³¨æ„äº‹é¡¹ï¼Œå¦‚æœ‰éœ€è¦ä¹Ÿä¼šå¸®ä½ è°ˆä»·æ ¼ã€‚ç§Ÿå®¢æ‰¿æ‹…ä¸­ä»‹è´¹ä¸€èˆ¬ä¸ºä¸€ä¸ªæœˆç§Ÿé‡‘ï¼Œç»­ç­¾æ—¶å€™çš„ä¸­ä»‹è´¹é—®é¢˜éœ€è¦çœ‹å„ä¸ªä¸­ä»‹å…¬å¸çš„æƒ…å†µã€‚è¿™ç§æ–¹å¼å¯ä»¥å¿«é€ŸåŒ¹é…ç§Ÿå®¢ä¸æˆ¿æºï¼Œçœå¿ƒçœåŠ›ã€‚ ä¸Šæµ·ç§Ÿæˆ¿å¯ä»¥å°è¯•â€œå…­å…­ç›´ç§Ÿâ€APPï¼Œä½†éœ€è¦ç­›é€‰æˆ¿æºã€‚ ","date":"2021-03-15","objectID":"/house-renting/:1:2","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"ä¸ªäººå»ºè®®å¦‚æœä½ æ²¡æœ‰ç§Ÿæˆ¿ç»éªŒï¼Œå»ºè®®æ‰¾ä¸€å®¶å¤§å‹ä¸­ä»‹ä¸ºä½ æ‰¾æˆ¿å­ï¼Œä¸­ä»‹è´¹æƒå½“ä½ è¿›å…¥ç§Ÿæˆ¿ã€è´­æˆ¿å¸‚åœºçš„å­¦è´¹äº†ã€‚åŸå› å¦‚ä¸‹ï¼š ä¸­ä»‹æ‰‹ä¸­æŒæ¡å¤§é‡æˆ¿æºä¿¡æ¯ï¼Œå¯ä»¥æ ¹æ®ä½ çš„éœ€æ±‚å¸®ä½ å¿«é€Ÿå®šä½ã€‚æ¯•ä¸šå­£ç§Ÿæˆ¿å¸‚åœºç«çˆ†ï¼Œå¿«é€Ÿæ‰¾åˆ°é€‚åˆè‡ªå·±çš„æˆ¿å­æ˜¯å…³é”®çš„ç¬¬ä¸€æ­¥ã€‚ ä¸­ä»‹å¯ä»¥ä¸ºä½ äº‰å–åˆ°å¸‚åœºä¸Šç»å¤§å¤šæ•°ç§Ÿå®¢å¯ä»¥äº«å—åˆ°çš„æœåŠ¡ï¼Œä¾‹å¦‚ç»´ä¿®è´£ä»»æ–¹ã€å¿…è¦çš„å®¶å…·ã€‚ åŒæ–¹äº¤ä»˜æˆ¿å­æ—¶ï¼Œä¸­ä»‹ä¼šå¸®åŠ©ä½ æ£€æŸ¥æˆ¿ä¸­ä¸€åˆ‡æƒ…å†µå¹¶ç™»è®°åœ¨æ¡ˆï¼Œé€€æˆ¿é€€æŠ¼é‡‘æ—¶å¯ä½œä¸ºä¾æ®ã€‚ æœ‰æ­£è§„çš„ç§ŸèµåˆåŒï¼Œçœå»æ‰¾äººçœ‹åˆåŒçš„éº»çƒ¦ã€‚ å¦‚æœæœ‰ç§Ÿæˆ¿ç»éªŒï¼Œå¯ä»¥ç›´æ¥å»å°åŒºæˆ–è€…ç½‘ä¸Šå¯»æ‰¾æˆ¿ä¸œç›´ç§Ÿä¿¡æ¯ï¼Œçœå»ä¸­ä»‹è´¹å²‚ä¸ç¾æ»‹æ»‹ã€‚ ","date":"2021-03-15","objectID":"/house-renting/:1:3","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"çœ‹æˆ¿å…³æ³¨çš„ç‚¹","date":"2021-03-15","objectID":"/house-renting/:2:0","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"é£é™©ä¿¡æ¯ æ ¸å®å‡ºç§Ÿäººèº«ä»½ï¼ŒæŸ¥çœ‹èº«ä»½è¯ä¸æˆ¿äº§è¯ä¿¡æ¯é¡µæ˜¯å¦åŒ¹é… æ£€æŸ¥æ˜¯å¦æœ‰æƒåˆ©ç‘•ç–µï¼Œä¾‹å¦‚æŠµæŠ¼ã€æŸ¥å°ã€æ‹å–ç­‰ç­‰ æ£€æŸ¥æˆ¿å±‹æ˜¯å¦éæ³•æ”¹é€ ï¼Œä¸»ä½“ç»“æ„æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŠ¨äº†æ‰¿é‡å¢™ï¼Œå…·ä½“æ–¹æ³•ä¸ºçœ‹æˆ¿äº§è¯ æ£€æŸ¥æˆ¿å±‹æ˜¯å¦å­˜åœ¨ç©ºæ°”è´¨é‡é—®é¢˜ çº¦å®šå¥½è¿çº¦è¡Œä¸ºï¼Œä¸€èˆ¬æ˜¯å¸‚åœºé»˜è®¤çš„è¿çº¦è¡Œä¸º å¼‚åœ°ç§Ÿæˆ¿ä¸€å®šè¦ç°åœºç¡®è®¤æˆ¿å±‹æƒ…å†µï¼Œä¸è¦è½»æ˜“ç¡®å®š å®šé‡‘æœ€å¥½ä¸è¦äº¤ï¼Œç›´æ¥ç­¾åˆåŒäº¤ç§Ÿé‡‘ã€‚å¦‚æœéœ€è¦äº¤å®šé‡‘ï¼Œä¸€å®šä¸è¦è½»æ˜“äº¤ ","date":"2021-03-15","objectID":"/house-renting/:2:1","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"æˆ¿å±‹è´¨é‡ æˆ¿å±‹çš„å¸ƒå±€æ˜¯å¦åˆç†ï¼Œæ˜¯å¦ç¬¦åˆä½ çš„è¦æ±‚ æˆ¿å±‹é‡‡å…‰å¦‚ä½•ï¼Œèƒ½å¦ä¿è¯ä½ å¸Œæœ›çš„è¶³å¤Ÿé‡‡å…‰æ—¶é•¿ã€å¼ºåº¦ã€‚æ›´è¯¦ç»†è¯·çœ‹å»ºç­‘é‡‡å…‰è®¾è®¡æ ‡å‡† æˆ¿å±‹æ˜¯å¦æ¼æ°´ï¼Œæ¥¼ä¸Šæ˜¯å¦æ¼æ°´ æˆ¿å±‹å–æš–æ–¹å¼ï¼Œä¼˜å…ˆé›†ä½“ä¾›æš– æˆ¿å±‹ç‡ƒæ°”ç®¡ã€ç‡ƒæ°”é˜€ã€ç‡ƒè¡¨æƒ…å†µï¼Œæ˜¯å¦éœ€è¦æ›´æ¢ æˆ¿å±‹çª—æˆ·æ˜¯å¦æ¼é£ å®¶å…·æ˜¯å¦é½å…¨ï¼Œå®¶å…·åŠŸèƒ½æ˜¯å¦æ­£å¸¸ æˆ¿å±‹ç”µè·¯æ˜¯å¦æ­£å¸¸ï¼Œè™½ç„¶æ’åº§å‡ºé—®é¢˜æ¦‚ç‡å°ï¼Œä½†å¿…è¦æ—¶ä»éœ€æ£€æŸ¥ é•¿æœŸä¸ä½äººçš„æˆ¿å±‹æ›´è¦å°å¿ƒä»”ç»†æ£€æŸ¥ æˆ¿å±‹çš„éš”éŸ³æ¡ä»¶ï¼Œå‘¨è¾¹ç¯å¢ƒæ˜¯å¦æœ‰å™ªéŸ³ ","date":"2021-03-15","objectID":"/house-renting/:2:2","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"å®‰å…¨é—®é¢˜ å°åŒºã€ä½å®…æ¥¼çš„å®‰å…¨ç®¡ç†æƒ…å†µå¦‚ä½• ","date":"2021-03-15","objectID":"/house-renting/:2:3","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"è´¹ç”¨é—®é¢˜ ä»˜æ¬¾é¢‘ç‡ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯æŠ¼ä¸€ä»˜ä¸‰ é€€æˆ¿è¿”æŠ¼é‡‘çš„æ ‡å‡†ï¼Œéœ€è¦äº¤ä»˜æ—¶å€™ä¸æˆ¿ä¸œç¡®è®¤å¥½æˆ¿å±‹ç»†èŠ‚ ç»´ä¿®è´¹ç”¨çš„æ‰¿æ‹…ï¼Œç§Ÿå®¢åŸå› ç§Ÿå®¢æ‰¿æ‹…ï¼Œéç§Ÿå®¢åŸå› éœ€è¦å•†é‡å¥½ ç‰©ä¸šè´¹ã€è½¦ä½è´¹ï¼šç‰©ä¸šè´¹æˆ¿ä¸œæ‰¿æ‹…ï¼Œè½¦ä½è´¹æ²¡äº†è§£è¿‡ æ°´ã€ç”µã€ç‡ƒæ°”ã€å®½å¸¦ã€å–æš–è´¹ç”¨ç§Ÿå®¢æ‰¿æ‹… çº¦å®šå¥½è¿çº¦é‡‘ ","date":"2021-03-15","objectID":"/house-renting/:2:4","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"å…¶ä»–æœ‰ç”¨çš„ç‚¹ æŠŠè‡ªå·±æ”¶æ‹¾çš„å¹²å‡€ä¸€äº›ï¼Œè®©æˆ¿ä¸œç›¸ä¿¡ä½ å¯ä»¥ç…§é¡¾å¥½ä»–çš„æˆ¿å­ æ˜ç¡®å’Œæˆ¿ä¸œã€ä¸­ä»‹è®²æ¸…è‡ªå·±çš„éœ€æ±‚ï¼Œä¸€å¼€å§‹çº¦å®šå¥½æ¯”åé¢è¿½åŠ æ¡ä»¶è¦å®¹æ˜“å¤š æˆ¿ä¸œå–œæ¬¢ç¨³å®šã€å¯é•¿ç§Ÿçš„ç§Ÿå®¢ï¼Œå¯ä»¥è¡¨ç°ä½ çš„å·¥ä½œã€æ”¶å…¥ç¨³å®š æƒ…ä¾£æ¯”æœ‹å‹åˆç§Ÿæ›´æœ‰ä¼˜åŠ¿ æˆ¿ä¸œå¸Œæœ›å°½å¿«å…¥ä½ï¼Œé¿å…æˆ¿å±‹ç©ºé—²ï¼Œç­¾çº¦é€Ÿåº¦ä¹Ÿæ˜¯æˆ¿ä¸œé€‰æ‹©ç§Ÿå®¢çš„è¦ç´ ä¹‹ä¸€ ","date":"2021-03-15","objectID":"/house-renting/:3:0","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["æ‚è°ˆåˆ†äº«"],"content":"æ€»ç»“è¦æ˜¯æ²¡æœ‰ç»éªŒï¼Œæ¨èæ‰¾ä¸­ä»‹ã€‚æœ‰åç»­é£é™©é—®é¢˜éƒ½å¯ä»¥æ‰¾ä¸­ä»‹è§£å†³ï¼Œç¬¬ä¸‰ä¿¡ä»»æ–¹æ˜¯äº¤æ˜“é¡ºåˆ©å®Œæˆçš„ä¿éšœã€‚è‡ªå·±åœ¨çœ‹æˆ¿å­çš„æ—¶å€™éœ€è¦ä»”ç»†ã€ä»”ç»†ã€ä»”ç»†æ£€æŸ¥é£é™©ã€æˆ¿å±‹è´¨é‡ã€å®‰å…¨ä¸è´¹ç”¨ç­‰é—®é¢˜ã€‚è°ˆå¥½çš„æ¡ä»¶ä¸€å®šè¦æ±‚è½å®åœ¨åˆåŒä¸­ã€‚ æœ€åç¥å¤§å®¶æ‰¾åˆ°è‡ªå·±æ»¡æ„çš„æˆ¿å­ã€‚å¦‚æœä½ æœ‰å…¶ä»–é—®é¢˜ï¼Œå¯ä»¥ä»é¦–é¡µä¸­ä»»æ„è”ç³»æ–¹å¼æ‰¾åˆ°æˆ‘ã€‚ å¦‚æœä½ æœ‰å…¶ä»–å»ºè®®ï¼Œæ¬¢è¿åˆ†äº«ç»™æˆ‘ï¼Œæ–¹å¼å¦‚ä¸ŠğŸ‘† æˆ‘ä¼šæ·»åŠ åœ¨æ–‡ä¸­ï¼Œå¹¶ç•™ä¸‹ä½ çš„å§“åè¡¨ç¤ºæ„Ÿè°¢ã€‚ ","date":"2021-03-15","objectID":"/house-renting/:4:0","tags":["ç§Ÿæˆ¿","æ³¨æ„äº‹é¡¹"],"title":"åº”å±Šç”Ÿç§Ÿæˆ¿æ³¨æ„äº‹é¡¹ï¼ˆæŒç»­æ›´æ–°ï¼‰","uri":"/house-renting/"},{"categories":["Java"],"content":"æœ¬æ–‡ä»‹ç»äº†Executoræ¡†æ¶ï¼Œæ¡†æ¶é‡‡ç”¨äº†ä»»åŠ¡æäº¤ã€æ‰§è¡Œçš„è§£è€¦æ–¹æ¡ˆã€‚ä¸ºäº†è®©è¯¥æ–¹æ¡ˆé€‚é…ä¸åŒåœºæ™¯ï¼Œéœ€è¦å°†å¤šç§å› ç´ è€ƒè™‘è¿›æ‰§è¡Œç­–ç•¥ä¸­ã€‚ä¸åŒçš„æ‰§è¡Œç­–ç•¥ä¹Ÿè¡ç”Ÿå‡ºä¸åŒçš„çº¿ç¨‹æ± ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨å‰éœ€è¦åˆ†æçœŸå®ç¯å¢ƒå»é€‰æ‹©é€‚å½“çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± å¼‚æ­¥æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œå¯¼è‡´ä»»åŠ¡å¯èƒ½å¤„äºä¸åŒçš„çŠ¶æ€ã€‚ä¸ºäº†ç®¡ç†æ•´ä¸ªçº¿ç¨‹æ± çš„ç”Ÿå‘½å‘¨æœŸï¼ŒExecutorServiceæä¾›äº†å¤šç§æ–¹æ³•ï¼Œä¸€èˆ¬é‡‡å–awaitTerminationã€shutdownç»„åˆä½¿ç”¨çš„æ–¹å¼ï¼Œè¾¾åˆ°åŒæ­¥å…³é—­çš„æ•ˆæœã€‚æœ€åï¼Œæœ¬æ–‡ä»‹ç»äº†ScheduledThreadPoolåœ¨å»¶è¿Ÿä»»åŠ¡ã€å‘¨æœŸä»»åŠ¡çš„ä¼˜è¶Šæ€§ï¼Œå¦‚æœæ„å»ºè°ƒåº¦æœåŠ¡ï¼Œå¯ä»¥é‡‡ç”¨DelayQueueã€‚","date":"2021-03-12","objectID":"/java-concurrency-1/","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"Executoræ¡†æ¶æˆ‘ä»¬å°†æ‰§è¡Œçš„é€»è¾‘å·¥ä½œå•å…ƒæŠ½è±¡ä¸ºä»»åŠ¡ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±æ˜¯ä½¿ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œçš„å®¹å™¨ã€‚å¦‚æœæŠŠæ‰€æœ‰ä»»åŠ¡æ”¾åœ¨å•ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œå°†å¯¹åº”ç”¨çš„å“åº”æ€§å’Œååé‡é€ æˆç¾éš¾æ€§å½±å“ã€‚ ä¸ºæ¯ä¸ªä»»åŠ¡åˆ†é…ä¸€ä¸ªçº¿ç¨‹ä¼¼ä¹æ˜¯ä¸é”™çš„è§£å†³æ–¹æ¡ˆï¼Œä¸è¿‡è¿™å¯¹èµ„æºç®¡ç†æœ‰ç€è¾ƒé«˜çš„è¦æ±‚ã€‚çº¿ç¨‹æ± ç¼“è§£äº†è¿™ä¸€å‹åŠ›ï¼Œå®ƒæ‰¿æ‹…äº†ç®¡ç†çº¿ç¨‹å·¥ä½œã€‚java.util.concurrent æä¾›äº†ä¸€ç§çµæ´»çš„çº¿ç¨‹æ± ä½œä¸ºExecutoræ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚ åœ¨ Java ç±»åº“ä¸­ï¼Œä»»åŠ¡æ‰§è¡Œçš„ä¸»è¦æŠ½è±¡ä¸æ˜¯ Threadï¼Œè€Œæ˜¯ Executorã€‚ public interface Executor { void execute (Runnable command); } Executor ä¸ºçµæ´»ä¸”å¼ºå¤§çš„å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ¡†æ¶æä¾›äº†åŸºç¡€ï¼Œä¸ºä»»åŠ¡çš„æäº¤ä¸æ‰§è¡Œæä¾›äº†æ ‡å‡†çš„æ–¹æ³•ï¼Œå°†ä¸¤ä¸ªè¿‡ç¨‹è§£è€¦å¼€æ¥ã€‚æ­¤å¤–ï¼ŒExecutor å®ç°äº†å¯¹ç”Ÿå‘½å‘¨æœŸçš„æ”¯æŒï¼Œä»¥åŠç›‘æ§ç®¡ç†ç­‰æœºåˆ¶ã€‚ Executor åŸºäºç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæäº¤ä»»åŠ¡çš„æ“ä½œç›¸å½“äºç”Ÿäº§è€…ï¼Œæ‰§è¡Œä»»åŠ¡çš„æ“ä½œç±»ä¼¼äºæ¶ˆè´¹è€…ã€‚åä¹‹ï¼Œå¦‚æœæƒ³å®ç°ç®€å•çš„ç”Ÿäº§æ¶ˆè´¹æ¨¡å‹ï¼Œå¯ä»¥é‡‡ç”¨ Executor å®ç°ã€‚ ","date":"2021-03-12","objectID":"/java-concurrency-1/:1:0","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"æ‰§è¡Œç­–ç•¥Executor æ¡†æ¶éœ€è¦è®¾è®¡ä¸€å¥—ä»»åŠ¡æ‰§è¡Œç­–ç•¥ï¼Œä»¥è§£å†³å¤šä»»åŠ¡æ‰§è¡Œæ··ä¹±çš„é—®é¢˜ã€‚æ‰§è¡Œç­–ç•¥åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š åœ¨ä»€ä¹ˆçº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Ÿ ä»»åŠ¡æŒ‰ç…§ä»€ä¹ˆé¡ºåºæ‰§è¡Œï¼ˆFIFOã€LIFOã€ä¼˜å…ˆçº§ï¼‰ï¼Ÿ æœ‰å¤šå°‘ä¸ªä»»åŠ¡èƒ½å¹¶å‘æ‰§è¡Œï¼Ÿ åœ¨é˜Ÿåˆ—ä¸­æœ‰å¤šå°‘ä¸ªä»»åŠ¡åœ¨ç­‰å¾…æ‰§è¡Œï¼Ÿ å¦‚æœç³»ç»Ÿéœ€è¦æ‹’ç»ä¸€ä¸ªä»»åŠ¡ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªä»»åŠ¡ï¼Ÿå¦‚ä½•é€šçŸ¥åº”ç”¨æœ‰ä»»åŠ¡è¢«æ‹’ç»ï¼Ÿ åœ¨æ‰§è¡Œä¸€ä¸ªä»»åŠ¡å‰åï¼Œåº”è¯¥è¿›è¡Œå“ªäº›åŠ¨ä½œï¼Ÿ ","date":"2021-03-12","objectID":"/java-concurrency-1/:2:0","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"çº¿ç¨‹æ± çº¿ç¨‹æ± æ˜¯ç®¡ç†è¯¸å¤šçº¿ç¨‹çš„èµ„æºæ± ï¼Œä¾é ä»»åŠ¡ä¿æŒæ‰€æœ‰ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚å·¥ä½œè€…çº¿ç¨‹Work Threadçš„ä»»åŠ¡å¾ˆç®€å•ï¼šä»å·¥ä½œé˜Ÿåˆ—è·å–ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œä»»åŠ¡ï¼Œç„¶åè¿”å›çº¿ç¨‹æ± å¹¶ç­‰å¾…ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚ ä¸ºæ¯ä¸ªä»»åŠ¡åˆ†é…ä¸€ä¸ªçº¿ç¨‹å¯èƒ½å¼•å…¥çº¿ç¨‹æ–°å»ºã€é”€æ¯çš„å¼€é”€ï¼Œä¸å¦‚è®©å¤šä¸ªä»»åŠ¡åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œã€‚é€šè¿‡é‡ç”¨ç°æœ‰çš„çº¿ç¨‹å¯ä»¥åˆ†æ‘Šå¤šä¸ªçº¿ç¨‹çš„å¼€é”€ã€‚æ­¤å¤–ï¼Œä»»åŠ¡ä¸ä¼šå› ç­‰å¾…çº¿ç¨‹åˆ›å»ºè€Œå»¶è¿Ÿæ‰§è¡Œï¼Œæå‡æ•´ä½“å“åº”æ€§ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡é…ç½®çº¿ç¨‹æ± å¤§å°ï¼Œåˆ›å»ºè¶³å¤Ÿå¤šçš„çº¿ç¨‹ä½¿å¤„ç†å™¨ä¿æŒå¿™ç¢ŒçŠ¶æ€ï¼Œè¿˜å¯é˜²æ­¢å¤šçº¿ç¨‹ç›¸äº’ç«äº‰èµ„æºè€Œä½¿åº”ç”¨ç¨‹åºè€—å°½å†…å­˜æˆ–å¤±è´¥ã€‚ ","date":"2021-03-12","objectID":"/java-concurrency-1/:3:0","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"newFixedThreadPoolnewFixedThreadPool æ˜¯æ‹¥æœ‰å›ºå®šæ•°é‡çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œæ¯å½“æäº¤ä¸€ä¸ªä»»åŠ¡å°±åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç›´åˆ°è¾¾åˆ°æœ€å¤§æ•°é‡ã€‚å¦‚æœæŸä¸ªçº¿ç¨‹å› å¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆçº¿ç¨‹æ± ä¼šè¡¥å……ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚ ","date":"2021-03-12","objectID":"/java-concurrency-1/:3:1","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"newCachedThreadPoolnewCachedThreadPool æ˜¯å¯ç¼“å­˜çš„çº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± å½“å‰è§„æ¨¡è¶…è¿‡å¤„ç†éœ€æ±‚ï¼Œå°†å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œè€Œå½“éœ€æ±‚å¢åŠ æ—¶ï¼Œå¯ä»¥æ·»åŠ æ–°çº¿ç¨‹ã€‚çº¿ç¨‹æ± è§„æ¨¡ä¸å­˜åœ¨ä»»ä½•é™åˆ¶ã€‚ ","date":"2021-03-12","objectID":"/java-concurrency-1/:3:2","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"newSingleThreadExecutornewSingleThreadExecutor æ˜¯å•çº¿ç¨‹çš„ Executorï¼Œå¦‚æœçº¿ç¨‹å› å¼‚å¸¸ç»“æŸï¼ŒnewSingleThreadExecutor ä¼šåˆ›å»ºå¦ä¸€ä¸ªçº¿ç¨‹æ¥æ›¿ä»£ã€‚ä»»åŠ¡æŒ‰ç…§é˜Ÿåˆ—é¡ºåºè€Œæ‰§è¡Œã€‚ ","date":"2021-03-12","objectID":"/java-concurrency-1/:3:3","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"newScheduledThreadPoolnewScheduledThreadPool çš„çº¿ç¨‹æ•°é‡ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œä½†å¯ä»¥ä»¥å»¶è¿Ÿæˆ–å®šæ—¶æ–¹å¼æ‰§è¡Œä»»åŠ¡ã€‚ ","date":"2021-03-12","objectID":"/java-concurrency-1/:3:4","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"Executor çš„ç”Ÿå‘½å‘¨æœŸExecutor é€šå¸¸ä¼šåˆ›å»ºçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œåªæœ‰å½“æ‰€æœ‰çº¿ç¨‹å…¨éƒ¨ç»ˆæ­¢åæ‰ä¼šé€€å‡ºï¼Œå¦‚æœæ— æ³•æ­£ç¡®å…³é—­ Executorï¼ŒJVM å°†æ— æ³•ç»“æŸã€‚ å› ä¸º Executor ä»¥å¼‚æ­¥æ–¹å¼æ‰§è¡Œä»»åŠ¡ï¼Œå¯èƒ½å¼•å‘ä»»åŠ¡çŠ¶æ€ä¸åŒæ­¥çš„é—®é¢˜ã€‚åŒä¸€æ—¶åˆ»ï¼Œä¸åŒä»»åŠ¡å¯èƒ½å¤„äºæ‰§è¡Œã€å®Œæˆã€ç­‰å¾…æ‰§è¡Œä¸‰ä¸ªçŠ¶æ€ã€‚ä¸ºäº†è§£å†³æ‰§è¡Œä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸé—®é¢˜ï¼ŒExecutor æ‰©å±•äº† ExecutorService æ¥å£ï¼Œæ·»åŠ äº†ä¸€äº›ç”¨äºç”Ÿå‘½å‘¨æœŸç®¡ç†çš„æ–¹æ³•ã€‚ public interface ExecutorService extends Executor { void shutdown(); List\u003cRunnable\u003e shutdownNow(); boolean isShutdown(); boolean isTerminated(); boolean awaitTermination(long timeout, TimeUnit unit) throws InterruptedException; // ... } ExecutorService çš„ç”Ÿå‘½å‘¨æœŸæœ‰ä¸‰ç§çŠ¶æ€ï¼šè¿è¡Œã€å…³é—­å’Œå·²ç»ˆæ­¢ã€‚shutdown æ–¹æ³•å°†å¹³ç¼“åœ°å…³é—­ ExecutorServiceï¼šä¸å†æ¥å—æ–°ä»»åŠ¡ï¼ŒåŒæ—¶ç­‰å¾…å·²ç»æäº¤çš„ä»»åŠ¡æ‰§è¡Œå®Œæˆâ€”â€”åŒ…æ‹¬è¿˜æœªå¼€å§‹æ‰§è¡Œçš„ä»»åŠ¡ã€‚shutdownNow æ–¹æ³•å°†ç²—æš´åœ°å…³é—­ ExecutorServiceï¼šç›´æ¥å–æ¶ˆæ‰€æœ‰æ‰§è¡Œä¸­çš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¸å†å¯åŠ¨é˜Ÿåˆ—ä¸­å°šæœªå¼€å§‹æ‰§è¡Œçš„ä»»åŠ¡ã€‚ awaitTermination æ–¹å¼å¯ä»¥ç­‰å¾… ExecutorService åˆ°è¾¾ç»ˆæ­¢çŠ¶æ€ï¼Œæˆ–è€…è°ƒç”¨ isTerminated æ¥è½®è¯¢ ExecutorService æ˜¯å¦å·²ç»ç»ˆæ­¢ã€‚é€šå¸¸åœ¨è°ƒç”¨ awaitTermination æ–¹æ³•åç«‹å³è°ƒç”¨ shutdownï¼Œä»è€Œäº§ç”ŸåŒæ­¥å…³é—­çš„æ•ˆæœã€‚ ","date":"2021-03-12","objectID":"/java-concurrency-1/:4:0","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"å»¶è¿Ÿä»»åŠ¡ä¸å‘¨æœŸä»»åŠ¡Timer ç±»è´Ÿè´£ç®¡ç†å»¶è¿Ÿä»»åŠ¡ä»¥åŠå‘¨æœŸä»»åŠ¡ã€‚ä½† Timer ç±»æ”¯æŒçš„æ˜¯åŸºäºç»å¯¹æ—¶é—´çš„è°ƒåº¦æœºåˆ¶ï¼Œå¯¹ç³»ç»Ÿæ—¶é’Ÿå˜åŒ–çš„å®¹å¿åº¦å¾ˆä½ï¼Œå­˜åœ¨å¤©ç„¶ç¼ºé™·ã€‚ScheduledThreadPool åªæ”¯æŒåŸºäºç›¸å¯¹æ—¶é—´çš„è°ƒåº¦ï¼Œå¯ä»¥é€šè¿‡ ScheduledThreadPool çš„æ„é€ å‡½æ•°æˆ– newScheduledThreadPool å·¥å‚æ–¹æ³•æ¥åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡ã€‚ å¦‚æœæ„å»ºè°ƒåº¦æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ DelayQueueï¼Œå®ƒå®ç°äº† BlockingQueueï¼Œå¹¶ä¸º ScheduledThreadPoolExecutor æä¾›è°ƒåº¦åŠŸèƒ½ã€‚DelayQueue ç®¡ç†ç€ä¸€ç»„ Delayed å¯¹è±¡ã€‚æ¯ä¸ª Delayed å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„å»¶è¿Ÿæ—¶é—´ã€‚ ","date":"2021-03-12","objectID":"/java-concurrency-1/:5:0","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["Java"],"content":"æ€»ç»“æœ¬æ–‡ä¸€å¼€å§‹ä»‹ç»äº† Executor æ¡†æ¶ï¼Œæ¡†æ¶é‡‡ç”¨äº†ä»»åŠ¡æäº¤ã€æ‰§è¡Œçš„è§£è€¦æ–¹æ¡ˆã€‚ä¸ºäº†è®©è¯¥æ–¹æ¡ˆé€‚é…ä¸åŒåœºæ™¯ï¼Œéœ€è¦å°†å¤šç§å› ç´ è€ƒè™‘è¿›æ‰§è¡Œç­–ç•¥ä¸­ã€‚ä¸åŒçš„æ‰§è¡Œç­–ç•¥ä¹Ÿè¡ç”Ÿå‡ºä¸åŒçš„çº¿ç¨‹æ± ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨å‰éœ€è¦åˆ†æçœŸå®ç¯å¢ƒå»é€‰æ‹©é€‚å½“çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± å¼‚æ­¥æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œå¯¼è‡´ä»»åŠ¡å¯èƒ½å¤„äºä¸åŒçš„çŠ¶æ€ã€‚ä¸ºäº†ç®¡ç†æ•´ä¸ªçº¿ç¨‹æ± çš„ç”Ÿå‘½å‘¨æœŸï¼ŒExecutorService æä¾›äº†å¤šç§æ–¹æ³•ï¼Œä¸€èˆ¬é‡‡å– awaitTerminationã€shutdown ç»„åˆä½¿ç”¨çš„æ–¹å¼ï¼Œè¾¾åˆ°åŒæ­¥å…³é—­çš„æ•ˆæœã€‚æœ€åï¼Œæœ¬æ–‡ä»‹ç»äº† ScheduledThreadPool åœ¨å»¶è¿Ÿä»»åŠ¡ã€å‘¨æœŸä»»åŠ¡çš„ä¼˜è¶Šæ€§ï¼Œå¦‚æœæ„å»ºè°ƒåº¦æœåŠ¡ï¼Œå¯ä»¥é‡‡ç”¨ DelayQueueã€‚ ","date":"2021-03-12","objectID":"/java-concurrency-1/:6:0","tags":["Java","å¹¶å‘"],"title":"Executorä¸çº¿ç¨‹æ± ","uri":"/java-concurrency-1/"},{"categories":["è¯»ä¹¦ç¬”è®°"],"content":"æ€ç»´æ··ä¹±å¸¸å¸¸å¯¼è‡´æˆ‘ä»¬å†³ç­–å¤±è¯¯ï¼Œæˆ´ä¸Šå…­é¡¶æ€è€ƒå¸½ï¼Œä¸“æ³¨æ€è€ƒæ–¹å‘ï¼Œå…¨é¢ã€å¿«é€Ÿã€æ¸…æ™°åœ°æ€è€ƒ","date":"2021-02-14","objectID":"/six-thinking-hats/","tags":["è¯»ä¹¦ç¬”è®°","æ€è€ƒæ–¹å¼","æ°´å¹³æ€è€ƒ"],"title":"ã€Šå…­é¡¶æ€è€ƒå¸½ã€‹è¯»ä¹¦ç¬”è®°","uri":"/six-thinking-hats/"},{"categories":["è¯»ä¹¦ç¬”è®°"],"content":" å°é¢ ","date":"2021-02-14","objectID":"/six-thinking-hats/:0:0","tags":["è¯»ä¹¦ç¬”è®°","æ€è€ƒæ–¹å¼","æ°´å¹³æ€è€ƒ"],"title":"ã€Šå…­é¡¶æ€è€ƒå¸½ã€‹è¯»ä¹¦ç¬”è®°","uri":"/six-thinking-hats/"},{"categories":["è¯»ä¹¦ç¬”è®°"],"content":"å…³äºæœ¬ä¹¦ å…³äºæœ¬ä¹¦ ","date":"2021-02-14","objectID":"/six-thinking-hats/:1:0","tags":["è¯»ä¹¦ç¬”è®°","æ€è€ƒæ–¹å¼","æ°´å¹³æ€è€ƒ"],"title":"ã€Šå…­é¡¶æ€è€ƒå¸½ã€‹è¯»ä¹¦ç¬”è®°","uri":"/six-thinking-hats/"},{"categories":["è¯»ä¹¦ç¬”è®°"],"content":"å†…å®¹ç®€ä»‹æœ¬ä¹¦ä»‹ç»äº†ä¸€ç§æ€è€ƒæ¨¡å¼ï¼Œå¯ä»¥åº”å¯¹æ¢ç´¢æ€§é—®é¢˜æˆ–è€…å•ç±»å‹é—®é¢˜ã€‚ å…­é¡¶æ€è€ƒå¸½ä»£è¡¨ä¸€ç§æ€ç»´æ–¹å¼ã€‚æ¯æ¬¡æ€è€ƒæ—¶ä¸“æ³¨äºä¸€é¡¶å¸½å­ï¼Œé¿å…å‡ºç°æ€ç»´æ··ä¹±çš„æƒ…å†µã€‚ é€šè¿‡è®­ç»ƒã€ä½¿ç”¨ï¼Œå¯ä»¥å…¨é¢ã€å®¢è§‚ã€å¿«é€Ÿè®¤æ¸…é—®é¢˜ï¼Œå¹¶æå‡ºè§£å†³æ–¹æ¡ˆã€‚ ","date":"2021-02-14","objectID":"/six-thinking-hats/:2:0","tags":["è¯»ä¹¦ç¬”è®°","æ€è€ƒæ–¹å¼","æ°´å¹³æ€è€ƒ"],"title":"ã€Šå…­é¡¶æ€è€ƒå¸½ã€‹è¯»ä¹¦ç¬”è®°","uri":"/six-thinking-hats/"},{"categories":["è¯»ä¹¦ç¬”è®°"],"content":"ä¹¦æ‘˜ æ€ç»´å¯¼å›¾æ€»ç»“ ","date":"2021-02-14","objectID":"/six-thinking-hats/:3:0","tags":["è¯»ä¹¦ç¬”è®°","æ€è€ƒæ–¹å¼","æ°´å¹³æ€è€ƒ"],"title":"ã€Šå…­é¡¶æ€è€ƒå¸½ã€‹è¯»ä¹¦ç¬”è®°","uri":"/six-thinking-hats/"},{"categories":["è¯»ä¹¦ç¬”è®°"],"content":"è¯»åæ„Ÿ æ€è€ƒæ˜¯äººç±»æœ€å¤§çš„å®è—ï¼Œä½†éå¸¸å®¹æ˜“å‡ºç°æ€è€ƒæ··ä¹±ï¼Œæƒ…æ„Ÿã€ä¿¡æ¯ã€é€»è¾‘ã€å¸Œæœ›å’Œåˆ›æ„æ…åœ¨ä¸€èµ·ã€‚ å¯ä»¥ä¸å¿…å…³æ³¨â€œæ˜¯ä»€ä¹ˆâ€ï¼Œå…³æ³¨â€œèƒ½å¤Ÿæ€æ ·â€ï¼Œè¾©è¯æ³•å‘Šè¯‰æˆ‘ä»¬è§’åº¦ä¸åŒã€ç»“è®ºä¸åŒã€‚ ç°ä»£æ–°äº‹ç‰©æ¶Œç°å¤ªå¿«ï¼Œéœ€è¦æ›´å¿«é€Ÿã€å…¨é¢åœ°è®¤æ¸…æ–°äº‹åŠ¡ï¼Œè¿™å¥—æ–¹æ³•æ¯”è¾ƒé€‚ç”¨ã€‚ ç»éªŒå‘Šè¯‰æˆ‘ï¼Œä½¿ç”¨è¿™å¥—æ–¹æ³•åº”è¯¥æ˜¯æ¶¦ç‰©ç»†æ— å£°çš„æ–¹å¼ï¼Œç”Ÿæ‹‰ç¡¬æ‹½ä¼šé€‚å¾—å…¶åã€‚ ","date":"2021-02-14","objectID":"/six-thinking-hats/:4:0","tags":["è¯»ä¹¦ç¬”è®°","æ€è€ƒæ–¹å¼","æ°´å¹³æ€è€ƒ"],"title":"ã€Šå…­é¡¶æ€è€ƒå¸½ã€‹è¯»ä¹¦ç¬”è®°","uri":"/six-thinking-hats/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"è‡ªæ²»DBMSå¯ä»¥é™ä½DBAå·¥ä½œè´Ÿæ‹…ï¼Œä¸ºä¼ä¸šå¸¦æ¥æ•°æ®é©±åŠ¨å†³ç­–çš„ä¾¿åˆ©ã€‚è¯¥æ–‡æå‡ºPeloton DBMSè‡ªæ²»æ¶æ„ï¼Œå¹¶è®¤ä¸ºåœ¨æ·±åº¦ç¥ç»ç½‘ç»œã€æ–°ç¡¬ä»¶å’Œé«˜æ€§èƒ½æ•°æ®åº“æ¶æ„ä¸‹ï¼Œè‡ªæ²»DBMSæ˜¯å¯ä»¥å®ç°çš„","date":"2021-01-22","objectID":"/self-driving-dbms/","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"æ³¨æ„ è‡ªæ²» DBMS å¯ä»¥é™ä½ DBA å·¥ä½œè´Ÿæ‹…ï¼Œä¸ºä¼ä¸šå¸¦æ¥æ•°æ®é©±åŠ¨å†³ç­–çš„ä¾¿åˆ©ã€‚è¯¥æ–‡æå‡º Peloton DBMS è‡ªæ²»æ¶æ„ï¼Œå¹¶è®¤ä¸ºåœ¨æ·±åº¦ç¥ç»ç½‘ç»œã€æ–°ç¡¬ä»¶å’Œé«˜æ€§èƒ½æ•°æ®åº“æ¶æ„ä¸‹ï¼Œè‡ªæ²» DBMS æ˜¯å¯ä»¥å®ç°çš„ã€‚ åŸæ–‡åœ¨è¿™é‡Œ ğŸ‘‰ Self-Driving DBMS ","date":"2021-01-22","objectID":"/self-driving-dbms/:0:0","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"æ‘˜è¦è¿‡å»ï¼Œç ”ç©¶å‘˜å’Œä¾›åº”å•†éƒ½æ­å»ºäº†æŸ¥è¯¢å·¥å…·å»å¸®åŠ© DBA å®ç°ç³»ç»Ÿè°ƒä¼˜ã€ç‰©ç†è®¾è®¡ã€‚ç„¶è€Œï¼Œä¹‹å‰å¤§éƒ¨åˆ†å·¥ä½œæ˜¯ä¸å®Œæ•´çš„ï¼Œå› ä¸º DBA ä»æ— æ³•æ‘†è„±æ•°æ®åº“æ›´æ”¹çš„è£å®šå·¥ä½œï¼Œå¹¶ä¸”åœ¨é—®é¢˜å‘ç”Ÿåä»éœ€è¦é‡‡å–åº”å¯¹æªæ–½ã€‚ çœŸæ­£çš„â€œè‡ªæ²»â€æ•°æ®åº“ç®¡ç†ç³»ç»ŸDatabase Manage Systemæ‰€éœ€è¦çš„æ˜¯ä¸€ç§ä¸ºè‡ªæ²»è€Œè®¾è®¡çš„æ–°æ¶æ„ã€‚è¿™ä¸ä»¥å‰çš„å·¥ä½œä¸åŒï¼Œå› ä¸ºç³»ç»Ÿæ‰€æœ‰æ–¹é¢éƒ½å—é›†æˆè§„åˆ’ç»„ä»¶æ§åˆ¶ï¼Œè¯¥ç»„ä»¶ä¸ä»…ä¼˜åŒ–ç³»ç»Ÿä»¥é€‚åº”å½“å‰è´Ÿè½½ï¼Œä¹Ÿé¢„æµ‹æœªæ¥çš„è´Ÿè½½è¶‹åŠ¿ï¼Œä»¥ä¾¿ç³»ç»Ÿèƒ½å¤Ÿç›¸åº”åœ°è¿›è¡Œå‡†å¤‡ã€‚è¿™æ ·ï¼ŒDBMS å°±å¯ä»¥æ”¯æŒæ‰€æœ‰ä»¥å‰çš„è°ƒä¼˜æŠ€æœ¯ï¼Œè€Œä¸éœ€è¦äººåŠ›ç¡®å®šæ­£ç¡®çš„æ–¹å¼å’Œé€‚å½“çš„æ—¶é—´å»éƒ¨ç½²å®ƒä»¬ã€‚å®ƒè¿˜æ”¯æŒä¸€äº›å¯¹ç°ä»£é«˜æ€§èƒ½ DBMS å¾ˆé‡è¦çš„ä¼˜åŒ–ï¼Œè¿™ç‚¹åœ¨ä»Šå¤©æ˜¯å¾ˆéš¾çš„ï¼Œå› ä¸ºç®¡ç†è¿™äº›ç³»ç»Ÿçš„å¤æ‚æ€§å·²ç»çªç ´ä¸“å®¶çš„èƒ½åŠ›ä¸Šé™ã€‚ æœ¬æ–‡ä»‹ç»äº†ç¬¬ä¸€ä»£ Self-Driving DBMSâ€”â€”Peloton çš„æ¶æ„ã€‚ç”±äºæ·±åº¦å­¦ä¹ ç®—æ³•çš„è¿›æ­¥ä»¥åŠç¡¬ä»¶ã€è‡ªé€‚åº”æ•°æ®åº“æ¶æ„çš„æ”¹è¿›ï¼ŒPeloton çš„è‡ªä¸»èƒ½åŠ›ç°åœ¨æœ‰äº†å¯èƒ½æ€§ã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:1:0","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"ä»‹ç»ä» 1970 å¹´ä»¥æ¥ï¼Œå…³ç³»æ¨¡å‹å’Œå£°æ˜å¼æŸ¥è¯¢è¯­è¨€å°±ä»¥æ¶ˆé™¤æ•°æ®ç®¡ç†è´Ÿæ‹…ä¸ºå–ç‚¹ã€‚40å¹´åï¼ŒDBMS å˜å¾—æ›´åŠ å¤æ‚ï¼ŒåŠŸèƒ½è¶Šæ¥è¶Šå¤šã€‚ä½¿ç”¨ç°æœ‰çš„è‡ªåŠ¨è°ƒä¼˜å·¥å…·æ˜¯ä¸€é¡¹ç¹é‡çš„ä»»åŠ¡ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦è´¹åŠ›å‡†å¤‡å·¥ä½œè´Ÿè½½æ ·æœ¬ã€ç©ºé—²çš„ç¡¬ä»¶æ¥æµ‹è¯•æ›´æ–°ï¼Œæœ€é‡è¦çš„åŸå› æ˜¯éœ€è¦ç›´è§‚äº†è§£ DBMS å†…éƒ¨ç»“æ„ã€‚å¦‚æœ DBMS å¯ä»¥è‡ªåŠ¨å®Œæˆè¿™äº›äº‹ï¼Œé‚£ä¹ˆå®ƒå°†æ¶ˆé™¤éƒ¨ç½²æ•°æ®åº“æ‰€æ¶‰åŠçš„è®¸å¤šå¤æ‚æ€§å’Œæˆæœ¬ã€‚ ä»¥å‰å…³äºè°ƒä¼˜ç³»ç»Ÿçš„å·¥ä½œå…³æ³¨ç‚¹åœ¨é’ˆå¯¹æ•°æ®åº“å•ä¸ªæ–¹é¢çš„ç‹¬ç«‹å·¥å…·ä¸Šã€‚ä¾‹å¦‚ï¼Œä¸€äº›å·¥å…·èƒ½å¤Ÿé€‰æ‹©æ•°æ®åº“çš„æœ€ä½³é€»è¾‘æˆ–ç‰©ç†è®¾è®¡ï¼Œå¦‚ç´¢å¼•ã€åˆ†åŒºæ–¹æ¡ˆã€æ•°æ®ç»„ç»‡æˆ–ç‰©åŒ–è§†å›¾ã€‚å…¶ä»–å·¥å…·å¯ä»¥ä¸ºåº”ç”¨é€‰æ‹©è°ƒä¼˜å‚æ•°ã€‚è¿™äº›å·¥å…·ä¸­çš„å¤§å¤šæ•°éƒ½ä»¥ç›¸åŒçš„æ–¹å¼æ“ä½œï¼šDBA ä¸ºå…¶æä¾›æ ·æœ¬æ•°æ®åº“å’Œå·¥ä½œè´Ÿè½½è·Ÿè¸ªï¼Œä»¥æŒ‡å¯¼æœç´¢è¿‡ç¨‹å»æ‰¾åˆ°æœ€ä½³æˆ–æ¥è¿‘æœ€ä½³çš„é…ç½®ã€‚ä¸»è¦çš„ DBMS ä¾›åº”å•†ï¼ˆåŒ…æ‹¬ Oracleã€Microsoft å’Œ IBMï¼‰éƒ½ä»¥è¿™ç§æ–¹å¼æ“ä½œã€‚æœ€è¿‘æœ‰ä¸€ç§æ¨åŠ¨é›†æˆç»„ä»¶æ”¯æŒè‡ªé€‚åº”æ¶æ„çš„è¶‹åŠ¿ï¼Œä½†è¿™åŒæ ·åªä¸“æ³¨äºè§£å†³ä¸€ä¸ªé—®é¢˜ã€‚åŒæ ·ï¼Œäº‘å‚å•†ä½¿ç”¨åŠ¨æ€èµ„æºåˆ†é…æœåŠ¡ï¼Œä¸ä¼šå¯¹å•ä¸ªæ•°æ®åº“è¿›è¡Œè°ƒä¼˜ã€‚ æ‰€æœ‰è¿™äº›å¯¹ä¸€ä¸ªå®Œå…¨è‡ªæ²»çš„ç³»ç»Ÿæ¥è¯´éƒ½æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºå®ƒä»¬åœ¨ DBMS ä¹‹å¤–ï¼Œä¸èƒ½åŒæ—¶è§£å†³å¤šä¸ªé—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬ä»ç³»ç»Ÿå¤–éƒ¨è§‚å¯Ÿ DBMS çš„è¡Œä¸ºï¼Œå¹¶åœ¨é—®é¢˜å‘ç”Ÿåå»ºè®® DBA å¦‚ä½•ä¿®æ­£é—®é¢˜ã€‚è°ƒä¼˜å·¥å…·å‡å®šæ“ä½œå®ƒä»¬çš„äººæœ‰è¶³å¤Ÿçš„çŸ¥è¯†ï¼Œå¯ä»¥åœ¨ç‰¹å®šæ—¶é—´å†…æ›´æ–° DBMSï¼Œä¸å¯¹åº”ç”¨äº§ç”Ÿå¤§å½±å“ã€‚ç„¶è€Œï¼Œæ•°æ®åº“é¢†åŸŸåœ¨è¿‡å»åå¹´ä¸­å‘ç”Ÿäº†å·¨å¤§çš„å˜åŒ–ï¼Œæˆ‘ä»¬ä¸èƒ½å‡å®š DBMS æ˜¯ç”±ä¸€ä¸ªäº†è§£æ•°æ®åº“ä¼˜åŒ–çš„ä¸“å®¶éƒ¨ç½²è€Œæˆã€‚å†è¯´ï¼Œå³ä½¿è¿™äº›è¿™äº›å·¥å…·å¯ä»¥å®ç°è‡ªæ²»ï¼Œ DBMS æ¶æ„ä¹Ÿä¼šåœ¨é‡å¤§æ›´æ–°æ—¶ç»™ DBMS æ–½åŠ å¾ˆå¤§å‹åŠ›ï¼Œä¹Ÿæ— æ³•çªç ´æœªæ¥çš„ç“¶é¢ˆã€‚ æœ¬æ–‡ä¸­ï¼Œä½œè€…è¯æ˜äº†è‡ªæ²»æ•°æ®åº“ç³»ç»Ÿæ˜¯å¯ä»¥å®ç°çš„ã€‚ä¸‹æ–‡é¦–å…ˆä¼šè®¨è®ºè¯¥ç³»ç»Ÿæ‰€é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜ã€‚ç„¶åï¼Œä½œè€…æå‡ºäº† Peloton çš„æ¶æ„ï¼Œä»¥åŠä½¿ç”¨ Peloton ä¸­é›†æˆæ·±åº¦å­¦ä¹ æ¡†æ¶çš„æµ‹é‡ç»“æœã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:2:0","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"é—®é¢˜æ¦‚è¿°è‡ªæ²» DBMS é¢ä¸´çš„ç¬¬ä¸€ä¸ªæŒ‘æˆ˜æ˜¯ç†è§£åº”ç”¨çš„è´Ÿè½½ã€‚æœ€åŸºæœ¬çš„çº§åˆ«æ˜¯å°†æŸ¥è¯¢å®šä¹‰ä¸º OLTP æˆ– OLAP åº”ç”¨ã€‚å¦‚æœ DBMS ç¡®å®šäº†åº”ç”¨å±äºäºŒè€…ä¸­çš„å“ªä¸€ç±»ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥å†³å®šå¦‚ä½•ä¼˜åŒ–æ•°æ®åº“ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ˜¯ OLTPï¼ŒDBMS åº”è¯¥å°†å…ƒç»„å­˜å‚¨åœ¨é¢å‘è¡Œçš„å¸ƒå±€ä¸­ï¼Œå¹¶ä¸ºå†™è¿›è¡Œä¼˜åŒ–ã€‚å¦‚æœæ˜¯ OLAPï¼Œé‚£ä¹ˆ DBMS ä½¿ç”¨é¢å‘åˆ—çš„å¸ƒå±€ï¼Œè¿™æ ·æ›´é€‚åº”è®¿é—®è¡¨åˆ—å­é›†çš„åªè¯»æŸ¥è¯¢ ã€‚å¤„ç†è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯éƒ¨ç½²ä¸“é—¨ç”¨äº OLTP å’Œ OLAP è´Ÿè½½çš„ç‹¬ç«‹ DBMSï¼Œç„¶ååœ¨å®ƒä»¬ä¹‹é—´å®šæœŸæµæ›´æ–°ã€‚ä½†æ˜¯è¿™ä¸é€‚åˆ HTAPï¼Œå› ä¸ºå®ƒåœ¨æ•°æ®ç”± OLTP å†™å…¥æ—¶å°±æ‰§è¡Œ OLAP æŸ¥è¯¢ï¼Œæ‰€ä»¥æ— æ³•å°† DBMS ç‹¬ç«‹éƒ¨ç½²å¼€ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯éƒ¨ç½²ä¸€ä¸ªæ”¯æŒæ··åˆ HTAP è´Ÿè½½çš„ DBMS ã€‚è¿™ç§ç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºä¸åŒæ•°æ®åº“æ®µé€‰æ‹©é€‚å½“çš„ OLTP æˆ– OLAP ä¼˜åŒ–ã€‚ é™¤äº†è¦ç†è§£åº”ç”¨çš„è´Ÿè½½ï¼ŒDMS ä¹Ÿéœ€è¦é¢„æµ‹èµ„æºåˆ©ç”¨è¶‹åŠ¿ã€‚è¿™å¸®åŠ©å®ƒèƒ½å¤Ÿé¢„æµ‹æœªæ¥éœ€æ±‚å’Œéƒ¨ç½²ä¼˜åŒ–ï¼ŒåŒæ—¶å¯¹æ€§èƒ½å½±å“æœ€å°ã€‚è®¸å¤šç¨‹åºçš„ä½¿ç”¨æ¨¡å¼å¯†åˆ‡å¥‘åˆäººç±»çš„æ—¥å¸¸ç”Ÿæ´»ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ DBA ä¼šåœ¨éé«˜å³°æ—¶é—´å®‰æ’æ›´æ–°ï¼Œä»¥é¿å…æ­£å¸¸ä¸šåŠ¡æ—¶é—´çš„æœåŠ¡ä¸­æ–­ã€‚ä¸å¯å¦è®¤ï¼Œæœ‰äº›å·¥ä½œè´Ÿè½½å¼‚å¸¸æ˜¯ DBMS æ— æ³•é¢„æ–™çš„ã€‚ä½†è¿™äº›æ¨¡å‹å¯ä»¥é¢„å…ˆè­¦å‘Šï¼Œä½¿å¾— DBMS èƒ½å¤Ÿæ¯”å¤–éƒ¨ç›‘æ§ç³»ç»Ÿæ›´å¿«åœ°å®æ–½ç¼“è§£æªæ–½ã€‚ ç°åœ¨ï¼Œ DBMS å¯ä»¥ä¾é è¿™äº›æ¨¡å‹å»ç¡®å®šæ•°æ®åº“è°ƒä¼˜ä¸ä¼˜åŒ–æ“ä½œï¼Œä»¥æ›´å¥½åº”å¯¹é¢„æœŸçš„å·¥ä½œè´Ÿè½½ã€‚è‡ªæ²» DBMS ä¸æ”¯æŒ DBA çš„ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡éœ€è¦ç³»ç»Ÿå¤–éƒ¨ä¿¡æ¯ï¼Œæ¯”å¦‚æƒé™ã€æ•°æ®æ¸…æ´—å’Œç‰ˆæœ¬æ§åˆ¶ã€‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œè‡ªæ²» DBMS å¯ä»¥æ”¯æŒä¸‰ç§ä¼˜åŒ–ç±»å‹ã€‚ç¬¬ä¸€ä¸ªæ˜¯æ•°æ®åº“ç‰©ç†è®¾è®¡ï¼Œç¬¬äºŒä¸ªæ˜¯æ•°æ®ç»„ç»‡çš„ä¿®æ”¹ï¼Œæœ€åæ˜¯å½±å“ DBMS çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚å¯¹äºæ¯ä¸€ä¸ªä¼˜åŒ–æ“ä½œï¼ŒDBMS å°†éœ€è¦è¯„ä¼°å®ƒä»¬å¯¹æ•°æ®åº“çš„æ½œåœ¨å½±å“ã€‚è¿™äº›è¯„ä¼°ä¸ä»…åŒ…æ‹¬è¡ŒåŠ¨éƒ¨ç½²åæ¶ˆè€—çš„èµ„æºï¼Œè¿˜åŒ…æ‹¬ DBMS éƒ¨ç½²è¡ŒåŠ¨æ—¶æ¶ˆè€—çš„èµ„æºã€‚ Types Actions PHYSICAL Indexes AddIndex, DropIndex, Rebuild, Convert PHYSICAL Materialized Views AddMatView, DropMatView PHYSICAL Storage Layout RowğŸ‘‰Columnar, ColumnarğŸ‘‰Row, Compress DATA Location MoveUpTier, MoveDownTier, Migrate DATA Partitioning RepartitionTable, ReplicateTable RUNTIME Resources AddNode, RemoveNode RUNTIME Configuration Tuning IncrementKnob, DecrementKnob, SetKnob RUNTIME Query Optimizations CostModelTune, Compilation, Prefetch å³ä½¿ç³»ç»Ÿèƒ½å¤Ÿé¢„æµ‹ç¨‹åºçš„å·¥ä½œè´Ÿè½½ï¼Œé€‰æ‹©è¦ä½¿ç”¨çš„æ“ä½œ ï¼Œå¹¶ç¡®å®šå®æ–½æ“ä½œçš„æœ€ä½³æ—¶é—´ï¼Œä»ç„¶å­˜åœ¨é¢å¤–çš„æŒ‘æˆ˜ã€‚å¦‚æœ DBMS ä¸èƒ½æœ‰æ•ˆåœ°åº”ç”¨è¿™äº›ä¼˜åŒ–ï¼Œæ²¡æœ‰å¸¦æ¥è¾ƒå¤§çš„æ€§èƒ½ä¸‹é™ï¼Œé‚£ä¹ˆç³»ç»Ÿå°†æ— æ³•å¿«é€Ÿé€‚åº”å˜åŒ–ã€‚è¿™ä¹Ÿæ˜¯ç›®å‰è‡ªæ²» DBMS ä¸å¯èƒ½å®ç°çš„å¦ä¸€ä¸ªåŸå› ã€‚å¦‚æœç³»ç»Ÿåªèƒ½æ¯å‘¨æ›´æ–°ä¸€æ¬¡ï¼Œé‚£ä¹ˆå®ƒå¾ˆéš¾è§„åˆ’å¦‚ä½•çº æ­£ç³»ç»Ÿã€‚å› æ­¤ï¼Œè®ºæ–‡è®¤ä¸ºéœ€è¦ä¸€ä¸ªçµæ´»çš„åŸºäºå†…å­˜çš„ DBMS ä½“ç³»ç»“æ„ï¼Œå¯ä»¥åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é€æ­¥ä¼˜åŒ–ï¼Œè€Œä¸ä¼šå¯¹åº”ç”¨ç¨‹åºäº§ç”Ÿå¯å¯Ÿè§‰çš„å½±å“ã€‚ æœ€åï¼Œä¸€ä¸ªè‡ªæ²» DBMS æœ‰ä¸¤ä¸ªé¢å¤–çš„çº¦æŸï¼Œå®ƒå¿…é¡»å…³è”å¦‚ä»Šçš„åº”ç”¨ç¨‹åºã€‚é¦–å…ˆï¼ŒDBMS ä¸èƒ½è¦æ±‚å¼€å‘äººå‘˜é‡å†™åº”ç”¨ä»£ç ä»¥é€‚åº”è‡ªæ²» DBMSã€‚ç¬¬äºŒï¼Œä¸èƒ½ä¾èµ–åªæ”¯æŒæŸäº›ç¼–ç¨‹ç¯å¢ƒçš„ç¨‹åºåˆ†æå·¥å…·ã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:3:0","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"è‡ªæ²»æ¶æ„ç ”å‘å‘ç°ç°æœ‰ DBMS å¯¹äºè‡ªæ²»æ“ä½œè¿‡äºç¬¨é‡ ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦åœ¨æ›´æ”¹æ—¶é‡æ–°å¯åŠ¨ï¼Œè€Œä¸”ä¸Šè¡¨ä¸­çš„è®¸å¤šæ“ä½œå¤ªæ…¢äº†ã€‚å› æ­¤ï¼ŒDBMS éœ€è¦ä¸€ä¸ªå´­æ–°çš„æ¶æ„ï¼Œå¯¹é›†æˆçš„è‡ªæ²»ç»„ä»¶æœ‰æ›´å…¨é¢ã€æ›´ç»†è‡´çš„æ§åˆ¶ ã€‚ æ¥ä¸‹æ¥æè¿° Peloton æ¶æ„ä¸­çš„ç»„ä»¶ã€‚Peloton æ¶æ„æ˜¯ä¸€ç§å…¨æ–°çš„æ¶æ„ï¼Œè€Œä¸æ˜¯æ”¹é€ ç°æœ‰çš„ DBMSï¼ˆä¾‹å¦‚ï¼ŒPostgres/MySQLï¼‰ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒä½¿ç”¨äº†å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼Œåœ¨ä¸é˜»å¡ OLAP æŸ¥è¯¢çš„å‰æä¸‹äº¤å‰ OLTP äº‹åŠ¡å’Œæ“ä½œã€‚å¦ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ªå†…å­˜å­˜å‚¨ç®¡ç†å™¨ï¼Œå…·æœ‰æ— é”çš„æ•°æ®ç»“æ„å’Œçµæ´»çš„å¸ƒå±€ï¼Œå¯ä»¥å¿«é€Ÿæ‰§è¡Œ HTAP å·¥ä½œè´Ÿè½½ã€‚è¿™äº›è®¾è®¡å·²ç»ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ”¯æŒ Peloton çš„ä¼˜åŒ–æ“ä½œã€‚ Pelotonæ¶æ„ Peloton çš„è‡ªæ²»æµç¨‹å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚é™¤äº†ç¯å¢ƒè®¾ç½®ï¼ˆæ¯”å¦‚å†…å­˜é˜ˆå€¼ä¸ç›®å½•è·¯å¾„ï¼‰ï¼Œè®ºæ–‡çš„ç›®æ ‡æ˜¯è®©Peloton åœ¨æ²¡æœ‰ä»»ä½•äººä¸ºæä¾›çš„æŒ‡å¯¼ä¿¡æ¯çš„æƒ…å†µä¸‹é«˜æ•ˆè¿è¡Œã€‚ç³»ç»Ÿè‡ªåŠ¨å­¦ä¹ å¦‚ä½•æé«˜åº”ç”¨ç¨‹åºæŸ¥è¯¢å’Œäº‹ç‰©çš„å»¶è¿Ÿã€‚å»¶è¿Ÿæ˜¯ DBMS ä¸­æœ€é‡è¦çš„åº¦é‡æ ‡å‡†ï¼Œå› ä¸ºå®ƒå…¨é¢ä»£è¡¨æ€§èƒ½æƒ…å†µã€‚æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†å‡è®¾å»¶è¿Ÿæ˜¯ä¸»è¦ä¼˜åŒ–ç›®æ ‡ã€‚å¯ä»¥ä¸ºåˆ†å¸ƒå¼ç¯å¢ƒä¸­çš„å…¶ä»–é‡è¦æŒ‡æ ‡æ·»åŠ é¢å¤–çš„çº¦æŸï¼Œä¾‹å¦‚æœåŠ¡æˆæœ¬å’Œèµ„æºã€‚ Peloton åŒ…å«ä¸€ä¸ªåµŒå…¥å¼ç›‘è§†å™¨ï¼Œè·Ÿè¸ªç³»ç»Ÿçš„å†…éƒ¨äº‹ä»¶æµçš„æ‰§è¡ŒæŸ¥è¯¢ã€‚æ¯ä¸ªæŸ¥è¯¢æ¡ç›®éƒ½æ ‡æ³¨äº†å…¶èµ„æºåˆ©ç”¨ç‡ã€‚æµè¿˜å®šæœŸè¢« DBMS/OS é¥æµ‹æ•°æ®å’Œä¼˜åŒ–æ“ä½œçš„å¼€å§‹/ç»“æŸäº‹ä»¶æ‰“æ–­ã€‚ç„¶åï¼ŒDBMS æ ¹æ®è¿™äº›ç›‘æ§æ•°æ®ä¸ºåº”ç”¨ç¨‹åºçš„é¢„æœŸå·¥ä½œè´Ÿè½½æ„å»ºé¢„æµ‹æ¨¡å‹ã€‚å®ƒä½¿ç”¨è¿™äº›æ¨¡å‹æ¥è¯†åˆ«ç“¶é¢ˆå’Œå…¶ä»–é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œç¼ºå°‘ç´¢å¼•ã€è¶…è½½èŠ‚ç‚¹ï¼‰ï¼Œç„¶åé€‰æ‹©æœ€ä½³æ“ä½œã€‚ç³»ç»Ÿæ‰§è¡Œæ­¤æ“ä½œçš„åŒæ—¶ä»ç„¶å¤„ç†åº”ç”¨ç¨‹åºçš„å¸¸è§„å·¥ä½œè´Ÿè½½ï¼Œå¹¶æ”¶é›†æ–°çš„ç›‘æ§æ•°æ®ï¼Œä»¥äº†è§£è¿™äº›æ“ä½œå¦‚ä½•å½±å“å…¶æ€§èƒ½ã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:4:0","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"å·¥ä½œè´Ÿè½½åˆ†ç±»ç¬¬ä¸€ä¸ªç»„ä»¶æ˜¯ DBMS çš„é›†ç¾¤å™¨ï¼Œå®ƒä½¿ç”¨æ— ç›‘ç£å­¦ä¹ æ–¹æ³•å¯¹å…·æœ‰ç±»ä¼¼ç‰¹å¾çš„åº”ç”¨ç¨‹åºæŸ¥è¯¢è¿›è¡Œåˆ†ç±»ã€‚é›†ç¾¤å·¥ä½œè´Ÿè½½å‡å°‘äº† DBMS ç»´æŠ¤çš„é¢„æµ‹æ¨¡å‹æ•°é‡ï¼Œä»è€Œä½¿é¢„æµ‹åº”ç”¨ç¨‹åºçš„è¡Œä¸ºæ›´å®¹æ˜“ï¼ˆä¹Ÿæ›´å‡†ç¡®ï¼‰ã€‚Peloton çš„åˆå§‹å®ç°ä½¿ç”¨ DBSCAN ç®—æ³•ã€‚è¿™ç§æ–¹æ³•å·²è¢«ç”¨äºå¯¹é™æ€ OLTP å·¥ä½œè´Ÿè½½è¿›è¡Œèšé›†æ“ä½œã€‚ è¿™ç§é›†ç¾¤çš„ä¸€å¤§é—®é¢˜æ˜¯ä½¿ç”¨ä»€ä¹ˆæŸ¥è¯¢ç‰¹å¾ã€‚è¿™ä¸¤ç§ç±»å‹çš„ç‰¹æ€§æ˜¯æŸ¥è¯¢çš„æ—¶é—´åº¦é‡å’ŒæŸ¥è¯¢çš„é€»è¾‘è¯­ä¹‰ã€‚è™½ç„¶å‰è€…ä½¿ DBMS èƒ½å¤Ÿæ›´å¥½åœ°èšé›†ç±»ä¼¼çš„æŸ¥è¯¢ï¼Œä¸”ä¸éœ€è¦ç†è§£å®ƒä»¬çš„å«ä¹‰ï¼Œä½†å®ƒä»¬å¯¹æ•°æ®åº“å†…å®¹æˆ–å…¶ç‰©ç†è®¾è®¡è®¾è®¡çš„å˜åŒ–æ›´æ•æ„Ÿã€‚å³ä½¿æ•°æ®åº“æ²¡æœ‰æ›´æ”¹ï¼Œåœ¨é«˜å¹¶å‘å·¥ä½œè´Ÿè½½ä¸­ä¹Ÿå¯èƒ½å‘ç”Ÿç±»ä¼¼çš„é—®é¢˜ã€‚å¦ä¸€ä¸ªæ–¹æ³•æ˜¯æ ¹æ®é€»è¾‘æ‰§è¡Œè®¡åˆ’çš„ç»“æ„ï¼ˆä¾‹å¦‚è¡¨ã€è°“è¯ï¼‰å¯¹æŸ¥è¯¢è¿›è¡Œåˆ†ç±»ï¼Œè¿™äº›ç‰¹å¾ç‹¬ç«‹äºæ•°æ®åº“çš„å†…å®¹åŠå…¶ç‰©ç†è®¾è®¡ã€‚è¿™äº›ç‰¹å¾æ˜¯å¦ä¼šäº§ç”Ÿé›†ç¾¤ä»¥ç”Ÿæˆè‰¯å¥½çš„é¢„æµ‹æ¨¡å‹è¿˜æœ‰å¾…è§‚å¯Ÿï¼Œæˆ–è€…è¿è¡Œæ—¶æŒ‡æ ‡çš„å‡†ç¡®æ€§æ˜¯å¦è¶…è¿‡äº†å†è®­ç»ƒçš„æˆæœ¬ã€‚è¿è¡Œæ—¶åº¦é‡å¯èƒ½ä¼šä½¿ç³»ç»Ÿåœ¨æ›´çŸ­çš„æ—¶é—´å†…æ”¶æ•›åˆ°ç¨³å®šçš„çŠ¶æ€ï¼Œå› æ­¤ç³»ç»Ÿä¸å¿…ç»å¸¸é‡æ–°è®­ç»ƒå®ƒçš„é¢„æµ‹æ¨¡å‹ã€‚æˆ–è€…ï¼Œå³ä½¿é›†ç¾¤ç»å¸¸å˜åŒ–ï¼Œç¡¬ä»¶åŠ é€Ÿè®­ç»ƒä¹Ÿèƒ½ä½¿ç³»ç»Ÿä»¥æœ€å° çš„å¼€é”€åŠ é€Ÿé‡å»ºæ¨¡å‹ã€‚ ä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•ç¡®å®šé›†ç¾¤ä½•æ—¶å¤±æ•ˆã€‚å½“è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼ŒDBMS å¿…é¡»é‡æ–°æ„å»ºé›†ç¾¤ï¼Œè¿™å¯èƒ½æ‰“ä¹±å·²æœ‰çš„åˆ†ç±»ï¼Œå¹¶è¦æ±‚å®ƒé‡æ–°è®­ç»ƒæ‰€æœ‰çš„é¢„æµ‹æ¨¡å‹ã€‚Peloton ä½¿ç”¨æ ‡å‡†äº¤å‰éªŒè¯æŠ€æœ¯æ¥ç¡®å®šé›†ç¾¤çš„é”™è¯¯ç‡ä½•æ—¶è¶…è¿‡é˜ˆå€¼ã€‚DBMS è¿˜å¯ä»¥åˆ©ç”¨æ“ä½œå¯¹æŸ¥è¯¢çš„å½±å“æ¥å†³å®šä½•æ—¶é‡å»ºé›†ç¾¤ã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:4:1","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"è´Ÿè½½é¢„æµ‹ä¸‹ä¸€æ­¥æ˜¯è®­ç»ƒé¢„æµ‹æ¨¡å‹ï¼Œé¢„æµ‹æ¯ä¸ªå·¥ä½œè´Ÿè½½é›†ç¾¤çš„æŸ¥è¯¢æŠµè¾¾ç‡ã€‚é™¤äº†å¼‚å¸¸çƒ­ç‚¹å¤–ï¼Œè¿™ç§é¢„æµ‹ä½¿ç³»ç»Ÿèƒ½å¤Ÿè¯†åˆ«å·¥ä½œè´Ÿè½½å‘¨æœŸæ€§å’Œæ•°æ®å¢é•¿è¶‹åŠ¿ï¼Œä¸ºè´Ÿè½½æ³¢åŠ¨åšå¥½å‡†å¤‡ã€‚åœ¨ DBMS æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢åï¼Œå®ƒç”¨å®ƒçš„é›†ç¾¤æ ‡è¯†ç¬¦æ ‡è®°æ¯ä¸ªæŸ¥è¯¢ï¼Œç„¶åå¡«å……ä¸€ä¸ªç›´æ–¹å›¾ğŸ“Šï¼Œè¯¥ç›´æ–¹å›¾è·Ÿè¸ªåœ¨ä¸€æ®µæ—¶é—´å†…æ¯ä¸ªé›†ç¾¤æ”¶åˆ°çš„æŸ¥è¯¢æ•°é‡ã€‚Peloton ä½¿ç”¨è¿™äº›æ•°æ®æ¥è®­ç»ƒé¢„æµ‹æ¨¡å‹ï¼Œé¢„æµ‹åº”ç”¨ç¨‹åºæœªæ¥å°†æ‰§è¡Œçš„æ¯ä¸ªé›†ç¾¤çš„æŸ¥è¯¢æ•°ã€‚DBMS è¿˜ä¸ºäº‹ä»¶æµä¸­çš„å…¶ä»– DBMS/OS æŒ‡æ ‡æ„å»ºäº†ç±»ä¼¼çš„æ¨¡å‹ã€‚ ä»¥å‰åœ¨è‡ªæ²»ç³»ç»Ÿæ–¹é¢çš„å°è¯•ä½¿ç”¨äº† auto-regressive-moving average æ¨¡å‹ï¼ˆARMAï¼‰æ¥é¢„æµ‹åœ¨äº‘ä¸­è‡ªåŠ¨ä¼¸ç¼©çš„ web æœåŠ¡å·¥ä½œè´Ÿè½½ã€‚ARMA å¯ä»¥æ•è·æ—¶é—´åºåˆ—æ•°æ®ä¸­çš„çº¿æ€§å…³ç³»ï¼Œä½†å®ƒä»¬é€šå¸¸éœ€è¦ä¸€ä¸ªäººæ¥è¯†åˆ«æ¨¡å‹ä¸­çš„å·®åˆ†é¡ºåºå’Œ term çš„æ•°é‡ã€‚æ­¤å¤–ï¼Œçº¿æ€§å‡è®¾å¯¹äºè®¸å¤šæ•°æ®åº“å·¥ä½œè´Ÿè½½å¯èƒ½å¹¶ä¸æœ‰æ•ˆï¼Œå› ä¸ºå®ƒä»¬å—åˆ°å¤–éƒ¨å› ç´ çš„å½±å“ã€‚ RNN æ˜¯é¢„æµ‹éçº¿å½¢ç³»ç»Ÿæ—¶é—´åºåˆ—æ¨¡å¼çš„ä¸€ç§æœ‰æ•ˆæ–¹æ³•ã€‚LSTM æ˜¯ RNN çš„ä¸€ç§å˜ä½“ï¼Œå…è®¸ç½‘ç»œå­¦ä¹ æ—¶é—´åºåˆ—æ•°æ®ä¸­çš„å‘¨æœŸæ€§å’Œé‡å¤è¶‹åŠ¿ï¼Œè€Œå¸¸è§„çš„ RNN æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚LSTM åŒ…å«ä¸€äº›ç‰¹æ®Šçš„ blockï¼Œç”¨äºå†³å®šæ˜¯å¦ä¿ç•™æ—§çš„ä¿¡æ¯ä»¥åŠä½•æ—¶å°†å…¶è¾“å‡ºåˆ°ç½‘ç»œä¸­ã€‚å°½ç®¡ RNN è¢«å¹æ§ä¸ºèƒ½å¤Ÿè§£å†³è®¸å¤šä»¥å‰éš¾ä»¥è§£å†³çš„é—®é¢˜ï¼Œä½†ä»éœ€è¦ç ”ç©¶å¦‚ä½•ä½¿å…¶é€‚ç”¨äºè‡ªæ²» DBMSã€‚ RNN çš„å‡†ç¡®æ€§ä¹Ÿä¾èµ–äºå®ƒçš„è®­ç»ƒé›†æ•°æ®çš„å¤§å°ã€‚ä½†æ˜¯è·Ÿè¸ªåœ¨ DBMS ä¸­æ‰§è¡Œçš„æ¯ä¸ªæŸ¥è¯¢éƒ½ä¼šå¢åŠ æ¨¡å‹æ„å»ºçš„è®¡ç®—æˆæœ¬ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰å¿…è¦çŸ¥é“å°†æ¥æŸ¥è¯¢çš„ç¡®åˆ‡æ•°é‡ã€‚ç›¸åï¼ŒPeloton ä¸ºæ¯ä¸ªç»„ç»´æŠ¤å¤šä¸ª RNNï¼Œå®ƒä»¬åœ¨ä¸åŒçš„æ—¶é—´èŒƒå›´å’Œé—´éš”ç²’åº¦ä¸Šé¢„æµ‹å·¥ä½œè´Ÿè½½ã€‚å°½ç®¡è¿™äº›ç²—ç²’åº¦çš„ RNN ä¸å‡†ç¡®ï¼Œä½†å®ƒä»¬å‡å°‘äº† DBMS å¿…é¡»ç»´æŠ¤çš„è®­ç»ƒæ•°æ®å’Œè¿è¡Œæ—¶çš„é¢„æµ‹æˆæœ¬ã€‚ç»„åˆå¤šä¸ª RNN ä½¿ DBMS èƒ½å¤Ÿå¤„ç†å¯¹ç²¾ç¡®åº¦è¦æ±‚æ›´é«˜çš„å³æ—¶é—®é¢˜ï¼Œä¹Ÿèƒ½å¤Ÿé€‚åº”è¯„ä¼°èŒƒå›´æ›´å¹¿çš„é•¿æœŸè®¡åˆ’ã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:4:2","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"è¡ŒåŠ¨è®¡åˆ’ä¸æ‰§è¡Œæœ€åä¸€ä¸ªç»„ä»¶æ˜¯ Peloton çš„æ§åˆ¶æ¡†æ¶ï¼Œèƒ½å¤ŸæŒç»­ç›‘æ§ç³»ç»Ÿå’Œé€‰æ‹©ä¼˜åŒ–è¡ŒåŠ¨ï¼Œä»¥æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚è¿™å°±æ˜¯è‡ªæ²»ç»„ä»¶å’Œ DBMS æ¶æ„ç´§å¯†è€¦åˆçš„æœ€æ˜æ˜¾å¥½å¤„ï¼Œå› ä¸ºå®ƒä½¿ä¸åŒçš„éƒ¨åˆ†èƒ½å¤Ÿç›¸äº’æä¾›åé¦ˆã€‚ä½œè€…ä¹Ÿç›¸ä¿¡æœ‰æœºä¼šåœ¨ç³»ç»Ÿæ›´å¤šéƒ¨åˆ†ä¸­ä½¿ç”¨å¼ºåŒ–å­¦ä¹ ï¼ŒåŒ…æ‹¬å¹¶å‘æ§åˆ¶å’ŒæŸ¥è¯¢ä¼˜åŒ–ã€‚ è¡ŒåŠ¨ç”Ÿæˆï¼šç³»ç»Ÿæœç´¢å¯èƒ½æé«˜æ€§èƒ½çš„æ“ä½œã€‚Peloton å°†è¿™äº›æ“ä½œå­˜å‚¨åœ¨ä¸€ä¸ªç›®å½•ä¸­ï¼Œå¹¶è®°å½•åœ¨æ“ä½œè°ƒç”¨çš„å†å²ã€‚è¿™ç§æœç´¢æ˜¯ç”±é¢„æµ‹æ¨¡å‹æŒ‡å¯¼çš„ã€‚å®ƒè¿˜å¯ä»¥åˆ é™¤å†—ä½™æ“ä½œï¼Œé™ä½æœç´¢å¤æ‚åº¦ã€‚ åœ¨éœ€æ±‚ç«äº‰ä½æ—¶ï¼ŒPeloton å¯ä»¥ç”¨æ›´å¤šçš„æ ¸å»å®ŒæˆåŠ¨ä½œéƒ¨ç½²ï¼Œåœ¨ç«äº‰é«˜æ—¶ï¼Œåªèƒ½ç”¨æ›´å°‘çš„æ ¸ã€‚ è¡ŒåŠ¨è®¡åˆ’ï¼šç°åœ¨æœ‰äº†è¡ŒåŠ¨ç›®å½•ï¼ŒDBMS æ ¹æ®é¢„æµ‹ã€å½“å‰æ•°æ®åº“é…ç½®å’Œç›®æ ‡å‡½æ•°å»é€‰æ‹©éƒ¨ç½²å“ªä¸ªè¡ŒåŠ¨ã€‚æ»šåŠ¨æ—¶åŸŸæ§åˆ¶æ¨¡å‹receding-horizon control modelï¼ŒRHCMçš„åŸºæœ¬æ€æƒ³ï¼šåœ¨æ¯ä¸ªæ—¶é—´å•å…ƒï¼Œç³»ç»Ÿä½¿ç”¨é¢„æµ‹æ¥ä¼°è®¡æŸä¸ªæœ‰é™æ—¶åŸŸçš„å·¥ä½œè´Ÿè½½ã€‚ç„¶åï¼Œå®ƒä¼šæœç´¢åŠ¨ä½œï¼Œä»¥æœ€å°åŒ–ç›®æ ‡å‡½æ•°ã€‚ä½†å®ƒåªèƒ½åº”ç”¨äºç¬¬ä¸€ä¸ªåŠ¨ä½œï¼Œåœ¨ä¸‹ä¸ªæ—¶é—´å•å…ƒé‡å¤æµç¨‹å‰åªå¥½ç­‰å¾…éƒ¨ç½²å®Œæˆã€‚è¿™å°±æ˜¯é«˜æ€§èƒ½ DBMS è‡³å…³é‡è¦çš„åŸå› ã€‚å¦‚æœåŠ¨ä½œåœ¨å‡ åˆ†é’Ÿå†…å®Œæˆï¼Œåˆ™ç³»ç»Ÿä¸å¿…ç›‘è§†å·¥ä½œè´Ÿè½½æ˜¯å¦å·²ç»è½¬ç§»ï¼Œå¹¶å†³å®šä¸­æ­¢æ­£åœ¨æ‰§è¡Œçš„åŠ¨ä½œã€‚ åœ¨ RHCM ä¸‹ï¼Œè®¡ç®—è¿‡ç¨‹è¢«å»ºæ¨¡ä¸ºä¸€æ£µæ ‘ï¼Œå…¶ä¸­æ¯ä¸€å±‚åŒ…å« DBMS å¯ä»¥è°ƒç”¨æ¯ä¸ªæ“ä½œçš„æ—¶é—´ã€‚è¯¥ç³»ç»Ÿé€šè¿‡ä¼°ç®—è¡ŒåŠ¨çš„æˆæœ¬æ•ˆç›Šæ¥æœç´¢æ ‘ï¼Œå¹¶é€‰æ‹©æœ€ä½æˆæœ¬çš„è¡ŒåŠ¨åºåˆ—ã€‚ä¹Ÿå¯ä»¥é€‰æ‹©åœ¨ä¸€ä¸ªæ—¶é—´å•å…ƒå†…ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ä¸€ç§é™ä½è¿™ä¸ªè¿‡ç¨‹å¤æ‚æ€§çš„æ–¹æ³•æ˜¯ï¼Œåœ¨æœç´¢æ ‘çš„æ›´æ·±å±‚æ¬¡éšæœºé€‰æ‹©è¦è€ƒè™‘çš„è¡ŒåŠ¨ï¼Œè€Œä¸æ˜¯è¯„ä¼°æ‰€æœ‰å¯èƒ½çš„è¡ŒåŠ¨ã€‚è¿™ç§æŠ½æ ·ä¼šåŠ ä¸Šæƒé‡ï¼Œä»¥ä¾¿æ›´æœ‰å¯èƒ½è€ƒè™‘ä¸ºæ•°æ®åº“å½“å‰çŠ¶æ€åŠå…¶é¢„æœŸå·¥ä½œè´Ÿè½½æä¾›æœ€ä¼˜è¡ŒåŠ¨ã€‚å®ƒè¿˜é¿å…äº†æœ€è¿‘è°ƒç”¨çš„è¡ŒåŠ¨ï¼Œä½†åæ¥ç³»ç»Ÿå–æ¶ˆè¿™æ¡è§„åˆ™ã€‚ ä¸€ä¸ªè¡ŒåŠ¨çš„æˆæœ¬æ˜¯å¯¹éƒ¨ç½²å®ƒæ‰€éœ€çš„æ—¶é—´ä¼°è®¡ï¼Œä»¥åŠåœ¨è¿™æ®µæ—¶é—´å†… DBMS æ€§èƒ½ä¼šä¸‹é™å¤šå°‘ã€‚ç”±äºä»¥å‰æ²¡æœ‰éƒ¨ç½²è¿‡å¾ˆå¤šè¡ŒåŠ¨ï¼Œå› æ­¤ä¸å¯èƒ½æ€»æ˜¯ä»ä»¥å‰çš„å†å²è®°å½•ç”Ÿæˆè¿™äº›ä¿¡æ¯ã€‚ç³»ç»Ÿä½¿ç”¨åˆ†ææ¨¡å‹æ¥è¯„ä¼°æ¯ä¸ªæ“ä½œç±»å‹çš„æˆæœ¬ï¼Œç„¶åé€šè¿‡åé¦ˆæœºåˆ¶è‡ªåŠ¨æ”¹è¿›å®ƒä»¬ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯åœ¨éƒ¨ç½²è¡ŒåŠ¨åæŸ¥è¯¢çš„å»¶è¿Ÿæ—¶é—´å‘ç”Ÿäº†å˜åŒ–ã€‚è¿™ä¸ªå¥½å¤„æ¥è‡ª DBMS çš„å†…éƒ¨æŸ¥è¯¢è®¡åˆ’å™¨æˆæœ¬æ¨¡å‹ã€‚å®ƒæ˜¯åŠ æƒè®¡ç®—çš„è¡ŒåŠ¨éƒ¨ç½²åæŸ¥è¯¢æ ·æœ¬å»¶è¿Ÿæ”¹è¿›çš„æ€»å’Œï¼Œæƒé‡æ˜¯é¢„æµ‹æ¨¡å‹é¢„æµ‹çš„æœŸæœ›æŸ¥è¯¢å®Œæˆç‡ã€‚ é™¤äº†ä¸Šè¿°çš„æˆæœ¬-æ”¶ç›Šåˆ†æä¹‹å¤–ï¼Œç³»ç»Ÿè¿˜å¿…é¡»è¯„ä¼°ä¸€ä¸ªè¡ŒåŠ¨å¦‚ä½•éšæ—¶é—´æ¨ç§»å½±å“ Peloton çš„å†…å­˜ä½¿ç”¨ã€‚ä»»ä½•å¯¼è‡´ DBMS è¶…è¿‡å†…å­˜é˜ˆå€¼çš„è¡ŒåŠ¨éƒ½éœ€è¦èˆå¼ƒã€‚ é‡è¦çš„æ˜¯ï¼Œç³»ç»Ÿåœ¨è€ƒè™‘è¡ŒåŠ¨æ—¶åº”è¯¥è€ƒè™‘å¤šé•¿æ—¶é—´è·¨åº¦ã€‚å¤ªçŸ­ä¼šé˜»æ­¢ DBMS åŠæ—¶ä¸ºå³å°†åˆ°æ¥çš„è´Ÿè½½å³°å€¼åšå¥½å‡†å¤‡ï¼Œä½†å¤ªé•¿ä¼šä½¿ DBMS æ— æ³•ç¼“è§£çªç„¶å‡ºç°çš„é—®é¢˜ï¼Œå› ä¸ºæ¨¡å‹å¤ªæ…¢ã€‚æ­¤å¤–ï¼Œç”±äºè®¡ç®—æ¯ä¸ªæ—¶é—´çºªå…ƒçš„æˆæœ¬-æ”¶ç›Šæ˜¯æ˜‚è´µçš„ï¼Œå®ƒå¯èƒ½åˆ›å»ºå¦ä¸€ä¸ªæ·±åº¦å­¦ä¹ ç½‘ç»œæ¥è¿‘ä¼¼å®ƒä»¬å€¼å‡½æ•°ã€‚ éƒ¨ç½²ï¼šPeloton æ”¯æŒéé˜»å¡æ–¹æ³•éƒ¨ç½²è¡ŒåŠ¨ã€‚ä¾‹å¦‚ï¼Œé‡æ–°ç»„ç»‡è¡¨çš„å¸ƒå±€æˆ–å°†å…¶ç§»åŠ¨åˆ°ä¸åŒçš„ä½ç½®å¹¶ä¸ä¼šé˜»æ­¢æŸ¥è¯¢è¯¥è¡¨ã€‚æœ‰äº›æ“ä½œï¼Œå¦‚æ·»åŠ ç´¢å¼•ï¼Œéœ€è¦ç‰¹åˆ«è€ƒè™‘ã€‚è¿™æ · DBMS å°±ä¸ä¼šå› ä¸ºåœ¨æ“ä½œè¿›è¡Œæ—¶æ•°æ®è¢«ä¿®æ”¹ï¼Œå¯¼è‡´ä»»ä½•é”™è¯¯å‘ç”Ÿã€‚ DBMS è¿˜ä»å…¶é›†æˆçš„æœºå™¨å­¦ä¹ ç»„ä»¶å¤„ç†èµ„æºè°ƒåº¦å’Œç«äº‰é—®é¢˜ã€‚ä½¿ç”¨å•ç‹¬çš„åå¤„ç†å™¨æˆ– GPU æ¥å¤„ç†ç¹é‡çš„è®¡ç®—ä»»åŠ¡ï¼Œå¯ä»¥é¿å…é™ä½ DBMS çš„é€Ÿåº¦ã€‚å¦åˆ™ï¼ŒDBMS å°†ä¸å¾—ä¸ä½¿ç”¨ä¸€å°å•ç‹¬çš„æœºå™¨ï¼Œä¸“é—¨ç”¨äºæ‰€æœ‰çš„é¢„æµ‹å’Œè®¡ç®—ç»„ä»¶ã€‚è¿™å°†ä½¿ç³»ç»Ÿçš„è®¾è®¡å¤æ‚åŒ–ï¼Œå¹¶ç”±äºåè°ƒè€Œå¢åŠ é¢å¤–çš„å¼€é”€ã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:4:3","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"å…¶ä»–æ³¨æ„äº‹é¡¹è¦è®©è‡ªæ²» DBMS å¾—åˆ°å¹¿æ³›åº”ç”¨ï¼Œè¿˜éœ€è¦å…‹æœä¸€äº›éæŠ€æœ¯æŒ‘æˆ˜ã€‚æœ€é‡è¦çš„æ˜¯ DBA ä¸æ„¿æ„å°†æ•°æ®åº“æ§åˆ¶æƒäº¤ç»™è‡ªåŠ¨åŒ–ç³»ç»Ÿã€‚ä¸ºäº†ç®€åŒ–è¿‡æ¸¡ï¼Œè‡ªæ²» DBMS å¯ä»¥ä»¥å¯è§†åŒ–æ–¹å¼å…¬å¼€å…¶å†³ç­–è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå®ƒé€‰æ‹©æ·»åŠ ä¸€ä¸ªç´¢å¼•ï¼Œå¯ä»¥å‘ DBA è§£é‡Šï¼Œå®ƒçš„æ¨¡å‹è¡¨æ˜å½“å‰çš„å·¥ä½œè´Ÿè½½ä¸è¿‡å»æŸä¸ªæ—¶é—´ç‚¹ç›¸ä¼¼ï¼Œè¿™ä¸ªæ—¶é—´ç‚¹ä½¿ç”¨è¿™æ ·çš„ç´¢å¼•æ˜¯æœ‰å¥½å¤„çš„ã€‚ è¿˜å¿…é¡»æ”¯æŒæ¥è‡ª DBA çš„æç¤ºï¼Œè¯´æ˜ç³»ç»Ÿæ˜¯å¦åº”è¯¥æ›´å¤šåœ°å…³æ³¨å·¥ä½œè´Ÿè½½çš„ OLTP æˆ– OLAP éƒ¨åˆ†ã€‚ç±»ä¼¼çš„ï¼Œå¯¹äºå¤šç§Ÿæˆ·éƒ¨ç½²ï¼Œç³»ç»Ÿéœ€è¦çŸ¥é“æ˜¯å¦åº”è¯¥å¯¹æ¯ä¸ªæ•°æ®åº“è¿›è¡Œç›¸åŒçš„è°ƒä¼˜ï¼Œæˆ–è€…ä¸€ä¸ªæ•°æ®åº“æ˜¯å¦æ¯”å…¶ä»–æ•°æ®åº“æ›´é‡è¦ã€‚ æœ€åï¼Œå¯èƒ½éœ€è¦ä¸º DBA æä¾›ä¸€ä¸ªè¦†ç›–æœºåˆ¶ã€‚äººç±»å‘èµ·çš„æ”¹å˜è¢«å½“ä½œå…¶ä»–ä¸€æ ·çš„è¡ŒåŠ¨ï¼ŒPeloton è®°å½•æ“ä½œå†å²æ¥å†³å®šè¯¥è¡ŒåŠ¨æ˜¯å¦æœ‰ç›Šã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ç³»ç»Ÿä¸å…è®¸é€†è½¬ã€‚ä¸ºäº†é˜²æ­¢ DBA åšå‡ºçš„é”™è¯¯å†³ç­–è¢«æ°¸ä¹…ä¿ç•™ï¼ŒDBMS å¯ä»¥è¦æ±‚ DBA æ‰‹åŠ¨è®¾ç½®ç”Ÿå‘½å‘¨æœŸã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:4:4","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"åˆæ­¥ç»“æœä½œè€…åœ¨ Peloton ä¸­é›†æˆäº† Tensorflowï¼Œä½¿ç”¨ä»ä¸€ä¸ªåœ¨çº¿è®¨è®ºç½‘ç«™ä¸€ä¸ªæœˆçš„æµé‡æ•°æ®ä¸­æå– 5200 ä¸‡ä¸ªæŸ¥è¯¢æ¥è®­ç»ƒä¸¤ä¸ª RNNã€‚ä½¿ç”¨ 75% çš„æ•°æ®å»è®­ç»ƒæ¨¡å‹ï¼Œ25% æ•°æ®å»éªŒè¯æ¨¡å‹ã€‚åœ¨è¾“å…¥ä¸Šåº”ç”¨äº†ä¸¤ä¸ªå †å çš„ LSTM å±‚ï¼Œç„¶åè¿æ¥åˆ°ä¸€ä¸ªçº¿å½¢å›å½’å±‚ï¼Œå¯¹è¿™äº›å±‚ä½¿ç”¨ 10% çš„ Drop ä»¥é¿å…è¿‡æ‹Ÿåˆã€‚ ç¬¬ä¸€ä¸ªæ¨¡å‹ä»¥åˆ†é’Ÿä¸ºç²’åº¦å»é¢„æµ‹ä¸‹ä¸€å°æ—¶å°†åˆ°è¾¾çš„æŸ¥è¯¢æ•°é‡ã€‚è¯¥æ¨¡å‹æ”¶å…¥æ˜¯ä¸€ä¸ªå‘é‡ï¼Œè¡¨ç¤ºè¿‡å»ä¸¤å°æ—¶å†…æ¯åˆ†é’Ÿçš„å·¥ä½œè´Ÿè½½ï¼Œè€Œè¾“å‡ºæ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œè¡¨ç¤ºä¸€å°æ—¶åé¢„æµ‹çš„å·¥ä½œè´Ÿè½½ã€‚ç¬¬äºŒä¸ªæ¨¡å‹ä½¿ç”¨ 24 å°æ—¶æ—¶åŸŸï¼Œç²’åº¦ä¸º 1 å°æ—¶ã€‚ RNNä¸çœŸå®è´Ÿè½½æ•°æ®çš„æ¯”è¾ƒç»“æœ ä¸¤ä¸ªRNNçš„è®­ç»ƒæ—¶é—´åˆ†åˆ«ä¸º 11 å’Œ 18 åˆ†é’Ÿï¼Œä»ä¸‹å›¾å¯çœ‹å‡ºï¼Œæ¨¡å‹èƒ½å¤Ÿä»¥ 11.3% çš„é”™è¯¯ç‡é¢„æµ‹ 1 å°æ—¶åçš„å·¥ä½œè´Ÿè½½ï¼Œä»¥ 13.2% çš„é”™è¯¯ç‡é¢„æµ‹ä¸€å¤©åçš„ã€‚å¯¹äºè®¡ç®—å¼€é”€ï¼Œå‰è€…å¤§çº¦æ˜¯ 2MBï¼ŒDBMS æ¢æµ‹æ¯ä¸ªæ¨¡å‹ä»¥è·å¾—æ–°é¢„æµ‹éœ€è¦ 2msï¼Œå‘å…¶æ·»åŠ ä¸€ä¸ªæ–°çš„æ•°æ®ç‚¹éœ€è¦ 5msã€‚ ä½¿ç”¨è¿™äº›æ¨¡å‹ï¼Œå¯ä»¥åœ¨ Peloton ä¸­å®ç°æ•°æ®ä¼˜åŒ–æ“ä½œã€‚æ ¹æ®è®¿é—®è¿™äº›è¡¨çš„æŸ¥è¯¢ç±»å‹ï¼Œå°†è¡¨è¿ç§»åˆ°ä¸åŒå¸ƒå±€ä¸­ã€‚æ¯ä¸ªè¡¨çš„â€œçƒ­â€å…ƒç»„å­˜å‚¨åœ¨è¡Œå¸ƒå±€ä¸­ï¼Œå·²ç»é’ˆå¯¹ OLTP ä¼˜åŒ–ï¼Œè€ŒåŒä¸€å¼ è¡¨ä¸­â€œå†·â€å…ƒç»„å­˜å‚¨åœ¨åˆ—å¸ƒå±€ä¸­ï¼Œå·²ç»é’ˆå¯¹ OLAP ä¼˜åŒ–ã€‚ä½¿ç”¨ HTAP å·¥ä½œè´Ÿè½½ï¼Œç™½å¤©æ‰§è¡Œ OLTP æ“ä½œï¼Œæ™šä¸Šæ‰§è¡Œ OLAP æŸ¥è¯¢ã€‚å½“å¯åŠ¨è‡ªåŠ¨å¸ƒå±€æ—¶ï¼Œåœ¨ Peloton ä¸­æ‰§è¡ŒæŸ¥è¯¢åºåˆ—ï¼Œå¹¶å°†å…¶ä¸é™æ€çš„è¡Œå’Œåˆ—å¸ƒå±€è¿›è¡Œæ¯”è¾ƒã€‚ è‡ªåŠ¨äº¤å‰å¸ƒå±€ä¸é™æ€å¸ƒå±€åœ¨HTAPåº”ç”¨ä¸­çš„æ€§èƒ½æ¯”è¾ƒ ä»ä¸Šå›¾å¯çœ‹å‡ºï¼ŒPeloton éšç€æ—¶é—´æ¨ç§»æ”¶æ•›åˆ°ä¸€ç§é€‚åˆå·¥ä½œè´Ÿè½½çš„å¸ƒå±€ã€‚åœ¨ç¬¬ä¸€æ®µåï¼ŒDBMS å°†è¡Œå…ƒç»„è¿ç§»åˆ°åˆ—å¸ƒå±€ï¼Œé€‚åº” OLAPã€‚æ¥ä¸‹æ¥ï¼Œå½“å·¥ä½œè´Ÿè½½è½¬ç§»åˆ° OLTP æŸ¥è¯¢æ—¶ï¼Œè‡ªæ²» DBMS æ¯”é™æ€ç³»ç»Ÿæ›´å¥½ï¼Œå› ä¸ºå®ƒæ‰§è¡Œçš„å†…å­˜å†™æ“ä½œæ›´å°‘ã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:5:0","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"æ€»ç»“éšç€å¤§æ•°æ®è¿åŠ¨å…´èµ·ï¼Œå¯¹è‡ªæ²» DBMS çš„éœ€æ±‚è¶Šæ¥è¶Šå¤§ã€‚è¿™ç±»ç³»ç»Ÿå°†é™ä½äººåŠ›æˆæœ¬åœ¨éƒ¨ç½²ä»»ä½•è§„æ¨¡æ•°æ®åº“ä¸Šçš„æµªè´¹ï¼Œå¹¶ä½¿å„ç»„ç»‡æ›´å®¹æ˜“äº«å—æ•°æ®é©±åŠ¨å†³ç­–å¸¦æ¥çš„ä¾¿åˆ©ã€‚è®ºæ–‡æ¦‚è¿°äº† Peloton DBMS çš„è‡ªæ²»æ¶æ„ã€‚ä½œè€…è®¤ä¸ºï¼Œç”±äºæ·±åº¦ç¥ç»ç½‘ç»œã€æ–°ç¡¬ä»¶å’Œé«˜æ€§èƒ½æ•°æ®åº“æ¶æ„ï¼Œè‡ªæ²» DBMS ç³»ç»Ÿæ˜¯å¯ä»¥å®ç°çš„ã€‚ ","date":"2021-01-22","objectID":"/self-driving-dbms/:6:0","tags":["è®ºæ–‡","DBMS","æ•°æ®åº“ç®¡ç†"],"title":"è‡ªæ²»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ","uri":"/self-driving-dbms/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"Lakehouseæ¶æ„æ”¯æŒå¼€æ”¾çš„æ•°æ®æ ¼å¼ã€æœºå™¨å­¦ä¹ ï¼Œæä¾›å“è¶Šçš„æ€§èƒ½ï¼Œæ˜¯ç¬¬ä¸‰ä»£æ•°æ®åˆ†æå¹³å°çš„ä»£è¡¨","date":"2021-01-06","objectID":"/lakehouse/","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"æ³¨æ„ Lakehouseæ¶æ„é€æ¸åœ¨å·¥ä¸šç•Œé“ºå¼€ï¼Œç¬¬ä¸‰ä»£æ•°æ®åˆ†æå¹³å°è¿›å…¥å¤§ä¼—è§†é‡ï¼ åŸæ–‡åœ¨è¿™é‡Œ ğŸ‘‰ Lakehouse ","date":"2021-01-06","objectID":"/lakehouse/:0:0","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"æ‘˜è¦è®ºæ–‡è®¤ä¸ºæ•°æ®ä»“åº“æ¶æ„åœ¨æœªæ¥ä¸€æ®µæ—¶é—´å†…ä¼šé€æ¸æ¶ˆäº¡ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¸€ç§æ–°å‹ Lakehouseæ¶æ„ï¼Œè¯¥æ¶æ„å…·æœ‰å¦‚ä¸‹ç‰¹ç‰¹æ€§ï¼š åŸºäºå¼€æ”¾çš„æ•°æ®æ ¼å¼ï¼Œä¾‹å¦‚ Apache Parquet å®Œå…¨æ”¯æŒæœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦ æä¾›å“è¶Šçš„æ€§èƒ½ Lakehouse è§£å†³æ•°æ®ä»“åº“é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜â€”â€”æ•°æ®é™ˆæ—§ã€å¯é æ€§ä¸é«˜ã€æ€»æˆæœ¬å¤§ã€æ•°æ®æ ¼å¼å—é™ã€åœºæ™¯æ”¯æŒå—é™ã€‚è®ºæ–‡ä¸‹é¢ä¼šè®¨è®º Lakehouse æ¶æ„ä¸ºä½•å–å¾—å·¥ä¸šç•Œé’çä»¥åŠå¦‚ä½•å½±å“æ•°æ®ç®¡ç†ã€‚ ","date":"2021-01-06","objectID":"/lakehouse/:1:0","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"æ•°æ®åˆ†æå¹³å°å‘å±•æ•°æ®ä»“åº“å°†ä¸šåŠ¡æ•°æ®åº“çš„æ•°æ®æ”¶é›†åˆ°é›†ä¸­å¼ä»“åº“ï¼Œå¸®åŠ©ä¼ä¸šé¢†å¯¼åˆ†ææ•°æ®ï¼Œä¹‹åè¢«ç”¨äºå†³ç­–æ”¯æŒå’Œå•†ä¸šæ™ºèƒ½Business Intelligenceã€‚æ•°æ®ä»“åº“ä½¿ç”¨å†™æ¨¡å¼schema-on-writeå†™å…¥æ•°æ®ï¼Œä¼˜åŒ–ä¸‹æ¸¸BIæ¶ˆè´¹çš„æ•°æ®æ¨¡å‹ã€‚è¿™å°±æ˜¯ç¬¬ä¸€ä»£æ•°æ®åˆ†æå¹³å°ã€‚ ç¬¬ä¸€ä»£æ•°æ®åˆ†æå¹³å° åæ¥ç¬¬ä¸€ä»£å¹³å°å¼€å§‹é¢ä¸´è¯¸å¤šæŒ‘æˆ˜ã€‚é¦–å…ˆæ˜¯è®¡ç®—ä¸å­˜å‚¨è€¦åˆä½¿å¾—æ‰©å®¹æˆæœ¬å¢åŠ ï¼Œè¿™è¿«ä½¿ä¼ä¸šæ”¯ä»˜ç”¨æˆ·è´Ÿè½½å’Œæ•°æ®ç®¡ç†å³°å€¼çš„æˆæœ¬ï¼Œè¿™ä¸ªæˆæœ¬éšç€æ•°æ®è§„æ¨¡å¢åŠ è€Œè¿…é€Ÿå¢åŠ ã€‚å…¶æ¬¡ï¼Œè¶Šæ¥è¶Šå¤šçš„æ•°æ®é›†æ˜¯éç»“æ„åŒ–çš„ï¼Œä¾‹å¦‚è§†é¢‘ã€éŸ³é¢‘å’Œæ–‡æœ¬æ–‡æ¡£ï¼Œè€Œæ•°æ®ä»“åº“æ— æ³•å­˜å‚¨ã€æŸ¥è¯¢è¿™ç±»æ•°æ®ã€‚ ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç¬¬äºŒä»£æ•°æ®åˆ†æå¹³å°å°†æ‰€æœ‰åŸå§‹æ•°æ®å¯¼å…¥æ•°æ®æ¹–ï¼šå…·æœ‰æ–‡ä»¶ API çš„ä½æˆæœ¬å­˜å‚¨ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå¯å­˜å‚¨å¼€æ”¾æ•°æ®æ ¼å¼ï¼Œä¾‹å¦‚ Apache Parquet å’Œ ORCã€‚è¿™ä¸ªæ–¹æ³•æºèµ·äº Apache Hadoopï¼ŒåŸºäº HDFS å®ç°ä½æˆæœ¬å­˜å‚¨ã€‚æ•°æ®æ¹–æ˜¯ä¸€ç§è¯»æ¨¡å¼schema-on-readæ¶æ„ï¼Œå¯ä»¥çµæ´»ã€ä½æˆæœ¬åœ°å­˜å‚¨æ•°æ®ï¼Œä¹Ÿè§£å†³äº†æ•°æ®è´¨é‡å’Œä¸‹æ¸¸ç®¡ç†çš„é—®é¢˜ã€‚è¯¥æ¶æ„ä¸­çš„ä¸€å°éƒ¨åˆ†æ•°æ®åœ¨è¿›è¡Œ ETL åæ³¨å…¥ä¸‹æ¸¸æ•°æ®ä»“åº“ï¼Œå†è¿›è¡Œå†³ç­–æ”¯æŒå’Œ BI åˆ†æã€‚å¼€æ”¾æ•°æ®æ ¼å¼ä½¿å¾—ç»å¤§å¤šæ•°åˆ†æå¼•æ“å¯ä»¥ç›´æ¥è®¿é—®æ•°æ®æ¹–æ•°æ®ã€‚ ç¬¬äºŒä»£æ•°æ®åˆ†æå¹³å°ï¼ˆæ•°æ®æ¹–+æ•°æ®ä»“åº“ï¼‰ 2015å¹´èµ·ï¼Œäº‘æ•°æ®æ¹–ï¼ˆS3ã€ADLSã€GCSã€OSSç­‰ï¼‰å¼€å§‹å–ä»£HDFSï¼Œå®ƒä»¬å…·æœ‰è¶…å¼ºçš„æŒä¹…æ€§ã€å†—ä½™å¯é ã€è¶…ä½å­˜å‚¨æˆæœ¬ã€‚äº‘ä¸Šæ¶æ„ä¸ç¬¬äºŒä»£å¹³å°æ¶æ„ç›¸åŒï¼Œä¾‹å¦‚Redshiftã€Snowflakeã€‚æ•°æ®æ¹– + æ•°æ®ä»“åº“ ä¸¤å±‚æ¶æ„å½“ä»Šåœ¨å·¥ä¸šç•Œä¸­å ä¸»å¯¼åœ°ä½ã€‚ å¦‚ä»Šï¼Œè¿™ç§æ¶æ„é¢ä¸´æ–°çš„æŒ‘æˆ˜ã€‚å°½ç®¡å­˜å‚¨å’Œè®¡ç®—çš„åˆ†ç¦»ä½¿å¾—äº‘æ•°æ®æ¹– + æ•°æ®ä»“åº“æ¶æ„çš„æˆæœ¬é™ä½ï¼Œå¯å¢åŠ äº†ç”¨æˆ·çš„ä½¿ç”¨æˆæœ¬ã€‚åœ¨ç¬¬ä¸€ä»£å¹³å°ä¸­ï¼Œæ‰€æœ‰ä¸šåŠ¡æ•°æ®åº“ä¸­çš„æ•°æ®ç»è¿‡ETLåç›´æ¥æ³¨å…¥æ•°æ®ä»“åº“ã€‚ç¬¬äºŒä»£å¹³å°å´åœ¨ä¸­é—´å¼•è¿›äº†æ•°æ®æ¹–ï¼Œå¢åŠ äº†é¢å¤–çš„å¤æ‚æ€§ã€å»¶è¿Ÿä¸æ•…éšœç‡ã€‚åŒæ—¶ï¼Œæ•°æ®æ¹– + æ•°æ®ä»“åº“äºŒå±‚æ¶æ„ä¸èƒ½å¾ˆå¥½æ”¯æŒæœºå™¨å­¦ä¹ ä¹‹ç±»çš„é«˜çº§åˆ†æã€‚å…·ä½“æ¥çœ‹ï¼Œå¯ä»¥å½’çº³ä¸ºå››ä¸ªé—®é¢˜ï¼š å¯é æ€§ã€‚ä¿æŒæ•°æ®æ¹–ä¸æ•°æ®ä»“åº“çš„ä¸€è‡´æ€§æ˜¯æˆæœ¬é«˜æ˜‚ä¸”å›°éš¾çš„äº‹æƒ…ã€‚éœ€è¦å¯¹ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´çš„ ETL ä½œä¸šè¿›è¡Œä»”ç»†è®¾è®¡ï¼Œå¦‚æ­¤æ–¹å¯è¿›è¡Œé«˜æ€§èƒ½å†³ç­–æ”¯æŒä¸ BI åˆ†æã€‚æ¯ä¸ªETLæ­¥éª¤è¿˜æœ‰å‘ç”Ÿæ•…éšœæˆ–å¼•å…¥é”™è¯¯çš„é£é™©ï¼Œä¾‹å¦‚ç”±äºæ•°æ®æ¹–å’Œæ•°æ®ä»“åº“å¼•æ“ä¹‹é—´çš„ç»†å¾®å·®åˆ«è€Œå¯¼è‡´æ•°æ®è´¨é‡é™ä½çš„é£é™©ã€‚ æ•°æ®é™ˆæ—§ã€‚æ•°æ®ä»“åº“æ•°æ®çš„æ—¶æ•ˆæ€§ä½äºæ•°æ®æ¹–æ•°æ®ï¼Œæ–°æ•°æ®çš„åŠ è½½é€šå¸¸è¦èŠ±è´¹å‡ å¤©ã€‚ä¸ç¬¬ä¸€ä»£åˆ†æç³»ç»Ÿç›¸æ¯”ï¼Œè¿™æ˜¯ä¸ªå€’é€€ï¼Œç¬¬ä¸€ä»£åˆ†æç³»ç»Ÿå¯ä»¥ç›´æ¥æŸ¥è¯¢æ–°çš„ä¸šåŠ¡æ•°æ®ã€‚æ ¹æ® Dimensional Research ä¸ Fivetran è°ƒæŸ¥ï¼Œ86% çš„åˆ†æä½¿ç”¨è¿‡æ—¶æ•°æ®ï¼Œ62% çš„æŠ¥å‘Šæ¯æœˆéœ€è¦ç­‰å¾…å‡ æ¬¡å¼•æ“èµ„æºã€‚ å¯¹é«˜çº§åˆ†ææ”¯æŒæœ‰é™ã€‚ä¼ä¸šå¸Œæœ›ä½¿ç”¨æ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œä¾‹å¦‚â€œæˆ‘åº”è¯¥ä¸ºå“ªäº›é¡¾å®¢æä¾›æŠ˜æ‰£ï¼Ÿâ€ã€‚ å°½ç®¡è®¸å¤šç ”ç©¶å…³æ³¨æœºå™¨å­¦ä¹ ä¸æ•°æ®ç®¡ç†ç»“åˆï¼Œä½†ä¸»æµæœºå™¨å­¦ä¹ ç³»ç»Ÿæ²¡æœ‰ä¸€ä¸ªå¯ä»¥å·¥ä½œåœ¨æ•°æ®ä»“åº“ä¸Šï¼ŒåŒ…æ‹¬ TensorFlowã€PyTorch å’Œ XGBoostã€‚ä¸ BI æŸ¥è¯¢å°‘é‡æ•°æ®ä¸åŒï¼Œè¿™äº›æœºå™¨å­¦ä¹ ç³»ç»Ÿéœ€è¦ä½¿ç”¨å¤æ‚çš„ No-SQL ä»£ç å¤„ç†å¤§å‹æ•°æ®é›†ï¼Œä½†é€šè¿‡ ODBC/JDBC è¯»å–æ•°æ®æ•ˆç‡å¾ˆä½ï¼Œå¹¶ä¸”æ— æ³•ç›´æ¥è®¿é—®æ•°æ®ä»“åº“å†…éƒ¨ä¸“æœ‰æ ¼å¼çš„æ•°æ®ã€‚å¯¹äºè¿™ç±»åœºæ™¯ï¼Œæ•°æ®ä»“åº“ä¾›åº”å•†å»ºè®®å¯¼å‡ºæ•°æ®ä¸ºæ–‡ä»¶ï¼Œä½†è¿™å¢åŠ äº†å¤æ‚æ€§å’Œæ»åæ€§ï¼Œå› ä¸ºæ·»åŠ äº†ç¬¬ä¸‰ä¸ª ETLã€‚æˆ–è€…ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ”¯æŒå¼€å‘æ ¼å¼çš„æ•°æ®æ¹–ä¸Šè¿è¡Œè¿™äº›ç³»ç»Ÿï¼Œè¿™ä¼šæŠ›å¼ƒæ•°æ®ä»“åº“ä¸°å¯Œçš„æ•°æ®ç®¡ç†åŠŸèƒ½ï¼Œä¾‹å¦‚ ACID äº‹åŠ¡ã€æ•°æ®ç‰ˆæœ¬æ§åˆ¶ä¸ç´¢å¼•ã€‚ æ€»æˆæœ¬ã€‚é™¤äº†æ”¯ä»˜ ETL ä½œä¸šè´¹ç”¨å¤–ï¼Œç”¨æˆ·è¿˜å¾—ä¸ºå¤åˆ¶åˆ°æ•°æ®ä»“åº“çš„æ•°æ®æ”¯ä»˜ä¸¤å€çš„å­˜å‚¨æˆæœ¬ï¼Œè€Œæ•°æ®ä»“åº“ä½¿ç”¨çš„å†…éƒ¨æ ¼å¼é¢å¤–å¼•å…¥æ•°æ®æˆ–å·¥ä½œè´Ÿè½½è¿ç§»åˆ°å…¶ä»–ç³»ç»Ÿçš„æˆæœ¬ã€‚ ä¸€ç§è¢«å¹¿æ³›é‡‡ç”¨çš„è§£å†³æ–¹æ¡ˆæ˜¯ä¸ä½¿ç”¨æ•°æ®æ¹– ï¼Œå°†æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨è®¡ç®—ã€å­˜å‚¨åˆ†ç¦»çš„æ•°æ®ä»“åº“ä¸­ã€‚è®ºæ–‡è®¤ä¸ºè¿™ç§æ–¹æ¡ˆå¯è¡Œæ€§æœ‰é™ï¼Œå› ä¸ºä¸æ”¯æŒè§†é¢‘ã€éŸ³é¢‘å’Œæ–‡æœ¬æ•°æ®æˆ–ä»æœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦å·¥ä½œè´Ÿè½½ä¸­ç›´æ¥è®¿é—®ã€‚ è®ºæ–‡ä½œè€…æå‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šæ˜¯å¦å¯ä»¥å°†åŸºäºå¼€æ”¾æ•°æ®æ ¼å¼ï¼ˆParquet ä¸ ORCï¼‰çš„æ•°æ®æ¹–è½¬ä¸ºä¸€ä¸ªé«˜æ€§èƒ½ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿæ—¢æ‹¥æœ‰æ•°æ®ä»“åº“å¼ºå¤§çš„æ€§èƒ½ã€ç®¡ç†åŠŸèƒ½ï¼Œåˆå¯ç›´æ¥ã€å¿«é€Ÿè®¿é—®é«˜çº§åˆ†æå·¥ä½œè´Ÿè½½ï¼Ÿéšç€è¶Šæ¥è¶Šå¤šçš„ä¸šåŠ¡åº”ç”¨å¼€å§‹ä¾èµ–è¿è¥æ•°æ®å’Œé«˜çº§åˆ†æï¼ŒLakehouse æ¶æ„å¯ä»¥æ¶ˆé™¤æ•°æ®ä»“åº“çš„ä¸Šè¿°æŒ‘æˆ˜ã€‚ ä½œè€…ç›¸ä¿¡ Lakehouse çš„æ—¶æœºå·²ç»åˆ°æ¥ï¼ Lakehouseæ¶æ„ Lakehouseå¯è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š æ•°æ®æ¹–ä¸Šå¯é çš„æ•°æ®ç®¡ç†ï¼šLakehouse éœ€è¦å­˜å‚¨åŸå§‹æ•°æ®ï¼ŒåŒæ—¶æ”¯æŒ ETL/ELT æµç¨‹æ¥æé«˜æ•°æ®åˆ†æè´¨é‡ã€‚ä¼ ç»Ÿæ•°æ®æ¹–å°†åŠç»“æ„åŒ–æ•°æ®ä»¥â€œä¸€å †æ–‡ä»¶â€å½¢å¼è¿›è¡Œç®¡ç†ï¼Œå¾ˆéš¾æä¾›ä¸€äº›ç®€åŒ–ETL/ELTçš„å…³é”®ç®¡ç†åŠŸèƒ½ï¼Œä¾‹å¦‚äº‹åŠ¡ã€å›æ»šã€é›¶æ‹·è´ã€‚ç„¶è€Œï¼Œä»¥ Delta Lake å’Œ Apache Iceberg ä¸ºä»£è¡¨çš„æ–°å‹æ•°æ®æ¹–æ¡†æ¶æä¾›äº†æ•°æ®æ¹–çš„äº‹ç‰©è§†å›¾ï¼Œå¹¶æä¾›äº†ç®¡ç†åŠŸèƒ½ï¼Œå‡å°‘ ETL æ­¥éª¤ï¼Œå¹¶ä¸”åˆ†æäººå‘˜å¯ä»¥é«˜æ•ˆæŸ¥è¯¢åŸå§‹æ•°æ®è¡¨ï¼Œè¿™ä¸ç¬¬ä¸€ä»£åˆ†æå¹³å°å¾ˆåƒã€‚ æ”¯æŒæœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦ï¼šæœºå™¨å­¦ä¹ ç³»ç»Ÿæ”¯æŒç›´æ¥è¯»å–æ•°æ®æ¹–æ•°æ®æ ¼å¼ï¼Œå¾ˆå¤šç³»ç»Ÿé‡‡ç”¨ DataFrames ä½œä¸ºæ“ä½œæ•°æ®çš„æŠ½è±¡ï¼Œè€Œå£°æ˜å¼ DataFrame APIs å¯ä»¥ä¸ºæœºå™¨å­¦ä¹ å·¥ä½œè´Ÿè½½ä¸­çš„æ•°æ®è®¿é—®è¿›è¡ŒæŸ¥è¯¢ä¼˜åŒ–ï¼Œå¯ä»¥è®©æœºå™¨å­¦ä¹ å·¥ä½œè´Ÿè½½ç›´æ¥äº«å— Lakehouse çš„ä¼˜åŒ–ç‚¹ã€‚ SQLæ€§èƒ½ï¼šLakehouse éœ€è¦åœ¨æµ·é‡ Parquet/ORC æ•°æ®é›†ä¸Šæä¾›å¾ˆå¥½çš„ SQL æ€§èƒ½ï¼Œç›¸æ¯”ä¹‹ä¸‹ç»å…¸æ•°æ®ä»“åº“å¯¹ SQL ä¼˜åŒ–æ›´å½»åº•ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè®ºæ–‡æå‡ºéœ€è¦ç»´æŠ¤ Parquet/ORC æ•°æ®é›†çš„è¾…åŠ©æ•°æ®ï¼Œåœ¨ç°æœ‰æ ¼å¼å†…ä¼˜åŒ–æ•°æ®å¸ƒå±€ä»¥å®ç°æ›´å¥½çš„æ€§èƒ½ã€‚ ","date":"2021-01-06","objectID":"/lakehouse/:2:0","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"å‡ºå‘ç‚¹ï¼šæ•°æ®ä»“åº“çš„æŒ‘æˆ˜å½“å‰å·¥ä¸šç•Œå¯¹æ•°æ®ä»“åº“ä¸æ˜¯å¾ˆæ»¡æ„ã€‚é¦–å…ˆæ˜¯æ•°æ®è´¨é‡å’Œå¯é æ€§ä¸é«˜ï¼Œç»´æŠ¤æ•°æ®æµåˆ†æçš„å‡†ç¡®æ€§æ˜¯ä¸€ä»¶å¾ˆå›°éš¾çš„å·¥ä½œã€‚å…¶æ¬¡ï¼Œè¶Šæ¥è¶Šå¤šçš„å•†ä¸šåˆ†æéœ€è¦æœ€æ–°çš„æ•°æ®ï¼Œä½†æ•°æ®ä»“åº“ä¸å¯é¿å…åœ°å¼•å…¥æ•°æ®æ»åæ€§ã€‚ç¬¬ä¸‰ï¼Œå¦‚ä»Šçš„éç»“æ„åŒ–æ•°æ®æ¯”é‡å¤§å¹…å¢åŠ ï¼Œä½†æ•°æ®ä»“åº“å¹¶ä¸èƒ½æä¾›å¾ˆå¥½çš„éç»“æ„åŒ–æ•°æ®åˆ†æã€‚æœ€åï¼Œç°åœ¨å·¥ä¸šç•Œéƒ¨ç½²çš„æœºå™¨å­¦ä¹ ä¸æ•°æ®ç§‘å­¦åº”ç”¨æ— æ³•ä»æ•°æ®ä»“åº“å’Œæ•°æ®æ¹–ä¸­å¾—åˆ°å¾ˆå¥½çš„æ”¯æŒã€‚ å½“å‰å·¥ä¸šç•Œå¯¹æ•°æ®æ¹– + æ•°æ®ä»“åº“çš„ä¸¤å±‚æ¶æ„å¹¶ä¸æ»¡æ„ã€‚é¦–å…ˆæ˜¯å‡ ä¹æ‰€æœ‰çš„æ•°æ®ä»“åº“è¿‘æœŸéƒ½å¢åŠ äº†å¯¹ Parquet å’Œ ORC æ ¼å¼çš„å¤–éƒ¨è¡¨æ”¯æŒï¼Œå…è®¸æ•°æ®ä»“åº“ç”¨æˆ·å¯ä»¥ä»ç›¸åŒçš„ SQL å¼•æ“æŸ¥è¯¢æ•°æ®æ¹–è¡¨ï¼Œä½†è¿™æ²¡æœ‰é™ä½æ•°æ®æ¹–ç®¡ç†éš¾åº¦ï¼Œä¹Ÿæ²¡æœ‰æ¶ˆé™¤æ•°æ®ä»“åº“ ETL å¤æ‚åº¦ã€æ»åæ€§å’Œé«˜çº§åˆ†ææŒ‘æˆ˜ã€‚å®é™…ä¸Šï¼Œè¿™äº›æ”¯æŒçš„æ€§èƒ½é€šå¸¸è¾ƒå·®ï¼Œå› ä¸º SQL å¼•æ“ä¸»è¦é’ˆå¯¹å…¶å†…éƒ¨æ•°æ®æ ¼å¼è¿›è¡Œäº†ä¼˜åŒ–ã€‚å…¶æ¬¡ï¼Œç›´æ¥é’ˆå¯¹æ•°æ®æ¹–å­˜å‚¨çš„ SQL å¼•æ“ä¹Ÿæœ‰å¹¿æ³›äº§å“ï¼Œä¾‹å¦‚ Spark SQLã€Prestoã€Hive å’Œ AWS Athenaã€‚ç„¶è€Œï¼Œè¿™äº›å¼•æ“ä¸èƒ½è§£å†³æ•°æ®æ¹–æ‰€æœ‰é—®é¢˜ï¼Œä¹Ÿä¸èƒ½å–ä»£æ•°æ®ä»“åº“ï¼Œæ•°æ®æ¹–ä»ç„¶ç¼ºå°‘åŒ…æ‹¬ ACID äº‹åŠ¡çš„åŸºç¡€ç®¡ç†åŠŸèƒ½å’Œæœ‰æ•ˆè®¿é—®æ–¹æ³•ï¼Œä¾‹å¦‚ä¸æ•°æ®ä»“åº“æ€§èƒ½åŒ¹é…çš„ç´¢å¼•ã€‚ ","date":"2021-01-06","objectID":"/lakehouse/:3:0","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"Lakehouse æ¶æ„è®ºæ–‡ä¸º Lakehouse æå‡ºä¸€ä¸ªå®šä¹‰ï¼šåŸºäºä½æˆæœ¬ã€ç›´æ¥è®¿é—®å­˜å‚¨çš„æ•°æ®ç®¡ç†ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå…·æœ‰ä¼ ç»Ÿåˆ†æå‹ DBMS ç®¡ç†å’Œæ€§èƒ½ï¼Œä¾‹å¦‚ ACID äº‹åŠ¡ã€æ•°æ®ç‰ˆæœ¬ç®¡ç†ã€æ•°æ®å®¡è®¡ã€ç´¢å¼•ã€ç¼“å­˜å’ŒæŸ¥è¯¢ä¼˜åŒ–ã€‚å¯ä»¥çœ‹å‡ºï¼ŒLakehouse ç»“åˆäº†æ•°æ®æ¹–å’Œæ•°æ®ä»“åº“çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚é—®é¢˜çš„å…³é”®åœ¨äºæ˜¯å¦å¯ä»¥æœ‰æ•ˆç»“åˆè¿™äº›ä¼˜åŠ¿ï¼Œç‰¹åˆ«æ˜¯ Lakehouse å¯¹ç›´æ¥è®¿é—®çš„æ”¯æŒæ„å‘³ç€å…¶æ”¾å¼ƒäº†éƒ¨åˆ†æ•°æ®ç‹¬ç«‹æ€§ã€‚ Lakehouse å¤©ç„¶é€‚åˆè®¡ç®—ã€å­˜å‚¨åˆ†ç¦»çš„äº‘ç¯å¢ƒï¼šä¸åŒçš„è®¡ç®—åº”ç”¨ç¨‹åºæŒ‰éœ€åˆ†é…åœ¨å®Œå…¨ç‹¬ç«‹çš„è®¡ç®—èŠ‚ç‚¹ï¼ˆä¾‹å¦‚ ML çš„ GPU é›†ç¾¤ï¼‰ï¼ŒåŒæ—¶ç›´æ¥è®¿é—®ç›¸åŒçš„å­˜å‚¨æ•°æ®ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°å­˜å‚¨ç³»ç»Ÿï¼ˆå¦‚ HDFSï¼‰ä¸Šå®ç° Lakehouseã€‚ ","date":"2021-01-06","objectID":"/lakehouse/:4:0","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"å®ç° Lakehouse ç³»ç»Ÿå®ç° Lakehouse çš„ç¬¬ä¸€ä¸ªå…³é”®æ€æƒ³æ˜¯ä½¿ç”¨æ ‡å‡†æ–‡ä»¶æ ¼å¼ï¼ˆå¦‚ Parquetï¼‰å°†æ•°æ®å­˜å‚¨åœ¨ä½æˆæœ¬çš„å¯¹è±¡å­˜å‚¨ï¼ˆå¦‚ Amazon S3ã€OSSï¼‰ä¸­ï¼Œå¹¶åœ¨å¯¹è±¡å­˜å‚¨ä¸Šå®ç°å…ƒæ•°æ®å±‚ï¼Œå…¶å®šä¹‰äº†å“ªäº›å¯¹è±¡æ˜¯è¡¨ç‰ˆæœ¬ä¸€éƒ¨åˆ†ã€‚è¿™ä½¿ç³»ç»Ÿå¯ä»¥åœ¨å…ƒæ•°æ®å±‚å®ç°å¦‚ ACID äº‹åŠ¡å¤„ç†æˆ–ç‰ˆæœ¬æ§åˆ¶ä¹‹ç±»çš„ç®¡ç†åŠŸèƒ½ï¼ŒåŒæ—¶å°†å¤§é‡æ•°æ®ä¿å­˜åœ¨ä½æˆæœ¬å¯¹è±¡å­˜å‚¨ä¸­ï¼Œå¹¶å…è®¸å®¢æˆ·ç«¯ä½¿ç”¨ä½¿ç”¨æ ‡å‡†æ–‡ä»¶æ ¼å¼ç›´æ¥ä»è¯¥å­˜å‚¨ä¸­è¯»å–å¯¹è±¡ã€‚ å°½ç®¡å…ƒæ•°æ®å±‚å¢åŠ äº†ç®¡ç†åŠŸèƒ½ï¼Œä½†ä¸è¶³ä»¥å®ç°è‰¯å¥½çš„ SQL æ€§èƒ½ã€‚æ•°æ®ä»“åº“ä½¿ç”¨å¤šç§æŠ€æœ¯è·å¾—æ€§èƒ½æå‡ï¼Œæ¯”å¦‚å°†çƒ­æ•°æ®å­˜å‚¨åœ¨ SSD ç­‰é«˜é€Ÿè®¾å¤‡ã€ç»´æŠ¤ç»Ÿè®¡ä¿¡æ¯ã€æ„å»ºæœ‰æ•ˆçš„è®¿é—®æ–¹æ³•ï¼ˆå¦‚ç´¢å¼•ï¼‰ä»¥åŠä¼˜åŒ–æ•°æ®æ ¼å¼å’Œè®¡ç®—å¼•æ“ã€‚åŸºäºç°æœ‰å­˜å‚¨æ ¼å¼çš„ Lakehouse æ— æ³•å˜æ›´æ ¼å¼ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥å®ç°ä¿æŒæ•°æ®æ–‡ä»¶ä¸å˜æƒ…å†µä¸‹çš„å…¶ä»–ä¼˜åŒ–ï¼ŒåŒ…æ‹¬ç¼“å­˜ã€è¾…åŠ©æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚ç´¢å¼•å’Œç»Ÿè®¡ä¿¡æ¯ï¼‰å’Œæ•°æ®å¸ƒå±€ä¼˜åŒ–ã€‚ æœ€ç»ˆï¼ŒLakehouse æ—¢å¯ä»¥åŠ å¿«é«˜çº§åˆ†æè´Ÿè½½ï¼Œåˆå¯ä»¥ä¸ºå…¶æä¾›æ›´å¥½çš„æ•°æ®ç®¡ç†åŠŸèƒ½ã€‚è®¸å¤šæœºå™¨å­¦ä¹ åº“ï¼ˆå¦‚ Tensorflow å’Œ Spark MLlibï¼‰å·²ç»å¯ä»¥è¯»å–æ•°æ®æ¹–æ–‡ä»¶æ ¼å¼ï¼ˆå¦‚ Parquetï¼‰ã€‚å› æ­¤å°†å®ƒä»¬ä¸ Lakeehouse é›†æˆæœ€ç®€å•æ–¹æ³•æ˜¯æŸ¥è¯¢å…ƒæ•°æ®å±‚ï¼ŒæŸ¥è¯¢å“ªäº› Parquet æ–‡ä»¶å±äºè¡¨ï¼Œç„¶åå°†å®ƒä»¬ä¼ é€’ç»™æœºå™¨å­¦ä¹ åº“ã€‚è¿™äº›ç³»ç»Ÿæ”¯æŒ DataFrame APIï¼Œä»¥ä¾¿è¿›è¡Œæ›´å¥½çš„ä¼˜åŒ–ã€‚R ä¸ Pandas æ¨å¹¿äº† DataFramesï¼Œä¸ºç”¨æˆ·æä¾›åŒ…å«å¤šç§æ“ä½œç¬¦çš„è¡¨æŠ½è±¡ï¼Œå…¶ä¸­å¤§å¤šæ•°æ˜ å°„åˆ°å…³ç³»ä»£æ•°ã€‚Spark SQL ç­‰ç³»ç»Ÿé€šè¿‡æƒ°æ€§è®¡ç®—è½¬æ¢ä¸ä¼ é€’ç»“æœæ“ä½œæ­¥éª¤åˆ°ä¼˜åŒ–å™¨å®ç°è¯¥ API å£°æ˜å¼ã€‚å› æ­¤ï¼Œè¿™äº› API å¯åˆ©ç”¨ Lakehouse æ–°ä¼˜åŒ–ç‰¹æ€§å®ç°æœºå™¨å­¦ä¹ åŠ é€Ÿï¼Œä¾‹å¦‚ç¼“å­˜å’Œè¾…åŠ©æ•°æ®ã€‚ APIs and Lakehouse ","date":"2021-01-06","objectID":"/lakehouse/:4:1","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"ç”¨äºæ•°æ®ç®¡ç†çš„å…ƒæ•°æ®å±‚Lakehouses çš„ç¬¬ä¸€ä¸ªç»„ä»¶æ˜¯å…ƒæ•°æ®å±‚ï¼Œå…¶å¯ä»¥å®ç° ACID äº‹åŠ¡å’Œå…¶ä»–ç®¡ç†åŠŸèƒ½ã€‚è¯¸å¦‚ S3 æˆ– HDFS ä¹‹ç±»çš„æ•°æ®æ¹–å­˜å‚¨ç³»ç»Ÿä»…æä¾›äº†ä½çº§çš„å¯¹è±¡å­˜å‚¨æˆ–æ–‡ä»¶ç³»ç»Ÿæ¥å£ï¼Œåœ¨è¿™äº›æ¥å£ä¸­ï¼Œå³ä½¿æ˜¯ç®€å•çš„æ“ä½œï¼ˆå¦‚æ›´æ–°è·¨å¤šä¸ªæ–‡ä»¶çš„è¡¨ï¼‰ä¹Ÿä¸æ˜¯åŸå­çš„ï¼Œè¿™ä¸ªé—®é¢˜ä½¿å¾—ä¸€äº›ç»„ç»‡å¼€å§‹è®¾è®¡æ›´ä¸°å¯Œçš„æ•°æ®ç®¡ç†å±‚ï¼Œä» Apache Hive ACID å¼€å§‹ï¼Œå…¶ä½¿ç”¨ OLTP DBMS è·Ÿè¸ªç»™å®šè¡¨ç‰ˆæœ¬ä¸­å“ªäº›æ•°æ®æ–‡ä»¶æ˜¯ Hive è¡¨çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶å…è®¸æ“ä½œä»¥äº‹åŠ¡æ–¹å¼æ›´æ–°æ­¤é›†åˆã€‚è¿‘å¹´æ¥ä¸€äº›æ–°ç³»ç»Ÿæä¾›äº†æ›´å¤šåŠŸèƒ½å’Œæ”¹è¿›çš„å¯ä¼¸ç¼©æ€§ï¼Œå¦‚ 2016 å¹´ Databricks å¼€å‘çš„ Delta Lakeï¼Œå…¶å°†æœ‰å…³å“ªäº›å¯¹è±¡æ˜¯è¡¨ä¸­ä¸€éƒ¨åˆ†çš„ä¿¡æ¯å­˜å‚¨åœ¨æ•°æ®æ¹–ä¸­ï¼Œä½œä¸º Parquet æ ¼å¼çš„äº‹åŠ¡æ—¥å¿—ï¼Œä½¿å…¶èƒ½å¤Ÿæ‰©å±•åˆ°æ¯å¼ è¡¨æ•°åäº¿ä¸ªå¯¹è±¡ï¼›Netflix çš„ Apache Iceberg ä¹Ÿä½¿ç”¨ç±»ä¼¼çš„è®¾è®¡ï¼Œå¹¶æ”¯æŒ Parquet å’Œ ORC å­˜å‚¨ï¼›Apache Hudi å§‹äº Uber ä¹Ÿç±»ä¼¼ï¼Œå°½ç®¡å®ƒä¸æ”¯æŒå¹¶å‘å†™å…¥ï¼ˆæ­£åœ¨æ”¯æŒä¸­ï¼‰ï¼Œè¯¥ç³»ç»Ÿä¾§é‡äºç®€åŒ–æµå¼æ•°æ®å…¥æ•°æ®æ¹–ã€‚ è¿™äº›ç³»ç»Ÿçš„ç»éªŒè¡¨æ˜å®ƒä»¬å¯ä»¥æä¾›ä¸åŸå§‹ Parquet/ORC æ•°æ®æ¹–ç±»ä¼¼æˆ–æ›´å¥½çš„æ€§èƒ½ï¼ŒåŒæ—¶è¿˜å¢åŠ äº†éå¸¸æœ‰ç”¨çš„ç®¡ç†åŠŸèƒ½ï¼Œä¾‹å¦‚äº‹åŠ¡å¤„ç†ï¼Œé›¶æ‹·è´å’Œå›æ»šã€‚ å…ƒæ•°æ®å±‚å¯¹æ•°æ®è´¨é‡éå¸¸é‡è¦ï¼Œä¾‹å¦‚å¯ä»¥å¯¹ Schema è¿›è¡Œæ ¡éªŒï¼Œä½¿å…¶ä¸ç ´åæ•°æ®è´¨é‡ã€‚ å¦å¤–å…ƒæ•°æ®å±‚å¯ä»¥å®ç°è¯¸å¦‚è®¿é—®æ§åˆ¶å’Œå®¡æ ¸æ—¥å¿—è®°å½•ä¹‹ç±»çš„æ²»ç†åŠŸèƒ½ï¼Œä¾‹å¦‚å…ƒæ•°æ®å±‚å¯ä»¥åœ¨æˆäºˆå®¢æˆ·ç«¯å‡­æ®ä»¥ä»äº‘å¯¹è±¡å­˜å‚¨è¯»å–è¡¨ä¸­çš„åŸå§‹æ•°æ®ä¹‹å‰ï¼Œæ£€æŸ¥æ˜¯å¦å…è®¸å®¢æˆ·ç«¯è®¿é—®è¡¨ï¼Œå¹¶ä¸”è®°å½•æ‰€æœ‰è®¿é—®è¡Œä¸ºã€‚ æœªæ¥æ–¹å‘å’Œæ›¿ä»£è®¾è®¡ã€‚ç”±äºæ•°æ®æ¹–çš„å…ƒæ•°æ®å±‚éå¸¸æ–°ï¼Œå› æ­¤å­˜åœ¨è®¸å¤šæ‚¬è€Œæœªå†³çš„é—®é¢˜å’Œæ›¿ä»£è®¾è®¡ã€‚ä¾‹å¦‚ Delta Lake è®¾è®¡ä¸ºå°†äº‹åŠ¡æ—¥å¿—å­˜å‚¨åœ¨å®ƒè¿è¡Œçš„åŒä¸€å¯¹è±¡å­˜å‚¨ä¸­ï¼ˆä¾‹å¦‚ S3ï¼‰ä»¥ç®€åŒ–ç®¡ç†ï¼ˆæ¶ˆé™¤äº†è¿è¡Œå•ç‹¬å­˜å‚¨ç³»ç»Ÿçš„éœ€è¦ï¼‰å¹¶æä¾›é«˜å¯ç”¨æ€§å’Œé«˜è¯»å–å¸¦å®½ï¼Œä½†å¯¹è±¡å­˜å‚¨çš„é«˜å»¶è¿Ÿé™åˆ¶äº†å®ƒå¯ä»¥æ”¯æŒçš„æ¯ç§’äº‹åŠ¡å¤„ç†é€Ÿç‡ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å°†å…ƒæ•°æ®ä½¿ç”¨æ›´å¿«çš„å­˜å‚¨ç³»ç»Ÿçš„è®¾è®¡å¯èƒ½æ›´å¯å–ã€‚åŒæ ·Delta Lakeã€Iceberg å’Œ Hudi ä»…æ”¯æŒå•è¡¨äº‹åŠ¡ï¼Œä½†ä¹Ÿå¯ä»¥æ‰©å±•ä»¥æ”¯æŒè·¨è¡¨äº‹åŠ¡ï¼Œä¼˜åŒ–äº‹åŠ¡æ—¥å¿—çš„æ ¼å¼å’Œç®¡ç†å¯¹è±¡çš„å¤§å°ä¹Ÿæ˜¯æœªè§£å†³çš„é—®é¢˜ã€‚ ","date":"2021-01-06","objectID":"/lakehouse/:4:2","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"Lakehouse ä¸­çš„ SQL æ€§èƒ½Lakehouse æ–¹æ¡ˆçš„æœ€å¤§æŠ€æœ¯é—®é¢˜å¯èƒ½æ˜¯å¦‚ä½•æä¾›æœ€æ–°çš„ SQL æ€§èƒ½ï¼ŒåŒæ—¶åˆæ”¾å¼ƒäº†ä¼ ç»Ÿ DBMS è®¾è®¡ä¸­å¾ˆå¤§ä¸€éƒ¨åˆ†çš„æ•°æ®ç‹¬ç«‹æ€§ï¼Œæœ‰å¾ˆå¤šè§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚å¯ä»¥åœ¨å¯¹è±¡å­˜å‚¨ä¸Šæ·»åŠ ä¸€ä¸ªç¼“å­˜å±‚ï¼Œä»¥åŠæ˜¯å¦å¯ä»¥æ›´æ”¹æ•°æ®å¯¹è±¡å­˜å‚¨æ ¼å¼è€Œä¸ä½¿ç”¨ç°æœ‰çš„æ ‡å‡†ï¼ˆä¾‹å¦‚ Parquet å’Œ ORCï¼ˆä¸æ–­æ”¹è¿›è¿™äº›æ ¼å¼çš„æ–°è®¾è®¡ä¸æ–­æ¶Œç°ï¼‰ï¼‰ã€‚æ— è®ºé‡‡ç”¨ä½•ç§è®¾è®¡ï¼Œæ ¸å¿ƒæŒ‘æˆ˜åœ¨äºæ•°æ®å­˜å‚¨æ ¼å¼å·²æˆä¸ºç³»ç»Ÿå…¬å…± API çš„ä¸€éƒ¨åˆ†ä»¥å…è®¸å¿«é€Ÿç›´æ¥è®¿é—®ï¼Œè¿™ä¸ä¼ ç»Ÿ DBMS ä¸åŒã€‚ æˆ‘ä»¬æå‡ºäº†å‡ ç§æŠ€æœ¯å¯ä»¥åœ¨ Lakehouse ä¸­ä¼˜åŒ– SQL æ€§èƒ½ï¼Œå¹¶ä¸”ä¸æ•°æ®æ ¼å¼æ— å…³ï¼Œå› æ­¤å¯ä»¥å°†å…¶ä¸ç°æœ‰æ ¼å¼æˆ–æœªæ¥æ•°æ®æ ¼å¼ä¸€èµ·ä½¿ç”¨ï¼Œè¿™äº›ä¸æ ¼å¼æ— å…³çš„ä¼˜åŒ–å¤§è‡´å¦‚ä¸‹ï¼š ç¼“å­˜ï¼šä½¿ç”¨å…ƒæ•°æ®å±‚æ—¶ï¼ŒLakehouse ç³»ç»Ÿå¯ä»¥å®‰å…¨åœ°å°†äº‘å¯¹è±¡å­˜å‚¨ä¸­çš„æ–‡ä»¶ç¼“å­˜åœ¨å¤„ç†èŠ‚ç‚¹ä¸Šæ›´å¿«çš„å­˜å‚¨è®¾å¤‡ï¼ˆä¾‹å¦‚ SSD å’Œ RAMï¼‰ä¸Šï¼Œæ­£åœ¨è¿è¡Œçš„äº‹åŠ¡å¯ä»¥ç¡®å®šè¯»å–ç¼“å­˜çš„æ–‡ä»¶æ˜¯å¦è¿˜æœ‰æ•ˆï¼Œæ­¤å¤–ç¼“å­˜å¯ä»¥é‡‡ç”¨è½¬ç æ ¼å¼ï¼Œå…¶å¯¹äºæŸ¥è¯¢å¼•æ“è¿è¡Œæ•ˆç‡æ›´é«˜ï¼Œä¾‹å¦‚åœ¨ Databricks çš„ç¼“å­˜ä¼šè§£å‹äº†éƒ¨åˆ†å®ƒåŠ è½½çš„ Parquet æ•°æ®ã€‚ è¾…åŠ©æ•°æ®ï¼šå³ä½¿ Lakehouse ä¸ºæ”¯æŒç›´æ¥ I/O è®¿é—®éœ€è¦å¼€æ”¾è¡¨å­˜å‚¨æ ¼å¼ï¼ˆå¦‚ Parquetï¼‰ï¼Œå®ƒä¹Ÿå¯ä»¥ç»´æŠ¤å…¶ä»–æ•°æ®æ¥å¸®åŠ©ä¼˜åŒ–æŸ¥è¯¢ï¼Œå¦‚åœ¨ Parquet æ–‡ä»¶ä¸­ç»´æŠ¤è¡¨ä¸­æ¯ä¸ªæ•°æ®æ–‡ä»¶çš„åˆ—æœ€å°-æœ€å¤§ç»Ÿè®¡ä¿¡æ¯ï¼Œæœ‰åŠ©äºè·³è¿‡æ•°æ®ï¼Œä»¥åŠåŸºäº Bloom è¿‡æ»¤å™¨çš„ç´¢å¼•ã€‚å¯ä»¥å®ç°å„ç§å„æ ·çš„è¾…åŠ©æ•°æ®ç»“æ„ï¼Œç±»ä¼¼äºä¸º\"åŸå§‹\"æ•°æ®å»ºç«‹ç´¢å¼•ã€‚ æ•°æ®å¸ƒå±€ï¼šæ•°æ®å¸ƒå±€åœ¨è®¿é—®æ€§èƒ½ä¸­èµ·ç€é‡è¦ä½œç”¨ã€‚Lakehouse ç³»ç»Ÿä¹Ÿå¯ä»¥ä¼˜åŒ–å¤šä¸ªå¸ƒå±€å†³ç­–ï¼Œæœ€æ˜æ˜¾çš„æ˜¯è®°å½•æ’åºï¼šå“ªäº›è®°å½•èšé›†åœ¨ä¸€èµ·å¯ä»¥æœ€å®¹æ˜“è¢«æ‰¹é‡è¯»å–ï¼ŒDelta ä¸­ä½¿ç”¨ Z-Orderï¼ŒHudi ä¸­ä½¿ç”¨åŸºäºå“ªäº›åˆ—è¿›è¡Œ Clusteringã€‚ å¯¹äºåˆ†æç³»ç»Ÿä¸­çš„å…¸å‹è®¿é—®æ¨¡å¼ï¼Œè¿™ä¸‰ä¸ªä¼˜åŒ–å¯ä»¥å¾ˆå¥½åœ°ååŒå·¥ä½œã€‚å…¸å‹çš„å·¥ä½œè´Ÿè½½ä¸­å¤§å¤šæ•°æŸ¥è¯¢å€¾å‘äºé›†ä¸­åœ¨æ•°æ®çš„\"çƒ­\"å­é›†ä¸Šï¼ŒLakehouse å¯ä»¥ä½¿ç”¨ä¸æ•°æ®ä»“åº“ç›¸åŒçš„ä¼˜åŒ–æ•°æ®ç»“æ„å¯¹å…¶è¿›è¡Œç¼“å­˜ï¼Œä»¥æä¾›ç›¸åŒçš„æŸ¥è¯¢æ€§èƒ½ã€‚å¯¹äºäº‘å¯¹è±¡å­˜å‚¨ä¸­çš„\"å†·\"æ•°æ®ï¼Œæ€§èƒ½çš„ä¸»è¦å†³å®šäºæ¯ä¸ªæŸ¥è¯¢è¯»å–çš„æ•°æ®é‡ï¼Œåœ¨è¯¥æƒ…å†µä¸‹æ•°æ®å¸ƒå±€ä¼˜åŒ–ï¼ˆå°†å…±åŒè®¿é—®çš„æ•°æ®èšç±»ï¼‰å’Œè¾…åŠ©æ•°æ®ç»“æ„ï¼ˆå¦‚åŒºåŸŸå›¾ï¼Œä½¿å¼•æ“å¿«é€Ÿç¡®å®šè¦è¯»å–çš„æ•°æ®æ–‡ä»¶èŒƒå›´ï¼‰çš„ç»„åˆå¯ä»¥ä½¿Lakehouseç³»ç»Ÿä¸æ•°ä»“ä¸€æ ·æœ€å°åŒ– I/O å¼€é”€ï¼Œå°½ç®¡ä½¿ç”¨æ ‡å‡†çš„å¼€æ”¾æ–‡ä»¶æ ¼å¼ï¼ˆç›¸æ¯”äºæ•°ä»“å†…ç½®æ–‡ä»¶æ ¼å¼ï¼‰ã€‚ æ€§èƒ½ç»“æœ TPC-DSæ¯”è¾ƒ æœªæ¥æ–¹å‘å’Œæ›¿ä»£è®¾è®¡ã€‚è®¾è®¡æ€§èƒ½è‰¯å¥½ä¸”å¯ä»¥ç›´æ¥è®¿é—®çš„ Lakehouse ç³»ç»Ÿæ˜¯æœªæ¥å·¥ä½œçš„é‡ç‚¹ã€‚ä¸€ä¸ªå°šå¾…æ¢ç´¢çš„æ–¹å‘æ˜¯è®¾è®¡æ›´å¥½é€‚åº”æ­¤ç±»åœºæ™¯çš„æ•°æ®æ¹–å­˜å‚¨æ ¼å¼ï¼Œä¾‹å¦‚ä¸º Lakehouse ç³»ç»Ÿå®ç°æ•°æ®å¸ƒå±€ä¼˜åŒ–æˆ–ç´¢å¼•æä¾›æ›´å¤§çµæ´»æ€§çš„å­˜å‚¨æ ¼å¼ï¼Œæˆ–è€…æ›´é€‚åˆç°ä»£ç¡¬ä»¶ã€‚ å³ä½¿ä¸æ”¹å˜æ•°æ®æ ¼å¼ï¼Œä¹Ÿæœ‰è®¸å¤šç¼“å­˜ç­–ç•¥ã€è¾…åŠ©æ•°æ®ç»“æ„å’Œæ•°æ®å¸ƒå±€ç­–ç•¥ã€‚å“ªä¸€ç§å¯¹äº‘å¯¹è±¡å­˜å‚¨ä¸­çš„æµ·é‡æ•°æ®é›†æ›´æœ‰æ•ˆæ˜¯ä¸€ä¸ªå¼€æ”¾å¼é—®é¢˜ã€‚ æœ€åï¼Œå¦ä¸€ä¸ªå€¼å¾—ç ”ç©¶çš„ç‚¹æ˜¯ç¡®å®šä½•æ—¶ä»¥åŠå¦‚ä½•ä½¿ç”¨ serverless è®¡ç®—ç³»ç»Ÿæ¥å“åº”æŸ¥è¯¢ã€ä¼˜åŒ–å­˜å‚¨ã€å…ƒæ•°æ®å±‚å’ŒæŸ¥è¯¢å¼•æ“ï¼Œä»¥å®ç°å»¶è¿Ÿæœ€å°åŒ–æ•ˆæœã€‚ ","date":"2021-01-06","objectID":"/lakehouse/:4:3","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"é«˜çº§åˆ†æé«˜æ•ˆè®¿é—®é«˜çº§åˆ†æåº“é€šå¸¸ä¸æ˜¯ä½¿ç”¨ SQL å‘½ä»¤ç¼–å†™ï¼Œå…¶éœ€è¦è®¿é—®å¤§é‡æ•°æ®ã€‚ä½œè€…è®¤ä¸ºéœ€è¦ç ”ç©¶ä»¥ä¸‹é—®é¢˜ï¼šå¦‚ä½•è®¾è®¡æ•°æ®è®¿é—®å±‚ï¼Œæœ€å¤§ç¨‹åº¦åœ°æé«˜é¡¶éƒ¨è¿è¡Œä»£ç çš„çµæ´»æ€§ï¼Œå¹¶ä¸”å¯ä»¥ä» Lakehouse çš„ä¼˜åŒ–ä¸­å—ç›Šï¼Ÿ ä¼˜åŒ–æ–¹æ¡ˆ ä½œè€…éªŒè¯äº†å¦‚ä¸Šå›¾æ‰€ç¤ºçš„ä¼˜åŒ–æ–¹æ¡ˆï¼šå°†ç¼“å­˜ã€æ•°æ®ç­›é€‰ã€æ•°æ®å¸ƒå±€ä¼˜åŒ–åŒæ—¶åº”ç”¨ï¼Œå®ç°äº†æœºå™¨å­¦ä¹ ç®—æ³•åŠ é€Ÿã€‚ æœºå™¨å­¦ä¹  API è¿…é€Ÿå‘å±•ï¼Œä½†æ˜¯ä¸€äº›æ•°æ®è®¿é—® APIï¼ˆä¾‹å¦‚ TensorFlow çš„ tf.dataï¼‰æ²¡æœ‰å°è¯•å°†æŸ¥è¯¢è¯­ä¹‰æ¨å…¥åº•å±‚å­˜å‚¨ç³»ç»Ÿï¼Œä¸€äº› API è¿˜ä¸“æ³¨äº CPU åˆ° GPU çš„ä¼ è¾“å’Œ GPU è®¡ç®—ï¼Œè¿™åœ¨æ•°æ®ä»“åº“ä¸­å¹¶æœªå¼•èµ·å¤ªå¤šå…³æ³¨ã€‚ æœªæ¥æ–¹å‘å’Œæ›¿ä»£è®¾è®¡ã€‚è®ºæ–‡æå‡ºéœ€è¦å¤šå…³æ³¨æœºå™¨å­¦ä¹ ç³»ç»Ÿçš„æ•°æ®è®¿é—®æ¥å£ã€‚è¿‘æœŸä¸€äº›æœºå™¨å­¦ä¹ æ¡†æ¶å°†ç®—æ³•é€»è¾‘èåˆè¿› SQL join æ“ä½œï¼Œå…¶ä»–åº”ç”¨åœ¨ç®—æ³•ä¸­çš„æŸ¥è¯¢ä¼˜åŒ–åº”ç”¨åœ¨ SQL ä¸­ã€‚æœ€åï¼Œä½œè€…è®¤ä¸ºéœ€è¦æ ‡å‡†æœºå™¨å­¦ä¹ æ¥å£ä»¥ä½¿æ•°æ®ç§‘å­¦å®¶èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ Lakehouseï¼ˆç”šè‡³æ•°æ®ä»“åº“ï¼‰ä¸­å¼ºå¤§çš„æ•°æ®ç®¡ç†åŠŸèƒ½ï¼Œå¦‚äº‹åŠ¡ï¼Œæ•°æ®ç‰ˆæœ¬æ§åˆ¶å’Œå›æ»šç­‰ã€‚ ","date":"2021-01-06","objectID":"/lakehouse/:4:4","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"ç ”ç©¶é—®é¢˜å’Œå¯ç¤ºLakehouse è¿˜æå‡ºäº†å…¶ä»–ä¸€äº›ç ”ç©¶é—®é¢˜ï¼ŒåŠŸèƒ½æ—¥ç›Šä¸°å¯Œçš„æ•°æ®æ¹–çš„è¡Œä¸šè¶‹åŠ¿ä¹Ÿå¯¹æ•°æ®ç³»ç»Ÿç ”ç©¶çš„å…¶ä»–é¢†åŸŸäº§ç”Ÿäº†å½±å“ã€‚ è¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥å®ç° Lakehouse ç›®æ ‡å—ï¼Ÿå¯ä»¥æƒ³åƒå…¶ä»–æ–¹æ³•æ¥å®ç° Lakehouse çš„ä¸»è¦ç›®æ ‡ï¼Œä¾‹å¦‚æ„å»ºç”¨äºæ•°æ®ä»“åº“çš„å¤§è§„æ¨¡å¹¶è¡ŒæœåŠ¡å±‚ï¼Œå¯ä»¥æ”¯æŒå¯¹é«˜çº§åˆ†æå·¥ä½œè´Ÿè½½çš„å¹¶è¡Œè¯»å–ï¼Œä½†æ˜¯ä¸å·¥ä½œè´Ÿè½½ç›´æ¥è®¿é—®å¯¹è±¡å­˜å‚¨åº“ç›¸æ¯”æˆæœ¬å°†æ›´é«˜ï¼Œéš¾ä»¥ç®¡ç†ï¼Œå¹¶ä¸”æ€§èƒ½å¯èƒ½ä¼šé™ä½ã€‚è¿™ç§æœåŠ¡å±‚å¹¶æœªå¾—åˆ°å¹¿æ³›åº”ç”¨ï¼Œä¾‹å¦‚ Hive LLAPã€‚ é™¤äº†åœ¨æ€§èƒ½ã€å¯ç”¨æ€§ã€æˆæœ¬å’Œé”å®šæ–¹é¢çš„æŒ‘æˆ˜å¤–ï¼Œè¿˜æœ‰ä¸€äº›é‡è¦çš„ç®¡ç†åŸå› ï¼Œå¦‚ä¼ä¸šå¯èƒ½æ›´å–œæ¬¢å°†æ•°æ®ä¿ç•™ä¸ºå¼€æ”¾æ ¼å¼ã€‚éšç€å¯¹æ•°æ®ç®¡ç†çš„æ³•è§„è¦æ±‚ä¸æ–­æé«˜ï¼Œç»„ç»‡å¯èƒ½éœ€è¦åœ¨çŸ­æ—¶é—´å†…æœç´¢æ—§æ•°æ®é›†ï¼Œåˆ é™¤å„ç§æ•°æ®æˆ–æ›´æ”¹å…¶æ•°æ®å¤„ç†åŸºç¡€ç»“æ„ï¼Œå¹¶ä¸”é‡‡ç”¨å¼€æ”¾æ ¼å¼è¿›è¡Œæ ‡å‡†åŒ–æ„å‘³ç€å®ƒä»¬å°†å§‹ç»ˆå¯ä»¥ç›´æ¥è®¿é—®æ•°æ®ï¼Œè½¯ä»¶è¡Œä¸šçš„é•¿æœŸè¶‹åŠ¿ä¸€ç›´æ˜¯å¼€æ”¾æ•°æ®æ ¼å¼ï¼Œä¼ä¸šæ•°æ®åº”è¯¥ç»§ç»­ä¿æŒè¿™ç§è¶‹åŠ¿ã€‚ ä»€ä¹ˆæ˜¯æ­£ç¡®çš„å­˜å‚¨æ ¼å¼å’Œè®¿é—® APIï¼ŸLakehouse çš„è®¿é—®æ¥å£åŒ…æ‹¬åŸå§‹å­˜å‚¨æ ¼å¼ä»¥åŠç›´æ¥è¯»å–æ­¤æ ¼å¼çš„å®¢æˆ·ç«¯åº“ï¼ˆä¾‹å¦‚ä½¿ç”¨ TensorFlow è¯»å–æ—¶ï¼‰ä»¥åŠé«˜çº§ SQL æ¥å£ã€‚æœ‰å¾ˆå¤šä¸åŒçš„æ–¹æ³•å¯ä»¥åœ¨è¿™äº›å±‚ä¸Šæ”¾ç½®ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä¾‹å¦‚é€šè¿‡è¦æ±‚è¯»è€…æ‰§è¡Œæ›´å¤æ‚çš„â€œå¯ç¼–ç¨‹â€è§£ç é€»è¾‘ï¼Œå¯ä»¥ä¸ºç³»ç»Ÿæä¾›æ›´å¤§çš„çµæ´»æ€§çš„å­˜å‚¨æ–¹æ¡ˆã€‚æœ‰å¾…è§‚å¯Ÿå“ªç§å­˜å‚¨æ ¼å¼ã€å…ƒæ•°æ®å±‚è®¾è®¡å’Œè®¿é—® API çš„ç»„åˆæ•ˆæœæœ€ä½³ã€‚ Lakehouse å¦‚ä½•å½±å“å…¶ä»–æ•°æ®ç®¡ç†ç ”ç©¶å’Œè¶‹åŠ¿ï¼Ÿæ•°æ®æ¹–çš„æµè¡Œä»¥åŠå¯¹ä¸°å¯Œç®¡ç†æ¥å£çš„ä½¿ç”¨ä¸æ–­å¢åŠ ï¼Œæ— è®ºå®ƒä»¬æ˜¯å…ƒæ•°æ®å±‚è¿˜æ˜¯å®Œæ•´çš„ Lakehouse è®¾è®¡ï¼Œéƒ½å¯¹æ•°æ®ç®¡ç†ç ”ç©¶çš„å…¶ä»–é¢†åŸŸäº§ç”Ÿäº†å½±å“ã€‚ Polystore æ—¨åœ¨è§£å†³è·¨ä¸åŒå­˜å‚¨å¼•æ“æŸ¥è¯¢æ•°æ®è¿™ä¸€éš¾é¢˜ï¼Œè¯¥é—®é¢˜åœ¨ä¼ä¸šä¸­æŒç»­å­˜åœ¨ï¼Œä½†æ˜¯åœ¨äº‘æ•°æ®æ¹–ä¸­ä»¥å¼€æ”¾æ ¼å¼æä¾›çš„æ•°æ®æ¯”ä¾‹è¶Šæ¥è¶Šé«˜ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç›´æ¥é’ˆå¯¹äº‘å¯¹è±¡å­˜å‚¨è¿è¡Œè®¸å¤š polystore æŸ¥è¯¢ï¼Œå³ä½¿åŸºç¡€æ•°æ®æ–‡ä»¶æ˜¯é€»è¾‘ä¸Šåˆ†å¼€çš„ Lakehouse çš„ä¸€éƒ¨åˆ†ã€‚ è¿˜å¯ä»¥åœ¨ Lakehouse ä¸Šè®¾è®¡æ•°æ®é›†æˆå’Œæ¸…ç†å·¥å…·ï¼Œå¹¶å¯ä»¥å¿«é€Ÿå¹¶è¡Œè®¿é—®æ‰€æœ‰æ•°æ®ï¼Œè¿™å¯ä»¥ç”¨äºå¤§å‹è”æ¥å’Œèšç±»ç­‰æ–°ç®—æ³•ã€‚ å¯ä»¥å°† HTAP ç³»ç»Ÿæ„å»ºä¸º Lakehouse å‰é¢çš„\"é™„åŠ \"å±‚ï¼Œé€šè¿‡ä½¿ç”¨å…¶äº‹åŠ¡ç®¡ç† API å°†æ•°æ®ç›´æ¥å½’æ¡£åˆ° Lakehouse ç³»ç»Ÿä¸­ï¼ŒLakehouse å°†èƒ½å¤ŸæŸ¥è¯¢æ•°æ®çš„ä¸€è‡´å¿«ç…§ã€‚ ML çš„æ•°æ®ç®¡ç†ä¹Ÿä¼šå˜å¾—æ›´åŠ ç®€å•å’Œå¼ºå¤§ï¼Œå¦‚ä»Šç»„ç»‡æ­£åœ¨æ„å»ºå„ç§å¯é‡æ–°å®ç°æ ‡å‡† DBMS åŠŸèƒ½çš„ï¼Œç‰¹å®šäº ML çš„æ•°æ®ç‰ˆæœ¬æ§åˆ¶å’Œç‰¹å¾å­˜å‚¨ç³»ç»Ÿï¼Œä½¿ç”¨å¸¦æœ‰å†…ç½® DBMS ç®¡ç†åŠŸèƒ½çš„æ•°æ®æ¹–æ¥å®ç°ç‰¹å¾å­˜å‚¨åŠŸèƒ½å¯èƒ½ä¼šæ›´ç®€å•ã€‚ Serverless å¼•æ“ä¹‹ç±»çš„äº‘åŸç”Ÿ DBMS è®¾è®¡å°†éœ€è¦ä¸æ›´ä¸°å¯Œçš„å…ƒæ•°æ®å±‚é›†æˆï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰«ææ•°æ®æ¹–ä¸­çš„åŸå§‹æ–‡ä»¶ï¼Œå¯ä»¥èƒ½å¤Ÿæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚ æœ€å Lakehouse çš„è®¾è®¡æ˜“äºåˆ†å¸ƒå¼åä½œï¼Œå› ä¸ºå¯ä»¥ä»å¯¹è±¡å­˜å‚¨åº“ç›´æ¥è®¿é—®æ‰€æœ‰æ•°æ®é›†ï¼Œè¿™ä½¿å¾—å…±äº«æ•°æ®å˜å¾—å¾ˆç®€å•ã€‚ ","date":"2021-01-06","objectID":"/lakehouse/:5:0","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"},{"categories":["è®ºæ–‡å­¦ä¹ "],"content":"ç»“è®ºåœ¨å¼€æ”¾çš„æ•°æ®æ¹–æ–‡ä»¶æ ¼å¼ä¸Šå®ç°æ•°æ®ä»“åº“åŠŸèƒ½çš„ç»Ÿä¸€æ•°æ®å¹³å°ä½“ç³»æ¶æ„å¯ä»¥ä¸ºå½“ä»Šçš„æ•°æ®ä»“åº“ç³»ç»Ÿæä¾›å…·æœ‰ç«äº‰åŠ›çš„æ€§èƒ½ï¼Œå¹¶æœ‰åŠ©äºåº”å¯¹æ•°æ®ä»“åº“ç”¨æˆ·é¢ä¸´çš„è®¸å¤šæŒ‘æˆ˜ï¼Œå°½ç®¡é™åˆ¶æ•°æ®ä»“åº“çš„å­˜å‚¨å±‚ä»¥æ ‡å‡†æ ¼å¼ç›´æ¥è®¿é—®çœ‹èµ·æ¥ä¼¼ä¹æ˜¯ä¸€ä¸ªé‡å¤§é™åˆ¶ï¼Œä½†è¯¸å¦‚çƒ­æ•°æ®ç¼“å­˜å’Œå†·æ•°æ®æ•°æ®å¸ƒå±€ä¼˜åŒ–ä¹‹ç±»çš„ä¼˜åŒ–å¯ä»¥ä½¿ Lakehouse è·å¾—å¾ˆä¸é”™çš„æ€§èƒ½ï¼Œå¦å¤–é‰´äºæ•°æ®æ¹–ä¸­å·²æœ‰å¤§é‡æ•°æ®ï¼Œå¹¶ä¸”æœ‰æœºä¼šå¤§å¤§ç®€åŒ–ä¼ä¸šæ•°æ®æ¶æ„ï¼Œè¡Œä¸šå¾ˆå¯èƒ½ä¼šå‘ Lakehouse æ¶æ„é€æ­¥è¿‡æ¸¡ã€‚ ","date":"2021-01-06","objectID":"/lakehouse/:6:0","tags":["è®ºæ–‡","æ•°æ®æ¹–","æ•°æ®ä»“åº“","æ•°æ®åˆ†æ"],"title":"Lakehouseï¼šç»Ÿä¸€æ•°æ®ä»“åº“å’Œé«˜çº§åˆ†æçš„å¼€æ”¾æ•°æ®å¹³å°","uri":"/lakehouse/"}]